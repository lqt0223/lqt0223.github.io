(function(t){function e(e){for(var i,o,c=e[0],r=e[1],d=e[2],l=0,u=[];l<c.length;l++)o=c[l],n[o]&&u.push(n[o][0]),n[o]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);p&&p(e);while(u.length)u.shift()();return a.push.apply(a,d||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],i=!0,c=1;c<s.length;c++){var r=s[c];0!==n[r]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=s[0]))}return t}var i={},n={app:0},a=[];function o(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=i,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(s,i,function(e){return t[e]}.bind(null,i));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var p=r;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"0038":function(t,e){!function(t){var e,s='<svg><symbol id="icon-success" viewBox="0 0 1024 1024"><path d="M512 995.555556C244.935111 995.555556 28.444444 779.064889 28.444444 512S244.935111 28.444444 512 28.444444s483.555556 216.490667 483.555556 483.555556-216.490667 483.555556-483.555556 483.555556z m0-56.888889c235.648 0 426.666667-191.018667 426.666667-426.666667C938.666667 276.352 747.648 85.333333 512 85.333333 276.352 85.333333 85.333333 276.352 85.333333 512c0 235.648 191.018667 426.666667 426.666667 426.666667z m250.225778-603.349334a28.444444 28.444444 0 1 1 39.992889 40.476445l-334.222223 330.268444a28.444444 28.444444 0 0 1-40.106666-0.128l-163.555556-163.555555a28.444444 28.444444 0 0 1 40.220445-40.220445l143.559111 143.559111 314.112-310.4z" fill="#FFFFFF" ></path></symbol><symbol id="icon-loading" viewBox="0 0 1024 1024"><path d="M958.862222 326.897778a28.444444 28.444444 0 0 1-52.551111 21.788444 427.320889 427.320889 0 0 0-92.615111-138.382222A425.159111 425.159111 0 0 0 512 85.333333C276.352 85.333333 85.333333 276.352 85.333333 512c0 235.648 191.018667 426.666667 426.666667 426.666667 235.648 0 426.666667-191.018667 426.666667-426.666667a28.444444 28.444444 0 1 1 56.888889 0c0 267.064889-216.490667 483.555556-483.555556 483.555556S28.444444 779.064889 28.444444 512 244.935111 28.444444 512 28.444444a482.033778 482.033778 0 0 1 341.930667 141.624889 484.209778 484.209778 0 0 1 104.931555 156.828445z" fill="#FFFFFF" ></path><path d="M995.555556 512a28.444444 28.444444 0 1 1-56.888889 0c0-132.878222-61.098667-255.616-163.726223-336.028444a28.444444 28.444444 0 0 1 35.100445-44.785778C926.279111 222.293333 995.555556 361.443556 995.555556 512z" fill="#006CB8" ></path></symbol><symbol id="icon-warning" viewBox="0 0 1024 1024"><path d="M512 995.555556C244.935111 995.555556 28.444444 779.064889 28.444444 512S244.935111 28.444444 512 28.444444s483.555556 216.490667 483.555556 483.555556-216.490667 483.555556-483.555556 483.555556z m0-56.888889c235.648 0 426.666667-191.018667 426.666667-426.666667C938.666667 276.352 747.648 85.333333 512 85.333333 276.352 85.333333 85.333333 276.352 85.333333 512c0 235.648 191.018667 426.666667 426.666667 426.666667z m-13.255111-711.111111h26.510222a28.444444 28.444444 0 0 1 28.444445 29.397333l-12.344889 369.777778A28.444444 28.444444 0 0 1 512.938667 654.222222h-1.877334a28.444444 28.444444 0 0 1-28.416-27.491555l-12.330666-369.777778A28.444444 28.444444 0 0 1 498.744889 227.555556zM512 810.666667a42.666667 42.666667 0 1 1 0-85.333334 42.666667 42.666667 0 0 1 0 85.333334z" fill="#FFFFFF" ></path></symbol><symbol id="icon-signin" viewBox="0 0 1024 1024"><path d="M170.666667 142.222222v28.444445a113.777778 113.777778 0 1 0 227.555555 0v-28.444445h227.555556v28.444445a113.777778 113.777778 0 1 0 227.555555 0v-28.444445h56.888889a113.777778 113.777778 0 0 1 113.777778 113.777778v654.222222a113.777778 113.777778 0 0 1-113.777778 113.777778H113.777778a113.777778 113.777778 0 0 1-113.777778-113.777778V256a113.777778 113.777778 0 0 1 113.777778-113.777778h56.888889z m0 227.555556a56.888889 56.888889 0 0 0-56.888889 56.888889v426.666666a56.888889 56.888889 0 0 0 56.888889 56.888889h682.666666a56.888889 56.888889 0 0 0 56.888889-56.888889V426.666667a56.888889 56.888889 0 0 0-56.888889-56.888889H170.666667z m113.777777-369.777778a56.888889 56.888889 0 0 1 56.888889 56.888889v113.777778a56.888889 56.888889 0 1 1-113.777777 0V56.888889a56.888889 56.888889 0 0 1 56.888888-56.888889z m455.111112 0a56.888889 56.888889 0 0 1 56.888888 56.888889v113.777778a56.888889 56.888889 0 1 1-113.777777 0V56.888889a56.888889 56.888889 0 0 1 56.888889-56.888889z m-77.568 496.056889a42.666667 42.666667 0 1 1 60.330666 60.330667L521.898667 756.821333a71.111111 71.111111 0 0 1-105.671111-5.674666l-79.672889-98.901334a42.666667 42.666667 0 1 1 66.446222-53.532444l69.76 86.570667 189.226667-189.226667z" fill="#FFFFFF" ></path></symbol><symbol id="icon-reward" viewBox="0 0 1024 1024"><path d="M856.177778 256H967.111111a56.888889 56.888889 0 0 1 56.888889 56.888889v113.777778a56.888889 56.888889 0 0 1-56.888889 56.888889H56.888889a56.888889 56.888889 0 0 1-56.888889-56.888889v-113.777778a56.888889 56.888889 0 0 1 56.888889-56.888889h129.735111a201.713778 201.713778 0 0 1-29.312-30.065778c-34.659556-43.633778-37.233778-93.980444-4.522667-146.318222 32.711111-52.352 79.089778-72.106667 133.489778-60.088889 35.271111 7.793778 61.809778 22.016 128.497778 63.715556l4.024889 2.503111c42.865778 26.794667 78.506667 59.505778 102.599111 93.624889 24.106667-34.119111 59.733333-66.830222 102.613333-93.624889l4.010667-2.503111c66.702222-41.699556 93.240889-55.921778 128.497778-63.715556 54.4-12.017778 100.792889 7.736889 133.504 60.088889 32.711111 52.337778 30.122667 102.684444-4.522667 146.318222A201.713778 201.713778 0 0 1 856.177778 256z m-514.517334 0h124.842667a114.631111 114.631111 0 0 0-9.528889-18.915556c-16.568889-27.136-46.307556-55.793778-83.399111-78.961777l-4.039111-2.531556c-57.102222-35.697778-79.928889-47.928889-101.660444-52.736-18.958222-4.181333-29.070222 0.113778-42.723556 21.973333s-13.084444 32.824889-1.024 48.028445c13.838222 17.422222 34.844444 32.583111 91.975111 68.266667l4.039111 2.517333c7.125333 4.465778 14.321778 8.590222 21.518222 12.359111zM701.155556 256a329.784889 329.784889 0 0 0 21.532444-12.359111l4.039111-2.517333c57.116444-35.683556 78.122667-50.844444 91.960889-68.266667 12.088889-15.203556 12.643556-26.168889-1.009778-48.028445-13.653333-21.859556-23.765333-26.168889-42.723555-21.973333-21.731556 4.807111-44.558222 17.038222-101.688889 52.736l-4.024889 2.531556c-37.077333 23.182222-66.816 51.825778-83.399111 78.947555A114.631111 114.631111 0 0 0 576.284444 256H701.155556zM140.942222 540.444444h742.144A69.831111 69.831111 0 0 1 952.888889 610.275556v343.893333A69.831111 69.831111 0 0 1 883.057778 1024H140.942222A69.831111 69.831111 0 0 1 71.111111 954.168889V610.275556A69.831111 69.831111 0 0 1 140.942222 540.444444zM512 597.333333a42.666667 42.666667 0 0 0-42.666667 42.666667v284.444444a42.666667 42.666667 0 0 0 85.333334 0V640a42.666667 42.666667 0 0 0-42.666667-42.666667z" fill="#FFFFFF" ></path></symbol></svg>',i=(e=document.getElementsByTagName("script"))[e.length-1].getAttribute("data-injectcss");if(i&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}!function(e){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(e,0);else{var s=function t(){document.removeEventListener("DOMContentLoaded",t,!1),e()};document.addEventListener("DOMContentLoaded",s,!1)}else document.attachEvent&&(i=e,n=t.document,a=!1,o=function(){a||(a=!0,i())},(c=function(){try{n.documentElement.doScroll("left")}catch(e){return void setTimeout(c,50)}o()})(),n.onreadystatechange=function(){"complete"==n.readyState&&(n.onreadystatechange=null,o())});var i,n,a,o,c}(function(){var t,e;(t=document.createElement("div")).innerHTML=s,s=null,(e=t.getElementsByTagName("svg")[0])&&(e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.width=0,e.style.height=0,e.style.overflow="hidden",function(t,e){e.firstChild?function(t,e){e.parentNode.insertBefore(t,e)}(t,e.firstChild):e.appendChild(t)}(e,document.body))})}(window)},"0059":function(t,e,s){},"0077":function(t,e,s){"use strict";var i=s("4263"),n=s.n(i);n.a},"00cb":function(t,e,s){"use strict";var i=s("c01d"),n=s.n(i);n.a},"00e6":function(t,e,s){},"02e5":function(t,e,s){},"0355":function(t,e,s){},"0357":function(t,e,s){},"051d":function(t,e,s){},"054f":function(t,e,s){"use strict";var i=s("ea6d"),n=s.n(i);n.a},"0650":function(t,e,s){},"07dd":function(t,e,s){"use strict";var i=s("622b"),n=s.n(i);n.a},"0a37":function(t,e,s){},"0a68":function(t,e,s){},"0a74":function(t,e,s){"use strict";var i=s("6288"),n=s.n(i);n.a},"0b48":function(t,e,s){"use strict";var i=s("12ca"),n=s.n(i);n.a},"0b49":function(t,e,s){},"0d5d":function(t,e,s){"use strict";var i=s("3e13"),n=s.n(i);n.a},"0f02":function(t,e,s){},"0f67":function(t,e,s){},"11f9":function(t,e,s){"use strict";var i=s("880b"),n=s.n(i);n.a},"12ca":function(t,e,s){},1458:function(t,e,s){},1470:function(t,e,s){},"166d":function(t,e,s){},1774:function(t,e,s){"use strict";var i=s("3244"),n=s.n(i);n.a},"19b6":function(t,e,s){},"1b20":function(t,e,s){},"1e58":function(t,e,s){"use strict";var i=s("da66"),n=s.n(i);n.a},2297:function(t,e,s){"use strict";var i=s("cb54"),n=s.n(i);n.a},"22c2":function(t,e,s){"use strict";var i=s("4d3c"),n=s.n(i);n.a},"25eb4":function(t,e,s){},2691:function(t,e,s){},"26d2":function(t,e,s){"use strict";var i=s("ef3e"),n=s.n(i);n.a},"272d":function(t,e,s){},2861:function(t,e,s){"use strict";var i=s("e637"),n=s.n(i);n.a},"2a6e":function(t,e,s){"use strict";var i=s("3cd0"),n=s.n(i);n.a},"2d3f":function(t,e,s){},"2dbc":function(t,e,s){"use strict";var i=s("d072"),n=s.n(i);n.a},"2dfb":function(t,e,s){"use strict";var i=s("5074"),n=s.n(i);n.a},"2eb6":function(t,e,s){"use strict";var i=s("300f"),n=s.n(i);n.a},"2fc9":function(t,e,s){"use strict";var i=s("a9d3"),n=s.n(i);n.a},"300f":function(t,e,s){},"313e":function(t,e,s){},"318b":function(t,e,s){},"31cd":function(t,e,s){"use strict";var i=s("c37f"),n=s.n(i);n.a},3244:function(t,e,s){},"33a7":function(t,e,s){},"344e":function(t,e,s){},"352a":function(t,e,s){"use strict";var i=s("f1b9"),n=s.n(i);n.a},"352c":function(t,e,s){"use strict";var i=s("6126"),n=s.n(i);n.a},3741:function(t,e,s){},3981:function(t,e,s){"use strict";var i=s("0355"),n=s.n(i);n.a},"3ae1":function(t,e,s){"use strict";var i=s("a29c"),n=s.n(i);n.a},"3cd0":function(t,e,s){},"3e13":function(t,e,s){},"3f41":function(t,e,s){"use strict";var i=s("50b7"),n=s.n(i);n.a},"3ffa":function(t,e,s){"use strict";var i=s("ba75"),n=s.n(i);n.a},4114:function(t,e,s){"use strict";var i=s("c25f"),n=s.n(i);n.a},"41fa":function(t,e,s){"use strict";var i=s("0650"),n=s.n(i);n.a},4263:function(t,e,s){},4536:function(t,e,s){"use strict";var i=s("3741"),n=s.n(i);n.a},"46ce":function(t,e,s){"use strict";var i=s("b06b"),n=s.n(i);n.a},"47e4":function(t,e,s){},"49bc":function(t,e,s){},"4ccb":function(t,e,s){},"4d3c":function(t,e,s){},"4df1":function(t,e,s){"use strict";var i=s("0357"),n=s.n(i);n.a},"4e38":function(t,e,s){"use strict";var i=s("166d"),n=s.n(i);n.a},"4e6b":function(t,e,s){},"4ea9":function(t,e,s){"use strict";var i=s("8f65"),n=s.n(i);n.a},"4ec4":function(t,e,s){"use strict";var i=s("1470"),n=s.n(i);n.a},5074:function(t,e,s){},"50b7":function(t,e,s){},5269:function(t,e,s){"use strict";var i=s("313e"),n=s.n(i);n.a},5591:function(t,e,s){"use strict";var i=s("6138"),n=s.n(i);n.a},5616:function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var i=s("2b0e"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("canvas",{attrs:{id:"cvs",width:t.w,height:t.h},on:{touchmove:t.handleTouchMove,mousemove:t.handleMouseMove}}),s("div",{staticClass:"control"},[s("div",{staticClass:"button",on:{click:t.handleLeft}},[t._v("left")]),s("div",{staticClass:"button",on:{click:t.handleForward}},[t._v("forward")]),s("div",{staticClass:"button",on:{click:t.handleBackward}},[t._v("backward")]),s("div",{staticClass:"button",on:{click:t.handleRight}},[t._v("right")])])])},a=[],o=(s("63d9"),s("2d3f"),s("25eb4"),[-1,-1,1,-1,-1,1,1,1,-1,1,1,-1]);function c(t,e,s){var i=e,n=s,a=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(a,i),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS))return console.error("An error occurred compiling the vertex shaders: "+t.getShaderInfoLog(a)),t.deleteShader(a),null;var o=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(o,n),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))return console.error("An error occurred compiling the fragment shaders: "+t.getShaderInfoLog(o)),t.deleteShader(o),null;var c=t.createProgram();return t.attachShader(c,a),t.attachShader(c,o),t.linkProgram(c),c}var r={data:function(){return{w:375,h:375,mouse:{x:0,y:0},cameraPos:{x:0,y:0,z:6},cameraDir:{yaw:0,pitch:0,x:0,y:0,z:-1}}},mounted:function(){var t=this;document.addEventListener("keypress",function(e){t.handleKeyPress(e)});var e=document.querySelector("#cvs").getContext("webgl",{antialias:!1}),s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s);var i=new Float32Array(o);e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW);var n=c(e,"\n        attribute vec4 aPosition;\n        varying vec4 vPosition;\n\n        void main() {\n          vPosition = aPosition;\n          gl_Position = aPosition;\n        }\n      ","\n        precision highp float;\n        uniform float u_time;\n        uniform vec2 u_resolution;\n        uniform vec2 u_mouse;\n        uniform vec3 u_camera_pos;\n        uniform vec3 u_camera_dir;\n        varying vec4 vPosition;\n\n        struct Hit {\n          bool miss;\n          float dist;\n          vec3 pos;\n          vec3 normal;\n          int id;\n        };\n\n        struct SceneInfo {\n          float dist;\n          int id;\n        };\n\n        const float screen_dist = 6.;\n        const vec3 light_pos = vec3(5.,5.,5.);\n        Hit miss = Hit(true, 1000., vec3(0.), vec3(0.), -1);\n\n        vec2 rotate2d(vec2 p, vec2 origin, float a) {\n          float c = cos(a);\n          float s = sin(a);\n          mat2 t = mat2(c,-s,s,c);\n          return t * (p - origin) + origin;\n        }\n\n        float sdf_sphere(vec3 p, vec3 origin, float radius) {\n          return length(p - origin) - radius;\n        }\n        \n        float sdf_scene_f(vec3 p) {\n          float d1 = sdf_sphere(p, vec3(-0.6,0.,-2.), 0.4);\n          float d2 = sdf_sphere(p, vec3(0.,0.,-4.), 0.4);\n          float d3 = sdf_sphere(p, vec3(0.6,0.,-6.), 0.4);\n          if (d1<d2&&d1<d3) {\n            return d1;\n          } else if (d2<d1&&d2<d3) {\n            return d2;\n          } else {\n            return d3;\n          }\n        }\n\n        SceneInfo sdf_scene(vec3 p) {\n          float d1 = sdf_sphere(p, vec3(-0.6,0.,-2.), 0.4);\n          float d2 = sdf_sphere(p, vec3(0.,0.,-4.), 0.4);\n          float d3 = sdf_sphere(p, vec3(0.6,0.,-6.), 0.4);\n          if (d1<d2&&d1<d3) {\n            return SceneInfo(d1, 0);\n          } else if (d2<d1&&d2<d3) {\n            return SceneInfo(d2, 1);\n          } else {\n            return SceneInfo(d3, 2);\n          }\n        }\n\n        vec3 normal_scene(vec3 p) {\n          float e = 0.0001;\n          vec2 h = vec2(e, 0.);\n          return normalize(vec3(\n            sdf_scene_f(p + h.xyy)- sdf_scene_f(p - h.xyy),\n            sdf_scene_f(p + h.yxy)- sdf_scene_f(p - h.yxy),\n            sdf_scene_f(p + h.yyx)- sdf_scene_f(p - h.yyx)\n          ));\n        }\n\n        Hit trace(vec3 ro, vec3 rd) {\n          float t = 0.;\n          for (int i = 0; i < 40; i++) {\n            vec3 p = ro + t * rd;\n            SceneInfo si = sdf_scene(p);\n            float dist = si.dist;\n            if (dist < 0.01) {\n              return Hit(false, t, p, normal_scene(p), si.id);\n            }\n            t += dist;\n            if (t > 100.) {\n              return miss;\n            }\n          }\n          return miss;\n        }\n\n        vec4 calc_color(Hit h) {\n          vec3 n = h.normal;\n          vec3 light = light_pos;\n          vec3 camera = u_camera_pos;\n          light.xz = rotate2d(light.xz, vec2(0.), u_time);\n          vec3 light_dir = normalize(light - h.pos);\n          vec3 view_dir = normalize(camera - h.pos);\n          vec3 reflected = reflect(-light_dir, n);\n\n          float diff = dot(light_dir, n);\n          float diffuse = pow(max(diff, 0.),4.);\n          float spec = dot(reflected, view_dir);\n          float specular = pow(max(spec, 0.), 64.);\n\n          float ambient = 0.1;\n\n          vec4 c = vec4(vec3(ambient+diffuse+specular), 1.);\n\n          return c;\n        }\n\n        void main() {\n          vec3 st = vec3(vPosition.xy, 0.);\n          st.x = st.x * u_resolution.x / u_resolution.y;\n          st.y = -st.y;\n\n          vec3 screen_origin = u_camera_pos + screen_dist * u_camera_dir;\n          vec3 v = normalize(u_camera_dir);\n          vec3 up = vec3(0.,1.,0.);\n          vec3 r = normalize(cross(v,up));\n          vec3 u = normalize(cross(v,r));\n          \n          mat4 basis = mat4(\n            r.x,r.y,r.z,0.,\n            u.x,u.y,u.z,0.,\n            v.x,v.y,v.z,0.,\n            0.,0.,0.,1.\n          );\n\n          mat4 translate = mat4(\n            1.,0.,0.,0.,\n            0.,1.,0.,0.,\n            0.,0.,1.,0.,\n            screen_origin.x,screen_origin.y,screen_origin.z,1.\n          );\n\n          mat4 view = translate * basis;\n          vec4 str = vec4(st,1.);\n          str = view * str;\n\n          vec3 rd = normalize(str.xyz - u_camera_pos);\n          vec3 ro = u_camera_pos;\n          Hit result = trace(ro, rd);\n          if (!result.miss) {\n            vec4 mo = vec4(u_mouse, 0.,1.);\n            mo = view * mo;\n            mo.xyz = mo.xyz - screen_dist * u_camera_dir;\n            vec3 md = u_camera_dir;\n            Hit mouseResult = trace(mo.xyz, md);\n            vec4 c = calc_color(result);\n            if (!mouseResult.miss && mouseResult.id == result.id) {\n              c.r += 0.5;\n            }\n            gl_FragColor = c;\n          } else {\n            gl_FragColor = vec4(vec3(0.2), 1.);\n          }\n        }\n      "),a=0,r=0,d=this.w,p=this.h,l=this;function u(t){t||(t=0),t*=5e-4;var i=t-r;r=t,e.clearColor(0,0,0,0),e.bindBuffer(e.ARRAY_BUFFER,s),e.vertexAttribPointer(0,2,e.FLOAT,!1,8,0),e.enableVertexAttribArray(0),e.bindAttribLocation(n,0,"aPosition"),e.linkProgram(n),e.useProgram(n);var o=e.getUniformLocation(n,"u_time");e.uniform1f(o,a);var c=e.getUniformLocation(n,"u_mouse");e.uniform2f(c,l.mouse.x,l.mouse.y);var _=e.getUniformLocation(n,"u_resolution");e.uniform2f(_,d,p);var m=e.getUniformLocation(n,"u_camera_pos");e.uniform3f(m,l.cameraPos.x,l.cameraPos.y,l.cameraPos.z);var h=e.getUniformLocation(n,"u_camera_dir");e.uniform3f(h,l.cameraDir.x,l.cameraDir.y,l.cameraDir.z),e.drawArrays(e.TRIANGLES,0,6),a+=i,window.requestAnimationFrame(function(t){return u(t)})}u()},methods:{crossProduct:function(t,e,s,i,n,a){return[e*a-s*n,s*i-t*i,t*n-e*i]},degToRad:function(t){return 3.14159*t/180},handleLeft:function(t){var e=.1,s=this.crossProduct(this.cameraDir.x,this.cameraDir.y,this.cameraDir.z,0,1,0);this.cameraPos.x-=e*s[0],this.cameraPos.y-=e*s[1],this.cameraPos.z-=e*s[2]},handleRight:function(t){var e=.1,s=this.crossProduct(this.cameraDir.x,this.cameraDir.y,this.cameraDir.z,0,1,0);this.cameraPos.x+=e*s[0],this.cameraPos.y+=e*s[1],this.cameraPos.z+=e*s[2]},handleForward:function(t){var e=.1;this.cameraPos.x+=e*this.cameraDir.x,this.cameraPos.y+=e*this.cameraDir.y,this.cameraPos.z+=e*this.cameraDir.z},handleBackward:function(t){var e=.1;this.cameraPos.x-=e*this.cameraDir.x,this.cameraPos.y-=e*this.cameraDir.y,this.cameraPos.z-=e*this.cameraDir.z},handleKeyPress:function(t){var e=t.key,s=.1;if("w"===e)this.cameraPos.x+=s*this.cameraDir.x,this.cameraPos.y+=s*this.cameraDir.y,this.cameraPos.z+=s*this.cameraDir.z;else if("s"===e)this.cameraPos.x-=s*this.cameraDir.x,this.cameraPos.y-=s*this.cameraDir.y,this.cameraPos.z-=s*this.cameraDir.z;else if("a"===e){var i=this.crossProduct(this.cameraDir.x,this.cameraDir.y,this.cameraDir.z,0,1,0);this.cameraPos.x-=s*i[0],this.cameraPos.y-=s*i[1],this.cameraPos.z-=s*i[2]}else if("d"===e){var n=this.crossProduct(this.cameraDir.x,this.cameraDir.y,this.cameraDir.z,0,1,0);this.cameraPos.x+=s*n[0],this.cameraPos.y+=s*n[1],this.cameraPos.z+=s*n[2]}},handleMouseMove:function(t){t.preventDefault();var e=t.clientX/this.w-.5,s=t.clientY/this.h-.5;s=-s,e*=360,e=this.degToRad(e),s*=180,s=this.degToRad(s),this.cameraDir.pitch=s,this.cameraDir.yaw=e,this.cameraDir.z=-Math.cos(this.cameraDir.pitch)*Math.cos(this.cameraDir.yaw),this.cameraDir.y=Math.sin(this.cameraDir.pitch),this.cameraDir.x=Math.cos(this.cameraDir.pitch)*Math.sin(this.cameraDir.yaw)},handleTouchMove:function(t){t.preventDefault();var e=t.touches[0].clientX/this.w-.5,s=t.touches[0].clientY/this.h-.5;s=-s,e*=360,e=this.degToRad(e),s*=180,s=this.degToRad(s),this.cameraDir.pitch=s,this.cameraDir.yaw=e,this.cameraDir.z=-Math.cos(this.cameraDir.pitch)*Math.cos(this.cameraDir.yaw),this.cameraDir.y=Math.sin(this.cameraDir.pitch),this.cameraDir.x=Math.cos(this.cameraDir.pitch)*Math.sin(this.cameraDir.yaw)}}},d=r,p=(s("5c0b"),s("2877")),l=Object(p["a"])(d,n,a,!1,null,null,null),u=l.exports,_=s("8c4f"),m=s("75fc"),h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-list"},[s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchEcProductList}},[s("div",{staticClass:"ec-product-list__bg"},[s("div",{staticClass:"ec-product-list__select-city"},[t.cityList&&t.currentCity?s("div",{staticClass:"ec-product-list__select-city__button"},[s("div",{staticClass:"ec-product-list__select-city__button__current-city"},[t._v(t._s(t.currentCity.cityName))]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.currentCity,expression:"currentCity"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.currentCity=e.target.multiple?s:s[0]}}},t._l(t.cityList,function(e){return s("option",{key:e.cityId,domProps:{value:e}},[t._v(t._s(e.cityName))])}),0)]):t._e()]),t.ecProductTabs.length>0?s("div",{staticClass:"ec-product-list__tab-list"},t._l(t.ecProductTabs,function(e,i){return s("div",{key:i,staticClass:"ec-product-list__tab-list__item",class:t.currentTab===e?"active":"",on:{click:function(s){return t.setCurrentTab(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),0):t._e(),t.filterEcProductList?s("div",{staticClass:"ec-product-list__list"},[t.filterEcProductList.length>0?t._l(t.filterEcProductList,function(e){return s("product-item",{key:e.commodityId,attrs:{product:e},nativeOn:{click:function(s){return t.gotoEcProductDetail(e.commodityId)}}})}):[s("div",{staticClass:"ec-product-list__list__no-data"},[s("div",{staticClass:"ec-product-list__list__no-data__icon"}),s("div",{staticClass:"ec-product-list__list__no-data__text"},[t._v("暂无内容")])])]],2):t._e()])]),s("goto-home"),s("div",{staticClass:"ec-product-list__my-order-list-button",on:{click:t.gotoMyOrderList}})],1)},g=[],v=s("795b"),f=s.n(v),C=(s("6762"),s("2fdb"),s("96cf"),s("3b8d")),y=s("f499"),b=s.n(y),w=s("bc3a"),S=s.n(w),D=s("c53e"),k=s.n(D),x="srs_signature_yoren2016",T="c0e9dcfdf2bf16fa5f169d744f142eac1d70dee1",I="yO7rE1nE0ck2Ey",A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function N(){for(var t="",e=0;e<6;e++){var s=Math.floor(Math.random()*A.length),i=A[s];t+=i}return t}function P(t){var e=N(),s=(new Date).getTime(),i=new k.a("SHA-1","TEXT");i.update("".concat(t).concat(e).concat(s));var n=i.getHash("HEX");return{nonce:e,timestamp:s,signature:n}}var L={generateMainApiSignature:function(){return P(x)},generateSignatureForPltApi:function(){return P(T)},generateModulesApi:function(){return P(I)}},M="https://lawsonapp.api.yorentick.cn",E={fetchUserInfo:function(t){var e=t.regionBlockCode,s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new f.a(function(t,s){S.a.get("".concat(M,"/app/v1/user/getUserInfo/"),{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},fetchUserGroupInfo:function(t){var e=t.regionBlockCode,s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new f.a(function(t,s){S.a.get("".concat(M,"/app/v1/user/group"),{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})}},$="https://lawsonapp.api.yorentick.cn",O={fetchEcProductShopList:function(t){var e=t.regionBlockCode,s=t.cityId,i=L.generateModulesApi(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat($,"/modules/mina/ec/getCommodityList");return S.a.get(c,{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e,cityId:s}})},fetchEcProductShopDetail:function(t){var e=t.commodityId,s=L.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat($,"/modules/mina/ec/getCommodityDetail?commodityId=").concat(e);return S.a.get(o,{params:{timestamp:i,nonce:n,signature:a}})},createOrder:function(t){var e=t.commodityId,s=t.quantity,i=L.generateModulesApi(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat($,"/modules/mina/ec/addOrder");return S.a.post(c,{timestamp:n,nonce:a,signature:o,commodityId:e,qty:s})},fetchOrderDetail:function(t){var e=t.orderId,s=L.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat($,"/modules/mina/ec/getOrderDetail?orderId=").concat(e);return S.a.get(o,{params:{timestamp:i,nonce:n,signature:a}})},fetchPayOrderDetail:function(t){var e=t.orderId,s=L.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat($,"/modules/mina/ec/getPayedOrderDetail?orderId=").concat(e);return S.a.get(o,{params:{timestamp:i,nonce:n,signature:a}})},fetchOrderShopList:function(t){var e=t.orderId,s=L.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat($,"/modules/mina/ec/getOrderShopList?orderId=").concat(e);return S.a.get(o,{params:{timestamp:i,nonce:n,signature:a}})},fetchMyOrderList:function(t){var e=t.regionBlockCode,s=L.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat($,"/modules/mina/ec/getOrderList?regionBlockCode=").concat(e);return S.a.get(o,{params:{timestamp:i,nonce:n,signature:a}})},deleteOrder:function(t){var e=t.orderId,s=L.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat($,"/modules/mina/ec/deleteOrder");return S.a.post(o,{timestamp:i,nonce:n,signature:a,orderId:e})},editOrder:function(t){var e=t.orderId,s=t.takeDate,i=t.shopId,n=L.generateModulesApi(),a=n.timestamp,o=n.nonce,c=n.signature,r="".concat($,"/modules/mina/ec/modifyOrder");return S.a.post(r,{timestamp:a,nonce:o,signature:c,orderId:e,takeDate:s,shopId:i})}},R="https://lawsonapp.api.yorentick.cn",F={fetchJsSdkSignatureData:function(t){var e=t.url;return new f.a(function(t,s){var i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;S.a.get("".concat(R,"/app/v1/weixin/authorize/getsignature/"),{params:{timestamp:n,nonce:a,signature:o,url:e}}).then(function(e){var i=0===e.data.code;i?t(e.data.data):s(e)}).catch(function(t){s(t)})})}},B=s("cebc"),U="https://lawsonapp.api.yorentick.cn",j={fetchCampaignList:function(t){var e=t.regionBlockCode,s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new f.a(function(t,s){S.a.get("".concat(U,"/app/v1/campaign/"),{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e,page:1,pageSize:1e3}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data.list;t(n)}else s(e)}).catch(function(t){s(t)})})},fetchCampaignDetail:function(t){var e=t.campaignDetailId,s=t.regionBlockCode,i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new f.a(function(t,i){S.a.get("".concat(U,"/app/v1/campaign/").concat(e),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:s}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})},campaignGift:function(t){var e=t.campaignId,s=t.stampId,i=t.regionBlockCode,n=L.generateMainApiSignature(),a=n.timestamp,o=n.nonce,c=n.signature;return new f.a(function(t,n){S.a.post("".concat(U,"/app/v1/campaign/gift"),{timestamp:a,nonce:o,signature:c,regionBlockCode:i,campaignId:e,stampId:s}).then(function(e){var s=0===e.data.code;if(s){var i=e.data.data;t(i)}else n(e)}).catch(function(t){n(t)})})},campaignGiftSaveAddress:function(t){var e=t.saveAddressInfo,s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new f.a(function(t,s){S.a.post("".concat(U,"/app/v1/campaign/saveAddress"),Object(B["a"])({timestamp:i,nonce:n,signature:a},e)).then(function(e){var i=0===e.data.code;if(i){var n=e.data;t(n)}else s(e)}).catch(function(t){s(t)})})},getCampaignProducts:function(t){var e=t.regionBlockCode,s=t.campaignDetailId,i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new f.a(function(t,i){S.a.get("".concat(U,"/app/v1/commodityAndType/").concat(s),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data;t(n)}else i(e)}).catch(function(t){i(t)})})},campaignBarrage:function(t){var e=t.regionBlockCode,s=t.campaignId,i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new f.a(function(t,i){S.a.get("".concat(U,"/app/v1/campaign/barrage"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e,campaignId:s}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})},getSendAddress:function(t){var e=t.regionBlockCode,s=t.campaignId,i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new f.a(function(t,i){S.a.get("".concat(U,"/app/v1/campaign/address"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e,campaignId:s}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})},getUserGiftInfo:function(t){var e=t.userGiftId,s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(U,"/app/v1/campaign/userGift?userGiftId=").concat(e);return new f.a(function(t,e){S.a.get(o,{params:{timestamp:i,nonce:n,signature:a}}).then(function(s){var i=0===s.data.code;if(i){var n=s.data;t(n)}else e(s)}).catch(function(t){e(t)})})}},H="https://lawsonapp.api.yorentick.cn",z={fetch:function(t){var e=t.regionBlockCode,s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(H,"/app/v1/mina/user/address");return S.a.get(o,{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}})},add:function(t){var e=t.addressInfo,s=t.regionBlockCode,i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(H,"/app/v1/mina/user/address/add");return S.a.post(c,Object(B["a"])({timestamp:n,nonce:a,signature:o,regionBlockCode:s},e))},edit:function(t){var e=t.addressInfo,s=t.regionBlockCode,i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(H,"/app/v1/mina/user/address/edit");return S.a.post(c,Object(B["a"])({timestamp:n,nonce:a,signature:o,regionBlockCode:s},e))}},W="https://lawsonapp.api.yorentick.cn",G="https://plt.api.yorentick.cn",V={fetchUserCouponDetail:function(t){var e=t.couponId,s=t.userCouponId,i=t.regionBlockCode;return new f.a(function(t,n){var a=L.generateMainApiSignature(),o=a.timestamp,c=a.nonce,r=a.signature;S.a.get("".concat(W,"/app/v1/mina/coupon/detail"),{params:{timestamp:o,nonce:c,signature:r,regionBlockCode:i,couponId:e,userCouponId:s}}).then(function(e){var s=0===e.data.code;if(s){var i=e.data.data;t(i)}else n(e)}).catch(function(t){n(t)})})},fetchCouponDetail:function(t){var e=t.couponId,s=t.regionBlockCode;return new f.a(function(t,i){var n=L.generateMainApiSignature(),a=n.timestamp,o=n.nonce,c=n.signature;S.a.get("".concat(W,"/app/v1/mina/coupon/detail"),{params:{timestamp:a,nonce:o,signature:c,regionBlockCode:s,couponId:e}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})},fetchPickCouponList:function(t){var e=t.regionBlockCode;return new f.a(function(t,s){var i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;S.a.get("".concat(W,"/app/v1/mina/coupon/pickCoupon/couponList"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},hasNewShopsCoupon:function(t){var e=t.regionBlockCode;return new f.a(function(t,s){var i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;S.a.get("".concat(W,"/app/v1/newShops/hasCoupon"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},fetchPickCouponActivityList:function(t){var e=t.regionBlockCode;return new f.a(function(t,s){var i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;S.a.get("".concat(W,"/app/v1/pickCouponActivity/"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},pickCouponActivity:function(t){var e=t.pickCouponActivityId,s=t.couponId;return new f.a(function(t,i){var n=L.generateMainApiSignature(),a=n.timestamp,o=n.nonce,c=n.signature;S.a.post("".concat(W,"/app/v1/pickCouponActivity/pick"),{timestamp:a,nonce:o,signature:c,pickCouponActivityId:e,couponId:s}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})},pickCoupon:function(t){var e=t.couponId;return new f.a(function(t,s){var i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;S.a.post("".concat(W,"/app/v1/mina/coupon/pickCoupon/pick"),{timestamp:n,nonce:a,signature:o,couponId:e}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},getNewShopTopBanner:function(t){var e=t.regionBlockCode;return new f.a(function(t,s){var i=L.generateSignatureForPltApi(),n=i.timestamp,a=i.nonce,o=i.signature;S.a.get("".concat(G,"/pltapp/v1/banner/forMina"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e,displayType:"minaNewShopTop"}}).then(function(e){t(e.data)}).catch(function(t){s(t)})})},fetchPickCouponDetail:function(t){var e=t.pickCouponActivityId;return new f.a(function(t,s){var i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;S.a.get("".concat(W,"/app/v1/pickCouponActivity/").concat(e),{params:{timestamp:n,nonce:a,signature:o}}).then(function(e){t(e.data)}).catch(function(t){s(t)})})},refusedPushState:function(){return new f.a(function(t,e){var s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;S.a.get("".concat(W,"/app/v1/weixinmina/deagreed"),{params:{timestamp:i,nonce:n,signature:a}}).then(function(s){var i=0===s.data.code;if(i){var n=s.data.data;t(n)}else e(s)}).catch(function(t){e(t)})})},agreePush:function(){return new f.a(function(t,e){var s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;S.a.post("".concat(W,"/app/v1/weixinmina/agreePush"),{timestamp:i,nonce:n,signature:a}).then(function(s){var i=0===s.data.code;if(i){var n=s.data.data;t(n)}else e(s)}).catch(function(t){e(t)})})},disagreePush:function(){return new f.a(function(t,e){var s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;S.a.post("".concat(W,"/app/v1/weixinmina/deagreePush"),{timestamp:i,nonce:n,signature:a}).then(function(s){var i=0===s.data.code;if(i){var n=s.data.data;t(n)}else e(s)}).catch(function(t){e(t)})})}},q="https://lawsonapp.api.yorentick.cn",Y={fetchNewShops:function(t){var e=t.regionBlockCode,s=t.cityId;return new f.a(function(t,i){var n=L.generateMainApiSignature(),a=n.timestamp,o=n.nonce,c=n.signature;S.a.get("".concat(q,"/app/v1/newShops/"),{params:{timestamp:a,nonce:o,signature:c,regionBlockCode:e,cityId:s}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data.list;t(n)}else i(e)}).catch(function(t){i(t)})})},pickNewShopCoupon:function(t){var e=t.regionBlockCode,s=t.couponId,i=t.shopId;return new f.a(function(t,n){var a=L.generateMainApiSignature(),o=a.timestamp,c=a.nonce,r=a.signature;S.a.post("".concat(q,"/app/v1/newShops/").concat(i,"/pickCoupon/"),{timestamp:o,nonce:c,signature:r,regionBlockCode:e,couponId:s,shopId:i}).then(function(e){var s=0===e.data.code;if(s){var i=e.data.data;t(i)}else n(e)}).catch(function(t){n(t)})})}},Q="https://lawsonapp.api.yorentick.cn",K={fetchLotteryDetail:function(t){var e=t.regionBlockCode,s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new f.a(function(t,s){S.a.get("".concat(Q,"/app/v1/lottery/"),{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},fetchLotteryHistory:function(t){var e=t.regionBlockCode,s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new f.a(function(t,s){S.a.get("".concat(Q,"/app/v1/lottery/history"),{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},startLottery:function(t){var e=t.lotteryId,s=t.regionBlockCode,i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new f.a(function(t,i){S.a.post("".concat(Q,"/app/v1/lottery/roll"),{timestamp:n,nonce:a,signature:o,lotteryId:e,regionBlockCode:s}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})}},X="https://lawsonapp.api.yorentick.cn",Z={fetchMissions:function(t){var e=t.regionBlockCode;return new f.a(function(t,s){S.a.get("".concat(X,"/app/v1/mission/"),{params:Object(B["a"])({regionBlockCode:e},L.generateMainApiSignature())}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data.list;t(n)}else s(e)}).catch(function(t){s(t)})})},pickReward:function(t){var e=t.missionHistoryId;return new f.a(function(t,s){S.a.post("".concat(X,"/app/v1/mission/receive"),Object(B["a"])({missionHistoryId:e},L.generateMainApiSignature())).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})}},J="https://lawsonapp.api.yorentick.cn",tt={fetchCityList:function(t){var e=t.regionBlockCode;return new f.a(function(t,s){var i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;S.a.get("".concat(J,"/app/v1/mina/cityList"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e}}).then(function(e){t(e.data)}).catch(function(t){s(t)})})}},et="https://lawsonapp.api.yorentick.cn",st={recordPopularStatistics:function(t){var e=t.type,s=t.key,i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new f.a(function(t,i){S.a.post("".concat(et,"/app/v1/mina/look"),{timestamp:n,nonce:a,signature:o,type:e,key:s}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})}},it="https://lawsonapp.api.yorentick.cn",nt={fetchShops:function(t){var e=t.regionBlockCode,s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(it,"/app/v1/shop/");return S.a.get(o,{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e,pageSize:3e3}})},fetchOftenShoplist:function(t){var e=t.regionBlockCode,s=L.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(it,"/app/v1/mina/oftenShoplist");return S.a.get(o,{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}})}},at="https://lawsonapp.api.yorentick.cn",ot={fetchTalkTopicDetail:function(t){var e=t.talkTopicId;return new f.a(function(t,s){var i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(at,"/app/v1/mina/saying/detail?sayingId=").concat(e);S.a.get(c,{params:{timestamp:n,nonce:a,signature:o}}).then(function(e){var i=0===e.data.code;i?t(e.data.data):s(e)}).catch(function(t){s(t)})})}},ct="https://lawsonapp.api.yorentick.cn",rt={fetchRecommendedCommodities:function(t){var e=t.regionBlockCode;return new f.a(function(t,s){var i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(ct,"/app/v1/mina/buying?regionBlockCode=").concat(e);S.a.get(c,{params:{timestamp:n,nonce:a,signature:o}}).then(function(e){var i=0===e.data.code;i?t(e.data.data):s(e)}).catch(function(t){s(t)})})},fetchRecommendedCommodity:function(t){var e=t.o2oCommodityId;return new f.a(function(t,s){var i=L.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(ct,"/app/v1/mina/buying/detail?o2oCommodityId=").concat(e);S.a.get(c,{params:{timestamp:n,nonce:a,signature:o}}).then(function(e){var i=0===e.data.code;i?t(e.data.data):s(e)}).catch(function(t){s(t)})})}},dt=(s("386d"),s("4328")),pt=s.n(dt);s("28a5");function lt(t){return new f.a(function(e,s){var i=document.createElement("script");i.src=t,i.addEventListener("load",e),i.addEventListener("error",s),document.body.appendChild(i)})}var ut={init:function(){return new f.a(function(t,e){lt("https://res.wx.qq.com/open/js/jweixin-1.3.2.js").then(function(){var t=window.location.href.split("#")[0];return mt.wechat.fetchJsSdkSignatureData({url:t})}).then(function(s){wx.config({appId:"wxa3acf7d554a353b9",timestamp:s.timestamp,nonceStr:s.nonceStr,signature:s.signature,jsApiList:["getLocation","openLocation"]}),wx.ready(function(){t()}),wx.error(function(t){e(t)})}).catch(function(t){e(t)})})},getLocation:function(){return new f.a(function(t,e){wx.getLocation({success:function(e){t(e)},fail:function(t){e(t)}})})},openLocation:function(t,e,s,i){wx.openLocation({latitude:t,longitude:e,name:s,address:i})}},_t={__initEnvWechatMiniProgram:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){var e,s,i,n,a,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=window.location.search.slice(1),s=pt.a.parse(e),i=s.token,n=s.regionBlockCode,window.sessionStorage.setItem("token",i),window.sessionStorage.setItem("regionBlockCode",n),a=""===i,!a){t.next=8;break}t.next=12;break;case 8:return t.next=10,mt.user.fetchUserInfo({regionBlockCode:n});case 10:o=t.sent,window.sessionStorage.setItem("userInfo",b()(o));case 12:return t.next=15,ut.init();case 15:t.next=18;break;case 17:ut.init();case 18:case"end":return t.stop()}},t)}));function e(){return t.apply(this,arguments)}return e}(),init:function(){var t=this;return new f.a(function(e,s){var i=function(){var t=window.location.search.slice(1),e=pt.a.parse(t),s=e.envType;return"wechatMiniProgram"===s}();i?(window.sessionStorage.setItem("envType","wechatMiniProgram"),t.__initEnvWechatMiniProgram().then(function(){return e()})):e()})},getEnvType:function(){return window.sessionStorage.getItem("envType")},getRegionBlockCode:function(){return window.sessionStorage.getItem("regionBlockCode")},getToken:function(){return window.sessionStorage.getItem("token")},getUserInfo:function(){return JSON.parse(window.sessionStorage.getItem("userInfo"))}};S.a.defaults.timeout=4e3,S.a.interceptors.request.use(function(t){var e=_t.getToken();return t.headers["Api-Access-Token"]=e||"",t}),S.a.interceptors.response.use(function(t){return t},function(t){var e=!!/timeout of \d+ms exceeded/.test(t.message);if(e){window.location.hash.slice(1);var s={url:window.location.hash.slice(1)},i="pages/webview-entry/webview-entry",n=encodeURIComponent(b()(s)),a=encodeURIComponent(i);wx&&wx.miniProgram.redirectTo({url:"/pages/error-page_network-unstable/network-unstable?refreshPageOptions=".concat(n,"&refreshPageRoute=").concat(a)})}return f.a.reject(t)});var mt={user:E,wechat:F,campaign:j,address:z,ec:O,coupon:V,mission:Z,newShops:Y,lottery:K,cityList:tt,popularStatistics:st,shop:nt,talkTopic:ot,recommendedCommodity:rt},ht=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"goto-home",on:{click:t.gotoHome}})},gt=[],vt={methods:{gotoHome:function(){var t=null===_t.getUserInfo();t?wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=homepage"}):wx.miniProgram.switchTab({url:"/pages/homepage/homepage"})}}},ft=vt,Ct=(s("a6fc"),Object(p["a"])(ft,ht,gt,!1,null,"1ddbb7bc",null)),yt=Ct.exports,bt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"product-item"},[s("div",{staticClass:"product-item__image"},[s("img",{attrs:{src:t.product.imageSmall}})]),s("div",{staticClass:"product-item__content"},[s("div",{staticClass:"product-item__content__top"},[s("div",{staticClass:"product-item__content__top__status"},[0===t.product.remainedQty&&1===t.product.expired?[t._m(0)]:[0===t.product.expired?s("span",{staticClass:"product-item__content__top__status-not-begin"},[t.isThisWeek(t.product.canOrderStart)?[t._v("本"+t._s(t._f("formatThisWeekDate")(t.product.canOrderStart))+"开始")]:[t._v(t._s(t._f("formatNotThisWeekDate")(t.product.canOrderStart))+"开始")]],2):1===t.product.expired?s("span",{staticClass:"product-item__content__top__status-begin"},[t._v("进行中")]):2===t.product.expired?s("div",{staticClass:"product-item__content__top__status-end"},[t._m(1)]):t._e()]],2),s("div",{staticClass:"product-item__content__top__title"},[t._v(t._s(t.product.commodityName))])]),s("div",{staticClass:"product-item__content__bottom"},[s("div",{staticClass:"product-item__content__bottom-time"},[s("div",{staticClass:"product-item__content__bottom-time__icon-time"}),s("div",{staticClass:"product-item__content__bottom-time__start-time"},[t._v(t._s(t._f("formatDate")(t.product.canOrderStart))+"开始")])]),s("div",{staticClass:"product-item__content__bottom-info"},[s("div",{staticClass:"product-item__content__bottom-info__price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("toRMB")(t.product.sellPrice)))]),s("div",{staticClass:"product-item__content__bottom-info__watch-number"},[t._v(t._s(t._f("formatOnlookerCount")(t.product.onlookerCount))+"人围观过")])])])])])},wt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"product-item__content__top__status-sold-out"},[s("div",{staticClass:"product-item__content__top__status-sold-out__container"},[s("span",[t._v("抢光了")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"product-item__content__top__status-end__container"},[s("span",[t._v("预约结束")])])}],St={props:["product"],methods:{isThisWeek:function(t){var e=new Date,s=0===e.getDay()?7:e.getDay(),i=new Date(e.getFullYear(),e.getMonth(),e.getDate()+(7-s)),n=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1-s);return t>n.getTime()&&t<i.getTime()}},filters:{toRMB:function(t){return t.toFixed(1)},formatDate:function(t){var e=new Date(t),s=("0"+(e.getMonth()+1)).slice(-2),i=("0"+e.getDate()).slice(-2);return"".concat(s,"月").concat(i,"日")},formatThisWeekDate:function(t){var e=["周日","周一","周二","周三","周四","周五","周六"],s=new Date(t),i=("0"+s.getHours()).slice(-2),n=("0"+s.getMinutes()).slice(-2),a=s.getDay();return"".concat(e[a]," ").concat(i,":").concat(n)},formatNotThisWeekDate:function(t){var e=new Date(t),s=("0"+(e.getMonth()+1)).slice(-2),i=("0"+e.getDate()).slice(-2),n=("0"+e.getHours()).slice(-2),a=("0"+e.getMinutes()).slice(-2);return"".concat(s,"月").concat(i,"日 ").concat(n,":").concat(a)},formatOnlookerCount:function(t){return t>=1e4?t%1e4>=1e3?(t/1e4).toFixed(1)+"万":(t/1e4).toFixed(0)+"万":t}}},Dt=St,kt=(s("5f40"),Object(p["a"])(Dt,bt,wt,!1,null,"48625ba1",null)),xt=kt.exports,Tt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"modal"},[s("transition",{attrs:{name:"fade"}},[t.visible?s("div",[s("div",{staticClass:"modal__container"},[s("div",{staticClass:"modal__container__wrapper"},[s("svg",{staticClass:"modal__container__wrapper__icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-loading"}})]),s("div",{staticClass:"modal__container__wrapper__msg"},[t._v("加载中")])])])]):t._e()])],1)},It=[],At={data:function(){return{visible:!1}},mounted:function(){var t=this;window.addEventListener("popstate",function(e){t.visible=!1})}},Nt=At,Pt=(s("5e76"),Object(p["a"])(Nt,Tt,It,!1,null,"4358107c",null)),Lt=Pt.exports,Mt=i["a"].extend(Lt),Et=new Mt({el:document.createElement("div")});document.body.appendChild(Et.$el);var $t={show:function(){Et.visible=!0},hide:function(){setTimeout(function(){Et.visible=!1},1e3)}},Ot=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pull-down-refresh",on:{touchstart:t.handleTouchStart,touchmove:t.handleTouchMove,touchend:t.handleTouchEnd,touchcancel:t.handleTouchCancel}},[s("div",{style:{transform:"translateY("+t.wrapperYOffset+"px)"}},[t.isRefreshing?s("div",{staticClass:"pull-down-refresh__refreshing-hint"},[s("p",[t._v("…")]),s("p",[t._v("正在刷新")])]):t.needRefresh?s("div",{staticClass:"pull-down-refresh__release-hint"},[s("p",[t._v("⇡")]),s("p",[t._v("松开以刷新")])]):s("div",{staticClass:"pull-down-refresh__pull-hint"},[s("p",[t._v("⇣")]),s("p",[t._v("下拉以刷新")])]),t._t("default")],2)])},Rt=[],Ft=200,Bt=.5,Ut={props:{isRefreshing:Boolean},data:function(){return{touchStartY:null,touchMoveY:null,scrollTop:null,isPullingDown:null,lastRefreshTimeStamp:null,touchInitialYDirection:null}},computed:{yDistance:function(){return this.touchMoveY-this.touchStartY},needRefresh:function(){return this.isPullingDown&&this.yDistance>Ft},wrapperYOffset:function(){return this.isPullingDown?this.yDistance*(1-Bt):0}},methods:{_resetData:function(){this.touchStartY=null,this.touchMoveY=null,this.scrollTop=null,this.isPullingDown=null,this.touchInitialYDirection=null},handleTouchStart:function(t){var e=t.touches[0].clientY;this.touchStartY=e,this.touchMoveY=e,this.scrollTop=this.$el.scrollTop},handleTouchMove:function(t){var e=t.touches[0].clientY;this.touchMoveY=e,this.scrollTop=this.$el.scrollTop,null===this.touchInitialYDirection&&(this.yDistance>0?this.touchInitialYDirection="downward":this.touchInitialYDirection="upward"),null===this.isPullingDown&&("downward"===this.touchInitialYDirection&&this.scrollTop<=0?this.isPullingDown=!0:this.isPullingDown=!1),this.isPullingDown&&t.preventDefault()},handleTouchEnd:function(t){if(this.needRefresh){var e=this.lastRefreshTimeStamp,s=(new Date).getTime(),i=5e3;console.log(s-e>i),(null===e||s-e>i)&&(this.$emit("refresh"),this.lastRefreshTimeStamp=s)}this._resetData()},handleTouchCancel:function(t){this._resetData()}}},jt=Ut,Ht=(s("8469"),Object(p["a"])(jt,Ot,Rt,!1,null,"699765e8",null)),zt=Ht.exports,Wt={components:{GotoHome:yt,ProductItem:xt,PullDownRefresh:zt},data:function(){return{ecProductTabs:[],currentTab:null,ecProductList:null,cityList:null,currentCity:null,isRefreshing:!1}},created:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.fetchCityList();case 2:this.fetchEcProductList();case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),computed:{filterEcProductList:function(){var t=this;return this.currentTab?this.ecProductList.filter(function(e){return e.tagName===t.currentTab}):this.ecProductList}},methods:{initCurrentTab:function(){this.ecProductTabs.length>0&&(this.currentTab=this.ecProductTabs[0])},fetchEcProductList:function(){var t=this;this.isRefreshing=!0,$t.show();var e=_t.getRegionBlockCode(),s=this.currentCity.cityId;mt.ec.fetchEcProductShopList({regionBlockCode:e,cityId:s}).then(function(e){if(200===e.data.code){t.ecProductList=e.data.data;var s=t.ecProductList.reduce(function(t,e){return!1===t.includes(e.tagName)&&void 0!==e.tagName?[].concat(Object(m["a"])(t),[e.tagName]):t},[]);t.ecProductTabs=s,t.initCurrentTab()}}).finally(function(){$t.hide(),t.isRefreshing=!1})},fetchCityList:function(){var t=this;return new f.a(function(e,s){$t.show();var i=_t.getRegionBlockCode();mt.cityList.fetchCityList({regionBlockCode:i}).then(function(s){t.cityList=s.data,t.currentCity=t.cityList[0],e()}).finally(function(){return $t.hide()})})},setCurrentTab:function(t){this.currentTab=t},gotoEcProductDetail:function(t){this.$router.push({path:"/ec-product-detail/".concat(t)})},gotoMyOrderList:function(){this.$router.push({path:"/my-order-list"})}},watch:{currentCity:function(t,e){e&&this.fetchEcProductList()}}},Gt=Wt,Vt=(s("6223"),Object(p["a"])(Gt,h,g,!1,null,"801f27de",null)),qt=Vt.exports,Yt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.productDetail?s("div",{staticClass:"ec-product-detail"},[s("div",{staticClass:"ec-product-detail__image"},[s("img",{attrs:{src:t.productDetail.imageSmall}})]),s("div",{staticClass:"ec-product-detail__summary"},[s("div",{staticClass:"ec-product-detail__summary__price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("toRMB")(t.productDetail.sellPrice)))]),t.currentDate<t.productDetail.canOrderStart?s("div",{staticClass:"ec-product-detail__summary__appointment-start-date"},[t._v("预约活动 "+t._s(t._f("toDays")(t.productDetail.canOrderStart-t.currentDate))+" 天后开始")]):t._e(),t.soldOut?s("div",{staticClass:"ec-product-detail__summary__status-sold-out"},[s("span",[t._v("抢光了")])]):t._e(),2===t.productDetail.expired?s("div",{staticClass:"ec-product-detail__summary__status-end"},[s("span",[t._v("预约结束")])]):t._e()]),s("div",{staticClass:"ec-product-detail__content-detail"},[s("div",{staticClass:"ec-product-detail__content-detail__title"},[t._v("\n      "+t._s(t.productDetail.commodityName)+"\n    ")]),s("div",{staticClass:"ec-product-detail__content-detail__info"},[s("div",{staticClass:"ec-product-detail__content-detail__info__sold-out"},[t._v("已售出："+t._s(t.productDetail.salesedQty)+"件")]),s("div",{staticClass:"ec-product-detail__content-detail__info__stock"},[t._v("库存："+t._s(t.productDetail.remainedQty)+"件")]),s("div",{staticClass:"ec-product-detail__content-detail__info__watch"},[t._l(t.avatars,function(t,e){return s("img",{key:e,staticClass:"ec-product-detail__content-detail__info__watch__avatar",attrs:{src:t}})}),s("span",[t._v(t._s(t._f("formatOnlookerCount")(t.productDetail.onlookerCount))+"人围观过")])],2)])]),s("div",{staticClass:"ec-product-detail__content-appointment-time-limit"},[t._m(0),s("div",{staticClass:"ec-product-detail__content-appointment-time-limit__content"},[s("timeline-bar",{attrs:{startDate:t.productDetail.canOrderStart,endDate:t.productDetail.canOrderEnd}})],1)]),s("div",{staticClass:"ec-product-detail__content-pick-up-shop",on:{click:t.gotoEcAvailableShopList}},[s("div",{staticClass:"ec-product-detail__content-pick-up-shop__head"},[t._m(1),s("div",{staticClass:"ec-product-detail__content-pick-up-shop__head__view"},[t._v("\n        查看全部("+t._s(t.sortedShopsWithDistance.length)+")\n      ")])]),t.sortedShopsWithDistance[0]?s("div",{staticClass:"ec-product-detail__content-pick-up-shop__content"},[s("div",{staticClass:"ec-product-detail__content-pick-up-shop__content__shop-info"},[s("div",{staticClass:"ec-product-detail__content-pick-up-shop__content__shop-info__shop-name"},[s("span",[t._v(t._s(t.sortedShopsWithDistance[0].shopName))]),""!==t.sortedShopsWithDistance[0].businessTime?s("format-business-time",{attrs:{businessTime:t.sortedShopsWithDistance[0].businessTime}}):t._e()],1),s("div",{staticClass:"ec-product-detail__content-pick-up-shop__content__shop-info__shop-address"},[t._v(t._s(t.sortedShopsWithDistance[0].address))])]),t.sortedShopsWithDistance[0].distance?s("div",{staticClass:"ec-product-detail__content-pick-up-shop__content__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.sortedShopsWithDistance[0].distance)))]):t._e()]):t._e()]),s("div",{staticClass:"ec-product-detail__content-appointment-instruction"},[t._m(2),s("div",{staticClass:"ec-product-detail__content-appointment-instruction__content",domProps:{innerHTML:t._s(t.productDetail.takeDescription)}})]),t.soldOut?t._e():s("div",{staticClass:"ec-product-detail__content-bottom-button-appointment"},[0===t.productDetail.expired?s("div",{staticClass:"ec-product-detail__content-bottom-button-appointment__not-begin"},[t._v("立即预约")]):1===t.productDetail.expired?s("div",{staticClass:"ec-product-detail__content-bottom-button-appointment__begin",on:{click:t.showAppointmentPopup}},[t._v("立即预约")]):t._e()]),s("goto-home"),t.appointmentPopupVisible?s("appointment-popup",{attrs:{productDetail:t.productDetail},on:{hideAppointmentPopup:t.hideAppointmentPopup}}):t._e()],1):t._e()},Qt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-detail__content-appointment-time-limit__head"},[s("div",{staticClass:"ec-product-detail__content-appointment-time-limit__head__icon"}),s("div",[t._v("可预约期限")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-detail__content-pick-up-shop__head__title"},[s("div",{staticClass:"ec-product-detail__content-pick-up-shop__head__title__icon"}),s("div",[t._v("可提货门店")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-detail__content-appointment-instruction__head"},[s("div",{staticClass:"ec-product-detail__content-appointment-instruction__head__icon"}),s("div",[t._v("预约商品说明")])])}],Kt=(s("55dd"),s("5176")),Xt=s.n(Kt),Zt=s("0a0d"),Jt=s.n(Zt),te=s("2ef0"),ee=s.n(te);function se(t){return t*Math.PI/180}function ie(t,e,s,i){var n=6371,a=se(s-t),o=se(i-e);t=se(t),s=se(s);var c=Math.sin(a/2)*Math.sin(a/2)+Math.sin(o/2)*Math.sin(o/2)*Math.cos(t)*Math.cos(s),r=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return n*r}var ne={recordCampaignPopularStatistics:function(t){mt.popularStatistics.recordPopularStatistics({type:"Campaigning",key:t})},recordRecommendedCommodityPopularStatistics:function(t){mt.popularStatistics.recordPopularStatistics({type:"Buying",key:t})},recordEcProductPopularStatistics:function(t){mt.popularStatistics.recordPopularStatistics({type:"Booking",key:t})},recordTalkTopicPopularStatistics:function(t){mt.popularStatistics.recordPopularStatistics({type:"Saying",key:t})}},ae=(s("7514"),[{regionBlockCode:"sh-lawson",regionName:"江浙沪"},{regionBlockCode:"bj-lawson",regionName:"京津冀"},{regionBlockCode:"dl-lawson",regionName:"大连"},{regionBlockCode:"wh-lawson",regionName:"武汉"},{regionBlockCode:"cq-lawson",regionName:"重庆"},{regionBlockCode:"ah-lawson",regionName:"安徽"}]),oe={getCurrentRegionName:function(t){return ae.find(function(e){return e.regionBlockCode===t})["regionName"]}},ce=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"business-time"},[0===t.formatBusinessTime?s("div",{staticClass:"business-time__content"},[s("span",{staticClass:"business-time__content__time"},[t._v("6:00-22:00")])]):t._e(),1===t.formatBusinessTime?s("div",{staticClass:"business-time__content"},[s("span",{staticClass:"business-time__content__time"},[t._v("7:00-23:00")])]):t._e(),2===t.formatBusinessTime?s("div",{staticClass:"business-time__content"},[s("span",{staticClass:"business-time__content__time"},[t._v("24h")])]):t._e(),3===t.formatBusinessTime?s("div",{staticClass:"business-time__content"},[s("span",{staticClass:"business-time__content__time"},[t._v("24h")]),s("span",{staticClass:"business-time__content__closed-time"},[t._v("周六、周日休业")])]):t._e()])},re=[],de={props:["businessTime"],data:function(){return{dateType:null}},computed:{formatBusinessTime:function(){var t=this.businessTime;return t.indexOf("6:00")>-1?this.dateType=0:t.indexOf("7:00")>-1?this.dateType=1:t.indexOf("每日24小时")>-1?this.dateType=2:t.indexOf("平日24")>-1&&(this.dateType=3),this.dateType}}},pe=de,le=(s("da46"),Object(p["a"])(pe,ce,re,!1,null,"497b2388",null)),ue=le.exports,_e=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"timeline-bar"},[s("div",{staticClass:"timeline-bar__line"}),s("div",{class:["timeline-bar__start-date",{"is-middle":t.startDate>t.currentDate&&t.startDate<t.endDate,"is-hidden":t.startDate<=t.currentDate}]},[s("div",{staticClass:"timeline-bar__start-date__title"},[t._v("预约开始")]),s("div",{staticClass:"timeline-bar__start-date__circle-icon"}),s("div",{staticClass:"timeline-bar__start-date__date"},[t._v(t._s(t._f("date")(t.startDate)))])]),s("div",{class:["timeline-bar__end-date",{"is-left":t.endDate<=t.currentDate,"is-right":t.endDate>t.currentDate}]},[s("div",{staticClass:"timeline-bar__end-date__title"},[t._v("预约结束")]),s("div",{staticClass:"timeline-bar__end-date__circle-icon"}),s("div",{staticClass:"timeline-bar__end-date__date"},[t._v(t._s(t._f("date")(t.endDate)))])]),s("div",{class:["timeline-bar__current-date",{"is-left":t.currentDate<t.startDate,"is-right":t.currentDate>=t.endDate}]},[s("div",{staticClass:"timeline-bar__current-date__title"},[t._v("今天")]),s("div",{staticClass:"timeline-bar__current-date__circle-icon"}),s("div",{staticClass:"timeline-bar__current-date__date"},[t._v(t._s(t._f("date")(t.currentDate)))])])])},me=[],he={data:function(){return{currentDate:Jt()()}},props:["startDate","endDate"],filters:{date:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,"-").concat(n,"-").concat(a)}}},ge=he,ve=(s("2eb6"),Object(p["a"])(ge,_e,me,!1,null,"a3b4dbd2",null)),fe=ve.exports,Ce=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"appointment-popup"},[s("div",{staticClass:"appointment-popup__container"},[s("div",{staticClass:"appointment-popup__container__head"},[s("div",{staticClass:"appointment-popup__container__head__image"},[s("img",{attrs:{src:t.productDetail.imageSmall}})]),s("div",{staticClass:"appointment-popup__container__head__info"},[s("div",{staticClass:"appointment-popup__container__head__info__price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("toRMB")(t.productDetail.sellPrice)))]),s("div",{staticClass:"appointment-popup__container__head__info__stock"},[t._v("剩余库存："+t._s(t.productDetail.remainedQty))])])]),s("div",{staticClass:"appointment-popup__container__content"},[s("div",{staticClass:"appointment-popup__container__content__left"},[t._v("\n        合计：\n        "),s("span",{staticClass:"appointment-popup__container__content__left__total-price"},[s("span",[t._v("¥")]),t._v(" "+t._s(t._f("toRMB")(t.totalPrice)))])]),s("div",{staticClass:"appointment-popup__container__content__right"},[s("div",{staticClass:"appointment-popup__container__content__right__quantity"},[s("span",{staticClass:"appointment-popup__container__content__right__quantity__label"},[t._v("数量:")]),s("div",{staticClass:"appointment-popup__container__content__right__quantity__icon-decrease",on:{click:t.decreaseQuantity}}),s("span",{staticClass:"appointment-popup__container__content__right__quantity__number"},[t._v(t._s(t.purchaseQuantity))]),s("div",{staticClass:"appointment-popup__container__content__right__quantity__icon-increase",on:{click:t.increaseQuantity}})]),s("div",{staticClass:"appointment-popup__container__content__right__descr"},[t._v("每个用户最多可预约"+t._s(t.productDetail.singleLimited)+"个")])])]),s("div",{staticClass:"appointment-popup__container__confirm",on:{click:t.gotoConfirmOrder}},[t._v("确定")]),s("div",{staticClass:"appointment-popup__container__close",on:{click:t.hideAppointmentPopup}})])])},ye=[],be={data:function(){return{purchaseQuantity:1}},props:["productDetail"],computed:{totalPrice:function(){return this.productDetail.sellPrice*this.purchaseQuantity}},methods:{decreaseQuantity:function(){this.purchaseQuantity>1&&(this.purchaseQuantity-=1)},increaseQuantity:function(){this.purchaseQuantity<this.productDetail.singleLimited&&this.purchaseQuantity<this.productDetail.remainedQty&&(this.purchaseQuantity+=1)},hideAppointmentPopup:function(){this.$emit("hideAppointmentPopup")},gotoConfirmOrder:function(){var t=this;$t.show();var e=this.productDetail.commodityId,s=this.purchaseQuantity;mt.ec.createOrder({commodityId:e,quantity:s}).then(function(e){var s=e.data.data;t.$router.push({path:"/ec-confirm-order/".concat(s)})}).finally(function(){return $t.hide()})}},filters:{toRMB:function(t){return t.toFixed(1)},toDays:function(t){return Math.ceil(t/864e5)}}},we=be,Se=(s("c1c0"),Object(p["a"])(we,Ce,ye,!1,null,"f6eb9864",null)),De=Se.exports,ke=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"message-box"},[t.visible?s("div",{staticClass:"message-box__mask"}):t._e(),s("transition",{attrs:{name:"bounce"}},[t.visible?s("div",{staticClass:"message-box__content"},[s("div",{staticClass:"message-box__title"},[t._v(t._s(t.title))]),s("div",{staticClass:"message-box__msg",domProps:{innerHTML:t._s(t.msg)}}),"alert"===t.type?s("div",[s("div",{staticClass:"message-box__operation"},[s("div",{staticClass:"message-box__i-know-button",on:{click:t.handleIknow}},[t._v("我知道了")])])]):"confirm"===t.type?s("div",[s("div",{staticClass:"message-box__operation"},[s("div",{staticClass:"message-box__confirm-button",on:{click:t.handleConfirm}},[t._v(t._s(t.confirmButtonText))]),s("div",{staticClass:"message-box__cancel-button",on:{click:t.handleCancel}},[t._v(t._s(t.cancelButtonText))])])]):t._e()]):t._e()])],1)},xe=[],Te={props:{type:String,title:String,msg:String,confirmButtonText:String,cancelButtonText:String,onIknow:Function,onConfirm:Function,onCancel:Function},data:function(){return{visible:!1}},methods:{handleIknow:function(){this.onIknow(),this.visible=!1},handleCancel:function(){this.onCancel(),this.visible=!1},handleConfirm:function(){this.onConfirm(),this.visible=!1}},mounted:function(){var t=this;window.addEventListener("popstate",function(e){return t.visible=!1})}},Ie=Te,Ae=(s("4e38"),Object(p["a"])(Ie,ke,xe,!1,null,"66497dd4",null)),Ne=Ae.exports,Pe=i["a"].extend(Ne),Le=new Pe({el:document.createElement("div")});document.body.appendChild(Le.$el);var Me={alert:function(t){var e=t.title,s=void 0===e?"提示":e,i=t.msg,n=void 0===i?"":i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};Le.type="alert",Le.title=s,Le.msg=n,Le.onIknow=a,Le.onCancel=o,Le.visible=!0},confirm:function(t){var e=t.title,s=void 0===e?"提示":e,i=t.msg,n=void 0===i?"":i,a=t.confirmButtonText,o=void 0===a?"确认":a,c=t.cancelButtonText,r=void 0===c?"取消":c,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};Le.type="confirm",Le.title=s,Le.msg=n,Le.confirmButtonText=o,Le.cancelButtonText=r,Le.onConfirm=d,Le.onCancel=p,Le.visible=!0}},Ee={components:{GotoHome:yt,FormatBusinessTime:ue,TimelineBar:fe,AppointmentPopup:De},data:function(){return{productDetail:null,currentDate:Jt()(),appointmentPopupVisible:!1,currentLocation:null,avatars:["".concat("http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new","/avatar/1.png"),"".concat("http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new","/avatar/2.png"),"".concat("http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new","/avatar/3.png")]}},created:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.setCurrentLocation(),t.next=3,this.fetchEcProductShopDetail();case 3:e=_t.getRegionBlockCode(),e!==this.productDetail.regionBlockCode&&this.showRegionDiffModal(this.productDetail.regionBlockCode),ne.recordEcProductPopularStatistics(this.$route.params.commodityId);case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),computed:{soldOut:function(){return 0===this.productDetail.remainedQty},shopIdList:function(){return this.productDetail.shopList},shopList:function(){var t=_t.getRegionBlockCode(),e=0===this.productDetail.shopUseFlg;if(e){var s=this.$store.getters["shop/shopsAvailableForRegion"](t);return s?this.$store.getters["shop/shopsForRegion"](t):[]}var i=this.$store.state.shop.shops[t],n=this.shopIdList;return ee.a.intersectionWith(i,n,function(t,e){return t.shopId===e})},sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shopList.map(function(e){var s=Xt()({},e);return s.distance=ie(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shopList}},methods:{fetchEcProductShopDetail:function(){var t=this;return new f.a(function(e,s){$t.show();var i=t.$route.params.commodityId;mt.ec.fetchEcProductShopDetail({commodityId:i}).then(function(s){200===s.status&&(t.productDetail=s.data.data,wx.miniProgram.postMessage({data:{shareTitle:t.productDetail.commodityName}})),e()}).catch(function(t){return s(t)}).finally(function(){return $t.hide()})})},showAppointmentPopup:function(){var t=null===_t.getUserInfo();if(t){var e=this.productDetail.commodityId;wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=ecProductDetail&commodityId=".concat(e,"&sourceType=internal")})}else this.appointmentPopupVisible=!0},hideAppointmentPopup:function(){this.appointmentPopupVisible=!1},gotoEcAvailableShopList:function(){var t=null===_t.getUserInfo();if(t){var e=this.productDetail.commodityId;wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=ecProductDetail&commodityId=".concat(e,"&sourceType=internal")})}else{var s=this.productDetail.shopUseFlg,i=this.productDetail.shopList;this.$router.push({name:"ec-available-shop-list",params:{shopUseFlg:s,shopList:i}})}},setCurrentLocation:function(){var t=this;ut.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i}})},showRegionDiffModal:function(t){var e=oe.getCurrentRegionName(t),s=null===_t.getUserInfo();s?Me.alert({title:"友情提示",msg:"你当前查阅内容，可能受区域限制有所不同"}):Me.alert({title:"友情提示",msg:"你所在区域无法参与，当前内容仅限".concat(e)})}},filters:{toRMB:function(t){return t.toFixed(1)},toDays:function(t){return Math.ceil(t/864e5)},formatOnlookerCount:function(t){return t>=1e4?t%1e4>=1e3?(t/1e4).toFixed(1)+"万":(t/1e4).toFixed(0)+"万":t},toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},$e=Ee,Oe=(s("b66f"),Object(p["a"])($e,Yt,Qt,!1,null,"7b225485",null)),Re=Oe.exports,Fe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shops&&t.oftenShops?s("div",{staticClass:"ec-product-shop-list"},[s("div",{staticClass:"ec-product-shop-list__search-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchShop,expression:"searchShop"}],staticClass:"ec-product-shop-list__search-container__search-bar",attrs:{placeholder:"输入门店名称"},domProps:{value:t.searchShop},on:{input:function(e){e.target.composing||(t.searchShop=e.target.value)}}})]),s("div",{ref:"currentShop",staticClass:"ec-product-shop-list__current-shop"},[t._m(0),s("div",{staticClass:"ec-product-shop-list__current-shop__item"},[s("div",{staticClass:"ec-product-shop-list__current-shop__item__icon-location"}),t.currentAddress?s("div",{staticClass:"ec-product-shop-list__current-shop__item__current-address"},[t._v(t._s(t.currentAddress))]):t._e(),s("div",{staticClass:"ec-product-shop-list__current-shop__item__refresh-location",on:{click:t.setCurrentAddress}},[t._v("重新定位")])]),s("div",{staticClass:"ec-product-shop-list__whitespace"}),t.oftenShops.length>0?[t._m(1),t._l(t.oftenShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e(),s("div",{staticClass:"ec-product-shop-list__whitespace"}),t.nearbyShops.length>0?[t._m(2),t._l(t.nearbyShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e()],2)]):t._e()},Be=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__current-shop__title-row"},[s("span",{staticClass:"ec-product-shop-list__current-shop__title-row__title"},[t._v("当前定位")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__my-shops__title-row"},[s("span",{staticClass:"ec-product-shop-list__my-shops__title-row__title"},[t._v("常去店铺")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__nearby-shops__title-row"},[s("span",{staticClass:"ec-product-shop-list__nearby-shops__title-row__title"},[t._v("附近店铺")])])}],Ue="QVPBZ-YBMHV-KYMPX-UIXW2-7AM7Z-BNFNU";function je(t){return new f.a(function(e,s){var i=document.createElement("script");i.src=t,i.addEventListener("error",s),document.body.appendChild(i)})}var He={init:function(){return new f.a(function(t,e){window.onQqLbsLoad=function(){t()};var s=!(!window.qq||!window.qq.maps);s?t():je("https://map.qq.com/api/js?v=2.exp&key=".concat(Ue,"&callback=onQqLbsLoad")).catch(function(t){e(t)})})},getAddressByLatLng:function(t,e){return new f.a(function(s,i){new qq.maps.Geocoder({complete:function(t){var e=t.detail;s(e)},error:function(t){i(t)}}).getAddress(new qq.maps.LatLng(t,e))})}},ze=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-item"},[s("div",{staticClass:"shop-item__info"},[s("div",{staticClass:"shop-item__basic-info"},[s("div",{staticClass:"shop-item__shop-name"},[s("span",[t._v(t._s(t.shop.shopName))]),""!==t.shop.businessTime?s("format-business-time",{attrs:{businessTime:t.shop.businessTime}}):t._e()],1),s("div",{staticClass:"shop-item__shop-address"},[t._v(t._s(t.shop.address))])]),t.shop.distance?s("div",{staticClass:"shop-item__map-info"},[s("div",{staticClass:"shop-item__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.shop.distance)))]),s("div",{staticClass:"shop-item__show-in-map",on:{click:t.openMap}},[t._v("地图 >")])]):t._e()])])},We=[],Ge={props:{shop:Object},components:{FormatBusinessTime:ue},methods:{openMap:function(){wx.openLocation({latitude:this.shop.latitude,longitude:this.shop.longitude,name:this.shop.shopName,address:this.shop.address})}},filters:{toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},Ve=Ge,qe=(s("352a"),Object(p["a"])(Ve,ze,We,!1,null,"083b4cbc",null)),Ye=qe.exports,Qe={components:{ShopItem:Ye},data:function(){return{shops:null,oftenShops:null,currentAddress:null,nearbyShopsLength:10,searchShop:null,currentLocation:null}},created:function(){this.getOrderShopList(),this.fetchOftenShoplist()},mounted:function(){var t=this;He.init().then(function(){t.setCurrentAddress()})},updated:function(){this.$refs.currentShop.addEventListener("scroll",this.handleScroll)},computed:{sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=Xt()({},e);return s.distance=ie(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops},filterShops:function(){var t=this;return this.searchShop?this.sortedShopsWithDistance.filter(function(e){return e.shopName.includes(t.searchShop)}):this.sortedShopsWithDistance},currentShop:function(){return this.sortedShopsWithDistance[0]},myShops:function(){return this.sortedShopsWithDistance.slice(1,3)},nearbyShops:function(){return this.filterShops.slice(0,this.nearbyShopsLength)}},methods:{handleScroll:ee.a.debounce(function(){var t=this.$refs.currentShop.scrollTop,e=this.$refs.currentShop.clientHeight,s=this.$refs.currentShop.scrollHeight,i=s<=e+t;i&&(this.nearbyShopsLength+=10)},150),getOrderShopList:function(){var t=this.$route.params.shopUseFlg,e=this.$route.params.shopList,s=_t.getRegionBlockCode(),i=0===t;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](s);this.shops=n?this.$store.getters["shop/shopsForRegion"](s):[]}else{var a=this.$store.state.shop.shops[s];this.shops=ee.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},fetchOftenShoplist:function(){var t=this;$t.show();var e=_t.getRegionBlockCode();mt.shop.fetchOftenShoplist({regionBlockCode:e}).then(function(e){t.oftenShops=e.data.data.slice(0,2)}).finally(function(){return $t.hide()})},setCurrentAddress:function(){var t=this;this.currentAddress=null,ut.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i},He.getAddressByLatLng(s,i).then(function(e){t.currentAddress=e.address})})}}},Ke=Qe,Xe=(s("4df1"),Object(p["a"])(Ke,Fe,Be,!1,null,"642f1e3f",null)),Ze=Xe.exports,Je=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shops&&t.oftenShops?s("div",{staticClass:"ec-product-shop-list"},[s("div",{staticClass:"ec-product-shop-list__search-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchShop,expression:"searchShop"}],staticClass:"ec-product-shop-list__search-container__search-bar",attrs:{placeholder:"输入门店名称"},domProps:{value:t.searchShop},on:{input:function(e){e.target.composing||(t.searchShop=e.target.value)}}})]),s("div",{ref:"currentShop",staticClass:"ec-product-shop-list__current-shop"},[t._m(0),s("div",{staticClass:"ec-product-shop-list__current-shop__item"},[s("div",{staticClass:"ec-product-shop-list__current-shop__item__icon-location"}),t.currentAddress?s("div",{staticClass:"ec-product-shop-list__current-shop__item__current-address"},[t._v(t._s(t.currentAddress))]):t._e(),s("div",{staticClass:"ec-product-shop-list__current-shop__item__refresh-location",on:{click:t.setCurrentAddress}},[t._v("重新定位")])]),s("div",{staticClass:"ec-product-shop-list__whitespace"}),t.oftenShops.length>0?[t._m(1),t._l(t.oftenShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e(),s("div",{staticClass:"ec-product-shop-list__whitespace"}),t.nearbyShops.length>0?[t._m(2),t._l(t.nearbyShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e()],2)]):t._e()},ts=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__current-shop__title-row"},[s("span",{staticClass:"ec-product-shop-list__current-shop__title-row__title"},[t._v("当前定位")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__my-shops__title-row"},[s("span",{staticClass:"ec-product-shop-list__my-shops__title-row__title"},[t._v("常去店铺")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__nearby-shops__title-row"},[s("span",{staticClass:"ec-product-shop-list__nearby-shops__title-row__title"},[t._v("附近店铺")])])}],es=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-item"},[s("div",{staticClass:"shop-item__info"},[s("div",{staticClass:"shop-item__basic-info",on:{click:function(e){return t.selectPickupShop(t.shop.shopId)}}},[s("div",{staticClass:"shop-item__shop-name"},[s("span",[t._v(t._s(t.shop.shopName))]),""!==t.shop.businessTime?s("format-business-time",{attrs:{businessTime:t.shop.businessTime}}):t._e()],1),s("div",{staticClass:"shop-item__shop-address"},[t._v(t._s(t.shop.address))])]),t.shop.distance?s("div",{staticClass:"shop-item__map-info"},[s("div",{staticClass:"shop-item__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.shop.distance)))]),s("div",{staticClass:"shop-item__show-in-map",on:{click:t.openMap}},[t._v("地图 >")])]):t._e()])])},ss=[],is={props:{shop:Object},components:{FormatBusinessTime:ue},methods:{openMap:function(){var t=this.shop.latitude,e=this.shop.longitude,s=this.shop.shopName,i=this.shop.address;ut.openLocation(t,e,s,i)},selectPickupShop:function(t){this.$store.commit("ecOrderInfo/setShopId",t),this.$router.back()}},filters:{toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},ns=is,as=(s("fa16"),Object(p["a"])(ns,es,ss,!1,null,"a4ea644a",null)),os=as.exports,cs={components:{ShopItem:os},data:function(){return{shops:null,oftenShops:null,currentAddress:null,nearbyShopsLength:10,searchShop:null,currentLocation:null}},created:function(){this.getOrderShopList(),this.fetchOftenShoplist()},mounted:function(){var t=this;He.init().then(function(){t.setCurrentAddress()})},updated:function(){this.$refs.currentShop.addEventListener("scroll",this.handleScroll)},computed:{sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=Xt()({},e);return s.distance=ie(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops},filterShops:function(){var t=this;return this.searchShop?this.sortedShopsWithDistance.filter(function(e){return e.shopName.includes(t.searchShop)}):this.sortedShopsWithDistance},currentShop:function(){return this.sortedShopsWithDistance[0]},nearbyShops:function(){return this.filterShops.slice(0,this.nearbyShopsLength)}},methods:{handleScroll:ee.a.debounce(function(){var t=this.$refs.currentShop.scrollTop,e=this.$refs.currentShop.clientHeight,s=this.$refs.currentShop.scrollHeight,i=s<=e+t;i&&(this.nearbyShopsLength+=10)},150),getOrderShopList:function(){var t=this.$route.params.shopUseFlg,e=this.$route.params.shopList,s=_t.getRegionBlockCode(),i=0===t;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](s);this.shops=n?this.$store.getters["shop/shopsForRegion"](s):[]}else{var a=this.$store.state.shop.shops[s];this.shops=ee.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},fetchOftenShoplist:function(){var t=this;$t.show();var e=_t.getRegionBlockCode();mt.shop.fetchOftenShoplist({regionBlockCode:e}).then(function(e){t.oftenShops=e.data.data.slice(0,2)}).finally(function(){return $t.hide()})},setCurrentAddress:function(){var t=this;this.currentAddress=null,ut.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i},He.getAddressByLatLng(s,i).then(function(e){t.currentAddress=e.address})})}}},rs=cs,ds=(s("46ce"),Object(p["a"])(rs,Je,ts,!1,null,"855d4526",null)),ps=ds.exports,ls=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.orderDetail?s("div",{staticClass:"confirm-order"},[s("div",{staticClass:"confirm-order__info"},[s("div",{staticClass:"confirm-order__info__image"},[s("img",{attrs:{src:t.orderDetail.imageSmall}})]),s("div",{staticClass:"confirm-order__info__content"},[s("div",{staticClass:"confirm-order__info__content__title"},[t._v(t._s(t.orderDetail.commodityName))]),s("div",{staticClass:"confirm-order__info__content__desc"},[s("div",{staticClass:"confirm-order__info__content__desc__price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("toRMB")(t.orderDetail.sellPrice)))]),s("div",{staticClass:"confirm-order__info__content__desc__quantity"},[t._v("x"+t._s(t.orderDetail.qty))])])])]),s("div",{staticClass:"confirm-order__notice"},[s("div",{staticClass:"confirm-order__notice__title"},[t._v("预约须知")]),s("div",{staticClass:"confirm-order__notice__content",domProps:{innerHTML:t._s(t.notice)}})]),s("div",{staticClass:"confirm-order__select-take-date"},[s("div",{staticClass:"confirm-order__select-take-date__info"},[s("div",{staticClass:"confirm-order__select-take-date__info__label"},[t._v("请选择提货时间")]),t.takeDate?s("div",{staticClass:"confirm-order__select-take-date__info__date"},[t._v(t._s(t._f("formatDate")(t.takeDate)))]):t._e(),s("select",{directives:[{name:"model",rawName:"v-model",value:t.takeDate,expression:"takeDate"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.takeDate=e.target.multiple?s:s[0]}}},[s("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("请选择提货时间")]),t._l(t.orderDetail.canTakeDate,function(e){return s("option",{key:e,domProps:{value:e}},[t._v(t._s(t._f("formatDate")(e)))])})],2)]),s("div",{staticClass:"confirm-order__select-take-date__icon"})]),s("div",{staticClass:"confirm-order__select-take-shop",on:{click:t.gotoEcChooseShopList}},[s("div",{staticClass:"confirm-order__select-take-shop__info"},[t.shopInfo?[s("div",{staticClass:"confirm-order__select-take-shop__info__label"},[t._v("提货门店")]),s("div",{staticClass:"confirm-order__select-take-shop__info__shop-address"},[t._v(t._s(t.shopInfo.shopName)+" "+t._s(t.shopInfo.address))]),s("div",{staticClass:"confirm-order__select-take-shop__info__business-time"},[t._v("营业时间："+t._s(t.shopInfo.businessTime))])]:[s("div",{staticClass:"confirm-order__select-take-shop__info__label"},[t._v("请选择提货门店")])]],2),s("div",{staticClass:"confirm-order__select-take-shop__icon"})]),s("div",{staticClass:"confirm-order__pay"},[s("div",{staticClass:"confirm-order__pay__descr"},[t._v("支付即代表您已阅读并同意预约须知")]),s("div",{staticClass:"confirm-order__pay__content"},[s("div",{staticClass:"confirm-order__pay__content__amount"},[s("span",{staticClass:"confirm-order__pay__content__amount__label"},[t._v("应付：")]),s("span",{staticClass:"confirm-order__pay__content__amount__total-price"},[s("span",[t._v("¥")]),t._v(" "+t._s(t._f("toRMB")(t.orderDetail.amt)))])]),s("div",{staticClass:"confirm-order__pay__content__button"},[t.shopId&&t.takeDate?s("div",{staticClass:"confirm-order__pay__content__button__primary",on:{click:t.gotoOrderPayment}},[t._v("微信支付")]):s("div",{staticClass:"confirm-order__pay__content__button__disabled"},[t._v("微信支付")])])])])]):t._e()},us=[],_s={namespaced:!0,state:{shopId:null,takeDate:null},mutations:{setShopId:function(t,e){t.shopId=e},setTakeDate:function(t,e){t.takeDate=e},initState:function(t){t.shopId=null,t.takeDate=null}}},ms={data:function(){return{orderDetail:null,notice:"1.支付后请按选择的日期和时间段前往指定的门店提货<br>2.非指定门店不可提货<br>3.选定日期和时间段前不可提货<br>4.选定日期和时间段内未前往门店提货时，门店无法保证商品库存和品质，因此造成的损失将由用户自己承担"}},created:function(){this.$store.registerModule("ecOrderInfo",_s),this.fetchOrderDetail()},computed:{shopId:function(){return this.$store.state.ecOrderInfo.shopId},shopInfo:function(){var t=this,e=_t.getRegionBlockCode();return this.$store.getters["shop/shopsForRegion"](e).find(function(e){return e.shopId===t.shopId})},takeDate:{get:function(){return this.$store.state.ecOrderInfo.takeDate},set:function(t){this.$store.commit("ecOrderInfo/setTakeDate",t)}}},methods:{fetchOrderDetail:function(){var t=this;$t.show();var e=this.$route.params.orderId;mt.ec.fetchOrderDetail({orderId:e}).then(function(e){t.orderDetail=e.data.data,t.shopId&&(t.orderDetail.shopId=t.shopId),t.takeDate&&(t.orderDetail.takeDate=t.takeDate)}).finally(function(){return $t.hide()})},gotoEcChooseShopList:function(){var t=this.orderDetail.shopUseFlg,e=this.orderDetail.shopList;this.$router.push({name:"ec-choose-shop-list",params:{shopUseFlg:t,shopList:e}})},gotoOrderPayment:function(){var t=this.orderDetail.orderId,e=this.shopId,s=this.takeDate;wx.miniProgram.redirectTo({url:"/pages/order-payment/order-payment?orderId=".concat(t,"&pickShopId=").concat(e,"&pickDate=").concat(s)}),this.$store.unregisterModule("ecOrderInfo",_s)}},filters:{toRMB:function(t){return t.toFixed(1)},formatDate:function(t){var e=["日","一","二","三","四","五","六"],s=new Date(t),i=s.getFullYear(),n=("0"+(s.getMonth()+1)).slice(-2),a=("0"+s.getDate()).slice(-2),o=s.getDay();return"".concat(i,"/").concat(n,"/").concat(a,"(星期").concat(e[o],")")}}},hs=ms,gs=(s("c536"),Object(p["a"])(hs,ls,us,!1,null,"456b1f4b",null)),vs=gs.exports,fs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.orderDetail?s("div",{staticClass:"edit-order"},[s("div",{staticClass:"edit-order__info"},[s("div",{staticClass:"edit-order__info__image"},[s("img",{attrs:{src:t.orderDetail.imageSmall}})]),s("div",{staticClass:"edit-order__info__content"},[s("div",{staticClass:"edit-order__info__content__title"},[t._v(t._s(t.orderDetail.commodityName))]),s("div",{staticClass:"edit-order__info__content__desc"},[s("div",{staticClass:"edit-order__info__content__desc__price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("toRMB")(t.orderDetail.sellPrice)))]),s("div",{staticClass:"edit-order__info__content__desc__quantity"},[t._v("x"+t._s(t.orderDetail.qty))])])])]),s("div",{staticClass:"edit-order__notice"},[s("div",{staticClass:"edit-order__notice__title"},[t._v("预约须知")]),s("div",{staticClass:"edit-order__notice__content",domProps:{innerHTML:t._s(t.notice)}})]),s("div",{staticClass:"edit-order__select-take-date"},[s("div",{staticClass:"edit-order__select-take-date__info"},[s("div",{staticClass:"edit-order__select-take-date__info__label"},[t._v("请选择提货时间")]),t.takeDate?s("div",{staticClass:"edit-order__select-take-date__info__date"},[t._v(t._s(t._f("formatDate")(t.takeDate)))]):t._e(),s("select",{directives:[{name:"model",rawName:"v-model",value:t.takeDate,expression:"takeDate"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.takeDate=e.target.multiple?s:s[0]}}},[s("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("请选择提货时间")]),t._l(t.orderDetail.canTakeDate,function(e){return s("option",{key:e,domProps:{value:e}},[t._v(t._s(t._f("formatDate")(e)))])})],2)]),s("div",{staticClass:"edit-order__select-take-date__icon"})]),s("div",{staticClass:"edit-order__select-take-shop",on:{click:t.gotoEcChooseShopList}},[s("div",{staticClass:"edit-order__select-take-shop__info"},[s("div",{staticClass:"edit-order__select-take-shop__info__label"},[t._v("提货门店")]),t.shopInfo?[s("div",{staticClass:"edit-order__select-take-shop__info__shop-address"},[t._v(t._s(t.shopInfo.shopName)+" "+t._s(t.shopInfo.address))]),s("div",{staticClass:"edit-order__select-take-shop__info__business-time"},[t._v("营业时间："+t._s(t.shopInfo.businessTime))])]:t._e()],2),s("div",{staticClass:"edit-order__select-take-shop__icon"})]),t.takeDate&&t.shopId?s("div",{staticClass:"edit-order__confirm-edit-order-button",on:{click:t.editOrder}},[t._v("\n    确认修改\n  ")]):t._e()]):t._e()},Cs=[],ys={data:function(){return{orderDetail:null,notice:"1.支付后请按选择的日期和时间段前往指定的门店提货<br>2.非指定门店不可提货<br>3.选定日期和时间段前不可提货<br>4.选定日期和时间段内未前往门店提货时，门店无法保证商品库存和品质，因此造成的损失将由用户自己承担"}},created:function(){this.$store.registerModule("ecOrderInfo",_s),this.fetchPayOrderDetail()},computed:{shopId:function(){return this.$store.state.ecOrderInfo.shopId},shopInfo:function(){var t=this,e=_t.getRegionBlockCode(),s=this.$store.getters["shop/shopsAvailableForRegion"](e);return s?this.$store.getters["shop/shopsForRegion"](e).find(function(e){return e.shopId===t.shopId}):null},takeDate:{get:function(){return this.$store.state.ecOrderInfo.takeDate},set:function(t){this.$store.commit("ecOrderInfo/setTakeDate",t)}}},methods:{fetchPayOrderDetail:function(){var t=this;$t.show();var e=this.$route.params.orderId;mt.ec.fetchPayOrderDetail({orderId:e}).then(function(e){t.orderDetail=e.data.data;var s=t.orderDetail.shopId;if(t.shopId||t.$store.commit("ecOrderInfo/setShopId",s),!t.takeDate){var i=new Date(t.orderDetail.takeDate),n=i.getFullYear(),a=("0"+(i.getMonth()+1)).slice(-2),o=("0"+i.getDate()).slice(-2),c="".concat(n,"-").concat(a,"-").concat(o);t.$store.commit("ecOrderInfo/setTakeDate",c)}}).finally(function(){return $t.hide()})},editOrder:function(){var t=this,e=this.orderDetail.orderId,s=this.takeDate,i=this.shopId;mt.ec.editOrder({orderId:e,takeDate:s,shopId:i}).then(function(e){t.$router.back()})},gotoEcChooseShopList:function(){var t=this.orderDetail.shopUseFlg,e=this.orderDetail.shopList;this.$router.push({name:"ec-choose-shop-list",params:{shopUseFlg:t,shopList:e}})}},filters:{toRMB:function(t){return t.toFixed(1)},formatDate:function(t){var e=["日","一","二","三","四","五","六"],s=new Date(t),i=s.getFullYear(),n=("0"+(s.getMonth()+1)).slice(-2),a=("0"+s.getDate()).slice(-2),o=s.getDay();return"".concat(i,"/").concat(n,"/").concat(a,"(星期").concat(e[o],")")}}},bs=ys,ws=(s("a4e8"),Object(p["a"])(bs,fs,Cs,!1,null,"8064359c",null)),Ss=ws.exports,Ds=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-payment-result"},[t.orderPaymentResult?[s("div",{staticClass:"order-payment-result__icon-success"}),s("div",{staticClass:"order-payment-result__status-text"},[t._v("支付成功")]),t.totalFee?s("div",{staticClass:"order-payment-result__amount"},[t._v("订单金额："),s("span",[t._v("¥ "+t._s(t._f("toRMB")(t.totalFee)))])]):t._e(),s("div",{staticClass:"order-payment-result__notice"},[t._v("预约商品以提货券的形式发送到您的账户可前往查看")]),s("div",{staticClass:"order-payment-result__view-order",on:{click:t.gotoMyCouponList}},[t._v("前往查看")]),s("div",{staticClass:"order-payment-result__my-order",on:{click:t.gotoMyOrderList}},[t._v("我的订单")])]:[s("div",{staticClass:"order-payment-result__icon-fail"}),s("div",{staticClass:"order-payment-result__status-text"},[t._v("支付失败")]),s("div",{staticClass:"order-payment-result__order-detail",on:{click:t.gotoMyOrderList}},[t._v("订单详情")]),s("div",{staticClass:"order-payment-result__go-home",on:{click:t.gotoHome}},[t._v("返回首页")])]],2)},ks=[],xs=s("e814"),Ts=s.n(xs),Is=(s("a481"),{data:function(){return{orderPaymentResult:null,totalFee:null}},created:function(){this.setOrderPaymentResult()},methods:{gotoMyCouponList:function(){wx.miniProgram.switchTab({url:"/pages/my-coupon-list/my-coupon-list"})},gotoMyOrderList:function(){this.$router.replace({path:"/my-order-list"})},gotoHome:function(){wx.miniProgram.switchTab({url:"/pages/homepage/homepage"})},setOrderPaymentResult:function(){var t="true"===this.$route.query.orderPaymentResult,e=this.$route.query.totalFee;this.orderPaymentResult=t,this.totalFee=e}},filters:{toRMB:function(t){return Ts()(t).toFixed(1)}}}),As=Is,Ns=(s("7770"),Object(p["a"])(As,Ds,ks,!1,null,"13dca6c1",null)),Ps=Ns.exports,Ls=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.orderList?s("div",{staticClass:"my-order-list"},[s("div",{staticClass:"my-order-list__order-list"},[t.orderList.length>0?[s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchMyOrderList}},t._l(t.orderList,function(e){return s("order-item",{key:e.orderId,attrs:{order:e},on:{refreshMyOrderList:t.fetchMyOrderList}})}),1)]:[t._m(0)]],2),s("goto-home")],1):t._e()},Ms=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-order-list__order-list__no-data"},[s("div",{staticClass:"my-order-list__order-list__no-data__icon"}),s("div",{staticClass:"my-order-list__order-list__no-data__text"},[t._v("暂无内容")])])}],Es=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-list-item"},[1===t.order.status?[s("div",{staticClass:"order-list-item__head"},[s("div",{staticClass:"order-list-item__head__order-id"},[t._v("订单号："+t._s(t.order.orderId))]),s("div",{staticClass:"order-list-item__head__status"},[t._v("待取货")])]),s("div",{staticClass:"order-list-item__content"},[s("div",{staticClass:"order-list-item__content__left"},[s("img",{attrs:{src:t.order.imageSmall}})]),s("div",{staticClass:"order-list-item__content__right"},[s("div",{staticClass:"order-list-item__content__right__title"},[t._v(t._s(t.order.commodityName))]),s("div",{staticClass:"order-list-item__content__right__quantity"},[t._v("x"+t._s(t.order.qty))])]),s("div",{staticClass:"order-list-item__content__info"},[t._v("共"+t._s(t.order.qty)+"件商品  应付款：\n        "),s("span",{staticClass:"order-list-item__content__info__price"},[t._v("¥"+t._s(t._f("toRMB")(t.order.amt)))])])]),s("div",{staticClass:"order-list-item__pickup-date"},[t._v("\n      提货时间："+t._s(t._f("formatDate")(t.order.takeDate))+"  00:00 - 23:59\n    ")]),s("div",{staticClass:"order-list-item__pickup-address"},[s("div",{staticClass:"order-list-item__pickup-address__address"},[t._v("提货地址："+t._s(t.order.shop.shopName)+" "+t._s(t.order.shop.address))]),s("div",{staticClass:"order-list-item__pickup-address__goto-map",on:{click:t.openMap}},[t._v("\n        地图\n        "),s("span",{staticClass:"order-list-item__pickup-address__goto-map__icon"})])]),s("div",{staticClass:"order-list-item__button-list"},[t.order.canModifyFlg?s("div",{staticClass:"order-list-item__button-list__modify-order",on:{click:function(e){return t.gotoEditOrder(t.order.orderId)}}},[t._v("修改订单")]):t._e(),"normal"===t.order.orderStatus?s("div",{staticClass:"order-list-item__button-list__pickup-explain",on:{click:t.showPickupExplainMessageBox}},[t._v("提货说明")]):t._e(),s("div",{staticClass:"order-list-item__button-list__view-pickup-coupon",on:{click:function(e){return t.gotoCouponDetail(t.order.couponId,t.order.userCouponArr)}}},[t._v("查看提货券")])])]:[s("div",{staticClass:"order-list-item__head"},[s("div",{staticClass:"order-list-item__head__order-id"},[t._v("订单号："+t._s(t.order.orderId))]),s("div",{staticClass:"order-list-item__head__status"},[t._v("待支付")])]),s("div",{staticClass:"order-list-item__content"},[s("div",{staticClass:"order-list-item__content__left"},[s("img",{attrs:{src:t.order.imageSmall}})]),s("div",{staticClass:"order-list-item__content__right"},[s("div",{staticClass:"order-list-item__content__right__title"},[t._v(t._s(t.order.commodityName))]),s("div",{staticClass:"order-list-item__content__right__quantity"},[t._v("x"+t._s(t.order.qty))])]),s("div",{staticClass:"order-list-item__content__info"},[t._v("共"+t._s(t.order.qty)+"件商品  应付款：\n        "),s("span",{staticClass:"order-list-item__content__info__price"},[t._v("¥"+t._s(t._f("toRMB")(t.order.amt)))])])]),s("div",{staticClass:"order-list-item__can-appointment-date"},[t._v("\n      可预约时间："+t._s(t._f("formatDate")(t.order.canOrderStart))+" - "+t._s(t._f("formatDate")(t.order.canOrderEnd))+"\n    ")]),s("div",{staticClass:"order-list-item__button-list"},[s("div",{staticClass:"order-list-item__button-list__cancel-order",on:{click:function(e){return t.showCancelOrderMessageBox(t.order.orderId)}}},[t._v("取消订单")]),s("div",{staticClass:"order-list-item__button-list__goto-pay",on:{click:function(e){return t.gotoConfirmOrder(t.order.orderId)}}},[t._v("去支付")])])]],2)},$s=[],Os={props:["order"],methods:{openMap:function(){wx.openLocation({latitude:this.order.shop.latitude,longitude:this.order.shop.longitude,name:this.order.shop.shopName,address:this.order.shop.address})},deleteOrder:function(t){var e=this;$t.show(),mt.ec.deleteOrder({orderId:t}).then(function(){e.$emit("refreshMyOrderList")}).finally(function(){return $t.hide()})},gotoCouponDetail:function(t,e){var s=e[0];this.$router.push({path:"/user-coupon-detail/".concat(t,"/").concat(s)})},gotoConfirmOrder:function(t){this.$router.push({path:"/ec-confirm-order/".concat(t)})},gotoEditOrder:function(t){this.$router.push({path:"/ec-edit-order/".concat(t)})},showPickupExplainMessageBox:function(){Me.alert({title:"提货说明",msg:"该号码仅供提货时出示给门店核销使用请妥善保管勿泄漏给他人。"})},showCancelOrderMessageBox:function(t){var e=this;Me.confirm({title:"取消订单？",msg:"取消后该订单即被删除，且无法恢复",confirmButtonText:"确定取消",cancelButtonText:"暂不取消"},function(){e.deleteOrder(t)})}},filters:{formatDate:function(t){var e=new Date(t),s=e.getFullYear(),i=("0"+(e.getMonth()+1)).slice(-2),n=("0"+e.getDate()).slice(-2);return"".concat(s,"/").concat(i,"/").concat(n)},toRMB:function(t){return t.toFixed(1)}}},Rs=Os,Fs=(s("c2d3"),Object(p["a"])(Rs,Es,$s,!1,null,"cd2c2ee4",null)),Bs=Fs.exports,Us={components:{GotoHome:yt,OrderItem:Bs,PullDownRefresh:zt},data:function(){return{orderList:null,isRefreshing:!1}},created:function(){this.$store.state["ecOrderInfo"]||this.$store.registerModule("ecOrderInfo",_s),this.$store.commit("ecOrderInfo/initState"),this.fetchMyOrderList()},methods:{fetchMyOrderList:function(){var t=this;this.isRefreshing=!0,$t.show();var e=_t.getRegionBlockCode();mt.ec.fetchMyOrderList({regionBlockCode:e}).then(function(e){t.orderList=e.data.data}).finally(function(){$t.hide(),t.isRefreshing=!1})}}},js=Us,Hs=(s("a4a5"),Object(p["a"])(js,Ls,Ms,!1,null,"03ea6d2c",null)),zs=Hs.exports,Ws=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"takeout-intro"})},Gs=[],Vs={},qs=Vs,Ys=(s("bde1"),Object(p["a"])(qs,Ws,Gs,!1,null,"7f54e286",null)),Qs=Ys.exports,Ks=[{path:"/ec-product-list",name:"ec-product-list",component:qt,meta:{title:"预约列表"}},{path:"/ec-product-detail/:commodityId",name:"ec-product-detail",component:Re,meta:{title:"预约详情"}},{path:"/ec-confirm-order/:orderId",name:"ec-confirm-order",component:vs,meta:{title:"确认订单"}},{path:"/ec-edit-order/:orderId",name:"ec-edit-order",component:Ss,meta:{title:"编辑订单"}},{path:"/ec-available-shop-list",name:"ec-available-shop-list",component:Ze,meta:{title:"可用门店"}},{path:"/ec-choose-shop-list",name:"ec-choose-shop-list",component:ps,meta:{title:"选择门店"}},{path:"/ec-order-payment-result",name:"ec-order-payment-result",component:Ps,meta:{title:"支付结果"}},{path:"/my-order-list",name:"my-order-list",component:zs,meta:{title:"订单列表"}},{path:"/ec-intro",name:"ec-intro",component:Qs,meta:{title:"预约介绍"}}],Xs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.couponDetails?s("div",{staticClass:"user-coupon-detail"},[s("coupon-type",{attrs:{couponDetails:t.couponDetails}}),s("div",{staticClass:"user-coupon-detail__timeline"},[s("div",{staticClass:"user-coupon-detail__timeline__title"},[s("img",{staticClass:"user-coupon-detail__timeline__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-time.png"}}),s("span",{staticClass:"user-coupon-detail__timeline__title__text"},[t._v("使用时间")])]),s("div",{staticClass:"user-coupon-detail__timeline__bar"},[s("timeline-bar",{attrs:{couponDetails:t.couponDetails}})],1)]),s("available-shop",{attrs:{couponDetails:t.couponDetails}}),s("available-commodity",{attrs:{couponDetails:t.couponDetails}}),s("coupon-instruction",{attrs:{couponExplain:t.couponDetails.couponExplain}}),""!==t.couponDetails.applicationScope1&&t.couponDetails.applicationScope1?s("use-condition",{attrs:{applicationScope1:t.couponDetails.applicationScope1}}):t._e(),""!==t.couponDetails.applicationScope2&&t.couponDetails.applicationScope2?s("other-condition",{attrs:{applicationScope2:t.couponDetails.applicationScope2}}):t._e(),s("goto-home")],1):t._e()},Zs=[],Js=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-type"},["productPriceMinusToFreeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[2!==t.couponDetails.useCondition&&t.currentDate<=t.couponDetails.useDateTo?s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}):s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-expired.png"}}),t._m(0)])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[2!==t.couponDetails.useCondition&&t.currentDate<=t.couponDetails.useDateTo?s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}):s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-expired.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("消费立减")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),"totalPriceMinusSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[2!==t.couponDetails.useCondition&&t.currentDate<=t.couponDetails.useDateTo?s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}):s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-expired.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("满"),s("span",{staticClass:"coupon-type__price__text__total-price__number"},[t._v(t._s(t.couponDetails.originalPrice))]),t._v("元可用\n          ")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[2!==t.couponDetails.useCondition&&t.currentDate<=t.couponDetails.useDateTo?s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}):s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-expired.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减至"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("消费立减")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),s("div",{staticClass:"coupon-type__title"},[s("div",{staticClass:"coupon-type__title__content"},[s("span",{staticClass:"coupon-type__title__content__name"},[t._v(t._s(t.couponDetails.couponName))]),t.calculateCouponUseTime?s("span",{staticClass:"coupon-type__title__content__will-expired-time"},[t._v(t._s(t.calculateCouponUseTime))]):t._e(),t.currentDate>t.couponDetails.useDateTo?s("span",{staticClass:"coupon-type__title__content__expired-time"},[t._v("已过期")]):t._e()]),s("div",{staticClass:"coupon-type__title__region"},[s("img",{staticClass:"coupon-type__title__region__image",attrs:{src:t.ossImageUrl+"/coupon/icon-region.png"}}),s("span",{staticClass:"coupon-type__title__region__name"},[t._v("限"+t._s(t.reginonName)+"使用")])])])])},ti=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("兑换")]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("全额抵扣")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("兑换券")])])}],ei={getType:function(t){return 1===t.type?"productPriceMinusToFreeCoupon":2===t.type?"totalPriceMinusSomeCoupon":3===t.type?"productPriceMinusSomeCoupon":0===t.type?"productPriceMinusToSomeCoupon":void 0}},si=432e6,ii=864e5,ni={props:["couponDetails"],data:function(){return{currentDate:Jt()(),ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ei.getType(this.couponDetails)},reginonName:function(){var t=_t.getRegionBlockCode();return oe.getCurrentRegionName(t)},calculateCouponUseTime:function(){var t=this.couponDetails.useDateFrom,e=this.couponDetails.useDateTo;if(this.currentDate<t){var s=t-this.currentDate,i=Math.floor(s/864e5);if(s<=si)return s<ii?"即可使用":i+"天后可用"}else if(this.currentDate<e){var n=e-this.currentDate,a=Math.floor(n/864e5);if(n<=si)return n<ii?"即将过期":a+"天后过期"}}}},ai=ni,oi=(s("655b"),Object(p["a"])(ai,Js,ti,!1,null,"443965fd",null)),ci=oi.exports,ri=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"timeline-bar"},[s("div",{staticClass:"timeline-bar__line"}),s("div",{class:["timeline-bar__start-date",{"is-middle":t.startDate>t.currentDate&&t.startDate<t.endDate,"is-hidden":t.startDate<=t.currentDate}]},[s("div",{staticClass:"timeline-bar__start-date__title"},[t._v("活动开始")]),s("div",{staticClass:"timeline-bar__start-date__circle-icon"}),s("div",{staticClass:"timeline-bar__start-date__date"},[t._v(t._s(t._f("date")(t.startDate)))])]),s("div",{class:["timeline-bar__end-date",{"is-left":t.endDate<=t.currentDate,"is-right":t.endDate>t.currentDate}]},[s("div",{staticClass:"timeline-bar__end-date__title"},[t._v("活动结束")]),s("div",{staticClass:"timeline-bar__end-date__circle-icon"}),s("div",{staticClass:"timeline-bar__end-date__date"},[t._v(t._s(t._f("date")(t.endDate)))])]),s("div",{class:["timeline-bar__current-date",{"is-left":t.currentDate<t.startDate,"is-right":t.currentDate>=t.endDate}]},[s("div",{staticClass:"timeline-bar__current-date__title"},[t._v("今天")]),s("div",{staticClass:"timeline-bar__current-date__circle-icon"}),s("div",{staticClass:"timeline-bar__current-date__date"},[t._v(t._s(t._f("date")(t.currentDate)))])])])},di=[],pi={props:["couponDetails"],data:function(){return{startDate:this.couponDetails.useDateFrom,endDate:this.couponDetails.useDateTo,currentDate:Jt()()}},filters:{date:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,"-").concat(n,"-").concat(a)}}},li=pi,ui=(s("7af5"),Object(p["a"])(li,ri,di,!1,null,"109aa22e",null)),_i=ui.exports,mi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"use-condition"},[s("div",{staticClass:"use-condition__title"},[s("img",{staticClass:"use-condition__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-use-condition.png"}}),s("span",{staticClass:"use-condition__title__text"},[t._v("适用条件")])]),s("div",{staticClass:"use-condition__text-list"},[s("p",[t._v(t._s(t.applicationScope1))])])])},hi=[],gi={props:["applicationScope1"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},vi=gi,fi=(s("26d2"),Object(p["a"])(vi,mi,hi,!1,null,"42e58150",null)),Ci=fi.exports,yi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"other-condition"},[s("div",{staticClass:"other-condition__title"},[s("img",{staticClass:"other-condition__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-other-condition.png"}}),s("span",{staticClass:"other-condition__title__text"},[t._v("其他条件")])]),s("div",{staticClass:"other-condition__text-list"},[s("p",[t._v(t._s(t.applicationScope2))])])])},bi=[],wi={props:["applicationScope2"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},Si=wi,Di=(s("054f"),Object(p["a"])(Si,yi,bi,!1,null,"6caebc78",null)),ki=Di.exports,xi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store"},[1===t.shopUseFlg&&null!==t.shops?s("div",[s("div",{staticClass:"available-store__title",on:{click:t.goToCouponShopList}},[s("div",{staticClass:"available-store__title__left"},[s("img",{staticClass:"available-store__title__left__image",attrs:{src:t.ossImageUrl+"/coupon/icon-shop.png"}}),s("span",{staticClass:"available-store__title__left__text"},[t._v("适用门店")])]),s("div",{staticClass:"available-store__title__right"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-arrows.png"}}),s("span",[t._v("查看全部("+t._s(t.shops.length)+")")])])]),s("div",{staticClass:"available-store__content"},[s("div",{staticClass:"available-store__content__title"},[s("div",{staticClass:"available-store__content__title__shop"},[s("span",{staticClass:"available-store__content__title__shop__name"},[t._v(t._s(t.shops[0].shopName))]),""!==t.shops[0].businessTime?s("format-business-time",{attrs:{businessTime:t.shops[0].businessTime}}):t._e()],1),t.sortedShopsWithDistance[0].distance?s("div",{staticClass:"available-store__content__title__distance"},[t._v("\n          距您"+t._s(t._f("toKilometer")(t.sortedShopsWithDistance[0].distance))+"\n        ")]):t._e()]),s("div",{staticClass:"available-store__content__address"},[t._v("\n        "+t._s(t.shops[0].address)+"\n      ")])])]):s("div",[s("div",{staticClass:"available-store__title"},[s("div",{staticClass:"available-store__title__left"},[s("img",{staticClass:"available-store__title__left__image",attrs:{src:t.ossImageUrl+"/coupon/icon-shop.png"}}),s("span",{staticClass:"available-store__title__left__text"},[t._v("适用门店")])])]),s("div",{staticClass:"available-store__all-shop"},[t._v("\n      "+t._s(t.regionName)+"地区所有门店\n    ")])])])},Ti=[],Ii={props:["couponDetails"],components:{FormatBusinessTime:ue},data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",shops:null,shopUseFlg:this.couponDetails.shopUseFlg,regionName:null,currentLocation:null}},created:function(){var t=_t.getRegionBlockCode();this.regionName=oe.getCurrentRegionName(t),this.filterShops(),this.getLocation()},filters:{toKilometer:function(t){return t>20?">20km":t.toFixed(2)+"km"}},computed:{sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=Xt()({},e);return s.distance=ie(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops}},methods:{goToCouponShopList:function(){var t=this.couponDetails.shopList;this.$router.push({name:"coupon-available-shop-list",params:{shopList:t}})},filterShops:function(){var t=_t.getRegionBlockCode(),e=this.couponDetails.shopList,s=this.shopUseFlg,i=0===s;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](t);this.shops=n?this.$store.getters["shop/shopsForRegion"](t):[]}else{var a=this.$store.state.shop.shops[t];this.shops=ee.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},getLocation:function(){var t=this;ut.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i}})}}},Ai=Ii,Ni=(s("5d4f"),Object(p["a"])(Ai,xi,Ti,!1,null,"76660e64",null)),Pi=Ni.exports,Li=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-instruction"},[s("div",{staticClass:"coupon-instruction__title"},[s("img",{staticClass:"coupon-instruction__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-coupon-instruction.png"}}),s("span",{staticClass:"coupon-instruction__title__text"},[t._v("礼券说明")])]),s("div",{staticClass:"coupon-instruction__text-list"},[s("p",[t._v(t._s(t.couponExplain))])])])},Mi=[],Ei={props:["couponExplain"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},$i=Ei,Oi=(s("92bc"),Object(p["a"])($i,Li,Mi,!1,null,"1b3cb606",null)),Ri=Oi.exports,Fi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-commodity"},[s("div",{staticClass:"available-commodity__title"},[s("img",{staticClass:"available-commodity__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-available-commodity.png"}}),s("span",{staticClass:"available-commodity__title__text"},[t._v("适用商品")])]),s("div",{staticClass:"available-commodity__content"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",[t._v("适用所有商品")]):"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType?s("div",[t._v(t._s(t.couponDetails.commodityList[0].commodityName))]):t._e()])])},Bi=[],Ui={props:["couponDetails"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ei.getType(this.couponDetails)}}},ji=Ui,Hi=(s("a66a"),Object(p["a"])(ji,Fi,Bi,!1,null,"41b75540",null)),zi=Hi.exports,Wi={data:function(){return{couponDetails:null,ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},components:{CouponType:ci,TimelineBar:_i,UseCondition:Ci,OtherCondition:ki,AvailableShop:Pi,CouponInstruction:Ri,AvailableCommodity:zi,GotoHome:yt},created:function(){this.fetchUserCouponDetails()},methods:{fetchUserCouponDetails:function(){var t=this;$t.show();var e=this.$route.params.userCouponId,s=this.$route.params.couponId,i=_t.getRegionBlockCode();mt.coupon.fetchUserCouponDetail({couponId:s,userCouponId:e,regionBlockCode:i}).then(function(e){t.couponDetails=e}).finally(function(){return $t.hide()})}}},Gi=Wi,Vi=(s("c98c"),Object(p["a"])(Gi,Xs,Zs,!1,null,"3da76559",null)),qi=Vi.exports,Yi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.couponDetails?s("div",{staticClass:"coupon-detail"},[s("coupon-type",{attrs:{couponDetails:t.couponDetails}}),0===t.couponDetails.dynamicPeriodFlg?s("div",{staticClass:"coupon-detail__timeline"},[s("div",{staticClass:"coupon-detail__timeline__title"},[s("img",{staticClass:"coupon-detail__timeline__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-time.png"}}),s("span",{staticClass:"coupon-detail__timeline__title__text"},[t._v("使用时间")])]),s("div",{staticClass:"coupon-detail__timeline__bar"},[s("timeline-bar",{attrs:{couponDetails:t.couponDetails}})],1)]):t._e(),s("available-shop",{attrs:{couponDetails:t.couponDetails}}),s("available-commodity",{attrs:{couponDetails:t.couponDetails}}),s("coupon-instruction",{attrs:{couponExplain:t.couponDetails.couponExplain}}),""!==t.couponDetails.applicationScope1&&t.couponDetails.applicationScope1?s("use-condition",{attrs:{applicationScope1:t.couponDetails.applicationScope1}}):t._e(),""!==t.couponDetails.applicationScope2&&t.couponDetails.applicationScope2?s("other-condition",{attrs:{applicationScope2:t.couponDetails.applicationScope2}}):t._e(),s("goto-home")],1):t._e()},Qi=[],Ki=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-type"},["productPriceMinusToFreeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}),t._m(0)])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("消费立减")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),"totalPriceMinusSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("满"),s("span",{staticClass:"coupon-type__price__text__total-price__number"},[t._v(t._s(t.couponDetails.originalPrice))]),t._v("元可用\n          ")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减至"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("消费立减")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),s("div",{staticClass:"coupon-type__title"},[s("div",{staticClass:"coupon-type__title__content"},[s("span",{staticClass:"coupon-type__title__content__name"},[t._v(t._s(t.couponDetails.couponName))]),0===t.couponDetails.dynamicPeriodFlg&&t.calculateCouponUseTime?s("span",{staticClass:"coupon-type__title__content__will-expired-time"},[t._v(t._s(t.calculateCouponUseTime))]):t._e()]),s("div",{staticClass:"coupon-type__title__region"},[s("img",{staticClass:"coupon-type__title__region__image",attrs:{src:t.ossImageUrl+"/coupon/icon-region.png"}}),s("span",{staticClass:"coupon-type__title__region__name"},[t._v("限"+t._s(t.reginonName)+"使用")])])])])},Xi=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("兑换")]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("全额抵扣")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("兑换券")])])}],Zi=432e6,Ji=864e5,tn={props:["couponDetails"],data:function(){return{currentDate:Jt()(),ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ei.getType(this.couponDetails)},reginonName:function(){var t=_t.getRegionBlockCode();return oe.getCurrentRegionName(t)},calculateCouponUseTime:function(){var t=this.couponDetails.useDateFrom,e=this.couponDetails.useDateTo;if(this.currentDate<t){var s=t-this.currentDate,i=Math.floor(s/864e5);if(s<=Zi)return s<Ji?"即可使用":i+"天后可用"}else{var n=e-this.currentDate,a=Math.floor(n/864e5);if(n<=Zi)return n<Ji?"即将过期":a+"天后过期"}}}},en=tn,sn=(s("600b"),Object(p["a"])(en,Ki,Xi,!1,null,"222a0e56",null)),nn=sn.exports,an=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"timeline-bar"},[s("div",{staticClass:"timeline-bar__line"}),s("div",{class:["timeline-bar__start-date",{"is-middle":t.startDate>t.currentDate&&t.startDate<t.endDate,"is-hidden":t.startDate<=t.currentDate}]},[s("div",{staticClass:"timeline-bar__start-date__title"},[t._v("活动开始")]),s("div",{staticClass:"timeline-bar__start-date__circle-icon"}),s("div",{staticClass:"timeline-bar__start-date__date"},[t._v(t._s(t._f("date")(t.startDate)))])]),s("div",{class:["timeline-bar__end-date",{"is-left":t.endDate<=t.currentDate,"is-right":t.endDate>t.currentDate}]},[s("div",{staticClass:"timeline-bar__end-date__title"},[t._v("活动结束")]),s("div",{staticClass:"timeline-bar__end-date__circle-icon"}),s("div",{staticClass:"timeline-bar__end-date__date"},[t._v(t._s(t._f("date")(t.endDate)))])]),s("div",{class:["timeline-bar__current-date",{"is-left":t.currentDate<t.startDate,"is-right":t.currentDate>=t.endDate}]},[s("div",{staticClass:"timeline-bar__current-date__title"},[t._v("今天")]),s("div",{staticClass:"timeline-bar__current-date__circle-icon"}),s("div",{staticClass:"timeline-bar__current-date__date"},[t._v(t._s(t._f("date")(t.currentDate)))])])])},on=[],cn={props:["couponDetails"],data:function(){return{startDate:this.couponDetails.useDateFrom,endDate:this.couponDetails.useDateTo,currentDate:Jt()()}},filters:{date:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,"-").concat(n,"-").concat(a)}}},rn=cn,dn=(s("8732"),Object(p["a"])(rn,an,on,!1,null,"7a529eb4",null)),pn=dn.exports,ln=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"use-condition"},[s("div",{staticClass:"use-condition__title"},[s("img",{staticClass:"use-condition__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-use-condition.png"}}),s("span",{staticClass:"use-condition__title__text"},[t._v("适用条件")])]),s("div",{staticClass:"use-condition__text-list"},[s("p",[t._v(t._s(t.applicationScope1))])])])},un=[],_n={props:["applicationScope1"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},mn=_n,hn=(s("3ffa"),Object(p["a"])(mn,ln,un,!1,null,"bf545126",null)),gn=hn.exports,vn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"other-condition"},[s("div",{staticClass:"other-condition__title"},[s("img",{staticClass:"other-condition__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-other-condition.png"}}),s("span",{staticClass:"other-condition__title__text"},[t._v("其他条件")])]),s("div",{staticClass:"other-condition__text-list"},[s("p",[t._v(t._s(t.applicationScope2))])])])},fn=[],Cn={props:["applicationScope2"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},yn=Cn,bn=(s("0a74"),Object(p["a"])(yn,vn,fn,!1,null,"75306fd9",null)),wn=bn.exports,Sn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store"},[1===t.shopUseFlg&&null!==t.shops?s("div",[s("div",{staticClass:"available-store__title",on:{click:t.goToCouponShopList}},[s("div",{staticClass:"available-store__title__left"},[s("img",{staticClass:"available-store__title__left__image",attrs:{src:t.ossImageUrl+"/coupon/icon-shop.png"}}),s("span",{staticClass:"available-store__title__left__text"},[t._v("适用门店")])]),s("div",{staticClass:"available-store__title__right"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-arrows.png"}}),s("span",[t._v("查看全部("+t._s(t.shops.length)+")")])])]),s("div",{staticClass:"available-store__content"},[s("div",{staticClass:"available-store__content__title"},[s("div",{staticClass:"available-store__content__title__shop"},[s("span",{staticClass:"available-store__content__title__shop__name"},[t._v(t._s(t.shops[0].shopName))]),""!==t.shops[0].businessTime?s("format-business-time",{attrs:{businessTime:t.shops[0].businessTime}}):t._e()],1),t.sortedShopsWithDistance[0].distance?s("div",{staticClass:"available-store__content__title__distance"},[t._v("\n          距您"+t._s(t._f("toKilometer")(t.sortedShopsWithDistance[0].distance))+"\n        ")]):t._e()]),s("div",{staticClass:"available-store__content__address"},[t._v("\n        "+t._s(t.shops[0].address)+"\n      ")])])]):s("div",[s("div",{staticClass:"available-store__title"},[s("div",{staticClass:"available-store__title__left"},[s("img",{staticClass:"available-store__title__left__image",attrs:{src:t.ossImageUrl+"/coupon/icon-shop.png"}}),s("span",{staticClass:"available-store__title__left__text"},[t._v("适用门店")])])]),s("div",{staticClass:"available-store__all-shop"},[t._v("\n      "+t._s(t.regionName)+"地区所有门店\n    ")])])])},Dn=[],kn={props:["couponDetails"],components:{FormatBusinessTime:ue},data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",shops:null,shopUseFlg:this.couponDetails.shopUseFlg,regionName:null,currentLocation:null}},created:function(){var t=_t.getRegionBlockCode();this.regionName=oe.getCurrentRegionName(t),this.filterShops(),this.getLocation()},filters:{toKilometer:function(t){return t>20?">20km":t.toFixed(2)+"km"}},computed:{sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=Xt()({},e);return s.distance=ie(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops}},methods:{goToCouponShopList:function(){var t=this.couponDetails.shopList;this.$router.push({name:"coupon-available-shop-list",params:{shopList:t}})},filterShops:function(){var t=_t.getRegionBlockCode(),e=this.couponDetails.shopList,s=this.shopUseFlg,i=0===s;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](t);this.shops=n?this.$store.getters["shop/shopsForRegion"](t):[]}else{var a=this.$store.state.shop.shops[t];this.shops=ee.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},getLocation:function(){var t=this;ut.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i}})}}},xn=kn,Tn=(s("748a"),Object(p["a"])(xn,Sn,Dn,!1,null,"adb73bba",null)),In=Tn.exports,An=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-instruction"},[s("div",{staticClass:"coupon-instruction__title"},[s("img",{staticClass:"coupon-instruction__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-coupon-instruction.png"}}),s("span",{staticClass:"coupon-instruction__title__text"},[t._v("礼券说明")])]),s("div",{staticClass:"coupon-instruction__text-list"},[s("p",[t._v(t._s(t.couponExplain))])])])},Nn=[],Pn={props:["couponExplain"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},Ln=Pn,Mn=(s("2a6e"),Object(p["a"])(Ln,An,Nn,!1,null,"69a72388",null)),En=Mn.exports,$n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-commodity"},[s("div",{staticClass:"available-commodity__title"},[s("img",{staticClass:"available-commodity__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-available-commodity.png"}}),s("span",{staticClass:"available-commodity__title__text"},[t._v("适用商品")])]),s("div",{staticClass:"available-commodity__content"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",[t._v("适用所有商品")]):"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType?s("div",[t._v(t._s(t.couponDetails.commodityList[0].commodityName))]):t._e()])])},On=[],Rn={props:["couponDetails"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ei.getType(this.couponDetails)}}},Fn=Rn,Bn=(s("afc2"),Object(p["a"])(Fn,$n,On,!1,null,"0127392b",null)),Un=Bn.exports,jn={data:function(){return{couponDetails:null,ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},components:{CouponType:nn,TimelineBar:pn,UseCondition:gn,OtherCondition:wn,AvailableShop:In,CouponInstruction:En,AvailableCommodity:Un,GotoHome:yt},created:function(){this.fetchCouponDetails()},methods:{fetchCouponDetails:function(){var t=this;$t.show();var e=this.$route.params.couponId,s=_t.getRegionBlockCode();mt.coupon.fetchCouponDetail({couponId:e,regionBlockCode:s}).then(function(e){t.couponDetails=e}).finally(function(){return $t.hide()})}}},Hn=jn,zn=(s("4ea9"),Object(p["a"])(Hn,Yi,Qi,!1,null,"75572b64",null)),Wn=zn.exports,Gn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"get-coupons"},[s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchData}},[s("div",{staticClass:"get-coupons__content"},[s("div",{staticClass:"get-coupons__pick-coupon-remind"},[s("span",{staticClass:"get-coupons__pick-coupon-remind__text"},[t._v("优惠订阅，活动开启前提醒我。")]),t.isRemind?s("div",{staticClass:"get-coupons__pick-coupon-remind__button",on:{click:t.remindSwitch}},[s("span",{staticClass:"get-coupons__pick-coupon-remind__button__switch"})]):s("div",{staticClass:"get-coupons__pick-coupon-remind__button-gray",on:{click:t.remindSwitch}},[s("span",{staticClass:"get-coupons__pick-coupon-remind__button-gray__switch"})])]),null!==t.pickCouponActivityList?s("div",{staticClass:"get-coupons__banner"},[s("swiper",{attrs:{options:t.swiperOption}},t._l(t.pickCouponActivityList.pickCouponActivityList,function(e,i){return s("swiper-slide",{key:i},[s("img",{attrs:{src:e.imagePathList},on:{click:function(s){return t.goToPickCouponActivityDetail(e.pickCouponActivityId)}}})])}),1),s("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"})],1):t._e(),t.hasNewShopsCouponVisible?s("div",{staticClass:"get-coupons__image",on:{click:t.goToNewShopCoupon}},[s("img",{attrs:{src:t.newShopBannerImage}})]):t._e(),null!==t.pickCouponList?s("div",{staticClass:"get-coupons__coupon-list"},t._l(t.pickCouponList,function(e,i){return s("div",{key:i},[e.notBegin?s("coupon-item-not-begin",{attrs:{coupon:e}}):e.hasPicked?s("coupon-item-picked",{attrs:{coupon:e}}):e.couponRemain<=0&&e.sendUpperLimit>0?s("coupon-item-no-remaining",{attrs:{coupon:e}}):e.hasPicked?t._e():s("coupon-item-unclaimed",{attrs:{coupon:e},on:{click:function(s){return t.pickCoupon(e.couponId)}}})],1)}),0):t._e()])]),s("goto-home")],1)},Vn=[],qn=s("768b"),Yn=(s("ac6a"),s("5df3"),s("dfa4"),s("7212")),Qn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.visible?s("div",{staticClass:"toast"},[s("transition",{attrs:{name:"fade"}},["success-icon"===t.iconName?s("div",[s("div",{staticClass:"toast__container"},[s("div",{staticClass:"toast__container__wrapper"},[s("span",{staticClass:"toast__container__wrapper__icon success"}),s("div",{staticClass:"toast__container__wrapper__msg"},[t._v(t._s(t.msg))])])])]):"error-icon"===t.iconName?s("div",[s("div",{staticClass:"toast__container"},[s("div",{staticClass:"toast__container__wrapper"},[s("span",{staticClass:"toast__container__wrapper__icon error"}),s("div",{staticClass:"toast__container__wrapper__msg"},[t._v(t._s(t.msg))])])])]):s("div",{staticClass:"toast__msg"},[t._v(t._s(t.msg))])])],1):t._e()},Kn=[],Xn={props:{msg:String,iconName:String},data:function(){return{visible:!1}},mounted:function(){var t=this;window.addEventListener("popstate",function(e){t.visible=!1})}},Zn=Xn,Jn=(s("d88c"),Object(p["a"])(Zn,Qn,Kn,!1,null,"58787cb4",null)),ta=Jn.exports,ea=i["a"].extend(ta),sa=new ea({el:document.createElement("div")});document.body.appendChild(sa.$el);var ia={show:function(t){var e=t.msg,s=void 0===e?"":e,i=t.duration,n=void 0===i?2500:i,a=t.iconName,o=void 0===a?"":a;sa.msg=s,sa.iconName=o,sa.visible=!0,setTimeout(function(){return sa.visible=!1},n)}},na=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__picked-up"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-picked-up.png"}})])])])},aa=[],oa={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:Jt()()}},computed:{couponType:function(){return ei.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},ca=oa,ra=(s("22c2"),Object(p["a"])(ca,na,aa,!1,null,"4f0bd26c",null)),da=ra.exports,pa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__activity-progress"},[s("div",{staticClass:"coupon-item__activity-progress__no-start"},[s("div",{staticClass:"coupon-item__activity-progress__no-start__time"},[t._v(t._s(t._f("formatTime")(t.coupon.useDateFrom)))]),s("div",[t._v("活动开始")])])])])])},la=[],ua={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:Jt()()}},computed:{couponType:function(){return ei.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)},formatTime:function(t){var e=new Date(t).getMonth()+1,s=new Date(t).getDate(),i=new Date(t).getHours(),n=new Date(t).getMinutes(),a=s<10?"0"+s:String(s),o=i<10?"0"+i:String(i),c=n<10?"0"+n:String(n);return"".concat(e,"月").concat(a,"日").concat(o,":").concat(c)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},_a=ua,ma=(s("95da"),Object(p["a"])(_a,pa,la,!1,null,"f1fd3c74",null)),ha=ma.exports,ga=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__activity-progress"},[t.coupon.sendUpperLimit>0?s("div",[s("div",{staticClass:"coupon-item__activity-progress__persent"},[s("canvas",{ref:"canvas",staticClass:"canvas",attrs:{width:"120",height:"120"}}),s("div",{staticClass:"coupon-item__activity-progress__persent__text"},[s("span",[t._v("已抢")]),s("span",[t._v(t._s(t.coupon.percentage)+"%")])])]),s("div",{staticClass:"coupon-item__activity-progress__button",on:{click:t.pickCoupon}},[s("span",[t._v("立即领取")])])]):s("div",{staticClass:"coupon-item__activity-progress__limit-none-button",on:{click:t.pickCoupon}},[s("span",[t._v("立即领取")])])])])])},va=[],fa={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:Jt()()}},computed:{couponType:function(){return ei.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},watch:{coupon:function(t,e){this.drawCanvas()}},mounted:function(){this.drawCanvas()},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})},pickCoupon:function(t){t.stopImmediatePropagation(),this.$emit("click")},drawCanvas:function(){if(this.coupon.sendUpperLimit>0){var t=function(t){n.clearRect(0,0,100,100),n.beginPath(),n.arc(60,60,32,i(0),i(100)),n.strokeStyle="#f5c7c0",n.lineWidth=3,n.lineCap="round",n.stroke(),n.beginPath(),n.arc(60,60,32,i(0),i(t)),n.strokeStyle="#e65c58",n.lineWidth=3,n.lineCap="round",n.stroke()},e=function e(s){s<=a&&(t(s),requestAnimationFrame(function(){e(s+1)}))},s=function(t,e,s,i,n){var a=(t-e)/(s-e);return i+a*(n-i)},i=function(t){return s(t,0,100,.75*Math.PI,2.25*Math.PI)},n=this.$refs.canvas.getContext("2d"),a=this.coupon.percentage;requestAnimationFrame(function(){return e(0)})}}}},Ca=fa,ya=(s("fc26"),Object(p["a"])(Ca,ga,va,!1,null,"7b3ed53e",null)),ba=ya.exports,wa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item-none",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item-none__image",attrs:{src:t.ossImageUrl+"/coupon/failure-coupons-background.png"}}),s("div",{staticClass:"coupon-item-none__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item-none__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price coupon-item-none__limit-product"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price coupon-item-none__limit-product"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item-none__description"},[s("div",{staticClass:"coupon-item-none__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item-none__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item-none__activity-progress"},[s("div",{staticClass:"coupon-item-none__activity-progress__picked-up"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-picked-up-none.png"}})])])])])},Sa=[],Da={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ei.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},ka=Da,xa=(s("5591"),Object(p["a"])(ka,wa,Sa,!1,null,"3828ce2c",null)),Ta=xa.exports,Ia={data:function(){return{pickCouponActivityList:null,pickCouponList:null,swiperOption:{autoplay:{delay:1500,disableOnInteraction:!1},speed:500,loop:!0,pagination:{el:".swiper-pagination"}},hasNewShopsCouponVisible:!1,newShopBannerImage:null,isRemind:!1,isRefreshing:!1}},components:{swiper:Yn["swiper"],GotoHome:yt,swiperSlide:Yn["swiperSlide"],PullDownRefresh:zt,CouponItemPicked:da,CouponItemNotBegin:ha,CouponItemUnclaimed:ba,CouponItemNoRemaining:Ta},created:function(){$t.show(),this.refusedPushState(),this.fetchData()},methods:{goToNewShopCoupon:function(){this.$router.push({path:"/new-shops-coupon"})},fetchData:function(){var t=this;return this.isRefreshing=!0,f.a.all([this.fetchPickCouponActivityList(),this.fetchPickCouponList(),this.hasNewShopsCoupon()]).then(function(e){var s=Object(qn["a"])(e,3),i=s[0],n=s[1],a=s[2];if(a.hasCoupon){var o=_t.getRegionBlockCode();mt.coupon.getNewShopTopBanner({regionBlockCode:o}).then(function(e){t.newShopBannerImage=e.data.list[0].imagePath})}n.forEach(function(t){t.notBegin=t.currentDate<t.useDateFrom,t.percentage=Math.round((t.sendUpperLimit-t.couponRemain)/t.sendUpperLimit*100),t.isRemaining=t.couponRemain<=0&&t.sendUpperLimit>0}),t.pickCouponActivityList=i,t.pickCouponList=n,t.hasNewShopsCouponVisible=a.hasCoupon}).finally(function(){t.isRefreshing=!1,$t.hide()})},fetchPickCouponActivityList:function(){var t=_t.getRegionBlockCode();return mt.coupon.fetchPickCouponActivityList({regionBlockCode:t})},fetchPickCouponList:function(){var t=_t.getRegionBlockCode();return mt.coupon.fetchPickCouponList({regionBlockCode:t})},hasNewShopsCoupon:function(){var t=_t.getRegionBlockCode();return mt.coupon.hasNewShopsCoupon({regionBlockCode:t})},goToPickCouponActivityDetail:function(t){this.$router.push({name:"pick-coupon-activity-detail",params:{pickCouponActivityId:t}})},remindSwitch:function(){var t=this;this.isRemind?mt.coupon.disagreePush().then(function(e){ia.show({msg:"您已关闭优惠订阅"}),t.isRemind=!1}):mt.coupon.agreePush().then(function(e){ia.show({msg:"您已开启闭优惠订阅"}),t.isRemind=!0})},pickCoupon:function(t){var e=this;mt.coupon.pickCoupon({couponId:t}).then(function(t){ia.show({msg:"抢券成功",iconName:"success-icon"});var s=_t.getRegionBlockCode();mt.coupon.fetchPickCouponList({regionBlockCode:s}).then(function(t){t.map(function(t){t.notBegin=t.currentDate<t.useDateFrom,t.percentage=Math.round((t.sendUpperLimit-t.couponRemain)/t.sendUpperLimit*100),t.isRemaining=t.couponRemain<=0&&t.sendUpperLimit>0}),e.pickCouponList=t})})},refusedPushState:function(){var t=this;mt.coupon.refusedPushState().then(function(e){e.deagreed?t.isRemind=!1:t.isRemind=!0})}}},Aa=Ia,Na=(s("c462"),Object(p["a"])(Aa,Gn,Vn,!1,null,"05b9fcf5",null)),Pa=Na.exports,La=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-shops-coupon"},[s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchNewShops}},[s("div",{staticClass:"new-shops-coupon__container"},[s("div",{staticClass:"new-shops-coupon__select-region"},[null!==t.cityList&&null!==t.currentCity?s("div",{staticClass:"new-shops-coupon__select-region__button"},[s("div",[t._v(t._s(t.currentCity.cityName))]),s("div",{staticClass:"new-shops-coupon__select-region__button__icon"}),s("select",{directives:[{name:"model",rawName:"v-model",value:t.currentCity,expression:"currentCity"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.currentCity=e.target.multiple?s:s[0]}}},t._l(t.cityList,function(e,i){return s("option",{key:e.cityId,domProps:{value:e}},[t._v(t._s(e.cityName))])}),0)]):t._e()]),null!==t.newShopList&&t.newShopList.length>0?s("div",{staticClass:"new-shops-coupon__content"},t._l(t.newShopList,function(e,i){return s("new-shop-item",{key:i,attrs:{newShop:e},on:{pickNewShopCoupon:t.pickNewShopCoupon}})}),1):s("div",{staticClass:"new-shops-coupon__no-data"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-no-data.png"}}),s("div",[t._v("暂无内容")])])])]),s("goto-home")],1)},Ma=[],Ea=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-shop-item"},[s("div",{staticClass:"new-shop-item__shop"},[s("div",{staticClass:"new-shop-item__shop__name"},[s("span",{staticClass:"new-shop-item__shop__name__title"},[t._v(t._s(t.newShop.shopInfo.shopName))]),""!==t.newShop.shopInfo.businessTime?s("format-business-time",{attrs:{businessTime:t.newShop.shopInfo.businessTime}}):t._e()],1),s("div",{staticClass:"new-shop-item__shop__address"},[s("span",{staticClass:"new-shop-item__shop__address__title"},[t._v(t._s(t.newShop.shopInfo.address))]),t.shopDistance?s("span",{staticClass:"new-shop-item__shop__address__km"},[t._v("距您"+t._s(t._f("toKilometer")(t.shopDistance)))]):t._e()])]),t.couponList.length>0?s("div",{staticClass:"new-shop-item__coupon-list"},[t._l(t.couponList,function(e,i){return s("div",{key:i},[e.notBegin?s("coupon-item-not-begin",{attrs:{coupon:e}}):1===e.pickFlg?s("coupon-item-picked",{attrs:{coupon:e}}):e.couponRemain<=0&&e.sendUpperLimit>0?s("coupon-item-no-remaining",{attrs:{coupon:e}}):0===e.pickFlg?s("coupon-item-unclaimed",{attrs:{coupon:e},on:{click:function(s){return t.pickNewShopCoupon(e.couponId)}}}):t._e()],1)}),t.newShop.shopCoupons.length>2?s("div",[t.isUnfold?s("div",{staticClass:"new-shop-item__coupon-list__unfold",on:{click:t.unfoldCouponList}},[s("span",[t._v("收起")]),s("img",{staticClass:"new-shop-item__coupon-list__unfold__image",attrs:{src:t.ossImageUrl+"/coupon/icon-unfold.png"}})]):s("div",{staticClass:"new-shop-item__coupon-list__unfold",on:{click:t.unfoldCouponList}},[s("span",[t._v("展开剩余"+t._s(t.unfoldCouponListLength)+"张")]),s("img",{staticClass:"new-shop-item__coupon-list__forward__image",attrs:{src:t.ossImageUrl+"/coupon/icon-forward-copy.png"}})])]):t._e()],2):t._e()])},$a=[],Oa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__picked-up"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-picked-up.png"}})])])])},Ra=[],Fa={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:Jt()()}},computed:{couponType:function(){return ei.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},Ba=Fa,Ua=(s("d662"),Object(p["a"])(Ba,Oa,Ra,!1,null,"5ceae9cf",null)),ja=Ua.exports,Ha=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__activity-progress"},[s("div",{staticClass:"coupon-item__activity-progress__no-start"},[s("div",{staticClass:"coupon-item__activity-progress__no-start__time"},[t._v(t._s(t._f("formatTime")(t.coupon.useDateFrom)))]),s("div",[t._v("活动开始")])])])])])},za=[],Wa={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:Jt()()}},computed:{couponType:function(){return ei.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)},formatTime:function(t){var e=new Date(t).getMonth()+1,s=new Date(t).getDate(),i=new Date(t).getHours(),n=new Date(t).getMinutes(),a=s<10?"0"+s:String(s),o=i<10?"0"+i:String(i),c=n<10?"0"+n:String(n);return"".concat(e,"月").concat(a,"日").concat(o,":").concat(c)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},Ga=Wa,Va=(s("2297"),Object(p["a"])(Ga,Ha,za,!1,null,"69000168",null)),qa=Va.exports,Ya=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__activity-progress"},[t.coupon.sendUpperLimit>0?s("div",[s("div",{staticClass:"coupon-item__activity-progress__persent"},[s("canvas",{ref:"canvas",staticClass:"canvas",attrs:{width:"120",height:"120"}}),s("div",{staticClass:"coupon-item__activity-progress__persent__text"},[s("span",[t._v("已抢")]),s("span",[t._v(t._s(t.coupon.percentage)+"%")])])]),s("div",{staticClass:"coupon-item__activity-progress__button",on:{click:t.pickCoupon}},[s("span",[t._v("立即领取")])])]):s("div",{staticClass:"coupon-item__activity-progress__limit-none-button",on:{click:t.pickCoupon}},[s("span",[t._v("立即领取")])])])])])},Qa=[],Ka={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:Jt()()}},computed:{couponType:function(){return ei.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},watch:{coupon:function(t,e){this.drawCanvas()}},mounted:function(){this.drawCanvas()},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})},pickCoupon:function(t){t.stopImmediatePropagation(),this.$emit("click")},drawCanvas:function(){if(this.coupon.sendUpperLimit>0){var t=function(t){n.clearRect(0,0,100,100),n.beginPath(),n.arc(60,60,32,i(0),i(100)),n.strokeStyle="#f5c7c0",n.lineWidth=3,n.lineCap="round",n.stroke(),n.beginPath(),n.arc(60,60,32,i(0),i(t)),n.strokeStyle="#e65c58",n.lineWidth=3,n.lineCap="round",n.stroke()},e=function e(s){s<=a&&(t(s),requestAnimationFrame(function(){e(s+1)}))},s=function(t,e,s,i,n){var a=(t-e)/(s-e);return i+a*(n-i)},i=function(t){return s(t,0,100,.75*Math.PI,2.25*Math.PI)},n=this.$refs.canvas.getContext("2d"),a=this.coupon.percentage;requestAnimationFrame(function(){return e(0)})}}}},Xa=Ka,Za=(s("4ec4"),Object(p["a"])(Xa,Ya,Qa,!1,null,"4b908a58",null)),Ja=Za.exports,to=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item-none",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item-none__image",attrs:{src:t.ossImageUrl+"/coupon/failure-coupons-background.png"}}),s("div",{staticClass:"coupon-item-none__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item-none__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price coupon-item-none__limit-product"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price coupon-item-none__limit-product"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item-none__description"},[s("div",{staticClass:"coupon-item-none__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item-none__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item-none__activity-progress"},[s("div",{staticClass:"coupon-item-none__activity-progress__picked-up"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-picked-up-none.png"}})])])])])},eo=[],so={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ei.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},io=so,no=(s("3ae1"),Object(p["a"])(io,to,eo,!1,null,"cd480352",null)),ao=no.exports,oo={props:["newShop"],data:function(){return{couponList:[],unfoldCouponListLength:null,isUnfold:!1,ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentLocation:null}},components:{CouponItemPicked:ja,CouponItemNotBegin:qa,CouponItemUnclaimed:Ja,CouponItemNoRemaining:ao,FormatBusinessTime:ue},filters:{toKilometer:function(t){return t>20?">20km":t.toFixed(2)+"km"}},computed:{shopDistance:function(){var t={latitude:this.newShop.shopInfo.latitude,longitude:this.newShop.shopInfo.longitude},e=this.currentLocation;if(e)return ie(t.latitude,t.longitude,e.latitude,e.longitude)}},created:function(){this.shopCoupons(),this.getLocation()},watch:{newShop:function(t,e){this.couponList=[],this.newShop.shopCoupons.forEach(function(t){t.notBegin=t.currentDate<t.useDateFrom,t.percentage=Math.round((t.sendUpperLimit-t.couponRemain)/t.sendUpperLimit*100),t.isRemaining=t.couponRemain<=0&&t.sendUpperLimit>0}),this.couponList=this.newShop.shopCoupons}},methods:{shopCoupons:function(){this.newShop.shopCoupons.forEach(function(t){t.notBegin=t.currentDate<t.useDateFrom,t.percentage=Math.round((t.sendUpperLimit-t.couponRemain)/t.sendUpperLimit*100),t.isRemaining=t.couponRemain<=0&&t.sendUpperLimit>0}),this.newShop.shopCoupons.length>2?(this.couponList.push(this.newShop.shopCoupons[0]),this.couponList.push(this.newShop.shopCoupons[1]),this.unfoldCouponListLength=this.newShop.shopCoupons.length-2):this.couponList=this.newShop.shopCoupons},unfoldCouponList:function(){this.couponList=[],this.isUnfold?(this.isUnfold=!1,this.couponList.push(this.newShop.shopCoupons[0]),this.couponList.push(this.newShop.shopCoupons[1]),this.unfoldCouponListLength=this.newShop.shopCoupons.length-2):(this.isUnfold=!0,this.couponList=this.newShop.shopCoupons)},pickNewShopCoupon:function(t){var e=this.newShop.shopId;this.$emit("pickNewShopCoupon",{couponId:t,shopId:e})},getLocation:function(){var t=this;ut.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i}})}}},co=oo,ro=(s("6032"),Object(p["a"])(co,Ea,$a,!1,null,"44ed5eea",null)),po=ro.exports,lo={data:function(){return{newShopList:null,ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",cityList:null,currentCity:null,isRefreshing:!1}},components:{GotoHome:yt,NewShopItem:po,PullDownRefresh:zt},created:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.fetchCityList();case 2:this.fetchNewShops();case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{fetchNewShops:function(){var t=this;this.isRefreshing=!0;var e=_t.getRegionBlockCode(),s=this.currentCity.cityId;mt.newShops.fetchNewShops({regionBlockCode:e,cityId:s}).then(function(e){t.newShopList=e,t.isRefreshing=!1}).catch(function(e){t.isRefreshing=!1})},fetchCityList:function(){var t=this;return $t.show(),new f.a(function(e,s){var i=_t.getRegionBlockCode();mt.cityList.fetchCityList({regionBlockCode:i}).then(function(s){t.cityList=s.data,t.currentCity=t.cityList[0],e()}).finally(function(){return $t.hide()})})},pickNewShopCoupon:function(t){var e=this,s=t.couponId,i=t.shopId,n=_t.getRegionBlockCode();mt.newShops.pickNewShopCoupon({regionBlockCode:n,couponId:s,shopId:i}).then(function(t){var s=e.currentCity.cityId;mt.newShops.fetchNewShops({regionBlockCode:n,cityId:s}).then(function(t){e.newShopList=t}),ia.show({msg:"抢券成功",iconName:"success-icon"})})}},watch:{currentCity:function(t,e){e&&this.fetchNewShops()}}},uo=lo,_o=(s("4536"),Object(p["a"])(uo,La,Ma,!1,null,"2ac6dc5b",null)),mo=_o.exports,ho=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.activityDetail?s("div",{staticClass:"pick-coupon-activity-detail"},[t.activityDetail.couponList.length<=1?s("single-coupon-activity",{attrs:{activityDetail:t.activityDetail},on:{pickCoupon:t.pickCoupon}}):s("multiple-coupon-activity",{attrs:{activityDetail:t.activityDetail},on:{pickCoupon:t.pickCoupon}}),s("goto-home")],1):t._e()},go=[],vo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"single-coupon"},[s("div",{staticClass:"single-coupon__image"},[s("img",{attrs:{src:t.pickCouponActivity.backgroundImage}})]),s("div",{staticClass:"single-coupon__button",style:{top:t.couponShowOffset+"px"}},[t.isActivityEnd||t.isActivityBegin||t.isActivityGoingAndNoRemain?s("img",{staticClass:"single-coupon__button__image",attrs:{src:t.pickCouponActivity.couponImageList[1].couponImage}}):s("img",{staticClass:"single-coupon__button__image",attrs:{src:t.pickCouponActivity.couponImageList[0].couponImage}}),t.isActivityBegin?s("span",{staticClass:"single-coupon__button__text"},[t._v("即将开始")]):t.isActivityEnd?s("span",{staticClass:"single-coupon__button__text"},[t._v("活动结束")]):t.coupon.couponRemain<=0&&t.coupon.sendUpperLimit>0?s("span",{staticClass:"single-coupon__button__text"},[t._v("已领完")]):t.coupon.hasPicked?s("span",{staticClass:"single-coupon__button__text"},[t._v("已领取")]):t.coupon.hasPicked?t._e():s("span",{staticClass:"single-coupon__button__text",on:{click:function(e){return t.pickCoupon(t.coupon.couponId)}}},[t._v("立即领取")])])])},fo=[],Co={props:["activityDetail"],computed:{pickCouponActivity:function(){return this.activityDetail.pickCouponActivity},coupon:function(){return this.activityDetail.couponList[0]},isActivityBegin:function(){var t=Date.parse(new Date);return t<this.pickCouponActivity.beginTime},isActivityEnd:function(){var t=Date.parse(new Date);return t>this.pickCouponActivity.endTime},isActivityGoingAndNoRemain:function(){var t=Date.parse(new Date);return t>=this.pickCouponActivity.beginTime&&t<=this.pickCouponActivity.endTime&&this.coupon.couponRemain<=0&&this.coupon.sendUpperLimit>0},couponShowOffset:function(){var t=window.screen.width,e=this.pickCouponActivity.couponShowOffset,s=375;return e*t/s}},methods:{pickCoupon:function(t){this.$emit("pickCoupon",t)}}},yo=Co,bo=(s("74fe"),Object(p["a"])(yo,vo,fo,!1,null,"3af48294",null)),wo=bo.exports,So=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"multiple-coupon"},[s("img",{staticClass:"multiple-coupon__image",attrs:{src:t.pickCouponActivity.backgroundImage}}),s("div",{staticClass:"multiple-coupon__coupon-list",style:{top:t.couponShowOffset+"px"}},t._l(t.couponList,function(e,i){return s("div",{key:i,staticClass:"multiple-coupon__coupon-list__item"},[t.isActivityBegin?s("img",{attrs:{src:t.pickCouponActivity.couponImageList[0].couponImage}}):t.isActivityEnd&&!e.hasPicked?s("img",{attrs:{src:t.pickCouponActivity.couponImageList[2].couponImage}}):t.isActivityEnd&&e.hasPicked?s("img",{attrs:{src:t.pickCouponActivity.couponImageList[3].couponImage}}):e.noRemaining?s("img",{attrs:{src:t.pickCouponActivity.couponImageList[2].couponImage}}):e.hasPicked?s("img",{attrs:{src:t.pickCouponActivity.couponImageList[1].couponImage}}):e.hasPicked?t._e():s("img",{attrs:{src:t.pickCouponActivity.couponImageList[0].couponImage}}),s("div",{staticClass:"multiple-coupon__coupon-list__item__container",on:{click:function(s){return t.pickCoupon(e)}}},[s("div",{staticClass:"multiple-coupon__coupon-list__item__info"},["totalPriceMinusSomeCoupon"===e.couponType?s("div",[s("div",{staticClass:"multiple-coupon__coupon-list__item__info__coupon-type"},[t._v("\n              满"+t._s(e.originalPrice)+"元可用\n            ")]),s("div",{staticClass:"multiple-coupon__coupon-list__item__info__price"},[s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__symbol"},[t._v("¥")]),s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__discount"},[t._v(t._s(e.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===e.couponType?s("div",[s("div",{staticClass:"multiple-coupon__coupon-list__item__info__coupon-type"},[t._v("全额折扣")]),t._m(0,!0)]):t._e(),"productPriceMinusSomeCoupon"===e.couponType?s("div",[s("div",{staticClass:"multiple-coupon__coupon-list__item__info__coupon-type"},[t._v("消费立减")]),s("div",{staticClass:"multiple-coupon__coupon-list__item__info__price"},[s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__symbol"},[t._v("¥")]),s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__discount"},[t._v(t._s(e.discountPrice))])])]):t._e(),"productPriceMinusToSomeCoupon"===e.couponType?s("div",[s("div",{staticClass:"multiple-coupon__coupon-list__item__info__coupon-type"},[t._v("\n              消费立减\n            ")]),s("div",{staticClass:"multiple-coupon__coupon-list__item__info__price"},[s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__discount product-price-minus--to-some-coupon"},[t._v("减至")]),s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__symbol"},[t._v("¥")]),s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__discount product-price-minus--to-some-coupon__price"},[t._v(t._s(e.discountPrice))])])]):t._e(),"totalPriceMinusSomeCoupon"===e.couponType?s("div",{staticClass:"multiple-coupon__coupon-list__item__info__commodity-type"},[t._v("\n            全品类商品\n          ")]):s("div",{staticClass:"multiple-coupon__coupon-list__item__info__commodity-type"},[t._v("\n            "+t._s(e.couponName)+"\n          ")])]),s("div",{staticClass:"multiple-coupon__coupon-list__item__status"},[t.isActivityBegin?s("span",[t._v("即将开始")]):t.isActivityEnd?s("span",[t._v("活动结束")]):e.noRemaining?s("span",[t._v("已领完")]):e.hasPicked?s("span",[t._v("已领取")]):e.hasPicked?t._e():s("span",[t._v("立即领取")])])])])}),0)])},Do=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"multiple-coupon__coupon-list__item__info__price"},[s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__discount product-price-minus-to-free-coupon"},[t._v("兑换")])])}],ko={props:["activityDetail"],computed:{couponList:function(){return this.activityDetail.couponList.map(function(t){t.noRemaining=t.couponRemain<=0&&t.sendUpperLimit>0,t.couponType=ei.getType(t)}),this.activityDetail.couponList},pickCouponActivity:function(){return this.activityDetail.pickCouponActivity},isActivityBegin:function(){var t=Date.parse(new Date);return t<this.pickCouponActivity.beginTime},isActivityEnd:function(){var t=Date.parse(new Date);return t>this.pickCouponActivity.endTime},couponShowOffset:function(){var t=window.screen.width,e=this.pickCouponActivity.couponShowOffset,s=375;return e*t/s}},methods:{pickCoupon:function(t){var e=Date.parse(new Date);e>=this.pickCouponActivity.beginTime&&e<=this.pickCouponActivity.endTime&&!t.noRemaining&&!t.hasPicked&&this.$emit("pickCoupon",t.couponId)}}},xo=ko,To=(s("6fe8"),Object(p["a"])(xo,So,Do,!1,null,"b295058e",null)),Io=To.exports,Ao={data:function(){return{activityDetail:null}},components:{GotoHome:yt,SingleCouponActivity:wo,MultipleCouponActivity:Io},created:function(){this.fetchPickCouponDetail()},methods:{fetchPickCouponDetail:function(){var t=this;$t.show();var e=this.$route.params.pickCouponActivityId;mt.coupon.fetchPickCouponDetail({pickCouponActivityId:e}).then(function(e){t.activityDetail=e.data;var s=t.activityDetail.pickCouponActivity,i=_t.getRegionBlockCode();i!==s.regionBlockCode&&t.showRegionDiffModal(s.regionBlockCode),wx.miniProgram.postMessage({data:{shareTitle:s.title}})}).finally(function(){return $t.hide()})},showRegionDiffModal:function(t){var e=oe.getCurrentRegionName(t),s=null===_t.getUserInfo();s?Me.alert({title:"友情提示",msg:"你当前查阅内容，可能受区域限制有所不同"}):Me.alert({title:"友情提示",msg:"你所在区域无法参与，当前内容仅限".concat(e)})},pickCoupon:function(t){var e=this,s=this.$route.params.pickCouponActivityId,i=null===_t.getUserInfo();i?wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=pickCouponActivity&pickCouponActivityId=".concat(s,"&sourceType=internal")}):mt.coupon.pickCouponActivity({pickCouponActivityId:s,couponId:t}).then(function(t){mt.coupon.fetchPickCouponDetail({pickCouponActivityId:s}).then(function(t){e.activityDetail=t.data})}).catch(function(t){console.log(t)})}}},No=Ao,Po=(s("f9cc"),Object(p["a"])(No,ho,go,!1,null,"95f21ea8",null)),Lo=Po.exports,Mo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shops&&t.oftenShops?s("div",{staticClass:"coupon-available-shop-list"},[s("div",{staticClass:"coupon-available-shop-list__search-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchShop,expression:"searchShop"}],staticClass:"coupon-available-shop-list__search-container__search-bar",attrs:{placeholder:"输入门店名称"},domProps:{value:t.searchShop},on:{input:function(e){e.target.composing||(t.searchShop=e.target.value)}}})]),s("div",{ref:"currentShop",staticClass:"coupon-available-shop-list__current-shop"},[t._m(0),s("div",{staticClass:"coupon-available-shop-list__current-shop__item"},[s("div",{staticClass:"coupon-available-shop-list__current-shop__item__icon-location"}),t.currentAddress?s("div",{staticClass:"coupon-available-shop-list__current-shop__item__current-address"},[t._v(t._s(t.currentAddress))]):t._e(),s("div",{staticClass:"coupon-available-shop-list__current-shop__item__refresh-location",on:{click:t.setCurrentAddress}},[t._v("重新定位")])]),s("div",{staticClass:"coupon-available-shop-list__whitespace"}),t.oftenShops.length>0?[t._m(1),t._l(t.oftenShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e(),s("div",{staticClass:"coupon-available-shop-list__whitespace"}),t._m(2),t.shops.length>0?t._l(t.nearbyShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})}):t._e()],2)]):t._e()},Eo=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-available-shop-list__current-shop__title-row"},[s("span",{staticClass:"coupon-available-shop-list__current-shop__title-row__title"},[t._v("当前定位")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-available-shop-list__my-shops__title-row"},[s("span",{staticClass:"coupon-available-shop-list__my-shops__title-row__title"},[t._v("常去门店")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-available-shop-list__nearby-shops__title-row"},[s("span",{staticClass:"coupon-available-shop-list__nearby-shops__title-row__title"},[t._v("附近门店")])])}],$o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-item"},[s("div",{staticClass:"shop-item__info"},[s("div",{staticClass:"shop-item__basic-info"},[s("div",{staticClass:"shop-item__shop-name"},[s("span",[t._v(t._s(t.shop.shopName))]),""!==t.shop.businessTime?s("format-business-time",{attrs:{businessTime:t.shop.businessTime}}):t._e()],1),s("div",{staticClass:"shop-item__shop-address"},[t._v(t._s(t.shop.address))])]),t.shop.distance?s("div",{staticClass:"shop-item__map-info"},[s("div",{staticClass:"shop-item__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.shop.distance)))]),s("div",{staticClass:"shop-item__show-in-map",on:{click:t.openMap}},[t._v("地图 >")])]):t._e()])])},Oo=[],Ro={props:{shop:Object},components:{FormatBusinessTime:ue},methods:{openMap:function(){wx.openLocation({latitude:this.shop.latitude,longitude:this.shop.longitude,name:this.shop.shopName,address:this.shop.address})}},filters:{toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},Fo=Ro,Bo=(s("9ba9"),Object(p["a"])(Fo,$o,Oo,!1,null,"fe2b9fbc",null)),Uo=Bo.exports,jo={components:{ShopItem:Uo},data:function(){return{shops:null,oftenShops:null,currentAddress:null,nearbyShopsLength:10,searchShop:null,currentLocation:null}},created:function(){this.fetchOrderShopList(),this.fetchOftenShoplist()},mounted:function(){var t=this;He.init().then(function(){t.setCurrentAddress()})},updated:function(){this.$refs.currentShop.addEventListener("scroll",this.handleScroll)},computed:{sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=Xt()({},e);return s.distance=ie(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops},filterShops:function(){var t=this;return this.searchShop?this.sortedShopsWithDistance.filter(function(e){return e.shopName.includes(t.searchShop)}):this.sortedShopsWithDistance},currentShop:function(){return this.sortedShopsWithDistance[0]},myShops:function(){return this.sortedShopsWithDistance.slice(1,3)},nearbyShops:function(){return this.filterShops.slice(0,this.nearbyShopsLength)}},methods:{handleScroll:ee.a.debounce(function(){var t=this.$refs.currentShop.scrollTop,e=this.$refs.currentShop.clientHeight,s=this.$refs.currentShop.scrollHeight,i=s<=e+t;i&&(this.nearbyShopsLength+=6)},150),fetchOrderShopList:function(){var t=this.$route.params.shopUseFlg,e=this.$route.params.shopList,s=_t.getRegionBlockCode(),i=0===t;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](s);this.shops=n?this.$store.getters["shop/shopsForRegion"](s):[]}else{var a=this.$store.state.shop.shops[s];this.shops=ee.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},fetchOftenShoplist:function(){var t=this;$t.show();var e=_t.getRegionBlockCode();mt.shop.fetchOftenShoplist({regionBlockCode:e}).then(function(e){t.oftenShops=e.data.data.slice(0,2)}).finally(function(){return $t.hide()})},setCurrentAddress:function(){var t=this;this.currentAddress=null,ut.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i},He.getAddressByLatLng(s,i).then(function(e){t.currentAddress=e.address})})}}},Ho=jo,zo=(s("95a5"),Object(p["a"])(Ho,Mo,Eo,!1,null,"eaf579f4",null)),Wo=zo.exports,Go=[{path:"/user-coupon-detail/:couponId/:userCouponId",name:"user-coupon-detail",component:qi,meta:{title:"优惠券详情"}},{path:"/coupon-detail/:couponId",name:"coupon-detail",component:Wn,meta:{title:"优惠券详情"}},{path:"/pick-coupon-list",name:"pick-coupon-list",component:Pa,meta:{title:"领券中心"}},{path:"/new-shops-coupon",name:"new-shops-coupon",component:mo,meta:{title:"新店优惠券"}},{path:"/pick-coupon-activity-detail/:pickCouponActivityId",name:"pick-coupon-activity-detail",component:Lo,meta:{title:"领券活动详情页"}},{path:"/coupon-available-shop-list",name:"coupon-available-shop-list",component:Wo,meta:{title:"优惠券适用门店"}}],Vo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-list"},[null===t.campaignList?s("div",{staticClass:"campaign-list__loading"},[s("div",{staticClass:"campaign-list__loading__skeleton-screen"})]):s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchCampaignList}},[0===t.campaignList.length?s("div",{staticClass:"campaign-list__error"},[s("div",{staticClass:"campaign-list__error__image"}),s("div",{staticClass:"campaign-list__error__no-data"},[t._v("暂无集点活动")])]):s("div",{staticClass:"campaign-list__success"},[t.canShowTitleTip?s("div",{class:["campaign-list__title-tip",{"close-title-tip-title":t.isCloseTitleTip}]},[s("div",{staticClass:"campaign-list__title-tip__image"}),s("div",{staticClass:"campaign-list__title-tip__text-wrapper"},[t.canTransferCampaignToFriend?s("div",{staticClass:"campaign-list__title-tip__text"},[t._v("你可通过转赠集点与朋友共同达成目标")]):s("div",{staticClass:"campaign-list__title-tip__text"},[t._v("您有 "+t._s(t.aboutToReachQuatity)+" 项集点即将达成目标，加油！！")]),s("div",{staticClass:"campaign-list__title-tip__close-wrapper",on:{click:t.closeTitleTip}},[s("div",{staticClass:"campaign-list__title-tip__close"})])])]):t._e(),s("div",{class:["campaign-list__list-body",{"close-title-tip-body":t.isCloseTitleTip}]},t._l(t.campaignList,function(t){return s("campaign-list-view-item",{key:t.campaignId,attrs:{campaign:t}})}),1)])]),s("div",{staticClass:"campaign-list__list-foot"},[s("goto-home")],1)],1)},qo=[],Yo=864e5;function Qo(t){var e=(new Date).getTime(),s=e>t.campaignDateFrom&&e<t.campaignDateTo;return s}function Ko(t){var e=Ts()(t.campaignDateFrom/Yo),s=Ts()((new Date).getTime()/Yo);return!ec(t)&&Ts()((e+4)/7)==Ts()((s+4)/7)&&t.campaignDateFrom>(new Date).getTime()}function Xo(t){var e=(new Date).getTime();return e<t.campaignDateFrom&&!Ko(t)&&t.campaignDateFrom-e<5*Yo&&t.campaignDateFrom-e>0}function Zo(t){var e=(new Date).getTime();return e<t.campaignDateFrom&&t.campaignDateFrom-e>5*Yo}function Jo(t){var e=t.userTotalStampNum%t.stampNeeded;return Qo(t)&&e/t.stampNeeded>=.7}function tc(t){var e=(new Date).getTime();return e<t.openEndDt&&t.userTotalStampNum/t.stampNeeded>=1}function ec(t){var e=(new Date).getTime();return e>t.campaignDateTo&&t.userTotalStampNum/t.stampNeeded<1||e>t.openEndDt}function sc(t){return 0===t.giftNums}function ic(t){var e=(new Date).getTime();return t.userTotalStampNum/t.stampNeeded>=.7&&t.userTotalStampNum/t.stampNeeded<1&&t.campaignDateTo-e<5*Yo&&t.giftNums>0}function nc(t){var e=(new Date).getTime();return e>t.campaignDateTo&&e<t.openEndDt&&t.userTotalStampNum/t.stampNeeded>=1&&t.giftNums>0}var ac={isAlreadyReached:function(t){return tc(t)},isAboutToReach:function(t){return Jo(t)},canTransferCampaignToFriend:function(t){return!ec(t)&&(t.openEndDt-(new Date).getTime())/Yo<7&&t.userTotalStampNum/t.stampNeeded>=.5},getStatus:function(t){if(sc(t))return"已结束";if(ic(t)||nc(t)){var e=(t.campaignDateTo-(new Date).getTime())/Yo;return e>=0?"进行中 ".concat(Ts()(e,0),"天后结束"):"活动截止"}if(Jo(t)){var s=(t.campaignDateTo-(new Date).getTime())/Yo;return"进行中 ".concat(Ts()(s,0),"天后结束")}if(tc(t)){var i=(t.campaignDateTo-(new Date).getTime())/Yo;return i>=0?"进行中 ".concat(Ts()(i,0),"天后结束"):"已结束"}if(Ko(t)){var n=new Date(t.campaignDateFrom),a=n.getMonth()+1,o=n.getDate()>=10?n.getDate():"0".concat(n.getDate());return"".concat(a,"月").concat(o,"日开始")}if(Xo(t)){var c=new Date(t.campaignDateFrom),r=c.getMonth()+1,d=c.getDate()>=10?c.getDate():"0".concat(c.getDate());return"".concat(r,"月").concat(d,"日开始")}if(Zo(t)){var p=new Date(t.campaignDateFrom),l=p.getMonth()+1,u=p.getDate()>=10?p.getDate():"0".concat(p.getDate());return"".concat(l,"月").concat(u,"日开始")}if(Qo(t)){var _=(t.campaignDateTo-(new Date).getTime())/Yo;return"进行中 ".concat(Ts()(_,0),"天后结束")}if(ec(t)){var m=new Date(t.campaignDateTo),h=m.getMonth()+1,g=m.getDate()>=10?m.getDate():"0".concat(m.getDate());return"".concat(h,"月").concat(g,"日结束")}},getCampaignStatus:function(t){if(sc(t))return{campaignStatus:"outOfDate",campaignStatusText:"已结束"};if(ic(t))return{campaignStatus:"almostOutOfDate",campaignStatusText:"即将过期"};if(nc(t))return{campaignStatus:"almostOutOfDateAndReached",campaignStatusText:"即将过期"};if(tc(t))return{campaignStatus:"reached",campaignStatusText:"可兑换"};if(Jo(t))return{campaignStatus:"aboutToReach",campaignStatusText:"即将达成"};if(Ko(t)){var e=new Date(t.campaignDateFrom),s=e.getDay(),i=e.getHours()>=10?e.getHours():"0".concat(e.getHours()),n=e.getMinutes()>=10?e.getMinutes():"0".concat(e.getMinutes());switch(s){case 1:return{campaignStatus:"aboutToStart",campaignStatusText:"本周一 ".concat(i,":").concat(n,"开始")};case 2:return{campaignStatus:"aboutToStart",campaignStatusText:"本周二 ".concat(i,":").concat(n,"开始")};case 3:return{campaignStatus:"aboutToStart",campaignStatusText:"本周三 ".concat(i,":").concat(n,"开始")};case 4:return{campaignStatus:"aboutToStart",campaignStatusText:"本周四 ".concat(i,":").concat(n,"开始")};case 5:return{campaignStatus:"aboutToStart",campaignStatusText:"本周五 ".concat(i,":").concat(n,"开始")};case 6:return{campaignStatus:"aboutToStart",campaignStatusText:"本周六 ".concat(i,":").concat(n,"开始")};case 0:return{campaignStatus:"aboutToStart",campaignStatusText:"本周日 ".concat(i,":").concat(n,"开始")}}}else{if(Xo(t)){var a=new Date(t.campaignDateFrom),o=new Date,c=a.getHours()>=10?a.getHours():"0".concat(a.getHours()),r=a.getMinutes()>=10?a.getMinutes():"0".concat(a.getMinutes()),d=(a.getTime()-o.getTime())/Yo;return{campaignStatus:"aboutToStart",campaignStatusText:"".concat(Ts()(d),"天后 ").concat(c,":").concat(r,"开始")}}if(Zo(t)){var p=new Date(t.campaignDateFrom),l=p.getMonth()+1>=10?p.getMonth()+1:"0".concat(p.getMonth()+1),u=p.getDate()>=10?p.getDate():"0".concat(p.getDate()),_=p.getHours()>=10?p.getHours():"0".concat(p.getHours()),m=p.getMinutes()>=10?p.getMinutes():"0".concat(p.getMinutes());return{campaignStatus:"aboutToStart",campaignStatusText:"".concat(l,"月").concat(u,"日 ").concat(_,":").concat(m,"开始")}}if(Qo(t))return{campaignStatus:"onGoing",campaignStatusText:"进行中"};if(ec(t))return{campaignStatus:"outOfDate",campaignStatusText:"已结束"}}}},oc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-list-view-item",on:{click:t.gotoDetail}},[s("div",{staticClass:"campaign-list-view-item__top"},[s("img",{staticClass:"campaign-list-view-item__top__image",attrs:{src:t.campaign.image}}),s("div",{class:["campaign-list-view-item__top__image-mask",{"out-of-date":"outOfDate"===t.campaign.campaignStatus,reached:"reached"===t.campaign.campaignStatus||"almostOutOfDateAndReached"===t.campaign.campaignStatus}]}),s("div",{staticClass:"campaign-list-view-item__top__status-region-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-wrapper"},["aboutToStart"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-about-to-start-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-about-to-start"},[t._v(t._s(t.campaign.campaignStatusText))])]):"onGoing"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-on-going-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-on-going"},[t._v(t._s(t.campaign.campaignStatusText))]),s("div",{staticClass:"campaign-list-view-item__top__campaign-count"},[t._v(t._s(t.campaign.surplusCount)+"/"+t._s(t.campaign.needCount))])]):"aboutToReach"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-about-to-end-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-about-to-end"},[t._v(t._s(t.campaign.campaignStatusText))]),s("div",{staticClass:"campaign-list-view-item__top__campaign-count"},[t._v(t._s(t.campaign.surplusCount)+"/"+t._s(t.campaign.needCount))])]):"almostOutOfDate"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-almost-out-of-date-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-almost-out-of-date"},[t._v(t._s(t.campaign.campaignStatusText))]),s("div",{staticClass:"campaign-list-view-item__top__campaign-count"},[t._v(t._s(t.campaign.surplusCount)+"/"+t._s(t.campaign.needCount))])]):"almostOutOfDateAndReached"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-almost-out-of-date-and-reached-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-almost-out-of-date-and-reached"},[t._v(t._s(t.campaign.campaignStatusText))]),s("div",{staticClass:"campaign-list-view-item__top__campaign-count"},[t._v(t._s(t.campaign.surplusCount)+"/"+t._s(t.campaign.needCount))])]):"reached"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-reached-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-reached"},[t._v(t._s(t.campaign.campaignStatusText))]),s("div",{staticClass:"campaign-list-view-item__top__campaign-count"},[t._v(t._s(t.campaign.surplusCount)+"/"+t._s(t.campaign.needCount))])]):"outOfDate"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-out-of-date-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-out-of-date"},[t._v(t._s(t.campaign.campaignStatusText))])]):t._e()]),s("div",{staticClass:"campaign-list-view-item__top__region-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__region-wrapper__region-icon"}),s("div",{staticClass:"campaign-list-view-item__top__region-wrapper__region-text"},[t._v(t._s(t.campaign.region))])])])]),s("div",{staticClass:"campaign-list-view-item__bottom"},[s("div",{staticClass:"campaign-list-view-item__bottom__name"},[t._v(t._s(t.campaign.name))]),s("div",{staticClass:"campaign-list-view-item__bottom__point-count-main-wrapper"},[s("div",{staticClass:"campaign-list-view-item__bottom__point-date-wrapper"},[s("div",{staticClass:"campaign-list-view-item__bottom__point-date-wrapper__date-icon"}),s("div",{staticClass:"campaign-list-view-item__bottom__point-date-wrapper__date-text"},[t._v(t._s(t.campaign.status))])]),t.campaign.onlookerCount>10?s("div",{staticClass:"campaign-list-view-item__bottom__onlooker-quatity"},[t._v(t._s(t.campaign.onlookerCount)+"人围观")]):t._e()])])])},cc=[],rc={props:{campaign:Object},methods:{gotoDetail:function(){var t=this.campaign.campaignId;this.$router.push({path:"/campaign-detail/".concat(t)})}}},dc=rc,pc=(s("dfe4"),Object(p["a"])(dc,oc,cc,!1,null,"5fa81464",null)),lc=pc.exports,uc={components:{GotoHome:yt,PullDownRefresh:zt,CampaignListViewItem:lc},data:function(){return{campaignList:null,isRefreshing:!1,isCloseTitleTip:!1,canShowTitleTip:!1,aboutToReachQuatity:0,canTransferCampaignToFriend:!1}},created:function(){this.fetchCampaignList()},methods:{parseRegionBlockCode:function(t){switch(t){case"sh-lawson":return"江浙沪";case"bj-lawson":return"京津冀";case"ah-lawson":return"安徽";case"dl-lawson":return"大连";case"wh-lawson":return"武汉";case"cq-lawson":return"重庆";default:return""}},closeTitleTip:function(){this.isCloseTitleTip=!0},fetchCampaignList:function(){var t=this;this.isRefreshing=!0;var e=_t.getRegionBlockCode();mt.campaign.fetchCampaignList({regionBlockCode:e}).then(function(s){t.campaignList=s.map(function(s,i){var n=ac.getCampaignStatus(s),a=n.campaignStatus,o=n.campaignStatusText,c=ac.isAboutToReach(s);c&&(t.aboutToReachQuatity+=1);var r=ac.canTransferCampaignToFriend(s);r&&(t.canTransferCampaignToFriend=r);var d=s.campaignName,p=s.imagePathList,l=ac.getStatus(s),u=t.parseRegionBlockCode(e),_=s.stampNeeded,m=s.campaignId,h=s.userTotalStampNum%s.stampNeeded,g=s.onlookerCount;return{name:d,image:p,status:l,region:u,needCount:_,campaignId:m,surplusCount:h,onlookerCount:g,campaignStatus:a,campaignStatusText:o}}),t.canShowTitleTip=t.aboutToReachQuatity>0,t.isRefreshing=!1}).catch(function(e){t.campaignList=[],t.isRefreshing=!1})}}},_c=uc,mc=(s("2861"),Object(p["a"])(_c,Vo,qo,!1,null,"61f4785e",null)),hc=mc.exports,gc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!=t.campaignDetail?s("div",{staticClass:"campaign-detail",class:{"no-scroll":"show"===t.isShowCampaignExchangeCouponSuccessModal||"show"===t.isShowCampaignExchangeNotWinningModal}},[s("div",{staticClass:"campaign-detail__banner-region"},[s("img",{staticClass:"campaign-detail__banner-region__img",attrs:{src:t.campaignDetail.imagePathDetail}}),s("div",{staticClass:"campaign-detail__banner-region__sub"},[t.barrageList?s("swiper",{attrs:{options:t.swiperOption}},t._l(t.barrageList,function(e,i){return s("swiper-slide",{key:i},[i%2?s("p",{staticClass:"campaign-detail__banner-region__sub__odd"}):s("p",{staticClass:"campaign-detail__banner-region__sub__even"},[s("img",{staticClass:"campaign-detail__banner-region__sub__profile",attrs:{src:e.userPhoto||t.defaultAvatar}}),s("span",{staticClass:"campaign-detail__banner-region__sub__name"},[t._v(t._s(e.nickName))]),s("span",{staticClass:"campaign-detail__banner-region__sub__tweets"},[t._v("刚刚获得了"+t._s(e.giftName))])])])}),1):t._e()],1)]),s("div",{staticClass:"campaign-detail__title-region"},[s("div",{staticClass:"campaign-detail__title-region__name-region"},[s("p",{staticClass:"campaign-detail__title-region__name-region__name"},[t._v(t._s(t.campaignDetail.campaignName))]),t.isCampaignStart?s("p"):t.isLessThanFivedays?s("p",{staticClass:"campaign-detail__title-region__name-region__end"},[s("span",[t._v(t._s(t._f("formatLessFiveDay")(t.campaignDetail.openEndDt)))])]):t.isThisWeed?s("p",{staticClass:"campaign-detail__title-region__name-region__end"},[s("span",[t._v(t._s(t._f("formatThisWeekDate")(t.campaignDetail.campaignDateFrom)))])]):t.isNotThisWeed?s("p",{staticClass:"campaign-detail__title-region__name-region__end"},[s("span",[t._v(t._s(t._f("formatNotThisWeekDate")(t.campaignDetail.campaignDateFrom)))])]):t._e()]),s("div",{staticClass:"campaign-detail__title-region__description"},[s("p",[s("span",[t._v("已兑换:")]),s("span",[t._v(t._s(t.campaignDetail.totalExchangedQty))])]),s("p",[s("span",[t._v("库存:")]),s("span",[t._v(t._s(t.campaignDetail.giftNums))])]),t.campaignDetail.onlookerCount>10&&t.campaignDetail.onlookerCount<1e4?s("div",{staticClass:"campaign-detail__title-region__description__profiles"},[t._m(0),s("div",{staticClass:"campaign-detail__title-region__description__concerns"},[t._v(t._s(t.campaignDetail.onlookerCount)+"人围观过")])]):t.campaignDetail.onlookerCount>=1e4?s("div",{staticClass:"campaign-detail__title-region__description__profiles"},[t._m(1),s("div",{staticClass:"campaign-detail__title-region__description__concerns"},[t._v(t._s(t._f("formatOnLookCount")(t.campaignDetail.onlookerCount))+"万人围观过")])]):t._e()])]),s("div",{staticClass:"campaign-detail__campaign-region"},[s("div",{staticClass:"campaign-detail__campaign-region__title"},[s("div",{staticClass:"campaign-detail__campaign-region__title__impress"},[t._v("集点印章 "+t._s(t.currentCompaign)+"/"+t._s(t.campaignDetail.stampNeeded))]),s("div",{staticClass:"campaign-detail__campaign-region__title__completed"},[t._v("\n        已达成\n        "),s("span",[t._v(t._s(t.completeRounds))]),t._v("轮\n      ")])]),s("div",{staticClass:"campaign-detail__campaign-region__rounds"},[s("campaign-detail-list",{attrs:{userStampList:t.campaignDetail.userStampList,participateRound:t.campaignDetail.participateRound,totalCampaignNum:t.campaignDetail.totalCampaignNum,iconNotOver:t.campaignDetail.iconNotOver,iconOver:t.campaignDetail.iconOver,stampNeeded:t.campaignDetail.stampNeeded}})],1),s("campaign-detail-expressed-and-address",{attrs:{userStampList:t.campaignDetail.userStampList,myExchangedQty:t.campaignDetail.myExchangedQty}})],1),s("div",{staticClass:"campaign-detail__appointment-time-limit-region"},[t._m(2),s("div",{staticClass:"campaign-detail__appointment-time-limit-region__title__timeline-bar"},[s("timeline-bar",{attrs:{startDate:t.campaignDetail.campaignDateFrom,endDate:t.campaignDetail.campaignDateTo}})],1)]),t.sortedShopsWithDistance[0]?s("div",{staticClass:"campaign-detail__shop-region"},[s("div",{staticClass:"campaign-detail__shop-region__title",on:{click:t.goToCampaignAvailableShopList}},[s("div",{staticClass:"campaign-detail__shop-region__title__apply-shop"},[t._v("适用门店")]),s("div",{staticClass:"campaign-detail__shop-region__title__all-shop"},[t._v("查看全部("+t._s(t.shopNum)+")")])]),s("div",{staticClass:"campaign-detail__shop-region__shop-name"},[s("p",[t._v(t._s(t.sortedShopsWithDistance[0].shopName)+"\n        "),""!==t.sortedShopsWithDistance[0].businessTime?s("format-business-time",{attrs:{businessTime:t.sortedShopsWithDistance[0].businessTime}}):t._e()],1),t.sortedShopsWithDistance[0].distance?s("p",{staticClass:"campaign-detail__shop-region__shop-distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.sortedShopsWithDistance[0].distance)))]):t._e()]),s("div",{staticClass:"campaign-detail__shop-region__shop-address"},[s("p",[t._v(t._s(t.sortedShopsWithDistance[0].address))])])]):t._e(),t.campaignDetail.commodityList.length?s("div",{staticClass:"campaign-detail__commodity-region"},[s("div",{staticClass:"campaign-detail__commodity-region__title"},[s("div",{staticClass:"campaign-detail__commodity-region__title__apply-commodity"},[t._v("活动商品")]),s("div",{staticClass:"campaign-detail__commodity-region__title__all-commoditys",on:{click:t.goToCampaignProducts}},[t._v("查看全部("+t._s(t.campaignDetail.commodityList.length)+")")])]),s("div",{staticClass:"campaign-detail__commodity-region__commodity-img"},[s("apply-commodity",{attrs:{campaignProducts:t.campaignDetail.commodityList}})],1)]):t._e(),s("div",{staticClass:"campaign-detail__explain-region"},[t._m(3),s("div",{staticClass:"campaign-detail__explain-region__describe"},[s("div",[t._v("兑换时间："+t._s(t._f("formatDate")(t.campaignDetail.campaignDateFrom))+"-"+t._s(t._f("formatDate")(t.campaignDetail.openEndDt)))]),s("hr"),s("p",{domProps:{innerHTML:t._s(t.campaignDetail.description)}})])]),s("campaign-exchangeAnd-transfer-button",{attrs:{isTransfer:t.isTransfer,isExchange:t.isExchange,campaignId:this.campaignDetail.campaignId,totalCampaignNum:this.campaignDetail.totalCampaignNum,image:this.campaignDetail.imagePathDetail||this.campaignDetail.imagePathList,rewardType:this.campaignDetail.rewardType},on:{campaignnExchang:t.__campaignnExchang,isCampaignnTransferModal:t.campaignnTransferModal}}),"show"===t.isShowCampaignExchangeNotWinningModal?s("campaign-exchange-not-winning-modal",{on:{hideCampaignExchangeNotWinningModal:t.hideCampaignExchangeNotWinningModal}}):t._e(),"show"===t.isShowCampaignExchangeCouponSuccessModal?s("campaign-exchange-coupon-success-modal",{attrs:{campaignGift:t.campaignGift}}):t._e()],1):t._e()},vc=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}}),s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}}),s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}}),s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}}),s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-detail__appointment-time-limit-region__title"},[s("div",{staticClass:"campaign-detail__appointment-time-limit-region__title__activity-time"},[t._v("活动时间")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-detail__explain-region__title"},[s("div",{staticClass:"campaign-detail__explain-region__title__instructions"},[t._v("活动说明")])])}],fc=(s("f576"),s("6b54"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"timeline-bar"},[s("div",{staticClass:"timeline-bar__line"}),s("div",{class:["timeline-bar__start-date",{"is-middle":t.startDate>t.currentDate&&t.startDate<t.endDate,"is-hidden":t.startDate<=t.currentDate}]},[s("div",{staticClass:"timeline-bar__start-date__title"},[t._v("活动开始")]),s("div",{staticClass:"timeline-bar__start-date__circle-icon"}),s("div",{staticClass:"timeline-bar__start-date__date"},[t._v(t._s(t._f("date")(t.startDate)))])]),s("div",{class:["timeline-bar__end-date",{"is-left":t.endDate<=t.currentDate,"is-right":t.endDate>t.currentDate}]},[s("div",{staticClass:"timeline-bar__end-date__title"},[t._v("活动结束")]),s("div",{staticClass:"timeline-bar__end-date__circle-icon"}),s("div",{staticClass:"timeline-bar__end-date__date"},[t._v(t._s(t._f("date")(t.endDate)))])]),s("div",{class:["timeline-bar__current-date",{"is-left":t.currentDate<t.startDate,"is-right":t.currentDate>=t.endDate}]},[s("div",{staticClass:"timeline-bar__current-date__title"},[t._v("今天")]),s("div",{staticClass:"timeline-bar__current-date__circle-icon"}),s("div",{staticClass:"timeline-bar__current-date__date"},[t._v(t._s(t._f("date")(t.currentDate)))])])])}),Cc=[],yc={data:function(){return{currentDate:Jt()()}},props:["startDate","endDate"],filters:{date:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,"-").concat(n,"-").concat(a)}}},bc=yc,wc=(s("bd1e"),Object(p["a"])(bc,fc,Cc,!1,null,"7c1b05ae",null)),Sc=wc.exports,Dc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"commodity-main"},[s("ul",t._l(t.campaignProducts,function(t,e){return s("li",{key:e},[s("img",{attrs:{src:t.imageUrl}})])}),0)])},kc=[],xc={props:["campaignProducts"]},Tc=xc,Ic=(s("4114"),Object(p["a"])(Tc,Dc,kc,!1,null,"a05c31da",null)),Ac=Ic.exports,Nc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isSendAddressShow?s("div",{staticClass:"express-address",on:{click:t.goToCampaignSendAddress}},[s("div",{staticClass:"express-address__name"},[t._v("寄送地址("+t._s(t.sendAddressNum)+")")]),s("div",{staticClass:"express-address__set-address"},[t.notSendAddressNum?s("span",[t._v("有"+t._s(t.notSendAddressNum)+"未设置地址")]):t._e(),s("span",{staticClass:"express-address__set-address__right-arrow"})])]):t.myExchangedQty?s("div",{staticClass:"express-address",on:{click:t.goToCampaignPostExchanged}},[s("div",{staticClass:"express-address__name"},[t._v("已兑换："+t._s(t.myExchangedQty))]),t._m(0)]):t.isShowExchangedAndExchangedAdress?s("div",{staticClass:"express-exchanged-and-address"},[s("div",{staticClass:"express-exchanged-and-address__warpper",on:{click:t.goToCampaignSendAddress}},[s("div",{staticClass:"express-address__name"},[t._v("寄送地址("+t._s(t.sendAddressNum)+")")]),s("div",{staticClass:"express-address__set-address"},[s("span",[t._v("有"+t._s(t.notSendAddressNum)+"未设置地址")]),s("span",{staticClass:"express-address__set-address__right-arrow"})])]),s("div",{staticClass:"express-exchanged-and-address__warpper",on:{click:t.goToCampaignPostExchanged}},[s("div",{staticClass:"express-exchanged-and-address__name"},[t._v("已兑换："+t._s(t.myExchangedQty))]),t._m(1)])]):t._e()])},Pc=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"express-address__set-address"},[s("span",{staticClass:"express-address__set-address__right-arrow"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"express-exchanged-and-address__set-address"},[s("span",{staticClass:"express-exchanged-and-address__set-address__right-arrow"})])}],Lc={props:["userStampList","myExchangedQty"],computed:{notSendAddressNum:function(){var t=this.userStampList;return t.filter(function(t){return 2===t.saveAddressFlg&&2===t.giftType}).length},sendAddressNum:function(){var t=this.userStampList;return t.filter(function(t){return 2===t.giftType}).length},isSendAddressShow:function(){var t=this.userStampList;return t.filter(function(t){return 2===t.status&&2===t.giftType}).length},isShowExchangedAndExchangedAdress:function(){var t=ee.a.find(this.userStampList,{giftType:1}),e=ee.a.find(this.userStampList,{giftType:2});return t&&e}},methods:{goToCampaignSendAddress:function(){var t=_t.getUserInfo(),e=this.$route.params.campaignId;t?this.$router.push({path:"/campaign-send-address/".concat(e)}):wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=campaignDetail&commodityId=".concat(e,"&sourceType=internal")})},goToCampaignPostExchanged:function(){var t=_t.getUserInfo(),e=this.$route.params.campaignId;if(t){var s=this.userStampList;this.$router.push({name:"campaign-post-exchanged",params:{userStampList:s}})}else wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=campaignDetail&commodityId=".concat(e,"&sourceType=internal")})}}},Mc=Lc,Ec=(s("6fb7"),Object(p["a"])(Mc,Nc,Pc,!1,null,"0e5a03c2",null)),$c=Ec.exports,Oc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null===t.participateRound?s("ul",{staticClass:"campaign-list"},t._l(t.stampNeeded,function(e){return s("li",{key:e},[t.userStampList.length<=1?s("div",[t.stampNeeded===t.totalCampaignNum?s("img",{attrs:{src:t.iconNotOver||t.defaultIconNotOver}}):e-1<t.totalCampaignNum&&e!==t.stampNeeded?s("img",{attrs:{src:t.iconOver||t.defaultIconOver}}):e>t.totalCampaignNum&&e!==t.stampNeeded?s("img",{attrs:{src:t.iconNotOver||t.defaultIconNotOver}}):s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-not-last-campaign.png"}}),t.stampNeeded===t.totalCampaignNum?s("p",{staticClass:"campaign-list__not-campaign"},[t._v(t._s(t.__campaignNum(e)))]):t.totalCampaignNum%t.stampNeeded>0&&e<=t.totalCampaignNum%t.stampNeeded?s("p",{staticClass:"campaign-list__campaign"},[t._v(t._s(e))]):s("p",{staticClass:"campaign-list__not-campaign"},[t._v(t._s(e))])]):t.userStampList.length>1?s("div",[t.totalCampaignNum%t.stampNeeded===0?s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-not-last-campaign.png"}}):t.totalCampaignNum%t.stampNeeded>0&&e-1<t.totalCampaignNum%t.stampNeeded?s("img",{attrs:{src:t.iconOver||t.defaultIconOver}}):e<t.stampNeeded?s("img",{attrs:{src:t.iconNotOver||t.defaultIconNotOver}}):s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-not-last-campaign.png"}}),t.totalCampaignNum%t.stampNeeded===0?s("p",{staticClass:"campaign-list__not-campaign"},[t._v(t._s(t.__campaignNum(e)))]):s("p",{staticClass:"campaign-list__campaigned"},[t._v(t._s(t.__campaignNum(e)))])]):t._e()])}),0):t.participateRound===t.userStampList.length?s("ul",{staticClass:"campaign-list"},t._l(t.stampNeeded,function(e){return s("li",{key:e},[s("div",[t.totalCampaignNum%t.stampNeeded===0&&t.lastIndex>t.__campaignNum(e)?s("img",{attrs:{src:t.iconOver||t.defaultIconOver}}):t.totalCampaignNum%t.stampNeeded!==0&&t.__campaignNum(e)<=t.totalCampaignNum?s("img",{attrs:{src:t.iconOver||t.defaultIconOver}}):t.totalCampaignNum%t.stampNeeded!==0&&t.__campaignNum(e)>t.totalCampaignNum&&t.__campaignNum(e)!==t.lastIndex?s("img",{attrs:{src:t.iconNotOver||t.defaultIconNotOver}}):t.totalCampaignNum%t.stampNeeded!==0&&t.__campaignNum(e)===t.lastIndex?s("img",{attrs:{src:t.campaignLastIconNotOver}}):t.totalCampaignNum%t.stampNeeded===0&&t.__campaignNum(e)===t.lastIndex?s("img",{staticClass:"3",attrs:{src:t.campaignLastIconOver}}):t._e(),t.totalCampaignNum%t.stampNeeded===0?s("p",{staticClass:"campaign-list__not-campaign"},[t._v(t._s(t.__campaignNum(e)))]):s("p",{staticClass:"campaign-list__campaigned"},[t._v(t._s(t.__campaignNum(e)))])])])}),0):s("ul",{staticClass:"campaign-list"},t._l(t.stampNeeded,function(e){return s("li",{key:e},[s("div",[t.totalCampaignNum%t.stampNeeded===0&&e>t.stampNeeded?s("img",{attrs:{src:t.campaignLastIconNotOver}}):t.totalCampaignNum%t.stampNeeded>0&&e-1<t.totalCampaignNum%t.stampNeeded?s("img",{attrs:{src:t.iconOver||t.defaultIconOver}}):e<t.stampNeeded?s("img",{attrs:{src:t.iconNotOver||t.defaultIconNotOver}}):s("img",{attrs:{src:t.campaignLastIconNotOver}}),t.totalCampaignNum%t.stampNeeded===0?s("p",{staticClass:"campaign-list__not-campaign"},[t._v(t._s(t.__campaignNum(e)))]):s("p",{staticClass:"campaign-list__campaigned"},[t._v(t._s(t.__campaignNum(e)))])])])}),0)},Rc=[],Fc={props:["userStampList","participateRound","totalCampaignNum","stampNeeded","iconNotOver","iconOver"],data:function(){return{defaultIconNotOver:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-not-campaign.png",defaultIconOver:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-campaigned.png",campaignLastIconNotOver:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-not-last-campaign.png",campaignLastIconOver:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-gift-bag.png"}},computed:{lastIndex:function(){return this.userStampList.length===this.participateRound?this.stampNeeded*this.userStampList.length:this.stampNeeded*this.userStampList.length+this.stampNeeded}},methods:{__campaignNum:function(t){return 0===this.userStampList.length?t:this.totalCampaignNum%this.stampNeeded>0?this.totalCampaignNum-this.totalCampaignNum%this.stampNeeded+t:this.userStampList.length<this.participateRound?this.stampNeeded*this.userStampList.length-this.stampNeeded+this.stampNeeded+t:this.userStampList.length==this.participateRound?this.stampNeeded*this.userStampList.length-this.stampNeeded+t:this.stampNeeded*this.userStampList.length-this.stampNeeded+this.stampNeeded+t}}},Bc=Fc,Uc=(s("00cb"),Object(p["a"])(Bc,Oc,Rc,!1,null,"0ee864b4",null)),jc=Uc.exports,Hc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"compaign-detail__button-region"},[s("div",[s("goto-home")],1),s("div",[!0===t.isTransfer?s("button",{staticClass:"compaign-detail__button-region__transfer",on:{click:t.goToCampaignTransferPage}},[t._v("转赠")]):s("button",{staticClass:"compaign-detail__button-region__no-transfer"},[t._v("转赠")]),!0===t.isExchange&&1===t.rewardType?s("button",{staticClass:"compaign-detail__button-region__exchange",on:{click:t.campaignnExchang}},[t._v("兑换")]):t.isExchange||1!==t.rewardType?!0===t.isExchange&&0===t.rewardType?s("button",{staticClass:"compaign-detail__button-region__exchange",on:{click:t.campaignnExchang}},[t._v("抽奖")]):!1===t.isExchange&&0===t.rewardType?s("button",{staticClass:"compaign-detail__button-region__no-exchange "},[t._v("抽奖")]):t._e():s("button",{staticClass:"compaign-detail__button-region__no-exchange"},[t._v("兑换")])])])},zc=[],Wc={props:["isTransfer","isExchange","campaignId","totalCampaignNum","rewardType"],data:function(){return{}},components:{GotoHome:yt},methods:{goToCampaignTransferPage:ee.a.debounce(function(){var t=this;wx.miniProgram.navigateTo({url:"/pages/campaign-transfer/campaign-transfer?campaignId=".concat(this.campaignId,"&stampNum=").concat(this.totalCampaignNum),success:function(){setTimeout(function(){t.$emit("isCampaignnTransferModal")},1e3)}})},1e3),campaignnExchang:function(){this.$emit("campaignnExchang")}}},Gc=Wc,Vc=(s("c168"),Object(p["a"])(Gc,Hc,zc,!1,null,"af5fc858",null)),qc=Vc.exports,Yc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store"},[s("div",{staticClass:"available-store__title",on:{click:t.goToShopList}},[t._m(0),t._m(1)]),t._m(2)])},Qc=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store__title__left"},[s("img",{staticClass:"available-store__title__left__image",attrs:{src:"https://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/h5/my-coupon/icon-shop.png"}}),s("span",{staticClass:"available-store__title__left__text"},[t._v("适用门店")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store__title__right"},[s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/right-arrow.png"}}),s("span",[t._v("查看全部(10)")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store__content"},[s("div",{staticClass:"available-store__content__title"},[s("div",{staticClass:"available-store__content__title__shop"},[s("span",{staticClass:"available-store__content__title__shop__name"},[t._v("大连一号店")]),s("span",{staticClass:"available-store__content__title__shop__time"},[t._v("24h")])]),s("div",{staticClass:"available-store__content__title__distance"},[t._v("\n        距您565m\n      ")])]),s("div",{staticClass:"available-store__content__address"},[t._v("\n      吴中区吴中大道1158号\n    ")])])}],Kc={methods:{goToShopList:function(){this.$router.push({path:"/ec-product-shop-list"})}}},Xc=Kc,Zc=(s("afa2"),Object(p["a"])(Xc,Yc,Qc,!1,null,"a79746ec",null)),Jc=Zc.exports,tr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-exchange__modal"},[s("div",{staticClass:"campaign-exchange__modal__wrapper"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__title"},[t._v("未中奖")]),s("div",{staticClass:"campaign-exchange__modal__wrapper__icon"}),s("div",{staticClass:"campaign-exchange__modal__wrapper__description-bottom"},[t._v("很遗憾！大奖与你擦肩而过,谢谢参与。")]),s("div",{staticClass:"campaign-exchange__modal__wrapper__button-wrapper"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__button-wrapper__confirm",on:{click:t.handleConfirm}},[t._v("我知道了")])])])])},er=[],sr={methods:{handleConfirm:function(){this.$emit("hideCampaignExchangeNotWinningModal")}}},ir=sr,nr=(s("3f41"),Object(p["a"])(ir,tr,er,!1,null,"63ac15af",null)),ar=nr.exports,or=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-exchange__modal"},[s("div",{staticClass:"campaign-exchange__modal__wrapper"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__title"},[t._v("兑换成功")]),s("div",{staticClass:"campaign-exchange__modal__wrapper__description-top"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__description-top__name-wrapper"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__description-top__name"},[t._v(t._s(t.campaignGift.giftName))]),s("div",{staticClass:"campaign-exchange__modal__wrapper__description-top__tip"},[t._v(t._s(t.couponType))])]),s("div",{staticClass:"campaign-exchange__modal__wrapper__description-top__condition"},[t._v("无使用门槛")])]),s("div",{staticClass:"campaign-exchange__modal__wrapper__description-bottom"},[t._v("您已成功兑换了"+t._s(t.campaignGift.giftName))]),s("div",{staticClass:"campaign-exchange__modal__wrapper__button-wrapper"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__button-wrapper__gotoHome",on:{click:t.gotoHomePage}},[t._v("返回首页")]),s("div",{staticClass:"campaign-exchange__modal__wrapper__button-wrapper__gotoCoupons",on:{click:t.gotoCouponDetail}},[t._v("查看")])])])])},cr=[],rr={getType:function(t){return 1===t.couponType?"couponcouponType:freeOnItem":2===t.couponType?"couponcouponType:discountOnReachingTotal":3===t.couponType?"couponType:discountOnItem":void 0}},dr={props:["campaignGift"],computed:{couponType:function(){return"couponcouponType:discountOnReachingTotal"===rr.getType(this.campaignGift)?"免费券":"couponcouponType:discountOnReachingTotal"===rr.getType(this.campaignGift)?"满减券":"couponcouponType:discountOnItem"===rr.getType(this.campaignGift)?"立减券":void 0}},methods:{gotoHomePage:function(){this.$emit("close"),wx.miniProgram.switchTab({url:"/pages/homepage/homepage"})},gotoCouponDetail:function(){var t=this.campaignGift.couponId,e=this.campaignGift.userCouponId;this.$router.push({path:"/user-coupon-detail/".concat(t,"/").concat(e)}),this.$emit("close")}}},pr=dr,lr=(s("bb23"),Object(p["a"])(pr,or,cr,!1,null,"392d8c73",null)),ur=lr.exports,_r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"modal"},[s("transition",{attrs:{name:"fade"}},[t.visible?s("div",[s("div",{staticClass:"modal__container"},[s("div",{staticClass:"modal__container__wrapper"},[s("svg",{staticClass:"modal__container__wrapper__icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-loading"}})]),s("div",{staticClass:"modal__container__wrapper__msg"},[t._v("提交中")])])])]):t._e()])],1)},mr=[],hr={data:function(){return{visible:!1}},mounted:function(){var t=this;window.addEventListener("popstate",function(e){t.visible=!1})}},gr=hr,vr=(s("b6c9"),Object(p["a"])(gr,_r,mr,!1,null,"3fe977a5",null)),fr=vr.exports,Cr=i["a"].extend(fr),yr=new Cr({el:document.createElement("div")});document.body.appendChild(yr.$el);var br={show:function(){yr.visible=!0},hide:function(){setTimeout(function(){yr.visible=!1},1e3)}};var wr={components:{swiper:Yn["swiper"],swiperSlide:Yn["swiperSlide"],TimelineBar:Sc,ApplyCommodity:Ac,CampaignExchangeAndTransferButton:qc,CampaignDetailList:jc,CampaignExchangeNotWinningModal:ar,CampaignExchangeCouponSuccessModal:ur,AvailableStore:Jc,FormatBusinessTime:ue,CampaignDetailExpressedAndAddress:$c},data:function(){return{campaignDetail:null,campaignProducts:null,campaignGift:null,currentLocation:null,barrageList:null,isShowCampaignExchangeCouponSuccessModal:"hide",isShowCampaignExchangeNotWinningModal:"hide",swiperOption:{direction:"vertical",initialSlide:1,zoom:!0,look:!0,loop:!0,autoplay:!0,autoHeight:!0,spaceBetween:20}}},created:function(){var t=Object(C["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=_t.getRegionBlockCode(),this.setCurrentLocation(),this.recordCampaignPopularStatistics(),t.next=5,this.__fetchCampaignDetail();case 5:e!==this.campaignDetail.regionBlockCode&&this.showRegionDiffModal(this.campaignDetail.regionBlockCode);case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),mounted:function(){this.fetchCampaignBarrage()},computed:{defaultAvatar:function(){return"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/default-man.png"},getShops:function(){var t=this.campaignDetail.shopUseFlg,e=this.campaignDetail.shopid,s=_t.getRegionBlockCode(),i=0===t;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](s);return n?this.$store.getters["shop/shopsForRegion"](s):[]}var a=this.$store.state.shop.shops[s];return ee.a.intersectionWith(a,e,function(t,e){return t.shopId===e})},sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.getShops.map(function(e){var s=Xt()({},e);return s.distance=ie(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.getShops.length?this.getShops:[]},shopNum:function(){var t=_t.getRegionBlockCode(),e=0===this.campaignDetail.shopUseFlg,s=this.$store.getters["shop/shopsAvailableForRegion"](t);return e?s?this.$store.getters["shop/shopsForRegion"](t).length:0:this.campaignDetail.shopid.length},isThisWeed:function(){var t=new Date,e=0===t.getDay()?7:t.getDay(),s=new Date(t.getFullYear(),t.getMonth(),t.getDate()+(7-e)),i=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1-e);return this.campaignDetail.campaignDateFrom>=i.getTime()&&this.campaignDetail.campaignDateFrom<=s.getTime()},isLessThanFivedays:function(){var t=(new Date).getTime(),e=this.campaignDetail.openEndDt,s=this.campaignDetail.campaignDateFrom,i=Ts()(864e5);return t<=e&&t>=s&&e-t<=5*i},isCampaignStart:function(){var t=(new Date).getTime(),e=this.campaignDetail.openEndDt,s=Ts()(864e5);return t>=this.campaignDetail.campaignDateFrom&&!(e-t<=5*s)},isNotThisWeed:function(){var t=new Date,e=t.getDay(),s=new Date(t.getFullYear(),t.getMonth(),t.getDate()+(7-e)),i=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1-e);return!(t.getTime()>this.campaignDetail.campaignDateFrom)&&(this.campaignDetail.campaignDateFrom<i.getTime()||this.campaignDetail.campaignDateFrom>s)},compaignEndTime:function(){return this.__fromNow(this.campaignDetail.campaignDateTo)},isTransfer:function(){return this.campaignDetail.totalCampaignNum>0&&0===this.campaignDetail.campaignGiveFlg},isExchange:function(){return this.campaignDetail.giftNums>0&&ee.a.filter(this.campaignDetail.userStampList,function(t){return 1===t.status}).length>0},currentCompaign:function(){return this.campaignDetail.userStampList.length===this.campaignDetail.participateRound&&this.campaignDetail.totalCampaignNum%this.campaignDetail.stampNeeded===0?this.campaignDetail.stampNeeded:this.campaignDetail.totalCampaignNum%this.campaignDetail.stampNeeded},completeRounds:function(){return Ts()(this.campaignDetail.userTotalStampNum/this.campaignDetail.stampNeeded)}},filters:{formatOnLookCount:function(t){return t%1e4===0?t/1e4:(t/1e4).toFixed(1)},formatDate:function(t){var e=new Date(t).getFullYear().toString(),s=(new Date(t).getMonth()+1).toString().padStart(2,"0"),i=new Date(t).getDate().toString().padStart(2,"0");return"".concat(e,".").concat(s,".").concat(i)},formatThisWeekDate:function(t){var e=["周日","周一","周二","周三","周四","周五","周六"],s=new Date(t),i=("0"+s.getHours()).slice(-2),n=("0"+s.getMinutes()).slice(-2),a=s.getDay();return"本".concat(e[a]," ").concat(i,":").concat(n,"开始")},formatNotThisWeekDate:function(t){var e=new Date,s=t,i=(new Date(s).getMonth()+1).toString().padStart(2,"0"),n=new Date(s).getDate().toString().padStart(2,"0"),a=new Date(s).getHours().toString().padStart(2,"0"),o=new Date(s).getMinutes().toString().padStart(2,"0"),c=s-e.getTime(),r=Ts()(c/864e5),d=Ts()(864e5);return e<s&&s-e>5*d?"".concat(i,"月").concat(n,"日 ").concat(a,":").concat(o,"分开始"):"".concat(r,"天后 ").concat(a,":").concat(o,"分开始")},formatLessFiveDay:function(t){var e=new Date,s=t,i=new Date(s).getHours().toString().padStart(2,"0"),n=new Date(s).getMinutes().toString().padStart(2,"0"),a=s-e.getTime(),o=Ts()(a/864e5);return"".concat(o,"天后 ").concat(i,":").concat(n,"分结束")},toKilometer:function(t){return t>20?">20km":t.toFixed(2)+"km"}},methods:{fetchCampaignBarrage:function(){var t=this,e=_t.getRegionBlockCode(),s=this.$route.params.campaignId;mt.campaign.campaignBarrage({regionBlockCode:e,campaignId:s}).then(function(e){t.barrageList=e})},showRegionDiffModal:function(t){var e=oe.getCurrentRegionName(t),s=_t.getUserInfo(),i=s?"你所在区域无法参与，当前内容仅限".concat(e):"你当前查阅内容，可能受区域限制有所不同";Me.alert({title:"友情提示",msg:i})},recordCampaignPopularStatistics:function(){var t=this.$route.params.campaignId;ne.recordCampaignPopularStatistics(t)},__handleCampaignProductsRes:function(t){var e=t.list.slice(0,4);this.campaignProducts=e},hideCampaignExchangeNotWinningModal:function(){this.isShowCampaignExchangeNotWinningModal="hide",document.body.style.overflow="auto"},__campaignnExchang:function(){var t=this,e=this.campaignDetail.campaignId,s=ee.a.find(this.campaignDetail.userStampList,function(t){return 1===t.status}).stampId;br.show(),mt.campaign.campaignGift({campaignId:e,stampId:s}).then(function(e){t.campaignGift=e;var s=1===t.campaignGift.giftType,i=2===t.campaignGift.giftType;if(i){var n=t.campaignGift.id;t.$router.push({path:"/campaign-post-exchange/",query:{userGiftId:n}})}else s&&(t.isShowCampaignExchangeCouponSuccessModal="show");br.hide()}).catch(function(e){if(201===e.data.code&&"5008"===e.data.errors[0].code){var s=1===t.campaignDetail.rewardType,i=0===t.campaignDetail.rewardType;s?Me.alert({title:"兑换失败",msg:"很遗憾,礼品已经被抢完了。"},function(e){t.__fetchCampaignDetail()}):i&&(t.isShowCampaignExchangeNotWinningModal="show",t.__fetchCampaignDetail()),br.hide()}})},__fetchCampaignDetail:function(){var t=this;return new f.a(function(e,s){$t.show();var i=_t.getRegionBlockCode(),n=t.$route.params.campaignId;mt.campaign.fetchCampaignDetail({campaignDetailId:n,regionBlockCode:i}).then(function(s){t.campaignDetail=s,$t.hide(),e()}).catch(function(t){s(t),$t.hide()})})},goToCampaignProducts:function(){var t=_t.getUserInfo(),e=this.campaignDetail.campaignId;t?this.$router.push({path:"/campaign-products/".concat(e)}):wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=campaignDetail&commodityId=".concat(e,"&sourceType=internal")})},goToCampaignAvailableShopList:function(){var t=_t.getUserInfo(),e=this.campaignDetail.campaignId;if(t){var s=this.campaignDetail,i=s.shopUseFlg,n=s.shopid;this.$router.push({name:"campaign-Available-shop-list",params:{shopUseFlg:i,shopid:n}})}else wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=campaignDetail&commodityId=".concat(e,"&sourceType=internal")})},campaignnTransferModal:function(){var t=this,e="提醒你的好友，要24小时内及时领取哦";Me.alert({title:"转赠完成",msg:e},function(e){t.__fetchCampaignDetail()})},setCurrentLocation:function(){var t=this;ut.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i}})}}},Sr=wr,Dr=(s("2fc9"),Object(p["a"])(Sr,gc,vc,!1,null,"024fcf1a",null)),kr=Dr.exports,xr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-products"},[null!==t.productList&&t.productList.length>0?s("div",{staticClass:"campaign-products__wrapper"},t._l(t.productList,function(e,i){return s("div",{key:i,staticClass:"campaign-products__item"},[s("img",{staticClass:"campaign-products__item__image",attrs:{src:e.imgUrl}}),s("div",{staticClass:"campaign-products__item__title"},[t._v(t._s(e.commodityName))]),t.showSellPrice?s("div",{staticClass:"campaign-products__item__price-wrapper"},[s("span",{staticClass:"campaign-products__item__price-wrapper__rmb-sign"},[t._v("¥ ")]),s("span",{staticClass:"campaign-products__item__price-wrapper__number"},[t._v(t._s(t._f("toPrice")(e.sellPrice)))])]):t._e()])}),0):s("div",{staticClass:"campaign-products__empty"},[s("p",{staticClass:"campaign-products__empty__icon"}),s("p",{staticClass:"campaign-products__empty__text"},[t._v("暂无活动商品")])])])},Tr=[],Ir=(s("c5f6"),{data:function(){return{productList:[],showSellPrice:!0}},created:function(){this.fetchCampaignProducts()},methods:{fetchCampaignProducts:function(){var t=this;$t.show();var e=_t.getRegionBlockCode(),s=this.$route.params.campaignId;mt.campaign.getCampaignProducts({regionBlockCode:e,campaignDetailId:s}).then(function(e){$t.hide();var s=e.data.list;s.forEach(function(e){t.showSellPrice=!e.largeClassificationId}),t.productList=s}).catch(function(t){$t.hide()})}},filters:{toPrice:function(t){return Number(t).toFixed(2)}}}),Ar=Ir,Nr=(s("a34c"),Object(p["a"])(Ar,xr,Tr,!1,null,"a3fff5e4",null)),Pr=Nr.exports,Lr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-post-exchange"},[s("img",{staticClass:"campaign-post-exchange__image",attrs:{src:t.imagePath}}),s("div",{staticClass:"campaign-post-exchange__description"},[t._v(t._s(t.giftName))]),s("div",{staticClass:"campaign-post-exchange__post-info-wrapper"},[t._m(0),null!==t.address?s("div",{on:{click:t.gotoChoosePostAddressInfo}},[s("div",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info"},[s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info__address"},[t._v(t._s(t.address.addressName))]),s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info__icon"})]),s("div",{staticClass:"campaign-post-exchange__post-info-wrapper__receiver-info"},[s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__receiver-info__name"},[t._v(t._s(t.address.name))]),s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__receiver-info__phone-number"},[t._v(t._s(t.address.phoneNumber))])])]):s("div",{on:{click:t.gotoChoosePostAddressInfo}},[t._m(1)])]),t._m(2),s("div",{staticClass:"campaign-post-exchange__term-description"},[t._v("点击“确认地址”表示您已阅读并同意以上条款")]),s("div",{staticClass:"campaign-post-exchange__exchange-button-wrapper"},[s("div",{staticClass:"campaign-post-exchange__exchange-button-wrapper__button",class:{active:t.confirmAddressButtonVisible},on:{click:t.handleConfirmAddress}},[t._v("确认地址\n    ")])])])},Mr=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-post-exchange__post-info-wrapper__title-info"},[s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__title-info__icon"}),s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__title-info__title"},[t._v("寄送地址")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info"},[s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info__address"},[t._v("请选择寄送地址")]),s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info__icon"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-post-exchange__intro-info-wrapper"},[s("div",{staticClass:"campaign-post-exchange__intro-info-wrapper__title-info"},[s("span",{staticClass:"campaign-post-exchange__intro-info-wrapper__title-info__icon"}),s("span",{staticClass:"campaign-post-exchange__intro-info-wrapper__title-info__title"},[t._v("兑换须知")])]),s("div",{staticClass:"campaign-post-exchange__intro-info-wrapper__other-description"},[t._v("❶ 请选择寄送地址；")]),s("div",{staticClass:"campaign-post-exchange__intro-info-wrapper__other-description"},[t._v("❷ 确认兑换后，1小时内修改寄送地址。")])])}],Er=(s("7f7f"),{namespaced:!0,state:{chooseAddressInfo:null,editAddressInfo:null,addAddressInfo:null,needShowEditAddressSuccessToast:!1,needShowAddAddressSuccessToast:!1},mutations:{setChooseAddressInfo:function(t,e){t.chooseAddressInfo=e},setEditAddressInfo:function(t,e){t.editAddressInfo=e},setAddAddressInfo:function(t,e){t.addAddressInfo=e},setNeedShowEditAddressSuccessToast:function(t,e){t.needShowEditAddressSuccessToast=e},setNeedShowAddAddressSuccessToast:function(t,e){t.needShowAddAddressSuccessToast=e},cleanupChooseAddressInfo:function(t){t.chooseAddressInfo=null},cleanupEditAddressInfo:function(t){t.editAddressInfo=null},cleanupAddAddressInfo:function(t){t.addAddressInfo=null},hideEditAddressSuccessToast:function(t){t.needShowEditAddressSuccessToast=!1},hideAddAddressSuccessToast:function(t){t.needShowAddAddressSuccessToast=!1}}}),$r={data:function(){return{imagePath:null,giftName:null,address:null,isChooseAddressButtonVisible:!1,confirmAddressButtonVisible:!1,userGiftId:null}},created:function(){this.registerCampaignExchangeAddressModule(),this.userGiftId=this.$route.query.userGiftId,this.getUserGiftInfo(this.userGiftId);var t=this.$store.state.campaignExchangeAddress.chooseAddressInfo,e=!!t;e&&(this.address=t,this.confirmAddressButtonVisible=!0)},methods:{getUserGiftInfo:function(t){var e=this;$t.show(),mt.campaign.getUserGiftInfo({userGiftId:t}).then(function(t){$t.hide(),e.imagePath=t.data.imagePath,e.giftName=t.data.giftName}).catch(function(t){$t.hide(),ia.show({msg:"获取礼品信息失败, 请稍后再试"})})},registerCampaignExchangeAddressModule:function(){this.$store.registerModule("campaignExchangeAddress",Er)},gotoChoosePostAddressInfo:function(){this.$router.push({path:"/campaign-post-exchange/choose-address"})},handleConfirmAddress:function(){var t=this;if(this.confirmAddressButtonVisible){var e=_t.getRegionBlockCode(),s={regionBlockCode:e,userGiftId:Number(this.userGiftId),userName:this.address.name,address:"".concat(this.address.addressDetailName).concat(this.address.addressName).concat(this.address.addressExtraInfo),mobile:this.address.phoneNumber};mt.campaign.campaignGiftSaveAddress({saveAddressInfo:s}).then(function(e){var s=0===e.code;if(s){var i="寄送地址: ".concat(t.address.addressDetailName).concat(t.address.addressName).concat(t.address.addressExtraInfo);Me.alert({title:"地址提交成功",msg:i},function(e){t.$router.go(-1),t.$store.commit("campaignExchangeAddress/cleanupChooseAddressInfo"),t.$store.unregisterModule("campaignExchangeAddress")})}}).catch(function(t){ia.show({msg:"确认地址信息失败, 请稍后再试"})})}}}},Or=$r,Rr=(s("3981"),Object(p["a"])(Or,Lr,Mr,!1,null,"4b5ec0be",null)),Fr=Rr.exports,Br=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-express-address"},[t.campaignPostExchangedList.length?s("ul",{staticClass:"campaign-express-address__list"},t._l(t.campaignPostExchangedList,function(e,i){return s("li",{key:i,staticClass:"campaign-express-address__list__item"},[s("div",{staticClass:"campaign-express-address__list__item__left"},[s("p",{staticClass:"campaign-express-address__list__item__left__title"},[t._v("第"+t._s(i+1)+"轮:   "+t._s(null===e.giftName?"未中奖":e.giftName))])])])}),0):s("div",{staticClass:"campaign-express-address__empty"},[s("p",{staticClass:"campaign-express-address__empty__icon"}),s("p",{staticClass:"campaign-express-address__empty__text"},[t._v("没有兑换过礼品")])])])},Ur=[],jr={data:function(){return{campaignPostExchangedList:null}},created:function(){var t=this.$route.params.userStampList.filter(function(t){return 2===t.status||3===t.status});this.campaignPostExchangedList=t}},Hr=jr,zr=(s("2dfb"),Object(p["a"])(Hr,Br,Ur,!1,null,"7db4fd6e",null)),Wr=zr.exports,Gr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"choose-address"},[null!==t.addresses?s("div",{staticClass:"choose-address__wrapper"},[s("div",{staticClass:"choose-address__container"},t._l(t.addresses,function(e,i){return s("div",{key:i,staticClass:"choose-address__content"},[s("div",{staticClass:"choose-address__content__info",on:{click:function(s){return t.chooseAddress(e)}}},[s("span",{staticClass:"choose-address__content__info__address-name"},[t._v(t._s(e.addressName))]),""!==e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag-container"},["家"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag home"},[t._v(t._s(e.tags[0]))]):t._e(),"公司"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag company"},[t._v(t._s(e.tags[0]))]):t._e(),"学校"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag school"},[t._v(t._s(e.tags[0]))]):t._e()]):t._e(),s("span",{staticClass:"choose-address__content__info__detail-address"},[t._v(t._s(e.addressExtraInfo))]),s("span",{staticClass:"choose-address__content__info__contact-name"},[t._v(t._s(e.name))]),s("span",{staticClass:"choose-address__content__info__phone-number"},[t._v(t._s(e.phoneNumber))])]),s("span",{staticClass:"choose-address__edit",on:{click:function(e){return t.editAddress(i)}}},[t._v("编辑")])])}),0)]):s("div",{staticClass:"choose-address__empty"},[s("p",{staticClass:"choose-address__empty__icon"}),s("p",{staticClass:"choose-address__empty__text"},[t._v("还未添加地址")])]),s("div",{staticClass:"choose-address__add-address",on:{click:t.addAddress}},[t._v("新增常用地址")])])},Vr=[],qr={data:function(){return{isAddAddressVisible:!1,isEditAddressVisible:!1,isTagHome:!1,isTagCompany:!1,isTagSchool:!1,addresses:null}},created:function(){He.init(),this.fetchUserAddressInfo(),this.showAddOrEditAddressSuccessToast()},methods:{showAddOrEditAddressSuccessToast:function(){var t=this.$store.state.campaignExchangeAddress.needShowEditAddressSuccessToast,e=this.$store.state.campaignExchangeAddress.needShowAddAddressSuccessToast;t?ia.show({msg:"修改地址信息成功"}):e&&ia.show({msg:"新增地址信息成功"}),this.$store.commit("campaignExchangeAddress/hideEditAddressSuccessToast"),this.$store.commit("campaignExchangeAddress/hideAddAddressSuccessToast")},fetchUserAddressInfo:function(){var t=this;$t.show();var e=_t.getRegionBlockCode();mt.address.fetch({regionBlockCode:e}).then(function(e){$t.hide();var s=0===e.data.code,i=e.data.data.length>0;s?i&&(t.addresses=e.data.data):($t.hide(),ia.show({msg:"获取地址信息失败, 请稍后再试"}))}).catch(function(t){$t.hide(),ia.show({msg:"获取地址信息失败, 请稍后再试"})})},chooseAddress:function(t){this.$store.commit("campaignExchangeAddress/setChooseAddressInfo",t),this.$router.go(-1)},editAddress:function(t){var e=this.addresses[t];this.$store.commit("campaignExchangeAddress/setEditAddressInfo",e),this.$router.push({path:"/campaign-post-exchange/edit-address"})},addAddress:function(){this.$router.push({path:"/campaign-post-exchange/add-address"})}}},Yr=qr,Qr=(s("31cd"),Object(p["a"])(Yr,Gr,Vr,!1,null,"1a7ced28",null)),Kr=Qr.exports,Xr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"add-address"},[s("div",{staticClass:"add-address__contact-content"},[s("span",{staticClass:"add-address__contact"},[t._v("联系人")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],staticClass:"add-address__contact-name",attrs:{placeholder:"请输入你的姓名"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"add-address__gender-info"},[s("span",{class:t.isSelectMale?"add-address__gender-mr tagSelect":"add-address__gender-mr",on:{click:t.selectMale}},[t._v("先生")]),s("span",{class:t.isSelectFemale?"add-address__gender-miss tagSelect":"add-address__gender-miss",on:{click:t.selectFemale}},[t._v("女士")])]),s("div",{staticClass:"add-address__phone-content"},[s("span",{staticClass:"add-address__phone"},[t._v("手机号")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.phoneNumber,expression:"phoneNumber"}],staticClass:"add-address__phone-number",attrs:{placeholder:"请输入你的手机号",type:"number"},domProps:{value:t.phoneNumber},on:{input:[function(e){e.target.composing||(t.phoneNumber=e.target.value)},t.handlePhoneNumberInputChange]}})]),t.showPhoneNumberSuggestion&&null!==t.suggestedPhoneNumbers?s("div",{staticClass:"add-address__phone-number-suggestion"},t._l(t.suggestedPhoneNumbers,function(e,i){return s("div",{key:i,staticClass:"add-address__phone-number-suggestion__item",on:{click:function(s){return t.handleSuggestedPhoneNumberTap(e)}}},[t._v(t._s(e))])}),0):t._e(),s("div",{staticClass:"add-address__address-content",on:{click:t.chooseAddress}},[s("span",{staticClass:"add-address__address"},[t._v("地址")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressDetailName,expression:"addressDetailName",modifiers:{trim:!0}}],staticClass:"add-address__address-description",attrs:{placeholder:"请选择地址",onfocus:"this.blur()"},domProps:{value:t.addressDetailName},on:{input:function(e){e.target.composing||(t.addressDetailName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("span",{staticClass:"add-address__address-description__icon",on:{click:t.chooseAddress}})]),s("div",{staticClass:"add-address__address-detail-content"},[s("span",{staticClass:"add-address__address-detail"},[t._v("门牌号")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressExtraInfo,expression:"addressExtraInfo",modifiers:{trim:!0}}],staticClass:"add-address__address-detail-description",attrs:{placeholder:"请输入门牌号，如A座8A座"},domProps:{value:t.addressExtraInfo},on:{input:function(e){e.target.composing||(t.addressExtraInfo=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"add-address__tag-info"},[s("span",{staticClass:"add-address__tag"},[t._v("标签")]),s("span",{class:t.isSelectHome?"add-address__tag-home tagSelect":"add-address__tag-home",on:{click:t.selectHome}},[t._v("家")]),s("span",{class:t.isSelectCompany?"add-address__tag-company tagSelect":"add-address__tag-company",on:{click:t.selectCompany}},[t._v("公司")]),s("span",{class:t.isSelectSchool?"add-address__tag-school tagSelect":"add-address__tag-school",on:{click:t.selectSchool}},[t._v("学校")])]),s("div",{staticClass:"add-address__save-address",on:{click:t.saveAddress}},[t._v("确定")])])},Zr=[],Jr={data:function(){return{name:"",gender:"FEMALE",phoneNumber:"",addressName:"",addressDetailName:null,addressExtraInfo:"",tags:[],addAddress:null,isSelectMale:!1,isSelectFemale:!1,isSelectHome:!1,isSelectCompany:!1,isSelectSchool:!1,isLocationPickerVisible:!1,locationInfo:null,showPhoneNumberSuggestion:!1,userAllPhoneNumbers:null,suggestedPhoneNumbers:null}},created:function(){if(this.setPhoneNumberSuggestion(),this.addAddress=this.$store.state.campaignExchangeAddress.addAddressInfo,this.addAddress){this.name=this.addAddress.name,this.gender=this.addAddress.gender,this.phoneNumber=this.addAddress.phoneNumber,this.addressName=this.$store.state.location.locationInfo.addressName,this.addressDetailName=this.$store.state.location.locationInfo.addressDetailName,this.addressExtraInfo=this.addAddress.addressExtraInfo;var t=this.$store.state.location.locationInfo.latitude,e=this.$store.state.location.locationInfo.longitude;this.locationInfo={latitude:t,longitude:e},this.$store.commit("location/cleanupLocationInfo");var s="MALE"===this.addAddress.gender;s?(this.isSelectMale=!0,this.gender="MALE"):(this.isSelectFemale=!0,this.gender="FEMALE");var i=!!this.addAddress.tags;if(i){var n="家"===this.addAddress.tags[0],a="公司"===this.addAddress.tags[0],o="学校"===this.addAddress.tags[0];n?(this.isSelectHome=!0,this.tags=["家"]):a?(this.isSelectCompany=!0,this.tags=["公司"]):o&&(this.isSelectSchool=!0,this.tags=["学校"])}}else this.isSelectFemale=!0},methods:{filterPhoneNumberForSuggestion:function(t,e){return 0===t.length?e.slice():e.filter(function(e){return e.slice(0,t.length)===t})},setPhoneNumberSuggestion:function(){var t=this,e=_t.getRegionBlockCode();mt.address.fetch({regionBlockCode:e}).then(function(e){var s=0===e.data.code,i=e.data.data.length>0,n=e.data.data,a=ee.a.uniq(n.map(function(t){return t.phoneNumber}));s&&i&&(t.userAllPhoneNumbers=a,t.suggestedPhoneNumbers=a)})},handlePhoneNumberInputChange:function(){var t=this.phoneNumber;t.length>11&&(this.phoneNumber=t.slice(0,11)),this.showPhoneNumberSuggestion=!0,this.suggestedPhoneNumbers=this.filterPhoneNumberForSuggestion(t,this.userAllPhoneNumbers)},handleSuggestedPhoneNumberTap:function(t){this.phoneNumber=t,this.showPhoneNumberSuggestion=!1},chooseAddress:function(){var t=this.name,e=this.gender,s=this.phoneNumber,i=this.addressName,n=this.addressDetailName,a=this.addressExtraInfo,o=this.tags,c={name:t,gender:e,phoneNumber:s,addressName:i,addressDetailName:n,addressExtraInfo:a,tags:o};this.$store.commit("campaignExchangeAddress/setAddAddressInfo",c),this.$router.push({path:"/choose-location"})},saveAddress:function(){var t=this,e=_t.getRegionBlockCode(),s=""===this.name,i=""===this.gender,n=""===this.phoneNumber,a=""===this.addressName,o=""===this.addressExtraInfo,c=!this.checkPhoneValid(this.phoneNumber);if(s)ia.show({msg:"请输入你的姓名"});else if(i)ia.show({msg:"请选择性别"});else if(n)ia.show({msg:"请输入你的手机号"});else if(c)ia.show({msg:"请输入有效的手机号"});else if(a)ia.show({msg:"请选择地址"});else if(o)ia.show({msg:"请输入门牌号"});else{br.show();var r={regionBlockCode:e,name:this.name,gender:this.gender,phoneNumber:this.phoneNumber,addressName:this.addressName,addressDetailName:this.addressDetailName,addressExtraInfo:this.addressExtraInfo,latitude:this.locationInfo.latitude,longitude:this.locationInfo.longitude,tags:this.tags};mt.address.add({addressInfo:r,regionBlockCode:e}).then(function(e){br.hide();var s=0===e.data.code;s?(t.$router.go(-1),t.$store.commit("campaignExchangeAddress/cleanupAddAddressInfo"),t.$store.commit("campaignExchangeAddress/setNeedShowAddAddressSuccessToast",!0)):(br.hide(),ia.show({msg:"新增地址信息失败, 请稍后再试"}))}).catch(function(t){br.hide(),ia.show({msg:"新增地址信息失败, 请稍后再试"})})}},checkPhoneValid:function(t){return!!/^1\d{10}$/.test(t)},selectMale:function(){this.isSelectMale=!0,this.isSelectFemale=!1,this.gender="MALE"},selectFemale:function(){this.isSelectFemale=!0,this.isSelectMale=!1,this.gender="FEMALE"},selectHome:function(){this.isSelectHome?(this.isSelectHome=!1,this.tags=[]):(this.isSelectHome=!0,this.tags=["家"]),this.isSelectCompany=!1,this.isSelectSchool=!1},selectCompany:function(){this.isSelectCompany?(this.isSelectCompany=!1,this.tags=[]):(this.isSelectCompany=!0,this.tags=["公司"]),this.isSelectHome=!1,this.isSelectSchool=!1},selectSchool:function(){this.isSelectSchool?(this.isSelectSchool=!1,this.tags=[]):(this.isSelectSchool=!0,this.tags=["学校"]),this.isSelectHome=!1,this.isSelectCompany=!1}}},td=Jr,ed=(s("fdd2"),Object(p["a"])(td,Xr,Zr,!1,null,"2c57b4c8",null)),sd=ed.exports,id=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"edit-address"},[s("div",{staticClass:"edit-address__contact-content"},[s("span",{staticClass:"edit-address__contact"},[t._v("联系人")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],staticClass:"edit-address__contact-name",domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"edit-address__gender-info"},[s("span",{class:t.isSelectMale?"edit-address__gender-mr tagSelect":"edit-address__gender-mr",on:{click:t.selectMale}},[t._v("先生")]),s("span",{class:t.isSelectFemale?"edit-address__gender-miss tagSelect":"edit-address__gender-miss",on:{click:t.selectFemale}},[t._v("女士")])]),s("div",{staticClass:"edit-address__phone-content"},[s("span",{staticClass:"edit-address__phone"},[t._v("手机号")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.phoneNumber,expression:"phoneNumber"}],staticClass:"edit-address__phone-number",attrs:{placeholder:"请输入你的手机号",type:"number"},domProps:{value:t.phoneNumber},on:{input:[function(e){e.target.composing||(t.phoneNumber=e.target.value)},t.handlePhoneNumberInputChange]}})]),t.showPhoneNumberSuggestion&&null!==t.suggestedPhoneNumbers?s("div",{staticClass:"edit-address__phone-number-suggestion"},t._l(t.suggestedPhoneNumbers,function(e,i){return s("div",{key:i,staticClass:"edit-address__phone-number-suggestion__item",on:{click:function(s){return t.handleSuggestedPhoneNumberTap(e)}}},[t._v(t._s(e))])}),0):t._e(),s("div",{staticClass:"edit-address__address-content",on:{click:t.chooseAddress}},[s("span",{staticClass:"edit-address__address"},[t._v("地址")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressDetailName,expression:"addressDetailName",modifiers:{trim:!0}}],staticClass:"edit-address__address-description",attrs:{onfocus:"this.blur()"},domProps:{value:t.addressDetailName},on:{input:function(e){e.target.composing||(t.addressDetailName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("span",{staticClass:"edit-address__address-description__icon"})]),s("div",{staticClass:"edit-address__address-detail-content"},[s("span",{staticClass:"edit-address__address-detail"},[t._v("门牌号")]),s("div",{staticClass:"edit-address__address-detail-show",attrs:{contenteditable:"true"}},[t._v(t._s(t.addressExtraInfo))]),s("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressExtraInfo,expression:"addressExtraInfo",modifiers:{trim:!0}}],staticClass:"edit-address__address-detail-description",domProps:{value:t.addressExtraInfo},on:{input:function(e){e.target.composing||(t.addressExtraInfo=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"edit-address__tag-info"},[s("span",{staticClass:"edit-address__tag"},[t._v("标签")]),s("span",{class:t.isSelectHome?"edit-address__tag-home tagSelect":"edit-address__tag-home",on:{click:t.selectHome}},[t._v("家")]),s("span",{class:t.isSelectCompany?"edit-address__tag-company tagSelect":"edit-address__tag-company",on:{click:t.selectCompany}},[t._v("公司")]),s("span",{class:t.isSelectSchool?"edit-address__tag-school tagSelect":"edit-address__tag-school",on:{click:t.selectSchool}},[t._v("学校")])]),s("div",{staticClass:"edit-address__save-address",on:{click:t.saveAddress}},[t._v("确定")])])},nd=[],ad={data:function(){return{name:null,gender:null,phoneNumber:null,addressName:null,addressDetailName:null,addressExtraInfo:null,addressId:null,tags:[],editAddress:null,isSelectMale:!1,isSelectFemale:!1,isSelectHome:!1,isSelectCompany:!1,isSelectSchool:!1,isLocationPickerVisible:!1,locationInfo:null,showPhoneNumberSuggestion:!1,userAllPhoneNumbers:null,suggestedPhoneNumbers:null}},created:function(){this.setPhoneNumberSuggestion(),this.editAddress=this.$store.state.campaignExchangeAddress.editAddressInfo,this.name=this.editAddress.name,this.gender=this.editAddress.gender,this.phoneNumber=this.editAddress.phoneNumber,this.addressName=this.editAddress.addressName,this.addressDetailName=this.editAddress.addressDetailName,this.addressExtraInfo=this.editAddress.addressExtraInfo,this.addressId=this.editAddress.addressId;var t=this.editAddress.latitude,e=this.editAddress.longitude;this.locationInfo={latitude:t,longitude:e};var s=null!==this.$store.state.location.locationInfo;if(s){this.addressName=this.$store.state.location.locationInfo.addressName,this.addressDetailName=this.$store.state.location.locationInfo.addressDetailName;var i=this.$store.state.location.locationInfo.latitude,n=this.$store.state.location.locationInfo.longitude;this.locationInfo={latitude:i,longitude:n},this.$store.commit("location/cleanupLocationInfo")}var a="MALE"===this.editAddress.gender,o="FEMALE"===this.editAddress.gender;a?(this.isSelectMale=!0,this.gender="MALE"):o&&(this.isSelectFemale=!0,this.gender="FEMALE");var c=!!this.editAddress.tags;if(c){var r="家"===this.editAddress.tags[0],d="公司"===this.editAddress.tags[0],p="学校"===this.editAddress.tags[0];r?(this.isSelectHome=!0,this.tags=["家"]):d?(this.isSelectCompany=!0,this.tags=["公司"]):p&&(this.isSelectSchool=!0,this.tags=["学校"])}},methods:{filterPhoneNumberForSuggestion:function(t,e){return 0===t.length?e.slice():e.filter(function(e){return e.slice(0,t.length)===t})},setPhoneNumberSuggestion:function(){var t=this,e=_t.getRegionBlockCode();mt.address.fetch({regionBlockCode:e}).then(function(e){var s=0===e.data.code,i=e.data.data.length>0,n=e.data.data,a=ee.a.uniq(n.map(function(t){return t.phoneNumber}));s&&i&&(t.userAllPhoneNumbers=a,t.suggestedPhoneNumbers=a)})},handlePhoneNumberInputChange:function(){var t=this.phoneNumber;t.length>11&&(this.phoneNumber=t.slice(0,11)),this.showPhoneNumberSuggestion=!0,this.suggestedPhoneNumbers=this.filterPhoneNumberForSuggestion(t,this.userAllPhoneNumbers)},handleSuggestedPhoneNumberTap:function(t){this.phoneNumber=t,this.showPhoneNumberSuggestion=!1},chooseAddress:function(){var t=this.name,e=this.gender,s=this.phoneNumber,i=this.addressName,n=this.addressDetailName,a=this.addressId,o=this.addressExtraInfo,c=this.editAddress.tags,r={name:t,gender:e,phoneNumber:s,addressName:i,addressDetailName:n,addressExtraInfo:o,addressId:a,tags:c,latitude:this.editAddress.location,longitude:this.editAddress.location};this.$store.commit("campaignExchangeAddress/setEditAddressInfo",r),this.$router.push({path:"/choose-location"})},saveAddress:function(){var t=this,e=""===this.name,s=""===this.gender,i=""==this.phoneNumber,n=""===this.addressName,a=""===this.addressExtraInfo,o=!this.checkPhoneValid(this.phoneNumber);if(e)ia.show({msg:"请输入你的姓名"});else if(s)ia.show({msg:"请选择性别"});else if(i)ia.show({msg:"请输入你的手机号"});else if(o)ia.show({msg:"请输入有效的手机号"});else if(n)ia.show({msg:"请选择地址"});else if(a)ia.show({msg:"请输入门牌号"});else{br.show();var c=_t.getRegionBlockCode(),r={regionBlockCode:c,addressId:this.editAddress.addressId,name:this.name,gender:this.gender,phoneNumber:this.phoneNumber,addressName:this.addressName,addressDetailName:this.addressDetailName,addressExtraInfo:this.addressExtraInfo,latitude:this.locationInfo.latitude,longitude:this.locationInfo.longitude,tags:this.tags};mt.address.edit({addressInfo:r,regionBlockCode:c}).then(function(e){br.hide();var s=0===e.data.code;s?(t.$router.go(-1),t.$store.commit("campaignExchangeAddress/cleanupEditAddressInfo"),t.$store.commit("campaignExchangeAddress/setNeedShowEditAddressSuccessToast",!0)):(br.hide(),ia.show({msg:"修改地址信息失败, 请稍后再试"}))}).catch(function(t){br.hide(),ia.show({msg:"修改地址信息失败, 请稍后再试"})})}},checkPhoneValid:function(t){return!!/^1\d{10}$/.test(t)},selectMale:function(){this.isSelectMale=!0,this.isSelectFemale=!1,this.gender="MALE"},selectFemale:function(){this.isSelectFemale=!0,this.isSelectMale=!1,this.gender="FEMALE"},selectHome:function(){this.isSelectHome?(this.isSelectHome=!1,this.tags=[]):(this.isSelectHome=!0,this.tags=["家"]),this.isSelectCompany=!1,this.isSelectSchool=!1,this.editAddress.tags=this.tags},selectCompany:function(){this.isSelectCompany?(this.isSelectCompany=!1,this.tags=[]):(this.isSelectCompany=!0,this.tags=["公司"]),this.isSelectHome=!1,this.isSelectSchool=!1,this.editAddress.tags=this.tags},selectSchool:function(){this.isSelectSchool?(this.isSelectSchool=!1,this.tags=[]):(this.isSelectSchool=!0,this.tags=["学校"]),this.isSelectHome=!1,this.isSelectCompany=!1,this.editAddress.tags=this.tags}}},od=ad,cd=(s("0077"),Object(p["a"])(od,id,nd,!1,null,"3252c45b",null)),rd=cd.exports,dd=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"location-picker"},[s("iframe",{ref:"locationPicker",attrs:{width:"100%",height:"100%",frameborder:"0",src:"https://apis.map.qq.com/tools/locpicker?type=1&policy=1&key=QVPBZ-YBMHV-KYMPX-UIXW2-7AM7Z-BNFNU&referer=locator"}})])},pd=[],ld={data:function(){return{chosenAddressName:null}},created:function(){this.initQQMapLocationPicker()},methods:{initQQMapLocationPicker:function(){window.addEventListener("message",this.handleLocationChange,!1)},handleLocationChange:function(t){var e=this,s=t.data;if(s&&"locationPicker"==s.module){var i="我的位置"===s.poiname;i?qqLbsService.getAddressByLatLng(s.latlng.lat,s.latlng.lng).then(function(t){var s=t.nearPois[0];e.chosenAddressName=s,e.hideLocationPicker()}):(this.chosenAddressName=s.poiname,this.hideLocationPicker());var n=this.$store.state.campaignExchangeAddress.addAddressInfo,a=n.name,o=n.gender,c=n.phoneNumber,r=this.chosenAddressName,d=s.poiaddress,p=n.addressExtraInfo,l=n.tags,u={name:a,gender:o,phoneNumber:c,addressName:r,addressDetailName:d,addressExtraInfo:p,tags:l,latitude:s.latlng.lat,longitude:s.latlng.lng};this.$store.commit("campaignExchangeAddress/setAddAddressInfo",u),this.$router.go(-1)}},hideLocationPicker:function(){var t=this.$refs.locationPicker;t.focus(),t.blur(),window.removeEventListener("message",this.handleLocationChange,!1)}}},ud=ld,_d=(s("de52"),Object(p["a"])(ud,dd,pd,!1,null,"37bba296",null)),md=_d.exports,hd=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"location-picker"},[s("iframe",{ref:"locationPicker",attrs:{width:"100%",height:"100%",frameborder:"0",src:"https://apis.map.qq.com/tools/locpicker?type=1&policy=1&key=QVPBZ-YBMHV-KYMPX-UIXW2-7AM7Z-BNFNU&referer=locator"}})])},gd=[],vd={data:function(){return{chosenAddressName:null}},created:function(){this.initQQMapLocationPicker()},methods:{initQQMapLocationPicker:function(){window.addEventListener("message",this.handleLocationChange,!1)},handleLocationChange:function(t){var e=this,s=t.data;if(s&&"locationPicker"==s.module){var i="我的位置"===s.poiname;i?qqLbsService.getAddressByLatLng(s.latlng.lat,s.latlng.lng).then(function(t){var s=t.nearPois[0];e.chosenAddressName=s,e.hideLocationPicker()}):(this.chosenAddressName=s.poiname,this.hideLocationPicker());var n=this.$store.state.campaignExchangeAddress.editAddressInfo,a=n.name,o=n.gender,c=n.phoneNumber,r=this.chosenAddressName,d=s.poiaddress,p=n.addressExtraInfo,l=n.addressId,u=n.tags,_={name:a,gender:o,phoneNumber:c,addressName:r,addressDetailName:d,addressExtraInfo:p,addressId:l,tags:u,latitude:s.latlng.lat,longitude:s.latlng.lng};this.$store.commit("campaignExchangeAddress/setEditAddressInfo",_),this.$router.go(-1)}},hideLocationPicker:function(){var t=this.$refs.locationPicker;t.focus(),t.blur(),window.removeEventListener("message",this.handleLocationChange,!1)}}},fd=vd,Cd=(s("9edc"),Object(p["a"])(fd,hd,gd,!1,null,"6a1b74a4",null)),yd=Cd.exports,bd=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"choose-address"},[null!==t.addresses?s("div",{staticClass:"choose-address__wrapper"},[s("div",{staticClass:"choose-address__container"},t._l(t.addresses,function(e,i){return s("div",{key:i,staticClass:"choose-address__content"},[s("div",{staticClass:"choose-address__content__info",on:{click:function(s){return t.chooseAddress(e)}}},[s("span",{staticClass:"choose-address__content__info__address-name"},[t._v(t._s(e.addressName))]),""!==e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag-container"},["家"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag home"},[t._v(t._s(e.tags[0]))]):t._e(),"公司"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag company"},[t._v(t._s(e.tags[0]))]):t._e(),"学校"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag school"},[t._v(t._s(e.tags[0]))]):t._e()]):t._e(),s("span",{staticClass:"choose-address__content__info__detail-address"},[t._v(t._s(e.addressExtraInfo))]),s("span",{staticClass:"choose-address__content__info__contact-name"},[t._v(t._s(e.name))]),s("span",{staticClass:"choose-address__content__info__phone-number"},[t._v(t._s(e.phoneNumber))])]),s("span",{staticClass:"choose-address__edit",on:{click:function(e){return t.editAddress(i)}}},[t._v("编辑")])])}),0)]):s("div",{staticClass:"choose-address__empty"},[s("p",{staticClass:"choose-address__empty__icon"}),s("p",{staticClass:"choose-address__empty__text"},[t._v("还未添加地址")])]),s("div",{staticClass:"choose-address__add-address",on:{click:t.addAddress}},[t._v("新增常用地址")])])},wd=[],Sd={namespaced:!0,state:{chooseAddressInfo:null,editAddressInfo:null,addAddressInfo:null,needShowEditAddressSuccessToast:!1,needShowAddAddressSuccessToast:!1},mutations:{setChooseAddressInfo:function(t,e){t.chooseAddressInfo=e},setEditAddressInfo:function(t,e){t.editAddressInfo=e},setAddAddressInfo:function(t,e){t.addAddressInfo=e},setNeedShowEditAddressSuccessToast:function(t,e){t.needShowEditAddressSuccessToast=e},setNeedShowAddAddressSuccessToast:function(t,e){t.needShowAddAddressSuccessToast=e},cleanupChooseAddressInfo:function(t){t.chooseAddressInfo=null},cleanupEditAddressInfo:function(t){t.editAddressInfo=null},cleanupAddAddressInfo:function(t){t.addAddressInfo=null},hideEditAddressSuccessToast:function(t){t.needShowEditAddressSuccessToast=!1},hideAddAddressSuccessToast:function(t){t.needShowAddAddressSuccessToast=!1}}},Dd={data:function(){return{isAddAddressVisible:!1,isEditAddressVisible:!1,isTagHome:!1,isTagCompany:!1,isTagSchool:!1,addresses:null}},created:function(){this.registerCampaignExchangeAddressModule(),this.fetchUserAddressInfo(),this.showAddOrEditAddressSuccessToast()},methods:{registerCampaignExchangeAddressModule:function(){this.$store.registerModule("campaignSendExchangeAddress",Sd)},showAddOrEditAddressSuccessToast:function(){var t=this.$store.state.campaignSendExchangeAddress.needShowEditAddressSuccessToast,e=this.$store.state.campaignSendExchangeAddress.needShowAddAddressSuccessToast;t?ia.show({msg:"修改地址信息成功"}):e&&ia.show({msg:"新增地址信息成功"}),this.$store.commit("campaignSendExchangeAddress/hideEditAddressSuccessToast"),this.$store.commit("campaignSendExchangeAddress/hideAddAddressSuccessToast")},fetchUserAddressInfo:function(){var t=this,e=_t.getRegionBlockCode();$t.show(),mt.address.fetch({regionBlockCode:e}).then(function(e){$t.hide();var s=0===e.data.code;s?e.data.data.length>0&&(t.addresses=e.data.data):ia.show({msg:"获取地址信息失败, 请稍后再试"})}).catch(function(t){ia.show({msg:"获取地址信息失败, 请稍后再试"}),$t.hide()})},chooseAddress:function(t){var e=this,s=this.$route.params.userGiftId,i=_t.getRegionBlockCode(),n={regionBlockCode:i,userGiftId:s,userName:t.name,address:"".concat(t.addressDetailName).concat(t.addressName).concat(t.addressExtraInfo),mobile:t.phoneNumber},a="".concat(n.address);Me.confirm({title:"您选择地址是",msg:a},function(t){br.show(),mt.campaign.campaignGiftSaveAddress({saveAddressInfo:n}).then(function(t){var s=0===t.code;s&&(e.$router.back(),br.hide())}).catch(function(t){console.log(t),br.hide()})})},editAddress:function(t){var e=this.addresses[t];this.$store.commit("campaignSendExchangeAddress/setEditAddressInfo",e),this.$router.push({path:"/campaign-send-exchange/edit-address"})},addAddress:function(){this.$router.push({path:"/campaign-send-exchange/add-address"})}}},kd=Dd,xd=(s("1e58"),Object(p["a"])(kd,bd,wd,!1,null,"06283ed1",null)),Td=xd.exports,Id=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-express-address"},[s("ul",{staticClass:"campaign-express-address__list"},t._l(t.sendAddressList,function(e,i){return s("li",{key:i,staticClass:"campaign-express-address__list__item"},[s("div",{staticClass:"campaign-express-address__list__item__left",on:{click:function(e){return t.back()}}},[s("p",{staticClass:"campaign-express-address__list__item__left__title"},[t._v("第"+t._s(i+1)+"轮: "+t._s(e.giftName))]),s("p",{staticClass:"campaign-express-address__list__item__left__address"},[t._v(t._s(e.address?e.address:"未设置"))]),s("p",{staticClass:"campaign-express-address__list__item__left__info"},[s("span",{staticClass:"campaign-express-address__list__item__left__name"},[t._v(t._s(e.userName))]),s("span",{staticClass:"campaign-express-address__list__item__left__phone"},[t._v(t._s(e.mobile))])])]),s("div",{staticClass:"campaign-express-address__list__item__right",on:{click:function(s){return t.goToCampaignChooseAddress(e.id)}}},[s("span",[t._v("设置")])])])}),0)])},Ad=[],Nd={data:function(){return{sendAddressList:null}},created:function(){this.fetchSendAddressList()},methods:{fetchSendAddressList:function(){var t=this,e=this.$route.params.campaignId;$t.show(),mt.campaign.getSendAddress({campaignId:e}).then(function(e){t.sendAddressList=e,$t.hide()})},goToCampaignChooseAddress:function(t){this.$router.push({path:"/campaign-send-choose-address/".concat(t)})},back:function(){this.$router.back()}}},Pd=Nd,Ld=(s("7dfb"),Object(p["a"])(Pd,Id,Ad,!1,null,"907dca14",null)),Md=Ld.exports,Ed=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"add-address"},[s("div",{staticClass:"add-address__contact-content"},[s("span",{staticClass:"add-address__contact"},[t._v("联系人")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],staticClass:"add-address__contact-name",attrs:{placeholder:"请输入你的姓名"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"add-address__gender-info"},[s("span",{class:t.isSelectMale?"add-address__gender-mr tagSelect":"add-address__gender-mr",on:{click:t.selectMale}},[t._v("先生")]),s("span",{class:t.isSelectFemale?"add-address__gender-miss tagSelect":"add-address__gender-miss",on:{click:t.selectFemale}},[t._v("女士")])]),s("div",{staticClass:"add-address__phone-content"},[s("span",{staticClass:"add-address__phone"},[t._v("手机号")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.phoneNumber,expression:"phoneNumber",modifiers:{number:!0}}],staticClass:"add-address__phone-number",attrs:{oninput:"if(value.length>11)value=value.slice(0,11)",placeholder:"请输入你的手机号",type:"number"},domProps:{value:t.phoneNumber},on:{input:function(e){e.target.composing||(t.phoneNumber=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"add-address__address-content",on:{click:t.chooseAddress}},[s("span",{staticClass:"add-address__address"},[t._v("地址")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressDetailName,expression:"addressDetailName",modifiers:{trim:!0}}],staticClass:"add-address__address-description",attrs:{placeholder:"请选择地址",onfocus:"this.blur()"},domProps:{value:t.addressDetailName},on:{input:function(e){e.target.composing||(t.addressDetailName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("span",{staticClass:"add-address__address-description__icon",on:{click:t.chooseAddress}})]),s("div",{staticClass:"add-address__address-detail-content"},[s("span",{staticClass:"add-address__address-detail"},[t._v("门牌号")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressExtraInfo,expression:"addressExtraInfo",modifiers:{trim:!0}}],staticClass:"add-address__address-detail-description",attrs:{placeholder:"请输入门牌号，如A座8A座"},domProps:{value:t.addressExtraInfo},on:{input:function(e){e.target.composing||(t.addressExtraInfo=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"add-address__tag-info"},[s("span",{staticClass:"add-address__tag"},[t._v("标签")]),s("span",{class:t.isSelectHome?"add-address__tag-home tagSelect":"add-address__tag-home",on:{click:t.selectHome}},[t._v("家")]),s("span",{class:t.isSelectCompany?"add-address__tag-company tagSelect":"add-address__tag-company",on:{click:t.selectCompany}},[t._v("公司")]),s("span",{class:t.isSelectSchool?"add-address__tag-school tagSelect":"add-address__tag-school",on:{click:t.selectSchool}},[t._v("学校")])]),s("div",{staticClass:"add-address__save-address",on:{click:t.saveAddress}},[t._v("确定")])])},$d=[],Od={data:function(){return{name:"",gender:"FEMALE",phoneNumber:"",addressName:"",addressDetailName:null,addressExtraInfo:"",tags:[],addAddress:null,isSelectMale:!1,isSelectFemale:!1,isSelectHome:!1,isSelectCompany:!1,isSelectSchool:!1,isLocationPickerVisible:!1,locationInfo:null}},created:function(){if(this.addAddress=this.$store.state.campaignSendExchangeAddress.addAddressInfo,this.addAddress){this.name=this.addAddress.name,this.gender=this.addAddress.gender,this.phoneNumber=this.addAddress.phoneNumber,this.addressName=this.$store.state.location.locationInfo.addressName,this.addressDetailName=this.$store.state.location.locationInfo.addressDetailName,this.addressExtraInfo=this.addAddress.addressExtraInfo;var t=this.$store.state.location.locationInfo.latitude,e=this.$store.state.location.locationInfo.longitude;this.locationInfo={latitude:t,longitude:e};var s="MALE"===this.addAddress.gender;s?(this.isSelectMale=!0,this.gender="MALE"):(this.isSelectFemale=!0,this.gender="FEMALE");var i=!!this.addAddress.tags;if(i){var n="家"===this.addAddress.tags[0],a="公司"===this.addAddress.tags[0],o="学校"===this.addAddress.tags[0];n?(this.isSelectHome=!0,this.tags=["家"]):a?(this.isSelectCompany=!0,this.tags=["公司"]):o&&(this.isSelectSchool=!0,this.tags=["学校"])}}else this.isSelectFemale=!0},methods:{chooseAddress:function(){var t=this.name,e=this.gender,s=this.phoneNumber,i=this.addressName,n=this.addressDetailName,a=this.addressExtraInfo,o=this.tags,c={name:t,gender:e,phoneNumber:s,addressName:i,addressDetailName:n,addressExtraInfo:a,tags:o};this.$store.commit("campaignSendExchangeAddress/setAddAddressInfo",c),this.$router.push({path:"/choose-location"})},saveAddress:function(){var t=this,e=_t.getRegionBlockCode(),s=""===this.name,i=""===this.gender,n=""===this.phoneNumber,a=""===this.addressName,o=""===this.addressExtraInfo,c=!this.checkPhoneValid(this.phoneNumber);if(s)ia.show({msg:"请输入你的姓名"});else if(i)ia.show({msg:"请选择性别"});else if(n)ia.show({msg:"请输入你的手机号"});else if(c)ia.show({msg:"请输入有效的手机号"});else if(a)ia.show({msg:"请选择地址"});else if(o)ia.show({msg:"请输入门牌号"});else{var r={regionBlockCode:e,name:this.name,gender:this.gender,phoneNumber:this.phoneNumber,addressName:this.addressName,addressDetailName:this.addressDetailName,addressExtraInfo:this.addressExtraInfo,latitude:this.locationInfo.latitude,longitude:this.locationInfo.longitude,tags:this.tags};br.show(),mt.address.add({addressInfo:r,regionBlockCode:e}).then(function(e){br.hide();var s=0===e.data.code;s?(t.$router.go(-1),t.$store.commit("campaignSendExchangeAddress/cleanupAddAddressInfo"),t.$store.commit("campaignSendExchangeAddress/setNeedShowAddAddressSuccessToast",!0)):ia.show({msg:"新增地址信息失败, 请稍后再试"})}).catch(function(t){br.hide(),ia.show({msg:"新增地址信息失败, 请稍后再试"})})}},checkPhoneValid:function(t){return!!/^1\d{10}$/.test(t)},selectMale:function(){this.isSelectMale=!0,this.isSelectFemale=!1,this.gender="MALE"},selectFemale:function(){this.isSelectFemale=!0,this.isSelectMale=!1,this.gender="FEMALE"},selectHome:function(){this.isSelectHome?(this.isSelectHome=!1,this.tags=[]):(this.isSelectHome=!0,this.tags=["家"]),this.isSelectCompany=!1,this.isSelectSchool=!1},selectCompany:function(){this.isSelectCompany?(this.isSelectCompany=!1,this.tags=[]):(this.isSelectCompany=!0,this.tags=["公司"]),this.isSelectHome=!1,this.isSelectSchool=!1},selectSchool:function(){this.isSelectSchool?(this.isSelectSchool=!1,this.tags=[]):(this.isSelectSchool=!0,this.tags=["学校"]),this.isSelectHome=!1,this.isSelectCompany=!1}}},Rd=Od,Fd=(s("70f4"),Object(p["a"])(Rd,Ed,$d,!1,null,"203a6ce0",null)),Bd=Fd.exports,Ud=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"edit-address"},[s("div",{staticClass:"edit-address__contact-content"},[s("span",{staticClass:"edit-address__contact"},[t._v("联系人")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],staticClass:"edit-address__contact-name",domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"edit-address__gender-info"},[s("span",{class:t.isSelectMale?"edit-address__gender-mr tagSelect":"edit-address__gender-mr",on:{click:t.selectMale}},[t._v("先生")]),s("span",{class:t.isSelectFemale?"edit-address__gender-miss tagSelect":"edit-address__gender-miss",on:{click:t.selectFemale}},[t._v("女士")])]),s("div",{staticClass:"edit-address__phone-content"},[s("span",{staticClass:"edit-address__phone"},[t._v("手机号")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.phoneNumber,expression:"phoneNumber",modifiers:{number:!0}}],staticClass:"edit-address__phone-number",attrs:{oninput:"if(value.length>11)value=value.slice(0,11)",type:"number"},domProps:{value:t.phoneNumber},on:{input:function(e){e.target.composing||(t.phoneNumber=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"edit-address__address-content",on:{click:t.chooseAddress}},[s("span",{staticClass:"edit-address__address"},[t._v("地址")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressDetailName,expression:"addressDetailName",modifiers:{trim:!0}}],staticClass:"edit-address__address-description",attrs:{onfocus:"this.blur()"},domProps:{value:t.addressDetailName},on:{input:function(e){e.target.composing||(t.addressDetailName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("span",{staticClass:"edit-address__address-description__icon"})]),s("div",{staticClass:"edit-address__address-detail-content"},[s("span",{staticClass:"edit-address__address-detail"},[t._v("门牌号")]),s("div",{staticClass:"edit-address__address-detail-show",attrs:{contenteditable:"true"}},[t._v(t._s(t.addressExtraInfo))]),s("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressExtraInfo,expression:"addressExtraInfo",modifiers:{trim:!0}}],staticClass:"edit-address__address-detail-description",domProps:{value:t.addressExtraInfo},on:{input:function(e){e.target.composing||(t.addressExtraInfo=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"edit-address__tag-info"},[s("span",{staticClass:"edit-address__tag"},[t._v("标签")]),s("span",{class:t.isSelectHome?"edit-address__tag-home tagSelect":"edit-address__tag-home",on:{click:t.selectHome}},[t._v("家")]),s("span",{class:t.isSelectCompany?"edit-address__tag-company tagSelect":"edit-address__tag-company",on:{click:t.selectCompany}},[t._v("公司")]),s("span",{class:t.isSelectSchool?"edit-address__tag-school tagSelect":"edit-address__tag-school",on:{click:t.selectSchool}},[t._v("学校")])]),s("div",{staticClass:"edit-address__save-address",on:{click:t.saveAddress}},[t._v("确定")])])},jd=[],Hd={data:function(){return{name:null,gender:null,phoneNumber:null,addressName:null,addressDetailName:null,addressExtraInfo:null,addressId:null,tags:[],editAddress:null,isSelectMale:!1,isSelectFemale:!1,isSelectHome:!1,isSelectCompany:!1,isSelectSchool:!1,isLocationPickerVisible:!1,locationInfo:null}},created:function(){this.editAddress=this.$store.state.campaignSendExchangeAddress.editAddressInfo,this.name=this.editAddress.name,this.gender=this.editAddress.gender,this.phoneNumber=this.editAddress.phoneNumber,this.addressName=this.editAddress.addressName,this.addressDetailName=this.editAddress.addressDetailName,this.addressExtraInfo=this.editAddress.addressExtraInfo,this.addressId=this.editAddress.addressId;var t=this.editAddress.latitude,e=this.editAddress.longitude;this.locationInfo={latitude:t,longitude:e};var s=null!==this.$store.state.location.locationInfo;if(s){this.addressName=this.$store.state.location.locationInfo.addressName,this.addressDetailName=this.$store.state.location.locationInfo.addressDetailName;var i=this.$store.state.location.locationInfo.latitude,n=this.$store.state.location.locationInfo.longitude;this.locationInfo={latitude:i,longitude:n},this.$store.commit("location/cleanupLocationInfo")}var a="MALE"===this.editAddress.gender,o="FEMALE"===this.editAddress.gender;a?(this.isSelectMale=!0,this.gender="MALE"):o&&(this.isSelectFemale=!0,this.gender="FEMALE");var c=!!this.editAddress.tags;if(c){var r="家"===this.editAddress.tags[0],d="公司"===this.editAddress.tags[0],p="学校"===this.editAddress.tags[0];r?(this.isSelectHome=!0,this.tags=["家"]):d?(this.isSelectCompany=!0,this.tags=["公司"]):p&&(this.isSelectSchool=!0,this.tags=["学校"])}},methods:{chooseAddress:function(){var t=this.name,e=this.gender,s=this.phoneNumber,i=this.addressName,n=this.addressDetailName,a=this.addressId,o=this.addressExtraInfo,c=this.editAddress.tags,r={name:t,gender:e,phoneNumber:s,addressName:i,addressDetailName:n,addressExtraInfo:o,addressId:a,tags:c,latitude:this.editAddress.location,longitude:this.editAddress.location};this.$store.commit("campaignSendExchangeAddress/setEditAddressInfo",r),this.$router.push({path:"/choose-location"})},saveAddress:function(){var t=this,e=""===this.name,s=""===this.gender,i=""==this.phoneNumber,n=""===this.addressName,a=""===this.addressExtraInfo,o=!this.checkPhoneValid(this.phoneNumber);if(e)ia.show({msg:"请输入你的姓名"});else if(s)ia.show({msg:"请选择性别"});else if(i)ia.show({msg:"请输入你的手机号"});else if(o)ia.show({msg:"请输入有效的手机号"});else if(n)ia.show({msg:"请选择地址"});else if(a)ia.show({msg:"请输入门牌号"});else{var c=_t.getRegionBlockCode(),r={regionBlockCode:c,addressId:this.editAddress.addressId,name:this.name,gender:this.gender,phoneNumber:this.phoneNumber,addressName:this.addressName,addressDetailName:this.addressDetailName,addressExtraInfo:this.addressExtraInfo,latitude:this.locationInfo.latitude,longitude:this.locationInfo.longitude,tags:this.tags};br.show(),mt.address.edit({addressInfo:r,regionBlockCode:c}).then(function(e){var s=0===e.data.code;br.hide(),s?(t.$router.go(-1),t.$store.commit("campaignSendExchangeAddress/cleanupEditAddressInfo"),t.$store.commit("campaignSendExchangeAddress/setNeedShowEditAddressSuccessToast",!0)):ia.show({msg:"修改地址信息失败, 请稍后再试"})}).catch(function(t){br.hide(),ia.show({msg:"修改地址信息失败, 请稍后再试"})})}},checkPhoneValid:function(t){return!!/^1\d{10}$/.test(t)},selectMale:function(){this.isSelectMale=!0,this.isSelectFemale=!1,this.gender="MALE"},selectFemale:function(){this.isSelectFemale=!0,this.isSelectMale=!1,this.gender="FEMALE"},selectHome:function(){this.isSelectHome?(this.isSelectHome=!1,this.tags=[]):(this.isSelectHome=!0,this.tags=["家"]),this.isSelectCompany=!1,this.isSelectSchool=!1,this.editAddress.tags=this.tags},selectCompany:function(){this.isSelectCompany?(this.isSelectCompany=!1,this.tags=[]):(this.isSelectCompany=!0,this.tags=["公司"]),this.isSelectHome=!1,this.isSelectSchool=!1,this.editAddress.tags=this.tags},selectSchool:function(){this.isSelectSchool?(this.isSelectSchool=!1,this.tags=[]):(this.isSelectSchool=!0,this.tags=["学校"]),this.isSelectHome=!1,this.isSelectCompany=!1,this.editAddress.tags=this.tags}}},zd=Hd,Wd=(s("d95f"),Object(p["a"])(zd,Ud,jd,!1,null,"20baab58",null)),Gd=Wd.exports,Vd=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shops&&t.oftenShops?s("div",{staticClass:"campagin-shop-list"},[s("div",{staticClass:"campagin-shop-list__search-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchShop,expression:"searchShop"}],staticClass:"campagin-shop-list__search-container__search-bar",attrs:{placeholder:"输入门店名称"},domProps:{value:t.searchShop},on:{input:function(e){e.target.composing||(t.searchShop=e.target.value)}}})]),s("div",{ref:"currentShop",staticClass:"campagin-shop-list__current-shop"},[t._m(0),s("div",{staticClass:"campagin-shop-list__current-shop__item"},[s("div",{staticClass:"campagin-shop-list__current-shop__item__icon-location"}),t.currentAddress?s("div",{staticClass:"campagin-shop-list__current-shop__item__current-address"},[t._v(t._s(t.currentAddress))]):t._e(),s("div",{staticClass:"campagin-shop-list__current-shop__item__refresh-location",on:{click:t.setCurrentAddress}},[t._v("重新定位")])]),s("div",{staticClass:"campagin-shop-list__whitespace"}),t.oftenShops.length>0?[t._m(1),t._l(t.oftenShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e(),s("div",{staticClass:"campagin-shop-list__whitespace"}),t._m(2),t.shops.length>0?t._l(t.nearbyShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})}):t._e()],2)]):t._e()},qd=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campagin-shop-list__current-shop__title-row"},[s("span",{staticClass:"campagin-shop-list__current-shop__title-row__title"},[t._v("当前定位")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campagin-shop-list__my-shops__title-row"},[s("span",{staticClass:"campagin-shop-list__my-shops__title-row__title"},[t._v("常去店铺")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campagin-shop-list__nearby-shops__title-row"},[s("span",{staticClass:"campagin-shop-list__nearby-shops__title-row__title"},[t._v("附近店铺")])])}],Yd=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-item"},[s("div",{staticClass:"shop-item__info"},[s("div",{staticClass:"shop-item__basic-info"},[s("div",{staticClass:"shop-item__shop-name"},[t._v("\n        "+t._s(t.shop.shopName)+"\n        "),t.shop.is24h?s("span",{staticClass:"shop-item__shop-name__24h-mark"},[t._v("24h")]):t._e()]),s("div",{staticClass:"shop-item__shop-address"},[t._v(t._s(t.shop.address))])]),t.shop.distance?s("div",{staticClass:"shop-item__map-info"},[s("div",{staticClass:"shop-item__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.shop.distance)))]),s("div",{staticClass:"shop-item__show-in-map",on:{click:t.openMap}},[t._v("地图 >")])]):t._e()])])},Qd=[],Kd={props:{shop:Object},methods:{openMap:function(){wx.openLocation({latitude:this.shop.latitude,longitude:this.shop.longitude,name:this.shop.shopName,address:this.shop.address})}},filters:{toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},Xd=Kd,Zd=(s("7783"),Object(p["a"])(Xd,Yd,Qd,!1,null,"c555971c",null)),Jd=Zd.exports,tp={components:{ShopItem:Jd},data:function(){return{shops:null,oftenShops:null,currentAddress:null,nearbyShopsLength:10,searchShop:null,currentLocation:null}},created:function(){this.getShopList(),this.fetchOftenShoplist()},mounted:function(){var t=this;He.init().then(function(){t.setCurrentAddress()})},updated:function(){this.$refs.currentShop.addEventListener("scroll",this.handleScroll)},computed:{sortedShopsWithDistance:function(){function t(t){return t*Math.PI/180}function e(e,s,i,n){var a=6371,o=t(i-e),c=t(n-s);e=t(e),i=t(i);var r=Math.sin(o/2)*Math.sin(o/2)+Math.sin(c/2)*Math.sin(c/2)*Math.cos(e)*Math.cos(i),d=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r));return a*d}var s=this.currentLocation;if(s){var i=this.shops.map(function(t){var i=Xt()({},t);return i.distance=e(t.latitude,t.longitude,s.latitude,s.longitude),i});return i.sort(function(t,e){return t.distance-e.distance}),i}return this.shops},filterShops:function(){var t=this;return this.searchShop?this.sortedShopsWithDistance.filter(function(e){return e.shopName.includes(t.searchShop)}):this.sortedShopsWithDistance},currentShop:function(){return this.sortedShopsWithDistance[0]},myShops:function(){return this.sortedShopsWithDistance.slice(1,3)},nearbyShops:function(){return this.filterShops.slice(0,this.nearbyShopsLength)}},methods:{handleScroll:ee.a.debounce(function(){var t=this.$refs.currentShop.scrollTop,e=this.$refs.currentShop.clientHeight,s=this.$refs.currentShop.scrollHeight,i=s<=e+t;i&&(this.nearbyShopsLength+=6)},150),getShopList:function(){var t=this.$route.params.shopUseFlg,e=this.$route.params.shopid,s=_t.getRegionBlockCode(),i=0===t;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](s);this.shops=n?this.$store.getters["shop/shopsForRegion"](s):[]}else{var a=this.$store.state.shop.shops[s];this.shops=ee.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},fetchOftenShoplist:function(){var t=this,e=_t.getRegionBlockCode();$t.show(),mt.shop.fetchOftenShoplist({regionBlockCode:e}).then(function(e){t.oftenShops=e.data.data.slice(0,2),$t.hide()})},setCurrentAddress:function(){var t=this;this.currentAddress=null,ut.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i},He.getAddressByLatLng(s,i).then(function(e){t.currentAddress=e.address})})}}},ep=tp,sp=(s("11f9"),Object(p["a"])(ep,Vd,qd,!1,null,"1eeabde6",null)),ip=sp.exports,np=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"location-picker"},[s("iframe",{ref:"locationPicker",attrs:{width:"100%",height:"100%",frameborder:"0",src:"https://apis.map.qq.com/tools/locpicker?type=1&policy=1&key=QVPBZ-YBMHV-KYMPX-UIXW2-7AM7Z-BNFNU&referer=locator"}})])},ap=[],op={data:function(){return{chosenAddressName:null}},created:function(){var t=this;He.init().then(function(){t.initQQMapLocationPicker()})},methods:{initQQMapLocationPicker:function(){window.addEventListener("message",this.handleLocationChange,!1)},handleLocationChange:function(t){var e=this,s=t.data;if(s&&"locationPicker"==s.module){var i="我的位置"===s.poiname;i?He.getAddressByLatLng(s.latlng.lat,s.latlng.lng).then(function(t){var s=t.nearPois[0];e.chosenAddressName=s,e.hideLocationPicker()}):(this.chosenAddressName=s.poiname,this.hideLocationPicker());var n=this.$store.state.campaignSendExchangeAddress.editAddressInfo,a=n.name,o=n.gender,c=n.phoneNumber,r=this.chosenAddressName,d=s.poiaddress,p=n.addressExtraInfo,l=n.addressId,u=n.tags,_={name:a,gender:o,phoneNumber:c,addressName:r,addressDetailName:d,addressExtraInfo:p,addressId:l,tags:u,latitude:s.latlng.lat,longitude:s.latlng.lng};this.$store.commit("campaignSendExchangeAddress/setEditAddressInfo",_),this.$router.back(),window.removeEventListener("message",this.handleLocationChange,!1)}},hideLocationPicker:function(){var t=this.$refs.locationPicker;t.focus(),t.blur(),window.removeEventListener("message",this.handleLocationChange,!1)}}},cp=op,rp=(s("5269"),Object(p["a"])(cp,np,ap,!1,null,"922e2b14",null)),dp=rp.exports,pp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"location-picker"},[s("iframe",{ref:"locationPicker",attrs:{width:"100%",height:"100%",frameborder:"0",src:"https://apis.map.qq.com/tools/locpicker?type=1&policy=1&key=QVPBZ-YBMHV-KYMPX-UIXW2-7AM7Z-BNFNU&referer=locator"}})])},lp=[],up={data:function(){return{chosenAddressName:null}},created:function(){this.initQQMapLocationPicker()},methods:{initQQMapLocationPicker:function(){window.addEventListener("message",this.handleLocationChange,!1)},handleLocationChange:function(t){var e=this,s=t.data;if(s&&"locationPicker"==s.module){var i="我的位置"===s.poiname;i?qqLbsService.getAddressByLatLng(s.latlng.lat,s.latlng.lng).then(function(t){var s=t.nearPois[0];e.chosenAddressName=s,e.hideLocationPicker()}):(this.chosenAddressName=s.poiname,this.hideLocationPicker());var n=this.$store.state.campaignSendExchangeAddress.addAddressInfo,a=n.name,o=n.gender,c=n.phoneNumber,r=this.chosenAddressName,d=s.poiaddress,p=n.addressExtraInfo,l=n.tags,u={name:a,gender:o,phoneNumber:c,addressName:r,addressDetailName:d,addressExtraInfo:p,tags:l,latitude:s.latlng.lat,longitude:s.latlng.lng};this.$store.commit("campaignSendExchangeAddress/setAddAddressInfo",u),this.$router.back()}},hideLocationPicker:function(){var t=this.$refs.locationPicker;t.focus(),t.blur(),window.removeEventListener("message",this.handleLocationChange,!1)}}},_p=up,mp=(s("81e0"),Object(p["a"])(_p,pp,lp,!1,null,"62cdb60c",null)),hp=mp.exports,gp=[{path:"/campaign-list-view",name:"campaign-list-view",component:hc,meta:{title:"集点列表"}},{path:"/campaign-detail/:campaignId",name:"campaign-detail",component:kr,meta:{title:"集点详情"}},{path:"/campaign-products/:campaignId",name:"campaign-products",component:Pr,meta:{title:"集点商品"}},{path:"/campaign-post-exchange",name:"campaign-post-exchange",component:Fr,meta:{title:"集点兑换"}},{path:"/campaign-post-exchange/choose-address",name:"campaign-post-exchange/choose-address",component:Kr,meta:{title:"选择地址"}},{path:"/campaign-post-exchange/add-address",name:"campaign-post-exchange/add-address",component:sd,meta:{title:"新增地址"}},{path:"/campaign-post-exchange/edit-address",name:"campaign-post-exchange/edit-address",component:rd,meta:{title:"编辑地址"}},{path:"/campaign-post-exchange/add-address/location-picker",name:"campaign-post-exchange/add-address/location-picker",component:md,meta:{title:"新增地址"}},{path:"/campaign-post-exchange/edit-address/location-picker",name:"campaign-post-exchange/edit-address/location-picker",component:yd,meta:{title:"编辑地址"}},{path:"/campaign-send-address/:campaignId",name:"campaign-express-address",component:Md,meta:{title:"寄送地址"}},{path:"/campaign-post-exchanged",name:"campaign-post-exchanged",component:Wr,meta:{title:"已兑换"}},{path:"/campaign-send-choose-address/:userGiftId",name:"campaign-choose-address",component:Td,meta:{title:"选择地址"}},{path:"/campaign-Available-shop-list",name:"campaign-Available-shop-list",component:ip,meta:{title:"适用门店"}},{path:"/campaign-send-exchange/add-address",name:"campaign-send-exchange/add-address",component:Bd,meta:{title:"编辑地址"}},{path:"/campaign-send-exchange/edit-address",name:"campaign-send-exchange/edit-address",component:Gd,meta:{title:"编辑地址"}},{path:"/campaign-send-exchange/edit-address/location-picker",name:"campaign-send-exchange/edit-address/location-picker",component:dp,meta:{title:"编辑地址"}},{path:"/campaign-send-exchange/add-address/location-picker",name:"campaign-send-exchange/add-address/location-picker",component:hp,meta:{title:"新增地址"}}],vp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null===t.missions?s("div",{staticClass:"mission-center-loading"}):s("div",{staticClass:"mission-center"},[s("div",{staticClass:"mission-center__content"},[s("div",{staticClass:"mission-center__content__background"}),s("div",{staticClass:"mission-center__content__rule",on:{click:t.gotoRule}},[s("span",{staticClass:"mission-center__content__rule__text"},[t._v("活动规则")]),s("span",{staticClass:"mission-center__content__rule__question-mark"})]),null!==t.userGroupInfo?s("div",{staticClass:"mission-center__content__misc"},[s("div",{staticClass:"mission-center__content__misc__avatar"},[s("img",{attrs:{src:t.avatarUrl}})]),s("div",{staticClass:"mission-center__content__misc__checkin-count"},[s("p",{staticClass:"mission-center__content__misc__checkin-count__number"},[t._v(t._s(t.userGroupInfo.continusDays))]),s("p",{staticClass:"mission-center__content__misc__checkin-count__title"},[t._v("签到")])]),s("div",{staticClass:"mission-center__content__misc__lottery-coin-count"},[s("p",{staticClass:"mission-center__content__misc__lottery-coin-count__number"},[t._v(t._s(t.userGroupInfo.ticketNum))]),s("p",{staticClass:"mission-center__content__misc__lottery-coin-count__title"},[t._v("抽奖币")])]),s("div",{staticClass:"mission-center__content__misc__go-to-lottery"},[s("button",{staticClass:"mission-center__content__misc__go-to-lottery__button",on:{click:t.gotoLottery}},[t._v("去抽奖")])])]):t._e(),null!==t.missions?s("div",{staticClass:"mission-center__content__weekly-missions"},[s("div",{staticClass:"mission-center__content__weekly-missions__title"}),s("div",{staticClass:"mission-center__content__weekly-missions__come-to-shop-mission"},[s("come-to-shop-mission",{attrs:{mission:t.comeToShopMission}})],1),s("div",{staticClass:"mission-center__content__weekly-missions__purchase-amount-mission"},[s("purchase-amount-mission",{attrs:{mission:t.purchaseAmountMission}})],1)]):t._e(),null!==t.missions?s("div",{staticClass:"mission-center__content__other-missions"},[s("div",{staticClass:"mission-center__content__other-missions__title"}),t._l(t.otherMissions,function(t){return s("div",{staticClass:"mission-center__content__other-missions__mission-item"},[s("other-mission",{attrs:{mission:t}})],1)})],2):t._e(),s("div",{staticClass:"mission-center__content__data-refresh-hint"},[t._v("数据可能会有延迟，24小时内更新")])]),s("transition",{attrs:{name:"fade"}},[null!==t.pickedResult?s("div",{staticClass:"mission-center__pick-result-modal"},[s("div",{staticClass:"mission-center__pick-result-modal__icon"}),s("p",{staticClass:"mission-center__pick-result-modal__text"},[t._v("任务已完成")]),s("p",{staticClass:"mission-center__pick-result-modal__text"},[t._v(t._s(t.pickedResultText))])]):t._e()])],1)},fp=[],Cp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"other-mission"},[s("div",{staticClass:"other-mission__icon"},[s("img",{attrs:{src:t.missionIconUrl}})]),s("div",{staticClass:"other-mission__info"},[s("div",{staticClass:"other-mission__info__title-and-reward"},[s("span",{staticClass:"other-mission__info__title-and-reward__title"},[t._v(t._s(t.mission.missionName))]),"point"===t.missionRewardType?s("span",{staticClass:"other-mission__info__title-and-reward__reward"},[t._v("+"+t._s(t.mission.lotteryPoint)+"积分")]):"coupon"===t.missionRewardType?s("span",{staticClass:"other-mission__info__title-and-reward__reward"},[t._v("+1礼券")]):"lotteryCoin"===t.missionRewardType?s("span",{staticClass:"other-mission__info__title-and-reward__reward"},[t._v("+"+t._s(t.mission.lotteryTicketNum)+"抽奖币")]):t._e()]),s("div",{staticClass:"other-mission__info__description"},[t._v(t._s(t.mission.missionContent))])]),s("div",{staticClass:"other-mission__right"},[2===t.mission.receiveFlg&&"firstRedeemPoint"!==t.missionType&&"firstPurchaseDiscountCommodity"!==t.missionType?s("button",{on:{click:t.gotoMission}},[t._v("去完成")]):1===t.mission.receiveFlg?s("div",[t._v("已达成")]):t._e()])])},yp=[],bp={getMissionType:function(t){return 0===t.missionType?"comeToShopWeekly":1===t.missionType?"comeToShopMonthly":2===t.missionType?"purchaseAmountWeekly":3===t.missionType?"purchaseAmountMonthly":4===t.missionType?"firstGotStamp":5===t.missionType?"firstGotCampaignReward":6===t.missionType?"firstPurchaseAnyCommodity":7===t.missionType?"firstPurchaseDiscountCommodity":8===t.missionType?"firstRedeemPoint":9===t.missionType?"firstPurchaseAnyCommodityByNewUser":void 0},getMissionRewardType:function(t){return 0===t.lotteryType?"point":1===t.lotteryType?"coupon":2===t.lotteryType?"lotteryCoin":void 0},getMissionIconUrl:function(t){var e="http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new";return 4===t.missionType?e+"/mission-center/head.png":5===t.missionType?e+"/mission-center/coupon.png":6===t.missionType?e+"/mission-center/shopping-bag.png":7===t.missionType?e+"/mission-center/diamond.png":8===t.missionType?e+"/mission-center/exchange.png":9===t.missionType?e+"/mission-center/shopping-bag.png":void 0},getGotoMissionHandler:function(t){return 4===t.missionType?function(){return console.log("去集点")}:5===t.missionType?function(){return console.log("去兑换集点")}:6===t.missionType?function(){return console.log("去预约购买")}:7===t.missionType?function(){return console.log("去会员价格商品")}:8===t.missionType?function(){return console.log("去积分商城")}:9===t.missionType?function(){return console.log("去会员价格商品")}:void 0}},wp={props:{mission:Object},computed:{missionIconUrl:function(){return bp.getMissionIconUrl(this.mission)},missionRewardType:function(){return bp.getMissionRewardType(this.mission)},missionType:function(){return bp.getMissionType(this.mission)}},methods:{gotoMission:function(){var t=this.missionType;switch(t){case"firstGotStamp":this.gotoCampaign();break;case"firstGotCampaignReward":this.gotoCampaign();break;case"firstPurchaseAnyCommodity":this.backToHomepage();break;case"firstPurchaseAnyCommodityByNewUser":this.backToHomepage();break;default:throw"unknown mission type"}},gotoCampaign:function(){this.$router.push("/campaign-list-view")},backToHomepage:function(){wx.miniProgram.switchTab({url:"/pages/homepage/homepage"})}}},Sp=wp,Dp=(s("79e50"),Object(p["a"])(Sp,Cp,yp,!1,null,"07d891f6",null)),kp=Dp.exports,xp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"come-to-shop-mission"},[s("div",{staticClass:"come-to-shop-mission__corner-circle"}),s("div",{staticClass:"come-to-shop-mission__corner-icon"}),1===t.mission.receiveFlg?s("div",{staticClass:"come-to-shop-mission__before-mission-complete-hint"},[t._v("已成功领取奖励 "+t._s(t.pickedType)+" "),s("span",[t._v(t._s(t.pickedCount))])]):s("div",{staticClass:"come-to-shop-mission__before-mission-complete-hint"},[t._v("还差到店 "),s("span",[t._v(t._s(t.beforeMissionCompleteComeToShopCount))]),t._v(" 次即可领取奖励，加油~")]),s("div",{staticClass:"come-to-shop-mission__requirement-hint"},[t._v("本周到店达到"+t._s(t.mission.visitsNumber)+"次即可获得奖励")]),s("div",{staticClass:"come-to-shop-mission__progress-bar"},[s("mission-progress-bar-discrete",{attrs:{total:t.mission.visitsNumber,current:t.mission.userComeShopTimes}})],1)])},Tp=[],Ip=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mission-progress-bar-discrete"},[s("div",{staticClass:"mission-progress-bar-discrete__sections"},[s("div",{staticClass:"mission-progress-bar-discrete__sections__complete",style:{"flex-grow":t.current}}),s("div",{staticClass:"mission-progress-bar-discrete__sections__incomplete",style:{"flex-grow":t.left}})]),s("div",{staticClass:"mission-progress-bar-discrete__milestones"},[t._l(t.total,function(e){return[e-1<=t.current?s("div",{staticClass:"mission-progress-bar-discrete__milestones__milestone complete"},[t._v(t._s(e-1))]):s("div",{staticClass:"mission-progress-bar-discrete__milestones__milestone"},[t._v(t._s(e-1))])]}),s("div",{staticClass:"mission-progress-bar-discrete__milestones__end",class:{"with-check":t.current===t.total}})],2)])},Ap=[],Np={props:{total:Number,current:Number},computed:{left:function(){return this.total-this.current}}},Pp=Np,Lp=(s("41fa"),Object(p["a"])(Pp,Ip,Ap,!1,null,"49449fee",null)),Mp=Lp.exports,Ep={components:{MissionProgressBarDiscrete:Mp},props:{mission:Object},computed:{beforeMissionCompleteComeToShopCount:function(){return this.mission.visitsNumber-this.mission.userComeShopTimes},pickedType:function(){var t=bp.getMissionRewardType(this.mission);return"point"===t?"积分":"coupon"===t?"礼券":"lotteryCoin"===t?"抽奖币":void 0},pickedCount:function(){var t=bp.getMissionRewardType(this.mission);return"point"===t?"+".concat(this.mission.lotteryPoint):"coupon"===t?"+1":"lotteryCoin"===t?"+".concat(this.mission.lotteryTicketNum):void 0}}},$p=Ep,Op=(s("a087"),Object(p["a"])($p,xp,Tp,!1,null,"59827885",null)),Rp=Op.exports,Fp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"purchase-amount-mission"},[s("div",{staticClass:"purchase-amount-mission__corner-circle"}),s("div",{staticClass:"purchase-amount-mission__corner-icon"}),1===t.mission.receiveFlg?s("div",{staticClass:"purchase-amount-mission__before-mission-complete-hint"},[t._v("已成功领取奖励 "+t._s(t.pickedType)+" "),s("span",[t._v(t._s(t.pickedCount))])]):s("div",{staticClass:"purchase-amount-mission__before-mission-complete-hint"},[t._v("还差消费 "),s("span",[t._v(t._s(t.beforeMissionCompletePurchaseAmount))]),t._v(" 元即可领取奖励，加油~")]),s("div",{staticClass:"purchase-amount-mission__requirement-hint"},[t._v("本周消费"+t._s(t.mission.visitsConsumptionAmount)+"元即可获得奖励")]),s("div",{staticClass:"purchase-amount-mission__progress-bar"},[s("mission-progress-bar",{attrs:{total:t.mission.visitsConsumptionAmount,current:t.mission.userPurchaseAmount}})],1)])},Bp=[],Up=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mission-progress-bar"},[s("div",{staticClass:"mission-progress-bar__sections"},[s("div",{staticClass:"mission-progress-bar__sections__complete",style:{"flex-grow":t.current}}),s("div",{staticClass:"mission-progress-bar__sections__incomplete",style:{"flex-grow":t.left}})]),s("div",{staticClass:"mission-progress-bar__milestones"},[s("div",{staticClass:"mission-progress-bar__milestones__milestone complete"},[t._v("0")]),s("div",{staticClass:"mission-progress-bar__milestones__end",class:{"with-check":t.current===t.total}})]),t.current!==t.total?s("div",{staticClass:"mission-progress-bar__current-milestone",style:{left:t.current/t.total*100+"%"}},[s("div",[t._v(t._s(t.current))])]):t._e()])},jp=[],Hp={props:{total:Number,current:Number},computed:{left:function(){return this.total-this.current}}},zp=Hp,Wp=(s("a203"),Object(p["a"])(zp,Up,jp,!1,null,"74874d43",null)),Gp=Wp.exports,Vp={components:{MissionProgressBar:Gp},props:{mission:Object},computed:{beforeMissionCompletePurchaseAmount:function(){return this.mission.visitsConsumptionAmount-this.mission.userPurchaseAmount},pickedType:function(){var t=bp.getMissionRewardType(this.mission);return"point"===t?"积分":"coupon"===t?"礼券":"lotteryCoin"===t?"抽奖币":void 0},pickedCount:function(){var t=bp.getMissionRewardType(this.mission);return"point"===t?"+".concat(this.mission.lotteryPoint):"coupon"===t?"+1":"lotteryCoin"===t?"+".concat(this.mission.lotteryTicketNum):void 0}}},qp=Vp,Yp=(s("8e19"),Object(p["a"])(qp,Fp,Bp,!1,null,"49680306",null)),Qp=Yp.exports,Kp={components:{OtherMission:kp,ComeToShopMission:Rp,PurchaseAmountMission:Qp},data:function(){return{missions:null,userGroupInfo:null,avatarUrl:_t.getUserInfo().basic.photo,pickedResult:null}},computed:{comeToShopMission:function(){return this.missions.find(function(t){return"comeToShopWeekly"===bp.getMissionType(t)})},purchaseAmountMission:function(){return this.missions.find(function(t){return"purchaseAmountWeekly"===bp.getMissionType(t)})},otherMissions:function(){return this.missions.filter(function(t){var e=["comeToShopWeekly","purchaseAmountWeekly","comeToShopMonthly","purchaseAmountMonthly"],s=bp.getMissionType(t);return e.indexOf(s)<0})},pickedResultText:function(){var t=bp.getMissionRewardType(this.pickedResult);return"point"===t?"积分+".concat(this.pickedResult.lotteryPoint):"coupon"===t?"礼券+1":"lotteryCoin"===t?"抽奖币+".concat(this.pickedResult.lotteryTicketNum):void 0}},methods:{gotoRule:function(){this.$router.push("/mission-center/rule")},gotoLottery:function(){this.$router.replace("/lottery")},fetchUserGroupInfo:function(){var t=this,e=_t.getRegionBlockCode();mt.user.fetchUserGroupInfo({regionBlockCode:e}).then(function(e){t.userGroupInfo=e})}},created:function(){var t=this,e=_t.getRegionBlockCode();this.fetchUserGroupInfo(),mt.mission.fetchMissions({regionBlockCode:e}).then(function(){var s=Object(C["a"])(regeneratorRuntime.mark(function s(i){var n,a,o,c,r;return regeneratorRuntime.wrap(function(s){while(1)switch(s.prev=s.next){case 0:if(t.missions=i,n=t.missions.filter(function(t){return 0===t.receiveFlg}),!(n.length>0)){s.next=19;break}a=0;case 4:if(!(a<n.length)){s.next=18;break}return o=n[a],s.next=8,mt.mission.pickReward({missionHistoryId:o.missionHistoryId});case 8:return c=s.sent,t.pickedResult=c,t.fetchUserGroupInfo(),r=new f.a(function(t){setTimeout(function(){t()},3e3)}),s.next=14,r;case 14:t.pickedResult=null;case 15:a++,s.next=4;break;case 18:mt.mission.fetchMissions({regionBlockCode:e}).then(function(e){t.missions=e});case 19:case"end":return s.stop()}},s)}));return function(t){return s.apply(this,arguments)}}())}},Xp=Kp,Zp=(s("2dbc"),Object(p["a"])(Xp,vp,fp,!1,null,"dec08b8c",null)),Jp=Zp.exports,tl=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},el=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rule"},[s("p",[t._v("1. 活动时间：2018年1月25日—2018年2月9日（在活动时间内，活动资源送完则活动自动结束）；")]),s("p",[t._v("2. 参与方式：在“浙江移动”微信公众号中回复“福袋”关键字；")]),s("p",[t._v("3. 活动规则：用户在活动期间参与活动，可通过本人参与、受邀、邀请好友三种方式参与活动，每个手机号累计最多获得11个福袋。")]),s("p",[t._v("（1）首次发起邀请成功，无论对方是否接受邀请，发起人均可获得1个福袋。")]),s("p",[t._v("（2）每次被邀请人接受邀请，发起人和被邀请人双方各自可获得1个福袋。双方可互相邀请，均可以发起人和被发起人的身份各自获得1个福袋，但一方重复接受另一方的邀请，只为双方赠送1个福袋。")]),s("p",[t._v("同一被邀请人接受多个发起人的邀请，均可获赠福袋，但单个手机号码累计获得以11个福袋为上限，之后再发起或接受邀请均不再享受。")])])}],sl={},il=sl,nl=(s("f948"),Object(p["a"])(il,tl,el,!1,null,"5643598a",null)),al=nl.exports,ol=[{path:"/mission-center",name:"mission-center",component:Jp,meta:{title:"任务中心"}},{path:"/mission-center/rule",name:"mission-center/rule",component:al,meta:{title:"活动规则"}}],cl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lottery"},[s("div",{staticClass:"lottery__gachapon"},[s("div",{staticClass:"lottery__gachapon__background"}),s("div",{staticClass:"lottery__gachapon__logo",style:{"background-image":"url("+t.logoImgUrl+")"}}),s("div",{staticClass:"lottery__gachapon__capsules"},[null!==t.capsules&&null!==t.capsulePhysicsInfo?s("div",{staticClass:"lottery__gachapon__capsules__wrapper"},t._l(t.capsules,function(e,i){return s("capsule",{key:i,attrs:{capsule:e,x:t.capsulePhysicsInfo[i].x,y:t.capsulePhysicsInfo[i].y,r:t.capsulePhysicsInfo[i].r}})}),1):t._e()]),s("div",{staticClass:"lottery__gachapon__collected-count"},[t._v(t._s(t.collectedCapsulesCount))]),null!==t.collectedCapsules?s("div",{staticClass:"lottery__gachapon__collected"},t._l(t.collectedCapsules,function(t){return s("div",{staticClass:"lottery__gachapon__collected__capsule",class:t.color})}),0):t._e(),s("div",{staticClass:"lottery__gachapon__goto-collected",on:{click:t.gotoCollected}}),t._m(0),null!==t.droppedCapsule?s("div",{staticClass:"lottery__gachapon__dropped-capsule",class:t.droppedCapsule.color}):t.tryDroppedCapsuleVisible?s("div",{staticClass:"lottery__gachapon__try-dropped-capsule blue"}):t._e(),t.isFetchingResult?s("div",{staticClass:"lottery__gachapon__knob rotating"}):t.isFetchingLotteryDetail?s("div",{staticClass:"lottery__gachapon__knob"}):s("div",{staticClass:"lottery__gachapon__knob",on:{click:t.startGachapon}}),s("div",{staticClass:"lottery__gachapon__current-mode-selection-wrapper",style:{left:t.currentModeSelectionWrapperLeft}}),s("div",{staticClass:"lottery__gachapon__mode try",on:{click:t.useModeTry}},[s("p",{staticClass:"lottery__gachapon__mode__title try",class:{selected:"try"===t.currentMode}},[t._v("试一试")]),s("p",{staticClass:"lottery__gachapon__mode__subtitle try",class:{selected:"try"===t.currentMode}},[t._v("免费试手气")])]),s("div",{staticClass:"lottery__gachapon__mode once",on:{click:t.useModeOnce}},[s("p",{staticClass:"lottery__gachapon__mode__title once",class:{selected:"once"===t.currentMode}},[t._v("扭一次")]),s("p",{staticClass:"lottery__gachapon__mode__subtitle once",class:{selected:"once"===t.currentMode}},[t._v(t._s(t.lotteryCoinForOneTrial)+"抽奖币")])]),s("div",{staticClass:"lottery__gachapon__mode three-times",on:{click:t.useModeThreeTimes}},[s("p",{staticClass:"lottery__gachapon__mode__title three-times",class:{selected:"threeTimes"===t.currentMode}},[t._v("扭三次")]),s("p",{staticClass:"lottery__gachapon__mode__subtitle three-times",class:{selected:"threeTimes"===t.currentMode}},[t._v(t._s(3*t.lotteryCoinForOneTrial)+"抽奖币")])]),s("div",{staticClass:"lottery__gachapon__goto-mission-center",on:{click:t.gotoMissionCenter}}),s("div",{staticClass:"lottery__gachapon__lottery-coin-count"},[t._v(t._s(t.lotteryCoinCount))])]),s("div",{staticClass:"lottery__rules"},[s("div",{staticClass:"lottery__rules__wrapper"},[t._m(1),s("p",{staticClass:"lottery__rules__wrapper__rule"},[t._v("❶ 每次抽奖都消耗"+t._s(t.lotteryCoinForOneTrial)+"枚抽奖币，每个用户每天最多抽奖"+t._s(t.maxLotteryTimeForOneDay)+"次")]),s("p",{staticClass:"lottery__rules__wrapper__rule"},[t._v("❷ 每次扭蛋都可以获得一个随机颜色的蛋壳，蛋壳颜色共3种")]),t._m(2),t._m(3),t._m(4)])]),t.gachaponResultVisible?s("div",{staticClass:"lottery__result-modal"},[s("div",{staticClass:"lottery__result-modal__mask"}),s("div",{staticClass:"lottery__result-modal__spark-left"}),s("div",{staticClass:"lottery__result-modal__spark-right"}),s("div",{staticClass:"lottery__result-modal__opened-capsule-right",class:t.droppedCapsule.color}),s("div",{staticClass:"lottery__result-modal__opened-capsule-left",class:t.droppedCapsule.color}),s("div",{staticClass:"lottery__result-modal__wrapper"},[null===t.droppedCapsule.reward?s("div",{staticClass:"lottery__result-modal__wrapper__reward-icon empty"}):s("div",{staticClass:"lottery__result-modal__wrapper__reward-icon",class:t.droppedCapsule.reward.type}),null===t.droppedCapsule.reward?s("div",{staticClass:"lottery__result-modal__wrapper__reward-title"},[t._v("这个扭蛋是空的")]):"coupon"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-title"},[t._v(t._s(t.droppedCapsule.reward.title))]):"point"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-title"},[t._v("赠送积分 "),s("span",[t._v("+"+t._s(t.droppedCapsule.reward.pointCount))])]):"lotteryCoin"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-title"},[t._v("赠送抽奖币 "),s("span",[t._v("+"+t._s(t.droppedCapsule.reward.lotteryCoinCount))])]):t._e(),null===t.droppedCapsule.reward?s("div",{staticClass:"lottery__result-modal__wrapper__reward-subtitle"},[t._v("加油，说不定下一次就是大奖哦")]):"coupon"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-subtitle"},[t._v("详情可至“优惠券”查看")]):"point"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-subtitle"},[t._v("请下载并安装APP，可至我的查看")]):"lotteryCoin"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-subtitle"},[t._v("已经收入你的帐户，可至任务中心查看")]):t._e()]),t.trialLeft>0?s("button",{staticClass:"lottery__result-modal__try-again",on:{click:t.continueGachapon}},[t._v("继续")]):s("button",{staticClass:"lottery__result-modal__try-again",on:{click:t.hideGachaponResult}},[t._v("去扭蛋")])]):t.gachaponTryResultVisible?s("div",{staticClass:"lottery__try-result-modal"},[s("div",{staticClass:"lottery__try-result-modal__mask"}),s("div",{staticClass:"lottery__try-result-modal__spark-left"}),s("div",{staticClass:"lottery__try-result-modal__spark-right"}),s("div",{staticClass:"lottery__try-result-modal__opened-capsule-right blue"}),s("div",{staticClass:"lottery__try-result-modal__opened-capsule-left blue"}),t._m(5),s("button",{staticClass:"lottery__result-modal__try-again",on:{click:t.hideGachaponTryResult}},[t._v("去扭蛋")])]):t._e(),t.lotteryCoinNotEnoughModalVisible?s("div",{staticClass:"lottery__lottery-coin-not-enough-modal"},[s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__mask"}),s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__wrapper"},[s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__wrapper__close",on:{click:t.hideLotteryCoinNotEnoughModal}}),s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__wrapper__icon"}),s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__wrapper__title"},[t._v("余额不足")]),s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__wrapper__subtitle"},[t._v("剩余："+t._s(t.lotteryCoinCount)+"抽奖币")])]),s("button",{staticClass:"lottery__lottery-coin-not-enough-modal__get-lottery-coin",on:{click:t.getLotteryCoin}},[t._v("获取抽奖币")])]):t._e()])},rl=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lottery__gachapon__broadcast"},[s("div",[s("span",[t._v("133****0000获得草莓8折券一张🎉")]),s("span",[t._v("138****0000获得草莓7折券一张🎉")]),s("span",[t._v("139****0000获得草莓6折券一张🎉")]),s("span",[t._v("131****0000获得草莓5折券一张🎉")]),s("span",[t._v("135****0000获得草莓4折券一张🎉")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"lottery__rules__wrapper__title"},[s("span",{staticClass:"lottery__rules__wrapper__title__left-bar"}),s("span",{staticClass:"lottery__rules__wrapper__title__text"},[t._v("游戏说明")]),s("span",{staticClass:"lottery__rules__wrapper__title__right-bar"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"lottery__rules__wrapper__capsule-intro"},[s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__capsule red"}),s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__text"},[t._v("红色扭蛋 会随机出现优惠券")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"lottery__rules__wrapper__capsule-intro"},[s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__capsule blue"}),s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__text"},[t._v("蓝色扭蛋 会随机出现会员积分")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"lottery__rules__wrapper__capsule-intro"},[s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__capsule yellow"}),s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__text"},[t._v("黄色扭蛋 会随机出现抽奖币")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lottery__try-result-modal__wrapper"},[s("div",{staticClass:"lottery__try-result-modal__wrapper__reward-icon try-success"}),s("div",{staticClass:"lottery__try-result-modal__wrapper__reward-title"},[t._v("免费尝试成功")]),s("div",{staticClass:"lottery__try-result-modal__wrapper__reward-subtitle"},[t._v("马上去实践吧，试试运气呦~~")])])}],dl=s("b8bf"),pl={namespaced:!0,state:{collectedCapsules:[]},getters:{collectedCapsulesCount:function(t){return t.collectedCapsules.length},collectedCapsulesFirstThree:function(t){return t.collectedCapsules.slice(0,3)}},mutations:{resetCollectedCapsules:function(t){t.collectedCapsules=[]},addCollectedCapsule:function(t,e){t.collectedCapsules.push(e)}}},ll=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"capsule",class:t.capsule.color,style:t.transforms},[t.capsule.logo?s("img",{staticClass:"capsule__logo",attrs:{src:t.capsule.logo}}):t._e()])},ul=[],_l={props:{capsule:Object,x:Number,y:Number,r:Number},computed:{transforms:function(){return{left:100*this.x+"%",top:100*this.y+"%",transform:"rotate(".concat(this.r,"rad)")}}}},ml=_l,hl=(s("6d4b"),Object(p["a"])(ml,ll,ul,!1,null,"fb1e3faa",null)),gl=hl.exports,vl={components:{Capsule:gl},data:function(){return{logoImgUrl:null,lotteryCoinCount:null,lotteryId:null,lotteryCoinForOneTrial:null,maxLotteryTimeForOneDay:null,currentMode:"try",trialLeft:0,isFetchingResult:!1,capsules:null,lotteryHistory:null,gachaponResultVisible:!1,gachaponTryResultVisible:!1,lotteryCoinNotEnoughModalVisible:!1,droppedCapsule:null,tryDroppedCapsuleVisible:!1,capsulePhysicsInfo:null,circles:[]}},computed:{currentModeSelectionWrapperLeft:function(){return"try"===this.currentMode?"18vw":"once"===this.currentMode?"39vw":"threeTimes"===this.currentMode?"60vw":void 0},isFetchingLotteryDetail:function(){return null===this.lotteryId},collectedCapsules:function(){return this.$store.getters["lottery/collectedCapsulesFirstThree"]},collectedCapsulesCount:function(){return this.$store.getters["lottery/collectedCapsulesCount"]}},methods:{gotoCollected:function(){this.$router.push("/lottery/collected")},gotoMissionCenter:function(){this.$router.replace("/mission-center")},useModeTry:function(){this.currentMode="try"},useModeOnce:function(){this.currentMode="once"},useModeThreeTimes:function(){this.currentMode="threeTimes"},getLotteryCoin:function(){this.lotteryCoinNotEnoughModalVisible=!1,this.$router.replace("/mission-center")},startGachapon:function(){"try"===this.currentMode?(this.trialLeft=0,this.startGachaponForTry()):"once"===this.currentMode?this.lotteryCoinCount>=this.lotteryCoinForOneTrial?(this.trialLeft=0,this.startGachaponForOnce()):this.showLotteryCoinNotEnoughModal():"threeTimes"===this.currentMode&&(this.lotteryCoinCount>=3*this.lotteryCoinForOneTrial?(this.trialLeft=2,this.startGachaponForOnce()):this.showLotteryCoinNotEnoughModal())},startGachaponForTry:function(){var t=this;this.isFetchingResult=!0;var e=setInterval(function(){t.circles.forEach(function(t){dl["Body"].applyForce(t,t.position,dl["Vector"].create(0,-.002))})},500);setTimeout(function(){clearInterval(e),t.isFetchingResult=!1,t.showGachaponTryResult()},3e3)},startGachaponForOnce:function(){var t=this;this.isFetchingResult=!0;var e=setInterval(function(){t.circles.forEach(function(t){dl["Body"].applyForce(t,t.position,dl["Vector"].create(0,-.002))})},500);this.fetchGachaponResult().then(function(s){clearInterval(e),t.isFetchingResult=!1,t.$store.commit("lottery/addCollectedCapsule",s),t.showGachaponResult(s)}).catch(function(s){clearInterval(e),t.isFetchingResult=!1,"reachMaxLotteryTimeForOneDay"===s?Me.alert({msg:"今日抽奖次数已达上限，明天再来哦"}):"rewardNoRemaining"===s&&Me.alert({msg:"奖品发光了，下次早点来哦"})})},continueGachapon:function(){this.fetchLotteryDetail(),this.hideGachaponResult(),this.trialLeft--,this.startGachaponForOnce()},showGachaponResult:function(t){this.droppedCapsule=t,this.gachaponResultVisible=!0},showGachaponTryResult:function(){this.tryDroppedCapsuleVisible=!0,this.gachaponTryResultVisible=!0},hideGachaponResult:function(){this.fetchLotteryDetail(),this.gachaponResultVisible=!1,this.droppedCapsule=null},hideGachaponTryResult:function(){this.tryDroppedCapsuleVisible=!1,this.gachaponTryResultVisible=!1},showLotteryCoinNotEnoughModal:function(){this.lotteryCoinNotEnoughModalVisible=!0},hideLotteryCoinNotEnoughModal:function(){this.lotteryCoinNotEnoughModalVisible=!1},getCapsulesWithLogos:function(t){for(var e=["yellow","blue","red"],s=10,i=[],n=0;n<s;n++){var a={color:ee.a.sample(e),logo:ee.a.sample(t)};i.push(a)}return i},getCollectedCapsules:function(t){return t.filter(function(t){var e=[0,1,2],s=e.indexOf(t.lotteryType)>-1;return s}).map(function(t){var e=function(){return 0===t.lotteryType?"point":1===t.lotteryType?"coupon":2===t.lotteryType?"lotteryCoin":void 0}();return"point"===e?{color:"blue"}:"coupon"===e?{color:"red"}:"lotteryCoin"===e?{color:"yellow"}:void 0})},fetchLotteryDetail:function(){var t=this;return new f.a(function(e,s){var i=_t.getRegionBlockCode();mt.lottery.fetchLotteryDetail({regionBlockCode:i}).then(function(s){t.lotteryId=s.lotteryId,t.lotteryCoinCount=s.userTicketNum,t.lotteryCoinForOneTrial=s.lotteryCouponCount,t.maxLotteryTimeForOneDay=s.lotteryTimes,t.logoImgUrl=s.bigLogo,t.capsules=t.getCapsulesWithLogos(s.smallLogoArr),e()})})},fetchGachaponResult:function(){var t=this;return new f.a(function(e,s){var i=_t.getRegionBlockCode();mt.lottery.startLottery({lotteryId:t.lotteryId,regionBlockCode:i}).then(function(t){var s=3===t.lotteryType;if(s)e({color:"blue",reward:null});else{var i=function(){return 0===t.lotteryType?"point":1===t.lotteryType?"coupon":2===t.lotteryType?"lotteryCoin":void 0}();"point"===i?e({color:"blue",reward:{type:"point",pointCount:t.lotteryNum}}):"coupon"===i?e({color:"red",reward:{type:"coupon",title:t.lotteryName}}):"lotteryCoin"===i&&e({color:"yellow",reward:{type:"lotteryCoin",lotteryCoinCount:t.lotteryNum}})}}).catch(function(t){var e="26004"===t.data.errors[0].code,i="26003"===t.data.errors[0].code;s(e?"rewardNoRemaining":i?"reachMaxLotteryTimeForOneDay":t)})})},createCapsulePhysicsWorld:function(){var t=dl["Engine"].create();t.enableSleeping=!0;var e=dl["Bodies"].rectangle(.5,22.5,1,45,{isStatic:!0}),s=dl["Bodies"].rectangle(91.5,22.5,1,45,{isStatic:!0}),i=dl["Bodies"].rectangle(46,44.5,92,1,{isStatic:!0}),n=dl["Bodies"].rectangle(46,.5,92,1,{isStatic:!0});dl["World"].add(t.world,[n,i,e,s]);for(var a=0;a<this.capsules.length;a++){var o=dl["Bodies"].circle(92/this.capsules.length*(a%5)+7.5,10*(Math.floor(a/5)+1),7.5,{restitution:.99});dl["World"].add(t.world,[o]),this.circles.push(o)}dl["Engine"].run(t);var c=this;(function e(){window.requestAnimationFrame(e);var s=dl["Composite"].allBodies(t.world),i=s.slice(4),n=i.map(function(t){return{x:(t.position.x-7.5)/92,y:(t.position.y-7.5)/45,r:t.angle}});c.capsulePhysicsInfo=n})()}},created:function(){var t=this;$t.show(),this.$store.state.lottery||(this.$store.registerModule("lottery",pl,{preserveState:!1}),this.$store.commit("lottery/resetCollectedCapsules")),this.fetchLotteryDetail().then(function(){$t.hide(),t.createCapsulePhysicsWorld()})},beforeRouteLeave:function(t,e,s){"/lottery/collected"!==t.path&&this.$store.unregisterModule("lottery"),s()}},fl=vl,Cl=(s("f0a7"),Object(p["a"])(fl,cl,rl,!1,null,"dc93c8fc",null)),yl=Cl.exports,bl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.pickedCapsules?s("div",{staticClass:"picked"},[t.pickedCapsules.length>0?s("div",{staticClass:"picked__capsules"},t._l(t.pickedCapsules,function(e){return s("div",{staticClass:"picked__capsule"},[s("div",{staticClass:"picked__capsule__capsule",class:e.color}),"coupon"===e.type?s("div",{staticClass:"picked__capsule__info"},[s("p",{staticClass:"picked__capsule__info__title"},[t._v(t._s(e.reward.couponName))]),s("p",{staticClass:"picked__capsule__info__subtitle"},[t._v("详情可至“优惠券”查看")])]):"point"===e.type?s("div",{staticClass:"picked__capsule__info"},[s("p",{staticClass:"picked__capsule__info__title"},[t._v("赠送积分+"+t._s(e.reward.lotteryPoint))]),s("p",{staticClass:"picked__capsule__info__subtitle"},[t._v("请下载并安装APP，可至我的查看")])]):"lotteryCoin"===e.type?s("div",{staticClass:"picked__capsule__info"},[s("p",{staticClass:"picked__capsule__info__title"},[t._v("赠送抽奖币+"+t._s(e.reward.lotteryTicketNum))]),s("p",{staticClass:"picked__capsule__info__subtitle"},[t._v("已经收入你的账户，可至任务中心查看")])]):t._e()])}),0):s("div",{staticClass:"picked__no-content"},[s("div",{staticClass:"picked__no-content__icon"}),s("div",{staticClass:"picked__no-content__text"},[t._v("暂无内容")])])]):t._e()},wl=[],Sl={data:function(){return{pickedCapsules:null}},methods:{getCollectedCapsules:function(t){return t.filter(function(t){var e=[0,1,2],s=e.indexOf(t.lotteryType)>-1;return s}).map(function(t){var e=function(){return 0===t.lotteryType?"point":1===t.lotteryType?"coupon":2===t.lotteryType?"lotteryCoin":void 0}();return"point"===e?{type:"point",color:"blue",reward:t}:"coupon"===e?{type:"coupon",color:"red",reward:t}:"lotteryCoin"===e?{type:"lotteryCoin",color:"yellow",reward:t}:void 0})}},created:function(){var t=this;$t.show();var e=_t.getRegionBlockCode();mt.lottery.fetchLotteryHistory({regionBlockCode:e}).then(function(e){$t.hide(),t.pickedCapsules=t.getCollectedCapsules(e)})}},Dl=Sl,kl=(s("e4c7"),Object(p["a"])(Dl,bl,wl,!1,null,"08c168ba",null)),xl=kl.exports,Tl=[{path:"/lottery",name:"lottery",component:yl,meta:{title:""}},{path:"/lottery/collected",name:"lottery/collected",component:xl,meta:{title:"已领取奖品"}}],Il=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.talkTopicDetail?s("div",{staticClass:"talk-topic-detail"},[s("div",{staticClass:"talk-topic-detail__banner"},[s("img",{attrs:{src:t.talkTopicDetail.themeImage}})]),s("div",{staticClass:"talk-topic-detail__content"},[s("div",{staticClass:"talk-topic-detail__title"},[t._v(t._s(t.talkTopicDetail.subTitle))]),s("div",{staticClass:"talk-topic-detail__lookers-count"},[t._v(t._s(t.talkTopicDetail.onlookerCount)+"人围观")]),s("div",{staticClass:"talk-topic-detail__article",domProps:{innerHTML:t._s(t.talkTopicDetail.article)}})]),t.talkTopicDetail.commodityList.length>0?s("div",{staticClass:"talk-topic-detail__show-commodity-button",on:{click:function(e){t.commodityListPopupVisible=!0}}},[t._v("\n    商品("+t._s(t.talkTopicDetail.commodityList.length)+")\n  ")]):t._e(),t.commodityListPopupVisible?s("div",[s("commodity-list-popup",{attrs:{commodities:t.talkTopicDetail.commodityList},on:{close:function(e){t.commodityListPopupVisible=!1}}})],1):t._e(),s("goto-home")],1):t._e()},Al=[],Nl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"commodity-list-popup"},[s("div",{staticClass:"commodity-list-popup__mask"}),s("div",{staticClass:"commodity-list-popup__content"},[s("div",{ref:"header",staticClass:"commodity-list-popup__header"},[s("div",[t._v("文中商品")]),s("img",{staticClass:"commodity-list-popup__header__close-button",attrs:{src:t.ossImageUrl+"/talk-topic/close.png"},on:{click:function(e){return t.$emit("close")}}})]),s("div",{ref:"list",staticClass:"commodity-list-popup__list"},t._l(t.commodities,function(e,i){return s("div",{key:i,staticClass:"commodity-list-popup__commodity"},[s("img",{staticClass:"commodity-list-popup__commodity__image",attrs:{src:e.imageUrl}}),s("div",{staticClass:"commodity-list-popup__commodity__detail"},[s("div",{staticClass:"commodity-list-popup__commodity__name"},[t._v(t._s(e.commodityName))]),s("div",{staticClass:"commodity-list-popup__commodity__price"},[s("span",{staticClass:"commodity-list-popup__commodity__price__rmb-sign"},[t._v("¥ ")]),s("span",{staticClass:"commodity-list-popup__commodity__price__number"},[t._v(t._s(e.sellPrice))])])])])}),0)])])},Pl=[],Ll={props:["commodities"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},mounted:function(){this.$refs.header.style.bottom="".concat(this.$refs.list.clientHeight-1,"px")}},Ml=Ll,El=(s("cbb6"),Object(p["a"])(Ml,Nl,Pl,!1,null,"2458eaf3",null)),$l=El.exports,Ol={components:{CommodityListPopup:$l,GotoHome:yt},data:function(){return{talkTopicDetail:null,commodityListPopupVisible:!1}},created:function(){var t=this,e=this.$route.params.id;mt.talkTopic.fetchTalkTopicDetail({talkTopicId:e}).then(function(e){t.talkTopicDetail=e}),ne.recordTalkTopicPopularStatistics(e)}},Rl=Ol,Fl=(s("07dd"),Object(p["a"])(Rl,Il,Al,!1,null,"4129891b",null)),Bl=Fl.exports,Ul=[{path:"/talk-topic-detail/:id",name:"talk-topic-detail",component:Bl,meta:{title:"聊话题"}}],jl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"load-failed"},[s("div",{staticClass:"load-failed__icon"}),s("div",{staticClass:"load-failed__text"},[t._v("加载失败")]),s("div",{staticClass:"load-failed__button",on:{click:t.handleRefresh}},[t._v("刷新")])])},Hl=[],zl={methods:{handleRefresh:function(){this.$router.go(-1)}}},Wl=zl,Gl=(s("352c"),Object(p["a"])(Wl,jl,Hl,!1,null,"00f4e6a0",null)),Vl=Gl.exports,ql=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"network-unstable"},[s("div",{staticClass:"network-unstable__icon"}),s("div",{staticClass:"network-unstable__text"},[t._v("网络不稳定")]),s("div",{staticClass:"network-unstable__button",on:{click:t.handleRefresh}},[t._v("刷新")])])},Yl=[],Ql={methods:{handleRefresh:function(){this.$router.go(-1)}}},Kl=Ql,Xl=(s("0b48"),Object(p["a"])(Kl,ql,Yl,!1,null,"8cdef00e",null)),Zl=Xl.exports,Jl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"no-network"},[s("div",{staticClass:"no-network__icon"}),s("div",{staticClass:"no-network__text"},[t._v("暂无网络")]),s("div",{staticClass:"no-network__button",on:{click:t.handleRefresh}},[t._v("刷新")])])},tu=[],eu={methods:{handleRefresh:function(){this.$router.go(-1)}}},su=eu,iu=(s("583c"),Object(p["a"])(su,Jl,tu,!1,null,"3e2a7f50",null)),nu=iu.exports,au=[{path:"/load-failed",name:"load-failed",component:Vl,meta:{title:"加载失败"}},{path:"/network-unstable",name:"network-unstable",component:Zl,meta:{title:"网络不稳定"}},{path:"/no-network",name:"no-network",component:nu,meta:{title:"暂无网络"}}],ou=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.commodities?s("div",{staticClass:"commodity-list"},[s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchRecommendedCommodities}},t._l(t.commodities,function(e,i){return s("div",{key:i,staticClass:"commodity-list__item",on:{click:function(s){return t.toDetailView(e)}}},[s("img",{staticClass:"commodity-list__item__image",attrs:{src:e.pictureKeys[0]}}),s("div",{staticClass:"commodity-list__item__detail"},[s("div",{staticClass:"commodity-list__item__detail__name"},[t._v(t._s(e.commodityName))]),e.onlookerCount>10?s("div",{staticClass:"commodity-list__item__detail__popular"},[t._v("\n          "+t._s(e.onlookerCount)+"人围观\n        ")]):t._e(),s("div",{staticClass:"commodity-list__item__detail__price"},[s("span",{staticClass:"commodity-list__item__detail__price__rmb-sign"},[t._v("¥")]),s("span",{staticClass:"commodity-list__item__detail__price__number"},[t._v(t._s(t._f("formatRMB")(e.price)))])])])])}),0)],1):t._e()},cu=[],ru={components:{PullDownRefresh:zt},data:function(){return{commodities:null,isRefreshing:!1}},methods:{toDetailView:function(t){this.$router.push({path:"/recommended-commodity-detail/".concat(t.id)})},fetchRecommendedCommodities:function(){var t=this;this.isRefreshing=!0,$t.show();var e=envService.getRegionBlockCode();mt.recommendedCommodity.fetchRecommendedCommodities({regionBlockCode:e}).then(function(e){t.commodities=e,$t.hide(),t.isRefreshing=!1}).catch(function(e){t.isRefreshing=!1})}},filters:{formatRMB:function(t){return t.toFixed(2)}},created:function(){this.fetchRecommendedCommodities()}},du=ru,pu=(s("8b72"),Object(p["a"])(du,ou,cu,!1,null,"1f0d0dc8",null)),lu=pu.exports,uu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.commodity?s("div",{staticClass:"commodity-detail"},[s("img",{staticClass:"commodity-detail__image",attrs:{src:t.commodity.articleImage}}),s("goto-home")],1):t._e()},_u=[],mu={components:{GotoHome:yt},data:function(){return{commodity:null}},created:function(){var t=this;$t.show();var e=this.$route.params.id;mt.recommendedCommodity.fetchRecommendedCommodity({o2oCommodityId:e}).then(function(e){t.commodity=e,$t.hide()})}},hu=mu,gu=(s("8b3c"),Object(p["a"])(hu,uu,_u,!1,null,"f46e8eea",null)),vu=gu.exports,fu=[{path:"/recommended-commodity-list",name:"recommended-commodity-list",component:lu,meta:{name:"购品质"}},{path:"/recommended-commodity-detail/:id",name:"recommended-commodity-detail",component:vu,meta:{name:"购品质详情"}}],Cu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div")},yu=[],bu={beforeRouteEnter:function(t,e,s){"/choose-location"!==e.path&&wx.miniProgram.navigateTo({url:"/pages/webview-choose-location/webview-choose-location"}),s()},watch:{$route:function(){var t=JSON.parse(this.$route.query.location),e=!ee.a.isEmpty(t);e&&this.$store.commit("location/setLocationInfo",t),history.go(-2)}}},wu=bu,Su=Object(p["a"])(wu,Cu,yu,!1,null,"5e516f97",null),Du=Su.exports,ku=[{path:"/choose-location",name:"choose-location",component:Du,meta:{title:"选择地址"}}],xu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shops&&t.oftenShops?s("div",{staticClass:"shop-list"},[s("div",{staticClass:"shop-list__search-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchShop,expression:"searchShop"}],staticClass:"shop-list__search-container__search-bar",attrs:{placeholder:"输入门店名称"},domProps:{value:t.searchShop},on:{input:function(e){e.target.composing||(t.searchShop=e.target.value)}}})]),s("div",{ref:"currentShop",staticClass:"shop-list__current-shop"},[t._m(0),s("div",{staticClass:"shop-list__current-shop__item"},[s("div",{staticClass:"shop-list__current-shop__item__icon-location"}),t.currentAddress?s("div",{staticClass:"shop-list__current-shop__item__current-address"},[t._v(t._s(t.currentAddress))]):t._e(),s("div",{staticClass:"shop-list__current-shop__item__refresh-location",on:{click:t.setCurrentAddress}},[t._v("重新定位")])]),s("div",{staticClass:"shop-list__whitespace"}),t.oftenShops.length>0?[t._m(1),t._l(t.oftenShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e(),s("div",{staticClass:"shop-list__whitespace"}),t.nearbyShops.length>0?[t._m(2),t._l(t.nearbyShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e()],2)]):t._e()},Tu=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-list__current-shop__title-row"},[s("span",{staticClass:"shop-list__current-shop__title-row__title"},[t._v("当前定位")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-list__my-shops__title-row"},[s("span",{staticClass:"shop-list__my-shops__title-row__title"},[t._v("常去店铺")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-list__nearby-shops__title-row"},[s("span",{staticClass:"shop-list__nearby-shops__title-row__title"},[t._v("附近店铺")])])}],Iu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-item"},[s("div",{staticClass:"shop-item__info"},[s("div",{staticClass:"shop-item__basic-info"},[s("div",{staticClass:"shop-item__shop-name"},[s("span",[t._v(t._s(t.shop.shopName))]),""!==t.shop.businessTime?s("format-business-time",{attrs:{businessTime:t.shop.businessTime}}):t._e()],1),s("div",{staticClass:"shop-item__shop-address"},[t._v(t._s(t.shop.address))])]),t.shop.distance?s("div",{staticClass:"shop-item__map-info"},[s("div",{staticClass:"shop-item__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.shop.distance)))]),s("div",{staticClass:"shop-item__show-in-map",on:{click:t.openMap}},[t._v("地图 >")])]):t._e()])])},Au=[],Nu={props:{shop:Object},components:{FormatBusinessTime:ue},methods:{openMap:function(){wx.openLocation({latitude:this.shop.latitude,longitude:this.shop.longitude,name:this.shop.shopName,address:this.shop.address})}},filters:{toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},Pu=Nu,Lu=(s("1774"),Object(p["a"])(Pu,Iu,Au,!1,null,"4a62c5de",null)),Mu=Lu.exports,Eu={components:{ShopItem:Mu},data:function(){return{oftenShops:null,currentAddress:null,nearbyShopsLength:10,searchShop:null,currentLocation:null}},created:function(){this.fetchOftenShoplist()},mounted:function(){var t=this;He.init().then(function(){t.setCurrentAddress()})},updated:function(){this.$refs.currentShop.addEventListener("scroll",this.handleScroll)},computed:{shops:function(){var t=this.$store.state.shop.shops;if(ee.a.isEmpty(t))return[];var e=_t.getRegionBlockCode();return t[e]},sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=Xt()({},e);return s.distance=ie(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops},filterShops:function(){var t=this;return this.searchShop?this.sortedShopsWithDistance.filter(function(e){return e.shopName.includes(t.searchShop)}):this.sortedShopsWithDistance},currentShop:function(){return this.sortedShopsWithDistance[0]},myShops:function(){return this.sortedShopsWithDistance.slice(1,3)},nearbyShops:function(){return this.filterShops.slice(0,this.nearbyShopsLength)}},methods:{handleScroll:ee.a.debounce(function(){var t=this.$refs.currentShop.scrollTop,e=this.$refs.currentShop.clientHeight,s=this.$refs.currentShop.scrollHeight,i=s<=e+t;i&&(this.nearbyShopsLength+=10)},150),fetchOftenShoplist:function(){var t=this;$t.show();var e=_t.getRegionBlockCode();mt.shop.fetchOftenShoplist({regionBlockCode:e}).then(function(e){t.oftenShops=e.data.data.slice(0,2)}).finally(function(){return $t.hide()})},setCurrentAddress:function(){var t=this;this.currentAddress=null,ut.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i},He.getAddressByLatLng(s,i).then(function(e){t.currentAddress=e.address})})}}},$u=Eu,Ou=(s("5c6b"),Object(p["a"])($u,xu,Tu,!1,null,"0a235796",null)),Ru=Ou.exports,Fu=[{path:"/nearby-shop-list",name:"nearby-shop-list",component:Ru,meta:{title:"附近门店"}}],Bu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"takeout-intro"})},Uu=[],ju={},Hu=ju,zu=(s("0d5d"),Object(p["a"])(Hu,Bu,Uu,!1,null,"0167f826",null)),Wu=zu.exports,Gu=[{path:"/takeout-intro",name:"takeout-intro",component:Wu,meta:{title:"外卖预约介绍"}}],Vu=[].concat(Object(m["a"])(Ks),Object(m["a"])(Go),Object(m["a"])(gp),Object(m["a"])(ol),Object(m["a"])(Tl),Object(m["a"])(Ul),Object(m["a"])(au),Object(m["a"])(fu),Object(m["a"])(ku),Object(m["a"])(Fu),Object(m["a"])(Gu));i["a"].use(_["a"]);var qu=new _["a"]({routes:Vu});qu.afterEach(function(t,e){document.title=t.meta.title?t.meta.title:"罗森点点"});var Yu=qu,Qu=s("2f62"),Ku=function(t){return"number"!==typeof t.latitude||"number"!==typeof t.longitude},Xu=function(t){return 0!==t.businessStatus},Zu=function(t){return 0!==t.delFlg},Ju=function(t){return Ku(t)||Xu(t)||Zu(t)},t_={namespaced:!0,state:{shops:{}},getters:{shopsForRegion:function(t){return function(e){return t.shops[e].filter(function(t){return!Ju(t)})}},shopsAvailableForRegion:function(t){return function(e){return void 0!==t.shops[e]}}},mutations:{updateShopsForRegion:function(t,e){var s=e.shops,n=e.regionBlockCode;i["a"].set(t.shops,n,s)}}},e_={namespaced:!0,state:{locationInfo:null},mutations:{setLocationInfo:function(t,e){t.locationInfo=e},cleanupLocationInfo:function(t){t.locationInfo=null}}};i["a"].use(Qu["a"]);var s_=new Qu["a"].Store({modules:{shop:t_,location:e_}}),i_=s_;s("9579"),new i["a"],s("0038");i["a"].config.productionTip=!1;var n_=function(){new i["a"]({router:Yu,store:i_,render:function(t){return t(u)}}).$mount("#app")};n_()},"583c":function(t,e,s){"use strict";var i=s("e2d7"),n=s.n(i);n.a},"5ad5":function(t,e,s){},"5c0b":function(t,e,s){"use strict";var i=s("ca2b"),n=s.n(i);n.a},"5c6b":function(t,e,s){"use strict";var i=s("62fd"),n=s.n(i);n.a},"5ceb":function(t,e,s){},"5d4f":function(t,e,s){"use strict";var i=s("d469"),n=s.n(i);n.a},"5e76":function(t,e,s){"use strict";var i=s("ace3"),n=s.n(i);n.a},"5f40":function(t,e,s){"use strict";var i=s("d698"),n=s.n(i);n.a},"600b":function(t,e,s){"use strict";var i=s("9580"),n=s.n(i);n.a},6032:function(t,e,s){"use strict";var i=s("0059"),n=s.n(i);n.a},6126:function(t,e,s){},6138:function(t,e,s){},6223:function(t,e,s){"use strict";var i=s("cc08"),n=s.n(i);n.a},"622b":function(t,e,s){},6288:function(t,e,s){},"62fd":function(t,e,s){},"655b":function(t,e,s){"use strict";var i=s("0a37"),n=s.n(i);n.a},"69c0":function(t,e,s){},"6b6a":function(t,e,s){},"6d4b":function(t,e,s){"use strict";var i=s("0b49"),n=s.n(i);n.a},"6e7c":function(t,e,s){},"6fb7":function(t,e,s){"use strict";var i=s("f7e4"),n=s.n(i);n.a},"6fe8":function(t,e,s){"use strict";var i=s("89e1"),n=s.n(i);n.a},"70f4":function(t,e,s){"use strict";var i=s("1b20"),n=s.n(i);n.a},"748a":function(t,e,s){"use strict";var i=s("02e5"),n=s.n(i);n.a},"74fe":function(t,e,s){"use strict";var i=s("b37b"),n=s.n(i);n.a},7764:function(t,e,s){},7770:function(t,e,s){"use strict";var i=s("4e6b"),n=s.n(i);n.a},7783:function(t,e,s){"use strict";var i=s("5ad5"),n=s.n(i);n.a},7832:function(t,e,s){},"79e50":function(t,e,s){"use strict";var i=s("9aff"),n=s.n(i);n.a},"7af5":function(t,e,s){"use strict";var i=s("f848"),n=s.n(i);n.a},"7dfb":function(t,e,s){"use strict";var i=s("b095"),n=s.n(i);n.a},"819c":function(t,e,s){},"81b0":function(t,e,s){},"81e0":function(t,e,s){"use strict";var i=s("cb13"),n=s.n(i);n.a},8469:function(t,e,s){"use strict";var i=s("ee5e"),n=s.n(i);n.a},8732:function(t,e,s){"use strict";var i=s("272d"),n=s.n(i);n.a},"87c8":function(t,e,s){},"880b":function(t,e,s){},"89e1":function(t,e,s){},"8a27":function(t,e,s){},"8b3c":function(t,e,s){"use strict";var i=s("19b6"),n=s.n(i);n.a},"8b72":function(t,e,s){"use strict";var i=s("bb72"),n=s.n(i);n.a},"8e19":function(t,e,s){"use strict";var i=s("b68f"),n=s.n(i);n.a},"8f65":function(t,e,s){},"915b":function(t,e,s){},"92bc":function(t,e,s){"use strict";var i=s("ecd6"),n=s.n(i);n.a},"92ff":function(t,e,s){},9580:function(t,e,s){},9587:function(t,e,s){},"95a5":function(t,e,s){"use strict";var i=s("9587"),n=s.n(i);n.a},"95da":function(t,e,s){"use strict";var i=s("df90"),n=s.n(i);n.a},9882:function(t,e,s){},"9aff":function(t,e,s){},"9ba9":function(t,e,s){"use strict";var i=s("d97d"),n=s.n(i);n.a},"9edc":function(t,e,s){"use strict";var i=s("4ccb"),n=s.n(i);n.a},a087:function(t,e,s){"use strict";var i=s("fffc"),n=s.n(i);n.a},a203:function(t,e,s){"use strict";var i=s("2691"),n=s.n(i);n.a},a29c:function(t,e,s){},a34c:function(t,e,s){"use strict";var i=s("6b6a"),n=s.n(i);n.a},a4a5:function(t,e,s){"use strict";var i=s("1458"),n=s.n(i);n.a},a4e8:function(t,e,s){"use strict";var i=s("47e4"),n=s.n(i);n.a},a66a:function(t,e,s){"use strict";var i=s("81b0"),n=s.n(i);n.a},a6fc:function(t,e,s){"use strict";var i=s("0f02"),n=s.n(i);n.a},a9d3:function(t,e,s){},ace3:function(t,e,s){},afa2:function(t,e,s){"use strict";var i=s("33a7"),n=s.n(i);n.a},afc2:function(t,e,s){"use strict";var i=s("d81e"),n=s.n(i);n.a},b06b:function(t,e,s){},b095:function(t,e,s){},b32f:function(t,e,s){},b37b:function(t,e,s){},b66f:function(t,e,s){"use strict";var i=s("819c"),n=s.n(i);n.a},b68f:function(t,e,s){},b6c9:function(t,e,s){"use strict";var i=s("318b"),n=s.n(i);n.a},ba75:function(t,e,s){},bb23:function(t,e,s){"use strict";var i=s("d00d"),n=s.n(i);n.a},bb72:function(t,e,s){},bd1e:function(t,e,s){"use strict";var i=s("6e7c"),n=s.n(i);n.a},bde1:function(t,e,s){"use strict";var i=s("b32f"),n=s.n(i);n.a},c01d:function(t,e,s){},c168:function(t,e,s){"use strict";var i=s("0f67"),n=s.n(i);n.a},c1c0:function(t,e,s){"use strict";var i=s("92ff"),n=s.n(i);n.a},c25f:function(t,e,s){},c2d3:function(t,e,s){"use strict";var i=s("5616"),n=s.n(i);n.a},c37f:function(t,e,s){},c3b2:function(t,e,s){},c400:function(t,e,s){},c462:function(t,e,s){"use strict";var i=s("344e"),n=s.n(i);n.a},c536:function(t,e,s){"use strict";var i=s("e79f"),n=s.n(i);n.a},c98c:function(t,e,s){"use strict";var i=s("5ceb"),n=s.n(i);n.a},ca2b:function(t,e,s){},cb13:function(t,e,s){},cb54:function(t,e,s){},cbb6:function(t,e,s){"use strict";var i=s("7832"),n=s.n(i);n.a},cc08:function(t,e,s){},d00d:function(t,e,s){},d072:function(t,e,s){},d469:function(t,e,s){},d662:function(t,e,s){"use strict";var i=s("49bc"),n=s.n(i);n.a},d698:function(t,e,s){},d81e:function(t,e,s){},d88c:function(t,e,s){"use strict";var i=s("c400"),n=s.n(i);n.a},d95f:function(t,e,s){"use strict";var i=s("f70c"),n=s.n(i);n.a},d97d:function(t,e,s){},da46:function(t,e,s){"use strict";var i=s("0a68"),n=s.n(i);n.a},da66:function(t,e,s){},de52:function(t,e,s){"use strict";var i=s("00e6"),n=s.n(i);n.a},df90:function(t,e,s){},dfe4:function(t,e,s){"use strict";var i=s("69c0"),n=s.n(i);n.a},e2d7:function(t,e,s){},e4c7:function(t,e,s){"use strict";var i=s("7764"),n=s.n(i);n.a},e637:function(t,e,s){},e79f:function(t,e,s){},ea6d:function(t,e,s){},ecd6:function(t,e,s){},ee5e:function(t,e,s){},ef3e:function(t,e,s){},f0a7:function(t,e,s){"use strict";var i=s("c3b2"),n=s.n(i);n.a},f1b9:function(t,e,s){},f70c:function(t,e,s){},f7e4:function(t,e,s){},f848:function(t,e,s){},f948:function(t,e,s){"use strict";var i=s("051d"),n=s.n(i);n.a},f9cc:function(t,e,s){"use strict";var i=s("87c8"),n=s.n(i);n.a},fa16:function(t,e,s){"use strict";var i=s("915b"),n=s.n(i);n.a},fc26:function(t,e,s){"use strict";var i=s("9882"),n=s.n(i);n.a},fdd2:function(t,e,s){"use strict";var i=s("8a27"),n=s.n(i);n.a},fffc:function(t,e,s){}});
//# sourceMappingURL=app.9c10b748.js.map