{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./App.vue?3ce3","webpack:///App.vue","webpack:///./App.vue?c68c","webpack:///./App.vue","webpack:///./App.vue?2363"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","app","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","render","_vm","this","_h","$createElement","_c","_self","attrs","id","width","w","height","h","on","touchstart","$event","preventDefault","touchmove","handleTouchMove","mousemove","handleMouseMove","_v","directives","rawName","expression","type","domProps","checked","_q","cameraMode","change","for","click","showHowToPlay","staticRenderFns","planeVertices","createShaderProgram","gl","vsSource","fsSource","vertexShaderSource","fragmentShaderSource","vs","createShader","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","console","error","getShaderInfoLog","deleteShader","fs","FRAGMENT_SHADER","shaderProgram","createProgram","attachShader","linkProgram","lib_vue_loader_options_Appvue_type_script_lang_js_","mouse","x","y","canvas","left","top","screenDist","cameraPos","z","cameraDir","yaw","pitch","screenOrigin","sampleCount","mounted","_this","rect","document","querySelector","getBoundingClientRect","addEventListener","e","handleKeyPress","getContext","tracerProgram","planeBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","planeData","Float32Array","bufferData","STATIC_DRAW","vertexAttribPointer","FLOAT","enableVertexAttribArray","bindAttribLocation","textures","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","texImage2D","RGB","UNSIGNED_BYTE","fb","createFramebuffer","useProgram","time","then","self","draw","now","deltaTime","clearColor","tul","getUniformLocation","uniform1f","swul","cpul","uniform3f","screenToWorldMatrix","getScreenToWorldMatrix","swmul","uniformMatrix4fv","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","drawArrays","TRIANGLE_STRIP","reverse","requestAnimationFrame","timestamp","methods","alert","v","up","crossProduct","normalize","toConsumableArray","u","len","Math","sqrt","x1","y1","z1","x2","y2","z2","degToRad","deg","handleLeftRight","speed","handleForwardBackward","_r","clientX","clientY","cos","sin","touches","Appvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","_nvm_versions_node_v10_6_0_lib_node_modules_vue_cli_service_global_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_nvm_versions_node_v10_6_0_lib_node_modules_vue_cli_service_global_node_modules_css_loader_index_js_ref_6_oneOf_1_1_nvm_versions_node_v10_6_0_lib_node_modules_vue_cli_service_global_node_modules_vue_loader_lib_loaders_stylePostLoader_js_nvm_versions_node_v10_6_0_lib_node_modules_vue_cli_service_global_node_modules_cache_loader_dist_cjs_js_ref_0_0_nvm_versions_node_v10_6_0_lib_node_modules_vue_cli_service_global_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","_nvm_versions_node_v10_6_0_lib_node_modules_vue_cli_service_global_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_nvm_versions_node_v10_6_0_lib_node_modules_vue_cli_service_global_node_modules_css_loader_index_js_ref_6_oneOf_1_1_nvm_versions_node_v10_6_0_lib_node_modules_vue_cli_service_global_node_modules_vue_loader_lib_loaders_stylePostLoader_js_nvm_versions_node_v10_6_0_lib_node_modules_vue_cli_service_global_node_modules_cache_loader_dist_cjs_js_ref_0_0_nvm_versions_node_v10_6_0_lib_node_modules_vue_cli_service_global_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"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","file":"js/app.87b0c739.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('canvas',{attrs:{\"id\":\"cvs\",\"width\":_vm.w,\"height\":_vm.h},on:{\"touchstart\":function($event){$event.preventDefault();},\"touchmove\":_vm.handleTouchMove,\"mousemove\":_vm.handleMouseMove}}),_c('h2',[_vm._v(\"A demo for movable camera and path tracing\")]),_c('span',[_vm._v(\"Select a camera mode: \")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.cameraMode),expression:\"cameraMode\"}],attrs:{\"type\":\"radio\",\"id\":\"free\",\"value\":\"free\"},domProps:{\"checked\":_vm._q(_vm.cameraMode,\"free\")},on:{\"change\":function($event){_vm.cameraMode=\"free\"}}}),_c('label',{attrs:{\"for\":\"free\"}},[_vm._v(\"free\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.cameraMode),expression:\"cameraMode\"}],attrs:{\"type\":\"radio\",\"id\":\"focus\",\"value\":\"focus\"},domProps:{\"checked\":_vm._q(_vm.cameraMode,\"focus\")},on:{\"change\":function($event){_vm.cameraMode=\"focus\"}}}),_c('label',{attrs:{\"for\":\"focus\"}},[_vm._v(\"focus\")]),_c('p',[_vm._v(\"TIP: On PC or Mac, use F to toggle camera mode\")]),_c('p',[_c('button',{on:{\"click\":_vm.showHowToPlay}},[_vm._v(\"How to play?\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div id=\"app\">\n    <canvas id=\"cvs\" :width=\"w\" :height=\"h\" @touchstart.prevent @touchmove=\"handleTouchMove\" @mousemove=\"handleMouseMove\"></canvas>\n    <h2>A demo for movable camera and path tracing</h2>\n    <span>Select a camera mode: </span>\n    <input type=\"radio\" id=\"free\" value=\"free\" v-model=\"cameraMode\">\n    <label for=\"free\">free</label>\n    <input type=\"radio\" id=\"focus\" value=\"focus\" v-model=\"cameraMode\">\n    <label for=\"focus\">focus</label>\n    <p>TIP: On PC or Mac, use F to toggle camera mode</p>\n    <p>\n      <button @click=\"showHowToPlay\">How to play?</button>\n    </p>\n  </div>\n</template>\n\n<script>\n// for a raytracer rather than a rasterizer,\n// the only entitiy to draw is a rectangular \"canvas\" that covers the whole viewport\nconst planeVertices = [\n  -1,-1,\n  1,-1,\n  -1,1,\n  1,1\n];\n\nfunction createShaderProgram(gl, vsSource, fsSource) {\n  const vertexShaderSource = vsSource;\n  const fragmentShaderSource = fsSource;\n\n  const vs = gl.createShader(gl.VERTEX_SHADER);\n  gl.shaderSource(vs, vertexShaderSource);\n  gl.compileShader(vs);\n\n  if (!gl.getShaderParameter(vs, gl.COMPILE_STATUS)) {\n    // eslint-disable-next-line\n    console.error('An error occurred compiling the vertex shaders: ' + gl.getShaderInfoLog(vs));\n    gl.deleteShader(vs);\n    return null;\n  }\n\n  const fs = gl.createShader(gl.FRAGMENT_SHADER);\n  gl.shaderSource(fs, fragmentShaderSource);\n  gl.compileShader(fs);\n\n  if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS)) {\n    // eslint-disable-next-line\n    console.error('An error occurred compiling the fragment shaders: ' + gl.getShaderInfoLog(fs));\n    gl.deleteShader(fs);\n    return null;\n  }\n\n  const shaderProgram = gl.createProgram();\n  gl.attachShader(shaderProgram, vs);\n  gl.attachShader(shaderProgram, fs);\n  gl.linkProgram(shaderProgram);\n  return shaderProgram;\n}\n\nexport default {\n  data() {\n    return {\n      cameraMode: 'focus',\n      w: 512,\n      h: 512,\n      mouse: {\n        x: 0,\n        y: 0\n      },\n      canvas: {\n        left: 0,\n        top: 0\n      },\n      screenDist: 6,\n      cameraPos: {\n        x: 0,\n        y: 0,\n        z: 6\n      },\n      cameraDir: {\n        yaw: 0,\n        pitch: 0,\n        x: 0,\n        y: 0,\n        z: -1\n      },\n      screenOrigin: {\n        x: 0,\n        y: 0,\n        z: 0\n      },\n      sampleCount: 0\n    }\n  },\n  mounted() {\n    const rect = document.querySelector('canvas').getBoundingClientRect();\n    this.canvas.left = rect.left;\n    this.canvas.top = rect.top;\n\n    document.addEventListener('keypress', (e) => {\n      this.handleKeyPress(e);\n    });\n\n    const gl = document.querySelector('#cvs').getContext('webgl');\n\n    // the vertex and fragment shader for the actual path tracing\n    const tracerProgram = createShaderProgram(gl,\n      `\n        attribute vec4 aPosition;\n        varying vec4 vPosition;\n\n        void main() {\n          vPosition = aPosition;\n          gl_Position = aPosition;\n        }\n      `,\n      `\n        precision highp float;\n        uniform vec3 u_camera_pos;\n        varying vec4 vPosition;\n        uniform float u_time;\n        uniform float u_sw;\n        uniform mat4 u_screen_to_world;\n        uniform sampler2D tex;\n\n        // cube min vertx\n        const vec3 cmin0 = vec3(-0.2,-1.0,-4.2);\n        // cube max vertx\n        const vec3 cmax0 = vec3(0.2,-0.6,-3.8);\n        // cube diffuse color\n        const vec3 cd0 = vec3(0.9);\n\n        // sphere center\n        const vec3 sc0 = vec3(-0.8,-0.8,-4.);\n        // sphere radius\n        const float sr0 = 0.2;\n        // sphere diffuse color\n        const vec3 sd0 = vec3(0.9);\n\n        // cylinder center\n        const vec3 cc0 = vec3(0.8, -0.7, -4.0);\n        // cylinder height\n        const float ch0 = 0.3;\n        // cylinder radius\n        const float cr0 = 0.3;\n\n        // y_triangle y value\n        const float ty0 = -0.95;\n\n        // y_triangle vertices\n        const vec2 tv00 = vec2(-0.5,-2.866);\n        const vec2 tv01 = vec2(0.5,-2.866);\n        const vec2 tv02 = vec2(0.,-2.);\n\n        // sky (a infinite plane at the back of the scene)\n        const float pz = -6.5;\n        const vec3 pzd = vec3(1.,0.5,0.5);\n\n        // ground (a infinite plane at the bottom of the scene)\n        const float py = -1.;\n        const vec3 pyd = vec3(0.78,0.95,0.84);\n\n\n        float random(vec2 scale, float seed) {\n          return fract(sin(dot(gl_FragCoord.xy + seed, scale)) * 43758.5453);\n        }\n\n        vec3 cosineWeightedDirection(float seed, vec3 normal) {\n          float u = random(vec2(12.9898, 78.233), seed);\n          float v = random(vec2(63.7264, 10.873), seed);\n\n          float theta = 6.28 * u;\n          float r = sqrt(1. - v);\n          float x = r * cos(theta);\n          float y = sqrt(v);\n          float z = r * sin(theta);\n\n          vec3 right = normalize(cross(normal, vec3(0.1)));\n          vec3 front = cross(right, normal);\n          return right * x + normal * y + front * z;\n        }\n\n        vec3 customWeightedDirection(float seed, vec3 normal) {\n          float u = random(vec2(12.9898, 78.233), seed);\n          float v = random(vec2(63.7264, 10.873), seed);\n\n          float theta = 6.28 * u;\n          float k = pow(v, 0.0001);\n          float r = sqrt(1. - k*k);\n          float x = r * cos(theta);\n          float y = k;\n          float z = r * sin(theta);\n\n          vec3 right = normalize(cross(normal, vec3(0.1)));\n          vec3 front = cross(right, normal);\n          return right * x + normal * y + front * z;\n        }\n\n        // the function for ray-sphere intersection, given the origin and direction of a ray and the center and radius of a sphere\n        // returns the minimal distance when the ray hits the surface of the sphere\n        // when no intersection, returns 10000.0 \n        float sphere_hit(vec3 ro, vec3 rd, vec3 center, float r) {\n          vec3 oc = ro - center;\n          float a = dot(rd, rd);\n          float b = 2.0 * dot(oc, rd);\n          float c = dot(oc, oc) - r * r;\n          float discriminant = b * b - 4.0 * a * c;\n          if (discriminant > 0.0) {\n            float temp = (- b - sqrt(discriminant)) / (2.0 * a);\n            if (temp > 0.) {\n              return temp;\n            }\n          }\n          return 10000.0;\n        }\n\n        // the function for axis-aligned ray-box intersection\n        vec2 box_hit(vec3 ro, vec3 rd, vec3 box_min, vec3 box_max) {\n          vec3 tmin = (box_min - ro) / rd;\n          vec3 tmax = (box_max - ro) / rd;\n\n          vec3 t1 = min(tmin, tmax);\n          vec3 t2 = max(tmin, tmax);\n\n          float tnear = max(max(t1.x, t1.y), t1.z);\n          float tfar = min(min(t2.x, t2.y), t2.z);\n\n          return vec2(tnear, tfar);\n        }\n\n        // the function for a z-axis perpendicular plane and ray intersection\n        float z_plane_hit(vec3 ro, vec3 rd, float z) {\n          return (z - ro.z) / rd.z;\n        }\n\n        // the function for a y-axis perpendicular plane and ray intersection\n        float y_plane_hit(vec3 ro, vec3 rd, float y) {\n          return (y - ro.y) / rd.y;\n        }\n\n        // the function for a y-axis perpendicular disk (circle shaped plane) and ray intersection\n        float y_disk_hit(vec3 ro, vec3 rd, vec3 center, float r) {\n          float t = y_plane_hit(ro, rd, center.y);\n          if (t > 0.) {\n            vec3 hit = ro + t * rd;\n            if (length(center - hit) < r) {\n              return t;\n            }\n          }\n          return 10000.0;\n        }\n\n        // the function for ray-cylinder intersection\n        float cylinder_hit(vec3 ro, vec3 rd, vec3 center, float h, float r, out int face) {\n          vec2 oc = (ro - center).xz;\n          vec2 rd2 = rd.xz;\n          float a = dot(rd2, rd2);\n          float b = 2.0 * dot(oc, rd2);\n          float c = dot(oc, oc) - r * r;\n          float discriminant = b * b - 4.0 * a * c;\n          float top = center.y + h;\n          float bottom = center.y - h;\n\n          float temp = (- b - sqrt(discriminant)) / (2.0 * a);\n          vec3 hit = ro + temp * rd;\n          if (temp > 0. && hit.y < top && hit.y > bottom) {\n            face = 0;\n            return temp;\n          } else if (hit.y > top) {\n            face = 1;\n            return y_disk_hit(ro, rd, center + vec3(0.,h,0.), r);\n          } else {\n            face = 2;\n            return y_disk_hit(ro, rd, center + vec3(0.,-h, 0.), r);\n          }\n\n          return 10000.0;\n        }\n\n        float det2x2(vec2 va, vec2 vb) {\n          return (va.x * vb.y) - (vb.x * va.y);\n        }\n\n        bool in_triangle(vec2 p, vec2 v1, vec2 v2, vec2 v3) {\n          float d1 = det2x2(v2 - v1,p - v1);\n          float d2 = det2x2(v3 - v2,p - v2);\n          float d3 = det2x2(v1 - v3,p - v3);\n\n          return (\n            (d1 < 0. && d2 < 0. && d3 < 0.) ||\n            (d1 > 0. && d2 > 0. && d3 > 0.)\n          );\n        }\n\n        // the function for a y-axis perpendicula triangle and ray intersection\n        float y_triangle_hit(vec3 ro, vec3 rd, float y, vec2 v1, vec2 v2, vec2 v3) {\n          float t = y_plane_hit(ro, rd, y);\n          vec3 hit = ro + t * rd;\n          if (in_triangle(hit.xz, v1, v2, v3)) {\n            return t;\n          }\n          return 10000.0;\n        }\n\n        // the function for resolving color on a specific hit point\n        // currently returns only the diffuse color\n        vec3 calc_color(vec3 hit, vec3 normal, vec3 diff_c) {\n          vec3 light = vec3(2.8,2.5,1.5);\n          vec3 l = normalize(light - hit);\n          float diff = dot(l, normal);\n\n          vec3 v = normalize(u_camera_pos - hit);\n          float spec = dot(v, reflect(-l, normal));\n          return pow(max(diff, 0.), 4.) + pow(max(spec,0.), 32.) + diff_c;\n        }\n\n        vec3 refr(vec3 ray, vec3 normal, float ri) {\n          float dt = dot(ray, normal);\n          float ni_over_nt;\n          vec3 n;\n          if (dt > 0.) {\n            n = -normal;\n            ni_over_nt = ri;\n          } else {\n            n = normal;\n            ni_over_nt = 1./ri;\n          }\n\n          float discriminant = 1. - ni_over_nt*ni_over_nt*(1. - dt*dt);\n          if (discriminant > 0.) {\n            return ri*(ray - n*dt)-n*sqrt(discriminant);\n          } else {\n            return reflect(ray, normal);\n          }\n        }\n\n        vec3 box_normal(vec3 hit, vec3 box_min, vec3 box_max) {\n          if (hit.x < box_min.x + 0.001) return vec3(-1,0,0);\n          else if (hit.x > box_max.x - 0.001) return vec3(1,0,0);\n\n          else if (hit.y < box_min.y + 0.001) return vec3(0,-1,0);\n          else if (hit.y > box_max.y - 0.001) return vec3(0,1,0);\n\n          else if (hit.z < box_min.z + 0.001) return vec3(0,0,-1);\n          return vec3(0,0,1);\n        }\n\n        vec4 trace(vec3 ro, vec3 rd) {\n          vec3 color_mask = vec3(1.);\n          vec3 accu_color = vec3(1.);\n\n          int cylinder_face = -1;\n\n          // the path tracing depth\n          for (int i = 0; i < 5; i++) {\n            // finding the nearest hit point by checking intersection with every spheres\n            float dist = 10000.0;\n            vec2 dc0 = box_hit(ro, rd, cmin0, cmax0);\n            float d0 = sphere_hit(ro, rd,sc0, sr0);\n            float d1 = cylinder_hit(ro, rd, cc0, ch0, cr0, cylinder_face);\n            float d2 = y_triangle_hit(ro, rd, ty0, tv00, tv01, tv02);\n            float d3 = z_plane_hit(ro, rd, pz);\n            float d4 = y_plane_hit(ro, rd, py);\n\n            vec3 normal;\n            vec3 diffuse;\n\n            if (dc0.x > 0. && dc0.x < dc0.y && dist > dc0.x) dist = dc0.x;\n            if (dist > d0) dist = d0;\n            if (d1 > 0. && dist > d1) dist = d1;\n            if (d2 > 0. && dist > d2) dist = d2;\n            if (d3 > 0. && dist > d3) dist = d3;\n            if (d4 > 0. && dist > d4) dist = d4;\n\n            vec3 hit = ro + dist * rd;\n\n            if (dist == 10000.0) {\n              break;\n            // if any sphere is hit, accumulate the color on the sphere,\n            // and find a randomly scattered ray from the hit point as new ray\n            // for the next loop of path tracing\n            } else if (dist == dc0.x) {\n              diffuse = cd0;\n              normal = box_normal(hit, cmin0, cmax0);\n            } else if (dist == d0) {\n              diffuse = sd0;\n              normal = (hit - sc0) / sr0;\n            } else if (dist == d1) {\n              diffuse = sd0;\n              if (cylinder_face == 0) {\n                vec3 n = (hit - vec3(cc0.x, 0., cc0.z)) / cr0;\n                normal = vec3(n.x, 0., n.z);\n              } else if (cylinder_face == 1) {\n                normal = vec3(0,1,0);\n              } else {\n                normal = vec3(0,-1,0);\n              }\n            } else if (dist == d2) {\n              diffuse = sd0;\n              normal = vec3(0,1,0);\n            } else if (dist == d3) {\n              diffuse = pzd;\n              normal = vec3(0.,0.,-1.);\n            } else if (dist == d4) {\n              diffuse = pyd;\n              normal = vec3(0.,1.,0.);\n            }\n\n            if (dist == d3 || dist == d4) {\n              rd = cosineWeightedDirection(u_time, normal);\n            } else {\n              rd = customWeightedDirection(u_time, reflect(rd, normal));\n            }\n            ro = hit + 0.0001 * normal;\n\n            color_mask *= diffuse;\n            accu_color *= calc_color(hit, normal, color_mask);\n          }\n          return vec4(accu_color, 1.);\n        }\n\n        const float screen_dist = 6.;\n\n        void main() {\n          // s,t is the x,y axis of the screen-space coordinate,\n          // first assuming that there is a screen that lies in the world-space with its center at (0,0,0)\n          // and the plane of screen is parallel to the xy plane\n          vec4 st = vec4(vPosition.xy, 0., 1.);\n          st.y = -st.y;\n\n          // then, convert the screen to world-space where a camera position and direction is determined\n          // this is done by an inverse matrix operation of gluLookAt\n          // first change the basis, then translate to the world-space\n\n          vec4 rd = u_screen_to_world * st;\n          vec4 result = trace(u_camera_pos, rd.xyz);\n          \n          // gamma correction\n          result = sqrt(result);\n          // progressive rendering, where the results is accumulated with previous frame render result\n          // u_sw is a value that approximates 1\n          // thus the new frame will contribute less to the final image as time elapses\n          vec3 prev = texture2D(tex, gl_FragCoord.xy/512.0).rgb;\n          gl_FragColor = vec4(mix(result.rgb, prev, u_sw), 1.);\n        }\n      `\n    );\n\n    const planeBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, planeBuffer);\n    const planeData = new Float32Array(planeVertices);\n    gl.bufferData(gl.ARRAY_BUFFER, planeData, gl.STATIC_DRAW);\n    gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 8, 0);\n    gl.enableVertexAttribArray(0);\n    gl.bindAttribLocation(tracerProgram, 0, 'aPosition');\n\n    // In order to implement progressive rendering\n    // 2 textures as image storing, and one framebuffer for drawing rendered result to texture are needed\n    const textures = [];\n    for (var i = 0; i < 2; i++) {\n      textures.push(gl.createTexture());\n      gl.bindTexture(gl.TEXTURE_2D, textures[i]);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, this.w, this.h, 0, gl.RGB, gl.UNSIGNED_BYTE, null);\n    }\n\n    const fb = gl.createFramebuffer();\n\n    gl.useProgram(tracerProgram);\n\n    // draw call\n    let time = 0;\n    let then = 0;\n\n    let self = this;\n    function draw(now) {\n      if (!now) now = 0;\n      now *= 0.05;\n      const deltaTime = now - then;\n      then = now;\n\n      gl.clearColor(0,0,0,0);\n\n      gl.bindBuffer(gl.ARRAY_BUFFER, planeBuffer);\n\n      time+=deltaTime;\n      self.sampleCount++;\n      // time uniform\n      let tul = gl.getUniformLocation(tracerProgram, 'u_time');\n      gl.uniform1f(tul, time);\n\n      // sample weight\n      let swul = gl.getUniformLocation(tracerProgram, 'u_sw');\n      gl.uniform1f(swul, self.sampleCount / (self.sampleCount + 1));\n\n      // camera pos uniform\n      let cpul = gl.getUniformLocation(tracerProgram, 'u_camera_pos');\n      gl.uniform3f(cpul, self.cameraPos.x, self.cameraPos.y, self.cameraPos.z);\n\n      // screen to world matrix uniform\n      const screenToWorldMatrix = self.getScreenToWorldMatrix();\n      let swmul = gl.getUniformLocation(tracerProgram, 'u_screen_to_world');\n      gl.uniformMatrix4fv(swmul, false, screenToWorldMatrix);\n\n      // for progressive rendering, two textures are alteratively used to store the current path trace result\n      gl.bindTexture(gl.TEXTURE_2D, textures[0]);\n      gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, textures[1], 0);\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n      textures.reverse();\n\n      // render to canvas\n      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n      window.requestAnimationFrame((timestamp) => draw(timestamp));\n    }\n    window.requestAnimationFrame((timestamp) => draw(timestamp));\n  },\n  methods: {\n    showHowToPlay() {\n      if (this.cameraMode === 'free') {\n        alert(`\n      How to play on PC or Mac\n        1. move mouse inside to look around\n        2. use WSAD key to walk around\n\n      How to play on mobile devices\n        1. touch and move inside to look around\n        2. use two-finger gesture inside to walk around\n        `);\n      } else {\n        alert(`\n      How to play on PC or Mac\n        1. move mouse inside to rotate camera around the origin\n\n      How to play on mobile devices\n        1. touch inside to rotate camera around the origin\n        `);\n      }\n    },\n    getScreenToWorldMatrix() {\n      let v = [\n        this.cameraDir.x,\n        this.cameraDir.y,\n        this.cameraDir.z\n      ];\n\n      const up = [0.0,1.0,0.0];\n\n      let r = this.crossProduct(\n        v[0],v[1],v[2],\n        up[0],up[1],up[2]\n      );\n\n      r = this.normalize(...r);\n\n      let u = this.crossProduct(\n        v[0],v[1],v[2],\n        r[0],r[1],r[2]\n      );\n\n      const result = new Float32Array([\n        r[0],r[1],r[2],0.0,\n        u[0],u[1],u[2],0.0,\n        v[0],v[1],v[2],0.0,\n        this.screenDist*v[0],this.screenDist*v[1],this.screenDist*v[2],1.0\n      ]);\n      return result;\n    },\n    normalize(x,y,z) {\n      const len = Math.sqrt(x*x+y*y+z*z);\n      return [ x/len, y/len, z/len ];\n    },\n    // methods for implementing the movable camera\n    crossProduct(x1,y1,z1,x2,y2,z2) {\n      return [\n        y1*z2-z1*y2,\n        z1*x2-x1*z2,\n        x1*y2-y1*x2\n      ];\n    },\n    degToRad(deg) {\n      return deg * 3.14159 / 180;\n    },\n    handleLeftRight(speed) {\n      const r = this.crossProduct(this.cameraDir.x, this.cameraDir.y, this.cameraDir.z, 0,1,0);\n      this.cameraPos.x -= speed * r[0];\n      this.cameraPos.y -= speed * r[1];\n      this.cameraPos.z -= speed * r[2];\n    },\n    handleForwardBackward(speed) {\n      this.cameraPos.x += speed * this.cameraDir.x;\n      this.cameraPos.y += speed * this.cameraDir.y;\n      this.cameraPos.z += speed * this.cameraDir.z;\n    },\n    handleKeyPress(e) {\n      const key = e.key;\n      const speed = 0.1;\n      if (key === 'w') {\n        this.sampleCount = 0;\n        if (this.cameraMode === 'free') {\n          this.cameraPos.x += speed * this.cameraDir.x;\n          this.cameraPos.y += speed * this.cameraDir.y;\n          this.cameraPos.z += speed * this.cameraDir.z;\n\n          this.screenOrigin.x = this.cameraPos.x + this.screenDist * this.cameraDir.x;\n          this.screenOrigin.y = this.cameraPos.y + this.screenDist * this.cameraDir.y;\n          this.screenOrigin.z = this.cameraPos.z + this.screenDist * this.cameraDir.z;\n        }\n      } else if (key === 's') {\n        this.sampleCount = 0;\n        if (this.cameraMode === 'free') {\n          this.cameraPos.x -= speed * this.cameraDir.x;\n          this.cameraPos.y -= speed * this.cameraDir.y;\n          this.cameraPos.z -= speed * this.cameraDir.z;\n\n          this.screenOrigin.x = this.cameraPos.x + this.screenDist * this.cameraDir.x;\n          this.screenOrigin.y = this.cameraPos.y + this.screenDist * this.cameraDir.y;\n          this.screenOrigin.z = this.cameraPos.z + this.screenDist * this.cameraDir.z;\n        }\n      } else if (key === 'a') {\n        if (this.cameraMode === 'free') {\n          this.sampleCount = 0;\n          const r = this.crossProduct(this.cameraDir.x, this.cameraDir.y, this.cameraDir.z, 0,1,0);\n          this.cameraPos.x -= speed * r[0];\n          this.cameraPos.y -= speed * r[1];\n          this.cameraPos.z -= speed * r[2];\n\n          this.screenOrigin.x = this.cameraPos.x + this.screenDist * this.cameraDir.x;\n          this.screenOrigin.y = this.cameraPos.y + this.screenDist * this.cameraDir.y;\n          this.screenOrigin.z = this.cameraPos.z + this.screenDist * this.cameraDir.z;\n        }\n      } else if (key === 'd') {\n        if (this.cameraMode === 'free') {\n          this.sampleCount = 0;\n          const r = this.crossProduct(this.cameraDir.x, this.cameraDir.y, this.cameraDir.z, 0,1,0);\n          this.cameraPos.x += speed * r[0];\n          this.cameraPos.y += speed * r[1];\n          this.cameraPos.z += speed * r[2];\n\n          this.screenOrigin.x = this.cameraPos.x + this.screenDist * this.cameraDir.x;\n          this.screenOrigin.y = this.cameraPos.y + this.screenDist * this.cameraDir.y;\n          this.screenOrigin.z = this.cameraPos.z + this.screenDist * this.cameraDir.z;\n        }\n      } else if (key === 'f') {\n        if (this.cameraMode === 'free') {\n          this.cameraMode = 'focus';\n        } else {\n          this.cameraMode = 'free';\n        }\n      }\n    },\n    handleMouseMove(e) {\n      e.preventDefault();\n\n      this.sampleCount = 0;\n      let x = (e.clientX - this.canvas.left ) / this.w - 0.5;\n      let y = (e.clientY - this.canvas.top ) / this.h - 0.5;\n\n      y = -y;\n\n\n      x *= 360;\n      x = this.degToRad(x);\n\n      y *= 180;\n      y = this.degToRad(y);\n\n      this.cameraDir.pitch = y;\n      this.cameraDir.yaw = x;\n\n      this.cameraDir.z = -Math.cos(this.cameraDir.pitch) * Math.cos(this.cameraDir.yaw);\n      this.cameraDir.y = Math.sin(this.cameraDir.pitch);\n      this.cameraDir.x = Math.cos(this.cameraDir.pitch) * Math.sin(this.cameraDir.yaw);\n\n      if (this.cameraMode === 'focus') {\n        this.cameraPos.x = this.screenOrigin.x - this.screenDist * this.cameraDir.x;\n        this.cameraPos.y = this.screenOrigin.y - this.screenDist * this.cameraDir.y;\n        this.cameraPos.z = this.screenOrigin.z - this.screenDist * this.cameraDir.z;\n      } else {\n        this.screenOrigin.x = this.cameraPos.x + this.screenDist * this.cameraDir.x;\n        this.screenOrigin.y = this.cameraPos.y + this.screenDist * this.cameraDir.y;\n        this.screenOrigin.z = this.cameraPos.z + this.screenDist * this.cameraDir.z;\n      }\n    },\n    handleTouchMove(e) {\n      e.preventDefault();\n\n      this.sampleCount = 0;\n      let x = (e.touches[0].clientX - this.canvas.left ) / this.w - 0.5;\n      let y = (e.touches[0].clientY - this.canvas.top ) / this.h - 0.5;\n\n      y = -y;\n\n      if (this.cameraMode === 'free') {\n        if (e.touches.length === 2) {\n          this.handleLeftRight(-0.05*x);\n          this.handleForwardBackward(0.05*y);\n        } else {\n          x *= 360;\n          x = this.degToRad(x);\n\n          y *= 180;\n          y = this.degToRad(y);\n\n          this.cameraDir.pitch += 0.002*y;\n          this.cameraDir.yaw += 0.002*x;\n\n          this.cameraDir.z = -Math.cos(this.cameraDir.pitch) * Math.cos(this.cameraDir.yaw);\n          this.cameraDir.y = Math.sin(this.cameraDir.pitch);\n          this.cameraDir.x = Math.cos(this.cameraDir.pitch) * Math.sin(this.cameraDir.yaw);\n        }\n      } else {\n        this.cameraDir.pitch += 0.02*y;\n        this.cameraDir.yaw += 0.02*x;\n        \n        this.cameraDir.z = -Math.cos(this.cameraDir.pitch) * Math.cos(this.cameraDir.yaw);\n        this.cameraDir.y = Math.sin(this.cameraDir.pitch);\n        this.cameraDir.x = Math.cos(this.cameraDir.pitch) * Math.sin(this.cameraDir.yaw);\n\n        this.cameraPos.x = this.screenOrigin.x - this.screenDist * this.cameraDir.x;\n        this.cameraPos.y = this.screenOrigin.y - this.screenDist * this.cameraDir.y;\n        this.cameraPos.z = this.screenOrigin.z - this.screenDist * this.cameraDir.z;\n      }\n    }\n  }\n};\n</script>\n\n<style>\nbody {\n  margin: 0;\n  user-select: none;\n}\n#app {\n  width: 100vw;\n  overflow: hidden;\n}\n</style>\n","import mod from \"-!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/thread-loader/dist/cjs.js!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/babel-loader/lib/index.js??ref--12-1!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/thread-loader/dist/cjs.js!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/babel-loader/lib/index.js??ref--12-1!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=759e62dc&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../.nvm/versions/node/v10.6.0/lib/node_modules/@vue/cli-service-global/node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}