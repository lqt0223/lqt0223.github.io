(function(t){function e(e){for(var i,o,c=e[0],r=e[1],l=e[2],p=0,u=[];p<c.length;p++)o=c[p],n[o]&&u.push(n[o][0]),n[o]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);d&&d(e);while(u.length)u.shift()();return a.push.apply(a,l||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],i=!0,c=1;c<s.length;c++){var r=s[c];0!==n[r]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=s[0]))}return t}var i={},n={app:0},a=[];function o(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=i,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(s,i,function(e){return t[e]}.bind(null,i));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var d=r;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"0038":function(t,e){!function(t){var e,s='<svg><symbol id="icon-success" viewBox="0 0 1024 1024"><path d="M512 995.555556C244.935111 995.555556 28.444444 779.064889 28.444444 512S244.935111 28.444444 512 28.444444s483.555556 216.490667 483.555556 483.555556-216.490667 483.555556-483.555556 483.555556z m0-56.888889c235.648 0 426.666667-191.018667 426.666667-426.666667C938.666667 276.352 747.648 85.333333 512 85.333333 276.352 85.333333 85.333333 276.352 85.333333 512c0 235.648 191.018667 426.666667 426.666667 426.666667z m250.225778-603.349334a28.444444 28.444444 0 1 1 39.992889 40.476445l-334.222223 330.268444a28.444444 28.444444 0 0 1-40.106666-0.128l-163.555556-163.555555a28.444444 28.444444 0 0 1 40.220445-40.220445l143.559111 143.559111 314.112-310.4z" fill="#FFFFFF" ></path></symbol><symbol id="icon-loading" viewBox="0 0 1024 1024"><path d="M958.862222 326.897778a28.444444 28.444444 0 0 1-52.551111 21.788444 427.320889 427.320889 0 0 0-92.615111-138.382222A425.159111 425.159111 0 0 0 512 85.333333C276.352 85.333333 85.333333 276.352 85.333333 512c0 235.648 191.018667 426.666667 426.666667 426.666667 235.648 0 426.666667-191.018667 426.666667-426.666667a28.444444 28.444444 0 1 1 56.888889 0c0 267.064889-216.490667 483.555556-483.555556 483.555556S28.444444 779.064889 28.444444 512 244.935111 28.444444 512 28.444444a482.033778 482.033778 0 0 1 341.930667 141.624889 484.209778 484.209778 0 0 1 104.931555 156.828445z" fill="#FFFFFF" ></path><path d="M995.555556 512a28.444444 28.444444 0 1 1-56.888889 0c0-132.878222-61.098667-255.616-163.726223-336.028444a28.444444 28.444444 0 0 1 35.100445-44.785778C926.279111 222.293333 995.555556 361.443556 995.555556 512z" fill="#006CB8" ></path></symbol><symbol id="icon-warning" viewBox="0 0 1024 1024"><path d="M512 995.555556C244.935111 995.555556 28.444444 779.064889 28.444444 512S244.935111 28.444444 512 28.444444s483.555556 216.490667 483.555556 483.555556-216.490667 483.555556-483.555556 483.555556z m0-56.888889c235.648 0 426.666667-191.018667 426.666667-426.666667C938.666667 276.352 747.648 85.333333 512 85.333333 276.352 85.333333 85.333333 276.352 85.333333 512c0 235.648 191.018667 426.666667 426.666667 426.666667z m-13.255111-711.111111h26.510222a28.444444 28.444444 0 0 1 28.444445 29.397333l-12.344889 369.777778A28.444444 28.444444 0 0 1 512.938667 654.222222h-1.877334a28.444444 28.444444 0 0 1-28.416-27.491555l-12.330666-369.777778A28.444444 28.444444 0 0 1 498.744889 227.555556zM512 810.666667a42.666667 42.666667 0 1 1 0-85.333334 42.666667 42.666667 0 0 1 0 85.333334z" fill="#FFFFFF" ></path></symbol><symbol id="icon-signin" viewBox="0 0 1024 1024"><path d="M170.666667 142.222222v28.444445a113.777778 113.777778 0 1 0 227.555555 0v-28.444445h227.555556v28.444445a113.777778 113.777778 0 1 0 227.555555 0v-28.444445h56.888889a113.777778 113.777778 0 0 1 113.777778 113.777778v654.222222a113.777778 113.777778 0 0 1-113.777778 113.777778H113.777778a113.777778 113.777778 0 0 1-113.777778-113.777778V256a113.777778 113.777778 0 0 1 113.777778-113.777778h56.888889z m0 227.555556a56.888889 56.888889 0 0 0-56.888889 56.888889v426.666666a56.888889 56.888889 0 0 0 56.888889 56.888889h682.666666a56.888889 56.888889 0 0 0 56.888889-56.888889V426.666667a56.888889 56.888889 0 0 0-56.888889-56.888889H170.666667z m113.777777-369.777778a56.888889 56.888889 0 0 1 56.888889 56.888889v113.777778a56.888889 56.888889 0 1 1-113.777777 0V56.888889a56.888889 56.888889 0 0 1 56.888888-56.888889z m455.111112 0a56.888889 56.888889 0 0 1 56.888888 56.888889v113.777778a56.888889 56.888889 0 1 1-113.777777 0V56.888889a56.888889 56.888889 0 0 1 56.888889-56.888889z m-77.568 496.056889a42.666667 42.666667 0 1 1 60.330666 60.330667L521.898667 756.821333a71.111111 71.111111 0 0 1-105.671111-5.674666l-79.672889-98.901334a42.666667 42.666667 0 1 1 66.446222-53.532444l69.76 86.570667 189.226667-189.226667z" fill="#FFFFFF" ></path></symbol><symbol id="icon-reward" viewBox="0 0 1024 1024"><path d="M856.177778 256H967.111111a56.888889 56.888889 0 0 1 56.888889 56.888889v113.777778a56.888889 56.888889 0 0 1-56.888889 56.888889H56.888889a56.888889 56.888889 0 0 1-56.888889-56.888889v-113.777778a56.888889 56.888889 0 0 1 56.888889-56.888889h129.735111a201.713778 201.713778 0 0 1-29.312-30.065778c-34.659556-43.633778-37.233778-93.980444-4.522667-146.318222 32.711111-52.352 79.089778-72.106667 133.489778-60.088889 35.271111 7.793778 61.809778 22.016 128.497778 63.715556l4.024889 2.503111c42.865778 26.794667 78.506667 59.505778 102.599111 93.624889 24.106667-34.119111 59.733333-66.830222 102.613333-93.624889l4.010667-2.503111c66.702222-41.699556 93.240889-55.921778 128.497778-63.715556 54.4-12.017778 100.792889 7.736889 133.504 60.088889 32.711111 52.337778 30.122667 102.684444-4.522667 146.318222A201.713778 201.713778 0 0 1 856.177778 256z m-514.517334 0h124.842667a114.631111 114.631111 0 0 0-9.528889-18.915556c-16.568889-27.136-46.307556-55.793778-83.399111-78.961777l-4.039111-2.531556c-57.102222-35.697778-79.928889-47.928889-101.660444-52.736-18.958222-4.181333-29.070222 0.113778-42.723556 21.973333s-13.084444 32.824889-1.024 48.028445c13.838222 17.422222 34.844444 32.583111 91.975111 68.266667l4.039111 2.517333c7.125333 4.465778 14.321778 8.590222 21.518222 12.359111zM701.155556 256a329.784889 329.784889 0 0 0 21.532444-12.359111l4.039111-2.517333c57.116444-35.683556 78.122667-50.844444 91.960889-68.266667 12.088889-15.203556 12.643556-26.168889-1.009778-48.028445-13.653333-21.859556-23.765333-26.168889-42.723555-21.973333-21.731556 4.807111-44.558222 17.038222-101.688889 52.736l-4.024889 2.531556c-37.077333 23.182222-66.816 51.825778-83.399111 78.947555A114.631111 114.631111 0 0 0 576.284444 256H701.155556zM140.942222 540.444444h742.144A69.831111 69.831111 0 0 1 952.888889 610.275556v343.893333A69.831111 69.831111 0 0 1 883.057778 1024H140.942222A69.831111 69.831111 0 0 1 71.111111 954.168889V610.275556A69.831111 69.831111 0 0 1 140.942222 540.444444zM512 597.333333a42.666667 42.666667 0 0 0-42.666667 42.666667v284.444444a42.666667 42.666667 0 0 0 85.333334 0V640a42.666667 42.666667 0 0 0-42.666667-42.666667z" fill="#FFFFFF" ></path></symbol></svg>',i=(e=document.getElementsByTagName("script"))[e.length-1].getAttribute("data-injectcss");if(i&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}!function(e){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(e,0);else{var s=function t(){document.removeEventListener("DOMContentLoaded",t,!1),e()};document.addEventListener("DOMContentLoaded",s,!1)}else document.attachEvent&&(i=e,n=t.document,a=!1,o=function(){a||(a=!0,i())},(c=function(){try{n.documentElement.doScroll("left")}catch(e){return void setTimeout(c,50)}o()})(),n.onreadystatechange=function(){"complete"==n.readyState&&(n.onreadystatechange=null,o())});var i,n,a,o,c}(function(){var t,e;(t=document.createElement("div")).innerHTML=s,s=null,(e=t.getElementsByTagName("svg")[0])&&(e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.width=0,e.style.height=0,e.style.overflow="hidden",function(t,e){e.firstChild?function(t,e){e.parentNode.insertBefore(t,e)}(t,e.firstChild):e.appendChild(t)}(e,document.body))})}(window)},"0059":function(t,e,s){},"0077":function(t,e,s){"use strict";var i=s("4263"),n=s.n(i);n.a},"00cb":function(t,e,s){"use strict";var i=s("c01d"),n=s.n(i);n.a},"00e6":function(t,e,s){},"02e5":function(t,e,s){},"0355":function(t,e,s){},"0357":function(t,e,s){},"051d":function(t,e,s){},"054f":function(t,e,s){"use strict";var i=s("ea6d"),n=s.n(i);n.a},"0650":function(t,e,s){},"07dd":function(t,e,s){"use strict";var i=s("622b"),n=s.n(i);n.a},"0a37":function(t,e,s){},"0a68":function(t,e,s){},"0a74":function(t,e,s){"use strict";var i=s("6288"),n=s.n(i);n.a},"0b48":function(t,e,s){"use strict";var i=s("12ca"),n=s.n(i);n.a},"0b49":function(t,e,s){},"0d5d":function(t,e,s){"use strict";var i=s("3e13"),n=s.n(i);n.a},"0f02":function(t,e,s){},"0f67":function(t,e,s){},"11f9":function(t,e,s){"use strict";var i=s("880b"),n=s.n(i);n.a},"12ca":function(t,e,s){},1458:function(t,e,s){},1470:function(t,e,s){},"166d":function(t,e,s){},1774:function(t,e,s){"use strict";var i=s("3244"),n=s.n(i);n.a},"19b6":function(t,e,s){},"1b20":function(t,e,s){},"1e58":function(t,e,s){"use strict";var i=s("da66"),n=s.n(i);n.a},2297:function(t,e,s){"use strict";var i=s("cb54"),n=s.n(i);n.a},"22c2":function(t,e,s){"use strict";var i=s("4d3c"),n=s.n(i);n.a},"25eb4":function(t,e,s){},2691:function(t,e,s){},"26d2":function(t,e,s){"use strict";var i=s("ef3e"),n=s.n(i);n.a},"272d":function(t,e,s){},2861:function(t,e,s){"use strict";var i=s("e637"),n=s.n(i);n.a},"2a6e":function(t,e,s){"use strict";var i=s("3cd0"),n=s.n(i);n.a},"2d3f":function(t,e,s){},"2dbc":function(t,e,s){"use strict";var i=s("d072"),n=s.n(i);n.a},"2dfb":function(t,e,s){"use strict";var i=s("5074"),n=s.n(i);n.a},"2eb6":function(t,e,s){"use strict";var i=s("300f"),n=s.n(i);n.a},"2fc9":function(t,e,s){"use strict";var i=s("a9d3"),n=s.n(i);n.a},"300f":function(t,e,s){},"313e":function(t,e,s){},"318b":function(t,e,s){},"31cd":function(t,e,s){"use strict";var i=s("c37f"),n=s.n(i);n.a},3244:function(t,e,s){},"33a7":function(t,e,s){},"344e":function(t,e,s){},"352a":function(t,e,s){"use strict";var i=s("f1b9"),n=s.n(i);n.a},"352c":function(t,e,s){"use strict";var i=s("6126"),n=s.n(i);n.a},3741:function(t,e,s){},3981:function(t,e,s){"use strict";var i=s("0355"),n=s.n(i);n.a},"3ae1":function(t,e,s){"use strict";var i=s("a29c"),n=s.n(i);n.a},"3cd0":function(t,e,s){},"3e13":function(t,e,s){},"3f41":function(t,e,s){"use strict";var i=s("50b7"),n=s.n(i);n.a},"3ffa":function(t,e,s){"use strict";var i=s("ba75"),n=s.n(i);n.a},4114:function(t,e,s){"use strict";var i=s("c25f"),n=s.n(i);n.a},"41fa":function(t,e,s){"use strict";var i=s("0650"),n=s.n(i);n.a},4263:function(t,e,s){},4536:function(t,e,s){"use strict";var i=s("3741"),n=s.n(i);n.a},"46ce":function(t,e,s){"use strict";var i=s("b06b"),n=s.n(i);n.a},"47e4":function(t,e,s){},"49bc":function(t,e,s){},"4ccb":function(t,e,s){},"4d3c":function(t,e,s){},"4df1":function(t,e,s){"use strict";var i=s("0357"),n=s.n(i);n.a},"4e38":function(t,e,s){"use strict";var i=s("166d"),n=s.n(i);n.a},"4e6b":function(t,e,s){},"4ea9":function(t,e,s){"use strict";var i=s("8f65"),n=s.n(i);n.a},"4ec4":function(t,e,s){"use strict";var i=s("1470"),n=s.n(i);n.a},5074:function(t,e,s){},"50b7":function(t,e,s){},5269:function(t,e,s){"use strict";var i=s("313e"),n=s.n(i);n.a},5591:function(t,e,s){"use strict";var i=s("6138"),n=s.n(i);n.a},5616:function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var i=s("2b0e"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("canvas",{attrs:{id:"cvs",width:t.w,height:t.h},on:{touchmove:t.handleMouseMove}})])},a=[],o=(s("63d9"),s("2d3f"),s("25eb4"),0),c=0,r=[-100,0,-100,100,0,-100,-100,0,100,100,0,100],l=[-.5,.5,.5,0,0,1,0,0,.5,.5,.5,0,0,1,1,0,-.5,-.5,.5,0,0,1,0,1,.5,.5,.5,0,0,1,1,0,-.5,-.5,.5,0,0,1,0,1,.5,-.5,.5,0,0,1,1,1,-.5,.5,-.5,0,0,-1,0,0,.5,.5,-.5,0,0,-1,1,0,-.5,-.5,-.5,0,0,-1,0,1,.5,.5,-.5,0,0,-1,1,0,-.5,-.5,-.5,0,0,-1,0,1,.5,-.5,-.5,0,0,-1,1,1,-.5,.5,-.5,-1,0,0,0,0,-.5,.5,.5,-1,0,0,0,1,-.5,-.5,-.5,-1,0,0,1,0,-.5,-.5,.5,-1,0,0,1,1,-.5,.5,.5,-1,0,0,0,1,-.5,-.5,-.5,-1,0,0,1,0,.5,.5,-.5,1,0,0,0,0,.5,.5,.5,1,0,0,0,1,.5,-.5,-.5,1,0,0,1,0,.5,-.5,.5,1,0,0,1,1,.5,.5,.5,1,0,0,0,1,.5,-.5,-.5,1,0,0,1,0,-.5,.5,-.5,0,1,0,0,0,-.5,.5,.5,0,1,0,0,1,.5,.5,.5,0,1,0,1,1,.5,.5,.5,0,1,0,1,1,.5,.5,-.5,0,1,0,1,0,-.5,.5,-.5,0,1,0,0,0,-.5,-.5,-.5,0,-1,0,0,0,-.5,-.5,.5,0,-1,0,0,1,.5,-.5,.5,0,-1,0,1,1,.5,-.5,.5,0,-1,0,1,1,.5,-.5,-.5,0,-1,0,1,0,-.5,-.5,-.5,0,-1,0,0,0];function d(t,e,s){var i=e,n=s,a=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(a,i),t.compileShader(a),!t.getShaderParameter(a,t.COMPILE_STATUS))return console.error("An error occurred compiling the vertex shaders: "+t.getShaderInfoLog(a)),t.deleteShader(a),null;var o=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(o,n),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))return console.error("An error occurred compiling the fragment shaders: "+t.getShaderInfoLog(o)),t.deleteShader(o),null;var c=t.createProgram();return t.attachShader(c,a),t.attachShader(c,o),t.linkProgram(c),c}var p={data:function(){return{w:750,h:750}},mounted:function(){var t=document.querySelector("#cvs").getContext("webgl",{stencil:!0,antialias:!1}),e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e);var s=new Float32Array(l);t.bufferData(t.ARRAY_BUFFER,s,t.STATIC_DRAW);var i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i);var n=new Float32Array(r);t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW);var a=d(t,"\n        attribute vec3 aPosition;\n\n        uniform mat4 model;\n        uniform mat4 view;\n        uniform mat4 projection;\n\n        varying vec3 FragPos;\n\n        void main() {\n          FragPos = vec3(model * vec4(aPosition, 1.0));\n          gl_Position = projection * view * vec4(FragPos, 1.0);\n        }\n      ","\n        precision mediump float;\n        varying vec3 FragPos;\n\n        void main() {\n          vec2 xz = FragPos.xz;\n          float line_width = pow(-xz.y, 0.9) * .02;\n          xz *= 2.;\n          vec2 f = fract(xz);\n          vec4 color;\n          if (f.x <= line_width || f.y <= line_width) {\n            color = vec4(1.,1.,1.,.2);\n          } else {\n            color = vec4(0.);\n          }\n          gl_FragColor = color;\n        }\n      "),p=d(t,"\n        attribute vec3 aPosition;\n        attribute vec3 aNormal;\n        attribute vec2 aTexCoord;\n\n        uniform mat4 model;\n        uniform mat4 view;\n        uniform mat4 projection;\n        uniform mat4 mouse;\n\n        varying vec3 Normal;\n        varying vec3 FragPos;\n        varying vec3 Color;\n        varying vec2 TexCoord;\n        void main() {\n          FragPos = vec3(model * vec4(aPosition, 1.0));\n          Normal = vec3(model * vec4(aNormal, 1.0));\n          Color = aPosition * .5 + .5;\n          TexCoord = aTexCoord;\n          \n          gl_Position = projection * view * vec4(FragPos, 1.0);\n        }\n      ","\n        precision mediump float;\n        varying vec3 Normal;\n        varying vec3 FragPos;\n        varying vec3 Color;\n        varying vec2 TexCoord;\n\n        uniform float utime;\n\n        const vec3 light = vec3(2.,2.,0.);\n        const vec3 camera = vec3(0.,0.,1.);\n\n        vec2 rotate2d(vec2 st, float a) {\n          float c = cos(a);\n          float s = sin(a);\n          mat2 t = mat2(c,-s,s,c);\n          return t*st;\n        }\n\n        #define DELTA 0.02\n        #define OFFSET 0.002\n        #define SCALE 2.\n        #define IRON_PLATE_SCALE 10.\n\n        float sdfcircle(vec2 st, vec2 c, float r) {\n          return length(st-c)-r;\n        }\n\n        float avr(vec3 c) {\n          return (c.r+c.g+c.b)/3.;\n        }\n\n        float lotus(vec2 st) {\n            float d1 = sdfcircle(st,vec2(0.),.75);\n            float d2 = sdfcircle(st,vec2(1.),.75);\n            if (d1 > 0.||d2>.0) {\n                return 0.;\n            } else {\n                return 1.;\n            }\n        }\n\n        float iron_plate(vec2 st) {\n            st*=IRON_PLATE_SCALE;\n            vec2 i = floor(st);\n            vec2 f = fract(st);\n            f = f * .5 + .25;\n            if (mod((i.x), 2.)==0.) {\n                f.x=1.-f.x;\n            }\n            if (mod((i.x+i.y), 2.)==0.) {\n                f=0.1*f;\n            }\n            float c1 = lotus(f-vec2(-DELTA,-DELTA));\n            float c2 = lotus(f-vec2(DELTA,DELTA));\n            float c3 = lotus(f-vec2(-DELTA,DELTA));\n            float c4 = lotus(f-vec2(DELTA,-DELTA));\n\n            float color = (c1+c2+c3+c4)/4.;\n            return color;\n        }\n\n        vec3 iron_plate_nm(vec2 st) {\n            float ac = iron_plate(vec2(st.x+OFFSET,st.y));\n            float bc = iron_plate(vec2(st.x-OFFSET,st.y));\n            float cc = iron_plate(vec2(st.x,st.y+OFFSET));\n            float dc = iron_plate(vec2(st.x,st.y-OFFSET));\n\n            ac*=ac;\n            bc*=bc;\n            cc*=cc;\n            dc*=dc;\n\n            float e = SCALE * ac - SCALE * bc;\n            float f = SCALE * cc - SCALE * dc;\n\n            vec3 s = vec3(1.,0.,e);\n            vec3 t = vec3(0.,1.,f);\n\n            vec3 cross_p = cross(s, t);\n            vec3 n = cross_p / length(cross_p);\n\n            n = n*.5 +.5;\n            return n;\n        }\n\n        void main() {\n          vec3 objectColor = vec3(.3);\n          vec3 rlight = light;\n          rlight.xz = rotate2d(light.xz, utime*2.);\n          vec3 norm = normalize(Normal);\n          vec3 preturb = iron_plate_nm(TexCoord);\n          norm = preturb;\n          norm = normalize(norm);\n          vec3 lightDir = normalize(rlight-FragPos);\n          vec3 ambient = 0.5 * objectColor;\n          float diff = max(dot(lightDir, norm),0.);\n          vec3 diffuse = diff * objectColor;\n\n          vec3 reflectDir = reflect(-lightDir, norm);\n          float spec = pow(max(dot(reflectDir, camera), 0.), 256.);\n          vec3 specular = spec * objectColor;\n\n          vec3 result = ambient + .8*diffuse+1.0*specular;\n          gl_FragColor = vec4(result, 1.);\n        }\n      "),u=d(t,"\n        attribute vec3 aPosition;\n        uniform mat4 model;\n        uniform mat4 view;\n        uniform mat4 projection;\n        uniform mat4 mouse;\n\n        void main() {\n          gl_Position = projection * view * model * vec4(aPosition, 1.0);\n        }\n      ","\n        void main() {\n          gl_FragColor = vec4(1.,.5,0.,1.);\n        }\n      "),_=0,m=0;function h(s){s||(s=0),s*=5e-4;var n=s-m;m=s,t.enable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),t.blendFunc(t.SRC_ALPHA,t.ONE),t.disable(t.BLEND),t.clearColor(.3,.3,.3,1),t.clearDepth(1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(0,3,t.FLOAT,!1,32,0),t.enableVertexAttribArray(0),t.bindAttribLocation(p,0,"aPosition"),t.vertexAttribPointer(1,3,t.FLOAT,!1,32,12),t.enableVertexAttribArray(1),t.bindAttribLocation(p,1,"aNormal"),t.vertexAttribPointer(2,2,t.FLOAT,!1,32,24),t.enableVertexAttribArray(2),t.bindAttribLocation(p,2,"aTexCoord"),t.linkProgram(p),t.useProgram(p);var r=mat4.create(),l=t.getUniformLocation(p,"model");t.uniformMatrix4fv(l,!1,r);var d=mat4.create(),g=2*o,v=8*c,f=0*Math.cos(g)-3*Math.sin(g),C=0*Math.sin(g)+3*Math.cos(g);mat4.lookAt(d,[f,1-v,C],[0,0,0],[0,1,0]);var y=t.getUniformLocation(p,"view");t.uniformMatrix4fv(y,!1,d);var b=mat4.create();mat4.perspective(b,45*Math.PI/180,1,.1,100);var w=t.getUniformLocation(p,"projection");t.uniformMatrix4fv(w,!1,b);var S=mat4.create(),D=t.getUniformLocation(p,"mouse");t.uniformMatrix4fv(D,!1,S);var k=t.getUniformLocation(p,"utime");t.uniform1f(k,_),t.clear(t.STENCIL_BUFFER_BIT),t.stencilFunc(t.ALWAYS,1,255),t.stencilOp(t.REPLACE,t.KEEP,t.REPLACE),t.stencilMask(255),t.drawArrays(t.TRIANGLES,0,36),t.vertexAttribPointer(0,3,t.FLOAT,!1,32,0),t.enableVertexAttribArray(0),t.bindAttribLocation(u,0,"aPosition"),t.linkProgram(u),t.useProgram(u),r=mat4.create(),mat4.scale(r,r,[1.02,1.02,1.02]),l=t.getUniformLocation(u,"model"),t.uniformMatrix4fv(l,!1,r),y=t.getUniformLocation(u,"view"),t.uniformMatrix4fv(y,!1,d),w=t.getUniformLocation(u,"projection"),t.uniformMatrix4fv(w,!1,b),D=t.getUniformLocation(u,"mouse"),t.uniformMatrix4fv(D,!1,S),t.stencilFunc(t.NOTEQUAL,1,255),t.stencilMask(0),t.disable(t.STENCIL_TEST),t.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,i),t.vertexAttribPointer(0,3,t.FLOAT,!1,12,0),t.enableVertexAttribArray(0),t.bindAttribLocation(a,0,"aPosition"),t.linkProgram(a),t.useProgram(a),r=mat4.create(),l=t.getUniformLocation(a,"model"),t.uniformMatrix4fv(l,!1,r),y=t.getUniformLocation(a,"view"),t.uniformMatrix4fv(y,!1,d),w=t.getUniformLocation(a,"projection"),t.uniformMatrix4fv(w,!1,b),t.drawArrays(t.TRIANGLE_STRIP,0,4),_+=n,window.requestAnimationFrame(function(t){return h(t)})}h()},methods:{handleMouseMove:function(t){var e=t.touches[0].clientX,s=e/this.w*4-1,i=t.touches[0].clientY,n=i/this.h*4-1;o=s,c=-n}}},u=p,_=(s("5c0b"),s("2877")),m=Object(_["a"])(u,n,a,!1,null,null,null),h=m.exports,g=s("8c4f"),v=s("75fc"),f=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-list"},[s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchEcProductList}},[s("div",{staticClass:"ec-product-list__bg"},[s("div",{staticClass:"ec-product-list__select-city"},[t.cityList&&t.currentCity?s("div",{staticClass:"ec-product-list__select-city__button"},[s("div",{staticClass:"ec-product-list__select-city__button__current-city"},[t._v(t._s(t.currentCity.cityName))]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.currentCity,expression:"currentCity"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.currentCity=e.target.multiple?s:s[0]}}},t._l(t.cityList,function(e){return s("option",{key:e.cityId,domProps:{value:e}},[t._v(t._s(e.cityName))])}),0)]):t._e()]),t.ecProductTabs.length>0?s("div",{staticClass:"ec-product-list__tab-list"},t._l(t.ecProductTabs,function(e,i){return s("div",{key:i,staticClass:"ec-product-list__tab-list__item",class:t.currentTab===e?"active":"",on:{click:function(s){return t.setCurrentTab(e)}}},[t._v("\n          "+t._s(e)+"\n        ")])}),0):t._e(),t.filterEcProductList?s("div",{staticClass:"ec-product-list__list"},[t.filterEcProductList.length>0?t._l(t.filterEcProductList,function(e){return s("product-item",{key:e.commodityId,attrs:{product:e},nativeOn:{click:function(s){return t.gotoEcProductDetail(e.commodityId)}}})}):[s("div",{staticClass:"ec-product-list__list__no-data"},[s("div",{staticClass:"ec-product-list__list__no-data__icon"}),s("div",{staticClass:"ec-product-list__list__no-data__text"},[t._v("暂无内容")])])]],2):t._e()])]),s("goto-home"),s("div",{staticClass:"ec-product-list__my-order-list-button",on:{click:t.gotoMyOrderList}})],1)},C=[],y=s("795b"),b=s.n(y),w=(s("6762"),s("2fdb"),s("96cf"),s("3b8d")),S=s("f499"),D=s.n(S),k=s("bc3a"),T=s.n(k),x=s("c53e"),A=s.n(x),I="srs_signature_yoren2016",N="c0e9dcfdf2bf16fa5f169d744f142eac1d70dee1",L="yO7rE1nE0ck2Ey",P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function E(){for(var t="",e=0;e<6;e++){var s=Math.floor(Math.random()*P.length),i=P[s];t+=i}return t}function M(t){var e=E(),s=(new Date).getTime(),i=new A.a("SHA-1","TEXT");i.update("".concat(t).concat(e).concat(s));var n=i.getHash("HEX");return{nonce:e,timestamp:s,signature:n}}var $={generateMainApiSignature:function(){return M(I)},generateSignatureForPltApi:function(){return M(N)},generateModulesApi:function(){return M(L)}},F="https://lawsonapp.api.yorentick.cn",O={fetchUserInfo:function(t){var e=t.regionBlockCode,s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new b.a(function(t,s){T.a.get("".concat(F,"/app/v1/user/getUserInfo/"),{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},fetchUserGroupInfo:function(t){var e=t.regionBlockCode,s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new b.a(function(t,s){T.a.get("".concat(F,"/app/v1/user/group"),{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})}},R="https://lawsonapp.api.yorentick.cn",B={fetchEcProductShopList:function(t){var e=t.regionBlockCode,s=t.cityId,i=$.generateModulesApi(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(R,"/modules/mina/ec/getCommodityList");return T.a.get(c,{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e,cityId:s}})},fetchEcProductShopDetail:function(t){var e=t.commodityId,s=$.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(R,"/modules/mina/ec/getCommodityDetail?commodityId=").concat(e);return T.a.get(o,{params:{timestamp:i,nonce:n,signature:a}})},createOrder:function(t){var e=t.commodityId,s=t.quantity,i=$.generateModulesApi(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(R,"/modules/mina/ec/addOrder");return T.a.post(c,{timestamp:n,nonce:a,signature:o,commodityId:e,qty:s})},fetchOrderDetail:function(t){var e=t.orderId,s=$.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(R,"/modules/mina/ec/getOrderDetail?orderId=").concat(e);return T.a.get(o,{params:{timestamp:i,nonce:n,signature:a}})},fetchPayOrderDetail:function(t){var e=t.orderId,s=$.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(R,"/modules/mina/ec/getPayedOrderDetail?orderId=").concat(e);return T.a.get(o,{params:{timestamp:i,nonce:n,signature:a}})},fetchOrderShopList:function(t){var e=t.orderId,s=$.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(R,"/modules/mina/ec/getOrderShopList?orderId=").concat(e);return T.a.get(o,{params:{timestamp:i,nonce:n,signature:a}})},fetchMyOrderList:function(t){var e=t.regionBlockCode,s=$.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(R,"/modules/mina/ec/getOrderList?regionBlockCode=").concat(e);return T.a.get(o,{params:{timestamp:i,nonce:n,signature:a}})},deleteOrder:function(t){var e=t.orderId,s=$.generateModulesApi(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(R,"/modules/mina/ec/deleteOrder");return T.a.post(o,{timestamp:i,nonce:n,signature:a,orderId:e})},editOrder:function(t){var e=t.orderId,s=t.takeDate,i=t.shopId,n=$.generateModulesApi(),a=n.timestamp,o=n.nonce,c=n.signature,r="".concat(R,"/modules/mina/ec/modifyOrder");return T.a.post(r,{timestamp:a,nonce:o,signature:c,orderId:e,takeDate:s,shopId:i})}},U="https://lawsonapp.api.yorentick.cn",j={fetchJsSdkSignatureData:function(t){var e=t.url;return new b.a(function(t,s){var i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;T.a.get("".concat(U,"/app/v1/weixin/authorize/getsignature/"),{params:{timestamp:n,nonce:a,signature:o,url:e}}).then(function(e){var i=0===e.data.code;i?t(e.data.data):s(e)}).catch(function(t){s(t)})})}},H=s("cebc"),W="https://lawsonapp.api.yorentick.cn",G={fetchCampaignList:function(t){var e=t.regionBlockCode,s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new b.a(function(t,s){T.a.get("".concat(W,"/app/v1/campaign/"),{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e,page:1,pageSize:1e3}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data.list;t(n)}else s(e)}).catch(function(t){s(t)})})},fetchCampaignDetail:function(t){var e=t.campaignDetailId,s=t.regionBlockCode,i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new b.a(function(t,i){T.a.get("".concat(W,"/app/v1/campaign/").concat(e),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:s}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})},campaignGift:function(t){var e=t.campaignId,s=t.stampId,i=t.regionBlockCode,n=$.generateMainApiSignature(),a=n.timestamp,o=n.nonce,c=n.signature;return new b.a(function(t,n){T.a.post("".concat(W,"/app/v1/campaign/gift"),{timestamp:a,nonce:o,signature:c,regionBlockCode:i,campaignId:e,stampId:s}).then(function(e){var s=0===e.data.code;if(s){var i=e.data.data;t(i)}else n(e)}).catch(function(t){n(t)})})},campaignGiftSaveAddress:function(t){var e=t.saveAddressInfo,s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new b.a(function(t,s){T.a.post("".concat(W,"/app/v1/campaign/saveAddress"),Object(H["a"])({timestamp:i,nonce:n,signature:a},e)).then(function(e){var i=0===e.data.code;if(i){var n=e.data;t(n)}else s(e)}).catch(function(t){s(t)})})},getCampaignProducts:function(t){var e=t.regionBlockCode,s=t.campaignDetailId,i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new b.a(function(t,i){T.a.get("".concat(W,"/app/v1/commodityAndType/").concat(s),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data;t(n)}else i(e)}).catch(function(t){i(t)})})},campaignBarrage:function(t){var e=t.regionBlockCode,s=t.campaignId,i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new b.a(function(t,i){T.a.get("".concat(W,"/app/v1/campaign/barrage"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e,campaignId:s}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})},getSendAddress:function(t){var e=t.regionBlockCode,s=t.campaignId,i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new b.a(function(t,i){T.a.get("".concat(W,"/app/v1/campaign/address"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e,campaignId:s}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})},getUserGiftInfo:function(t){var e=t.userGiftId,s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(W,"/app/v1/campaign/userGift?userGiftId=").concat(e);return new b.a(function(t,e){T.a.get(o,{params:{timestamp:i,nonce:n,signature:a}}).then(function(s){var i=0===s.data.code;if(i){var n=s.data;t(n)}else e(s)}).catch(function(t){e(t)})})}},z="https://lawsonapp.api.yorentick.cn",V={fetch:function(t){var e=t.regionBlockCode,s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(z,"/app/v1/mina/user/address");return T.a.get(o,{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}})},add:function(t){var e=t.addressInfo,s=t.regionBlockCode,i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(z,"/app/v1/mina/user/address/add");return T.a.post(c,Object(H["a"])({timestamp:n,nonce:a,signature:o,regionBlockCode:s},e))},edit:function(t){var e=t.addressInfo,s=t.regionBlockCode,i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(z,"/app/v1/mina/user/address/edit");return T.a.post(c,Object(H["a"])({timestamp:n,nonce:a,signature:o,regionBlockCode:s},e))}},q="https://lawsonapp.api.yorentick.cn",Y="https://plt.api.yorentick.cn",Q={fetchUserCouponDetail:function(t){var e=t.couponId,s=t.userCouponId,i=t.regionBlockCode;return new b.a(function(t,n){var a=$.generateMainApiSignature(),o=a.timestamp,c=a.nonce,r=a.signature;T.a.get("".concat(q,"/app/v1/mina/coupon/detail"),{params:{timestamp:o,nonce:c,signature:r,regionBlockCode:i,couponId:e,userCouponId:s}}).then(function(e){var s=0===e.data.code;if(s){var i=e.data.data;t(i)}else n(e)}).catch(function(t){n(t)})})},fetchCouponDetail:function(t){var e=t.couponId,s=t.regionBlockCode;return new b.a(function(t,i){var n=$.generateMainApiSignature(),a=n.timestamp,o=n.nonce,c=n.signature;T.a.get("".concat(q,"/app/v1/mina/coupon/detail"),{params:{timestamp:a,nonce:o,signature:c,regionBlockCode:s,couponId:e}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})},fetchPickCouponList:function(t){var e=t.regionBlockCode;return new b.a(function(t,s){var i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;T.a.get("".concat(q,"/app/v1/mina/coupon/pickCoupon/couponList"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},hasNewShopsCoupon:function(t){var e=t.regionBlockCode;return new b.a(function(t,s){var i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;T.a.get("".concat(q,"/app/v1/newShops/hasCoupon"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},fetchPickCouponActivityList:function(t){var e=t.regionBlockCode;return new b.a(function(t,s){var i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;T.a.get("".concat(q,"/app/v1/pickCouponActivity/"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},pickCouponActivity:function(t){var e=t.pickCouponActivityId,s=t.couponId;return new b.a(function(t,i){var n=$.generateMainApiSignature(),a=n.timestamp,o=n.nonce,c=n.signature;T.a.post("".concat(q,"/app/v1/pickCouponActivity/pick"),{timestamp:a,nonce:o,signature:c,pickCouponActivityId:e,couponId:s}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})},pickCoupon:function(t){var e=t.couponId;return new b.a(function(t,s){var i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;T.a.post("".concat(q,"/app/v1/mina/coupon/pickCoupon/pick"),{timestamp:n,nonce:a,signature:o,couponId:e}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},getNewShopTopBanner:function(t){var e=t.regionBlockCode;return new b.a(function(t,s){var i=$.generateSignatureForPltApi(),n=i.timestamp,a=i.nonce,o=i.signature;T.a.get("".concat(Y,"/pltapp/v1/banner/forMina"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e,displayType:"minaNewShopTop"}}).then(function(e){t(e.data)}).catch(function(t){s(t)})})},fetchPickCouponDetail:function(t){var e=t.pickCouponActivityId;return new b.a(function(t,s){var i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;T.a.get("".concat(q,"/app/v1/pickCouponActivity/").concat(e),{params:{timestamp:n,nonce:a,signature:o}}).then(function(e){t(e.data)}).catch(function(t){s(t)})})},refusedPushState:function(){return new b.a(function(t,e){var s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;T.a.get("".concat(q,"/app/v1/weixinmina/deagreed"),{params:{timestamp:i,nonce:n,signature:a}}).then(function(s){var i=0===s.data.code;if(i){var n=s.data.data;t(n)}else e(s)}).catch(function(t){e(t)})})},agreePush:function(){return new b.a(function(t,e){var s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;T.a.post("".concat(q,"/app/v1/weixinmina/agreePush"),{timestamp:i,nonce:n,signature:a}).then(function(s){var i=0===s.data.code;if(i){var n=s.data.data;t(n)}else e(s)}).catch(function(t){e(t)})})},disagreePush:function(){return new b.a(function(t,e){var s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;T.a.post("".concat(q,"/app/v1/weixinmina/deagreePush"),{timestamp:i,nonce:n,signature:a}).then(function(s){var i=0===s.data.code;if(i){var n=s.data.data;t(n)}else e(s)}).catch(function(t){e(t)})})}},K="https://lawsonapp.api.yorentick.cn",X={fetchNewShops:function(t){var e=t.regionBlockCode,s=t.cityId;return new b.a(function(t,i){var n=$.generateMainApiSignature(),a=n.timestamp,o=n.nonce,c=n.signature;T.a.get("".concat(K,"/app/v1/newShops/"),{params:{timestamp:a,nonce:o,signature:c,regionBlockCode:e,cityId:s}}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data.list;t(n)}else i(e)}).catch(function(t){i(t)})})},pickNewShopCoupon:function(t){var e=t.regionBlockCode,s=t.couponId,i=t.shopId;return new b.a(function(t,n){var a=$.generateMainApiSignature(),o=a.timestamp,c=a.nonce,r=a.signature;T.a.post("".concat(K,"/app/v1/newShops/").concat(i,"/pickCoupon/"),{timestamp:o,nonce:c,signature:r,regionBlockCode:e,couponId:s,shopId:i}).then(function(e){var s=0===e.data.code;if(s){var i=e.data.data;t(i)}else n(e)}).catch(function(t){n(t)})})}},Z="https://lawsonapp.api.yorentick.cn",J={fetchLotteryDetail:function(t){var e=t.regionBlockCode,s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new b.a(function(t,s){T.a.get("".concat(Z,"/app/v1/lottery/"),{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},fetchLotteryHistory:function(t){var e=t.regionBlockCode,s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature;return new b.a(function(t,s){T.a.get("".concat(Z,"/app/v1/lottery/history"),{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})},startLottery:function(t){var e=t.lotteryId,s=t.regionBlockCode,i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new b.a(function(t,i){T.a.post("".concat(Z,"/app/v1/lottery/roll"),{timestamp:n,nonce:a,signature:o,lotteryId:e,regionBlockCode:s}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})}},tt="https://lawsonapp.api.yorentick.cn",et={fetchMissions:function(t){var e=t.regionBlockCode;return new b.a(function(t,s){T.a.get("".concat(tt,"/app/v1/mission/"),{params:Object(H["a"])({regionBlockCode:e},$.generateMainApiSignature())}).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data.list;t(n)}else s(e)}).catch(function(t){s(t)})})},pickReward:function(t){var e=t.missionHistoryId;return new b.a(function(t,s){T.a.post("".concat(tt,"/app/v1/mission/receive"),Object(H["a"])({missionHistoryId:e},$.generateMainApiSignature())).then(function(e){var i=0===e.data.code;if(i){var n=e.data.data;t(n)}else s(e)}).catch(function(t){s(t)})})}},st="https://lawsonapp.api.yorentick.cn",it={fetchCityList:function(t){var e=t.regionBlockCode;return new b.a(function(t,s){var i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;T.a.get("".concat(st,"/app/v1/mina/cityList"),{params:{timestamp:n,nonce:a,signature:o,regionBlockCode:e}}).then(function(e){t(e.data)}).catch(function(t){s(t)})})}},nt="https://lawsonapp.api.yorentick.cn",at={recordPopularStatistics:function(t){var e=t.type,s=t.key,i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature;return new b.a(function(t,i){T.a.post("".concat(nt,"/app/v1/mina/look"),{timestamp:n,nonce:a,signature:o,type:e,key:s}).then(function(e){var s=0===e.data.code;if(s){var n=e.data.data;t(n)}else i(e)}).catch(function(t){i(t)})})}},ot="https://lawsonapp.api.yorentick.cn",ct={fetchShops:function(t){var e=t.regionBlockCode,s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(ot,"/app/v1/shop/");return T.a.get(o,{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e,pageSize:3e3}})},fetchOftenShoplist:function(t){var e=t.regionBlockCode,s=$.generateMainApiSignature(),i=s.timestamp,n=s.nonce,a=s.signature,o="".concat(ot,"/app/v1/mina/oftenShoplist");return T.a.get(o,{params:{timestamp:i,nonce:n,signature:a,regionBlockCode:e}})}},rt="https://lawsonapp.api.yorentick.cn",lt={fetchTalkTopicDetail:function(t){var e=t.talkTopicId;return new b.a(function(t,s){var i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(rt,"/app/v1/mina/saying/detail?sayingId=").concat(e);T.a.get(c,{params:{timestamp:n,nonce:a,signature:o}}).then(function(e){var i=0===e.data.code;i?t(e.data.data):s(e)}).catch(function(t){s(t)})})}},dt="https://lawsonapp.api.yorentick.cn",pt={fetchRecommendedCommodities:function(t){var e=t.regionBlockCode;return new b.a(function(t,s){var i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(dt,"/app/v1/mina/buying?regionBlockCode=").concat(e);T.a.get(c,{params:{timestamp:n,nonce:a,signature:o}}).then(function(e){var i=0===e.data.code;i?t(e.data.data):s(e)}).catch(function(t){s(t)})})},fetchRecommendedCommodity:function(t){var e=t.o2oCommodityId;return new b.a(function(t,s){var i=$.generateMainApiSignature(),n=i.timestamp,a=i.nonce,o=i.signature,c="".concat(dt,"/app/v1/mina/buying/detail?o2oCommodityId=").concat(e);T.a.get(c,{params:{timestamp:n,nonce:a,signature:o}}).then(function(e){var i=0===e.data.code;i?t(e.data.data):s(e)}).catch(function(t){s(t)})})}},ut=(s("386d"),s("4328")),_t=s.n(ut);s("28a5");function mt(t){return new b.a(function(e,s){var i=document.createElement("script");i.src=t,i.addEventListener("load",e),i.addEventListener("error",s),document.body.appendChild(i)})}var ht={init:function(){return new b.a(function(t,e){mt("https://res.wx.qq.com/open/js/jweixin-1.3.2.js").then(function(){var t=window.location.href.split("#")[0];return vt.wechat.fetchJsSdkSignatureData({url:t})}).then(function(s){wx.config({appId:"wxa3acf7d554a353b9",timestamp:s.timestamp,nonceStr:s.nonceStr,signature:s.signature,jsApiList:["getLocation","openLocation"]}),wx.ready(function(){t()}),wx.error(function(t){e(t)})}).catch(function(t){e(t)})})},getLocation:function(){return new b.a(function(t,e){wx.getLocation({success:function(e){t(e)},fail:function(t){e(t)}})})},openLocation:function(t,e,s,i){wx.openLocation({latitude:t,longitude:e,name:s,address:i})}},gt={__initEnvWechatMiniProgram:function(){var t=Object(w["a"])(regeneratorRuntime.mark(function t(){var e,s,i,n,a,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=window.location.search.slice(1),s=_t.a.parse(e),i=s.token,n=s.regionBlockCode,window.sessionStorage.setItem("token",i),window.sessionStorage.setItem("regionBlockCode",n),a=""===i,!a){t.next=8;break}t.next=12;break;case 8:return t.next=10,vt.user.fetchUserInfo({regionBlockCode:n});case 10:o=t.sent,window.sessionStorage.setItem("userInfo",D()(o));case 12:return t.next=15,ht.init();case 15:t.next=18;break;case 17:ht.init();case 18:case"end":return t.stop()}},t)}));function e(){return t.apply(this,arguments)}return e}(),init:function(){var t=this;return new b.a(function(e,s){var i=function(){var t=window.location.search.slice(1),e=_t.a.parse(t),s=e.envType;return"wechatMiniProgram"===s}();i?(window.sessionStorage.setItem("envType","wechatMiniProgram"),t.__initEnvWechatMiniProgram().then(function(){return e()})):e()})},getEnvType:function(){return window.sessionStorage.getItem("envType")},getRegionBlockCode:function(){return window.sessionStorage.getItem("regionBlockCode")},getToken:function(){return window.sessionStorage.getItem("token")},getUserInfo:function(){return JSON.parse(window.sessionStorage.getItem("userInfo"))}};T.a.defaults.timeout=4e3,T.a.interceptors.request.use(function(t){var e=gt.getToken();return t.headers["Api-Access-Token"]=e||"",t}),T.a.interceptors.response.use(function(t){return t},function(t){var e=!!/timeout of \d+ms exceeded/.test(t.message);if(e){window.location.hash.slice(1);var s={url:window.location.hash.slice(1)},i="pages/webview-entry/webview-entry",n=encodeURIComponent(D()(s)),a=encodeURIComponent(i);wx&&wx.miniProgram.redirectTo({url:"/pages/error-page_network-unstable/network-unstable?refreshPageOptions=".concat(n,"&refreshPageRoute=").concat(a)})}return b.a.reject(t)});var vt={user:O,wechat:j,campaign:G,address:V,ec:B,coupon:Q,mission:et,newShops:X,lottery:J,cityList:it,popularStatistics:at,shop:ct,talkTopic:lt,recommendedCommodity:pt},ft=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"goto-home",on:{click:t.gotoHome}})},Ct=[],yt={methods:{gotoHome:function(){var t=null===gt.getUserInfo();t?wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=homepage"}):wx.miniProgram.switchTab({url:"/pages/homepage/homepage"})}}},bt=yt,wt=(s("a6fc"),Object(_["a"])(bt,ft,Ct,!1,null,"1ddbb7bc",null)),St=wt.exports,Dt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"product-item"},[s("div",{staticClass:"product-item__image"},[s("img",{attrs:{src:t.product.imageSmall}})]),s("div",{staticClass:"product-item__content"},[s("div",{staticClass:"product-item__content__top"},[s("div",{staticClass:"product-item__content__top__status"},[0===t.product.remainedQty&&1===t.product.expired?[t._m(0)]:[0===t.product.expired?s("span",{staticClass:"product-item__content__top__status-not-begin"},[t.isThisWeek(t.product.canOrderStart)?[t._v("本"+t._s(t._f("formatThisWeekDate")(t.product.canOrderStart))+"开始")]:[t._v(t._s(t._f("formatNotThisWeekDate")(t.product.canOrderStart))+"开始")]],2):1===t.product.expired?s("span",{staticClass:"product-item__content__top__status-begin"},[t._v("进行中")]):2===t.product.expired?s("div",{staticClass:"product-item__content__top__status-end"},[t._m(1)]):t._e()]],2),s("div",{staticClass:"product-item__content__top__title"},[t._v(t._s(t.product.commodityName))])]),s("div",{staticClass:"product-item__content__bottom"},[s("div",{staticClass:"product-item__content__bottom-time"},[s("div",{staticClass:"product-item__content__bottom-time__icon-time"}),s("div",{staticClass:"product-item__content__bottom-time__start-time"},[t._v(t._s(t._f("formatDate")(t.product.canOrderStart))+"开始")])]),s("div",{staticClass:"product-item__content__bottom-info"},[s("div",{staticClass:"product-item__content__bottom-info__price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("toRMB")(t.product.sellPrice)))]),s("div",{staticClass:"product-item__content__bottom-info__watch-number"},[t._v(t._s(t._f("formatOnlookerCount")(t.product.onlookerCount))+"人围观过")])])])])])},kt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"product-item__content__top__status-sold-out"},[s("div",{staticClass:"product-item__content__top__status-sold-out__container"},[s("span",[t._v("抢光了")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"product-item__content__top__status-end__container"},[s("span",[t._v("预约结束")])])}],Tt={props:["product"],methods:{isThisWeek:function(t){var e=new Date,s=0===e.getDay()?7:e.getDay(),i=new Date(e.getFullYear(),e.getMonth(),e.getDate()+(7-s)),n=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1-s);return t>n.getTime()&&t<i.getTime()}},filters:{toRMB:function(t){return t.toFixed(1)},formatDate:function(t){var e=new Date(t),s=("0"+(e.getMonth()+1)).slice(-2),i=("0"+e.getDate()).slice(-2);return"".concat(s,"月").concat(i,"日")},formatThisWeekDate:function(t){var e=["周日","周一","周二","周三","周四","周五","周六"],s=new Date(t),i=("0"+s.getHours()).slice(-2),n=("0"+s.getMinutes()).slice(-2),a=s.getDay();return"".concat(e[a]," ").concat(i,":").concat(n)},formatNotThisWeekDate:function(t){var e=new Date(t),s=("0"+(e.getMonth()+1)).slice(-2),i=("0"+e.getDate()).slice(-2),n=("0"+e.getHours()).slice(-2),a=("0"+e.getMinutes()).slice(-2);return"".concat(s,"月").concat(i,"日 ").concat(n,":").concat(a)},formatOnlookerCount:function(t){return t>=1e4?t%1e4>=1e3?(t/1e4).toFixed(1)+"万":(t/1e4).toFixed(0)+"万":t}}},xt=Tt,At=(s("5f40"),Object(_["a"])(xt,Dt,kt,!1,null,"48625ba1",null)),It=At.exports,Nt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"modal"},[s("transition",{attrs:{name:"fade"}},[t.visible?s("div",[s("div",{staticClass:"modal__container"},[s("div",{staticClass:"modal__container__wrapper"},[s("svg",{staticClass:"modal__container__wrapper__icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-loading"}})]),s("div",{staticClass:"modal__container__wrapper__msg"},[t._v("加载中")])])])]):t._e()])],1)},Lt=[],Pt={data:function(){return{visible:!1}},mounted:function(){var t=this;window.addEventListener("popstate",function(e){t.visible=!1})}},Et=Pt,Mt=(s("5e76"),Object(_["a"])(Et,Nt,Lt,!1,null,"4358107c",null)),$t=Mt.exports,Ft=i["a"].extend($t),Ot=new Ft({el:document.createElement("div")});document.body.appendChild(Ot.$el);var Rt={show:function(){Ot.visible=!0},hide:function(){setTimeout(function(){Ot.visible=!1},1e3)}},Bt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pull-down-refresh",on:{touchstart:t.handleTouchStart,touchmove:t.handleTouchMove,touchend:t.handleTouchEnd,touchcancel:t.handleTouchCancel}},[s("div",{style:{transform:"translateY("+t.wrapperYOffset+"px)"}},[t.isRefreshing?s("div",{staticClass:"pull-down-refresh__refreshing-hint"},[s("p",[t._v("…")]),s("p",[t._v("正在刷新")])]):t.needRefresh?s("div",{staticClass:"pull-down-refresh__release-hint"},[s("p",[t._v("⇡")]),s("p",[t._v("松开以刷新")])]):s("div",{staticClass:"pull-down-refresh__pull-hint"},[s("p",[t._v("⇣")]),s("p",[t._v("下拉以刷新")])]),t._t("default")],2)])},Ut=[],jt=200,Ht=.5,Wt={props:{isRefreshing:Boolean},data:function(){return{touchStartY:null,touchMoveY:null,scrollTop:null,isPullingDown:null,lastRefreshTimeStamp:null,touchInitialYDirection:null}},computed:{yDistance:function(){return this.touchMoveY-this.touchStartY},needRefresh:function(){return this.isPullingDown&&this.yDistance>jt},wrapperYOffset:function(){return this.isPullingDown?this.yDistance*(1-Ht):0}},methods:{_resetData:function(){this.touchStartY=null,this.touchMoveY=null,this.scrollTop=null,this.isPullingDown=null,this.touchInitialYDirection=null},handleTouchStart:function(t){var e=t.touches[0].clientY;this.touchStartY=e,this.touchMoveY=e,this.scrollTop=this.$el.scrollTop},handleTouchMove:function(t){var e=t.touches[0].clientY;this.touchMoveY=e,this.scrollTop=this.$el.scrollTop,null===this.touchInitialYDirection&&(this.yDistance>0?this.touchInitialYDirection="downward":this.touchInitialYDirection="upward"),null===this.isPullingDown&&("downward"===this.touchInitialYDirection&&this.scrollTop<=0?this.isPullingDown=!0:this.isPullingDown=!1),this.isPullingDown&&t.preventDefault()},handleTouchEnd:function(t){if(this.needRefresh){var e=this.lastRefreshTimeStamp,s=(new Date).getTime(),i=5e3;console.log(s-e>i),(null===e||s-e>i)&&(this.$emit("refresh"),this.lastRefreshTimeStamp=s)}this._resetData()},handleTouchCancel:function(t){this._resetData()}}},Gt=Wt,zt=(s("8469"),Object(_["a"])(Gt,Bt,Ut,!1,null,"699765e8",null)),Vt=zt.exports,qt={components:{GotoHome:St,ProductItem:It,PullDownRefresh:Vt},data:function(){return{ecProductTabs:[],currentTab:null,ecProductList:null,cityList:null,currentCity:null,isRefreshing:!1}},created:function(){var t=Object(w["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.fetchCityList();case 2:this.fetchEcProductList();case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),computed:{filterEcProductList:function(){var t=this;return this.currentTab?this.ecProductList.filter(function(e){return e.tagName===t.currentTab}):this.ecProductList}},methods:{initCurrentTab:function(){this.ecProductTabs.length>0&&(this.currentTab=this.ecProductTabs[0])},fetchEcProductList:function(){var t=this;this.isRefreshing=!0,Rt.show();var e=gt.getRegionBlockCode(),s=this.currentCity.cityId;vt.ec.fetchEcProductShopList({regionBlockCode:e,cityId:s}).then(function(e){if(200===e.data.code){t.ecProductList=e.data.data;var s=t.ecProductList.reduce(function(t,e){return!1===t.includes(e.tagName)&&void 0!==e.tagName?[].concat(Object(v["a"])(t),[e.tagName]):t},[]);t.ecProductTabs=s,t.initCurrentTab()}}).finally(function(){Rt.hide(),t.isRefreshing=!1})},fetchCityList:function(){var t=this;return new b.a(function(e,s){Rt.show();var i=gt.getRegionBlockCode();vt.cityList.fetchCityList({regionBlockCode:i}).then(function(s){t.cityList=s.data,t.currentCity=t.cityList[0],e()}).finally(function(){return Rt.hide()})})},setCurrentTab:function(t){this.currentTab=t},gotoEcProductDetail:function(t){this.$router.push({path:"/ec-product-detail/".concat(t)})},gotoMyOrderList:function(){this.$router.push({path:"/my-order-list"})}},watch:{currentCity:function(t,e){e&&this.fetchEcProductList()}}},Yt=qt,Qt=(s("6223"),Object(_["a"])(Yt,f,C,!1,null,"801f27de",null)),Kt=Qt.exports,Xt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.productDetail?s("div",{staticClass:"ec-product-detail"},[s("div",{staticClass:"ec-product-detail__image"},[s("img",{attrs:{src:t.productDetail.imageSmall}})]),s("div",{staticClass:"ec-product-detail__summary"},[s("div",{staticClass:"ec-product-detail__summary__price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("toRMB")(t.productDetail.sellPrice)))]),t.currentDate<t.productDetail.canOrderStart?s("div",{staticClass:"ec-product-detail__summary__appointment-start-date"},[t._v("预约活动 "+t._s(t._f("toDays")(t.productDetail.canOrderStart-t.currentDate))+" 天后开始")]):t._e(),t.soldOut?s("div",{staticClass:"ec-product-detail__summary__status-sold-out"},[s("span",[t._v("抢光了")])]):t._e(),2===t.productDetail.expired?s("div",{staticClass:"ec-product-detail__summary__status-end"},[s("span",[t._v("预约结束")])]):t._e()]),s("div",{staticClass:"ec-product-detail__content-detail"},[s("div",{staticClass:"ec-product-detail__content-detail__title"},[t._v("\n      "+t._s(t.productDetail.commodityName)+"\n    ")]),s("div",{staticClass:"ec-product-detail__content-detail__info"},[s("div",{staticClass:"ec-product-detail__content-detail__info__sold-out"},[t._v("已售出："+t._s(t.productDetail.salesedQty)+"件")]),s("div",{staticClass:"ec-product-detail__content-detail__info__stock"},[t._v("库存："+t._s(t.productDetail.remainedQty)+"件")]),s("div",{staticClass:"ec-product-detail__content-detail__info__watch"},[t._l(t.avatars,function(t,e){return s("img",{key:e,staticClass:"ec-product-detail__content-detail__info__watch__avatar",attrs:{src:t}})}),s("span",[t._v(t._s(t._f("formatOnlookerCount")(t.productDetail.onlookerCount))+"人围观过")])],2)])]),s("div",{staticClass:"ec-product-detail__content-appointment-time-limit"},[t._m(0),s("div",{staticClass:"ec-product-detail__content-appointment-time-limit__content"},[s("timeline-bar",{attrs:{startDate:t.productDetail.canOrderStart,endDate:t.productDetail.canOrderEnd}})],1)]),s("div",{staticClass:"ec-product-detail__content-pick-up-shop",on:{click:t.gotoEcAvailableShopList}},[s("div",{staticClass:"ec-product-detail__content-pick-up-shop__head"},[t._m(1),s("div",{staticClass:"ec-product-detail__content-pick-up-shop__head__view"},[t._v("\n        查看全部("+t._s(t.sortedShopsWithDistance.length)+")\n      ")])]),t.sortedShopsWithDistance[0]?s("div",{staticClass:"ec-product-detail__content-pick-up-shop__content"},[s("div",{staticClass:"ec-product-detail__content-pick-up-shop__content__shop-info"},[s("div",{staticClass:"ec-product-detail__content-pick-up-shop__content__shop-info__shop-name"},[s("span",[t._v(t._s(t.sortedShopsWithDistance[0].shopName))]),""!==t.sortedShopsWithDistance[0].businessTime?s("format-business-time",{attrs:{businessTime:t.sortedShopsWithDistance[0].businessTime}}):t._e()],1),s("div",{staticClass:"ec-product-detail__content-pick-up-shop__content__shop-info__shop-address"},[t._v(t._s(t.sortedShopsWithDistance[0].address))])]),t.sortedShopsWithDistance[0].distance?s("div",{staticClass:"ec-product-detail__content-pick-up-shop__content__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.sortedShopsWithDistance[0].distance)))]):t._e()]):t._e()]),s("div",{staticClass:"ec-product-detail__content-appointment-instruction"},[t._m(2),s("div",{staticClass:"ec-product-detail__content-appointment-instruction__content",domProps:{innerHTML:t._s(t.productDetail.takeDescription)}})]),t.soldOut?t._e():s("div",{staticClass:"ec-product-detail__content-bottom-button-appointment"},[0===t.productDetail.expired?s("div",{staticClass:"ec-product-detail__content-bottom-button-appointment__not-begin"},[t._v("立即预约")]):1===t.productDetail.expired?s("div",{staticClass:"ec-product-detail__content-bottom-button-appointment__begin",on:{click:t.showAppointmentPopup}},[t._v("立即预约")]):t._e()]),s("goto-home"),t.appointmentPopupVisible?s("appointment-popup",{attrs:{productDetail:t.productDetail},on:{hideAppointmentPopup:t.hideAppointmentPopup}}):t._e()],1):t._e()},Zt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-detail__content-appointment-time-limit__head"},[s("div",{staticClass:"ec-product-detail__content-appointment-time-limit__head__icon"}),s("div",[t._v("可预约期限")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-detail__content-pick-up-shop__head__title"},[s("div",{staticClass:"ec-product-detail__content-pick-up-shop__head__title__icon"}),s("div",[t._v("可提货门店")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-detail__content-appointment-instruction__head"},[s("div",{staticClass:"ec-product-detail__content-appointment-instruction__head__icon"}),s("div",[t._v("预约商品说明")])])}],Jt=(s("55dd"),s("5176")),te=s.n(Jt),ee=s("0a0d"),se=s.n(ee),ie=s("2ef0"),ne=s.n(ie);function ae(t){return t*Math.PI/180}function oe(t,e,s,i){var n=6371,a=ae(s-t),o=ae(i-e);t=ae(t),s=ae(s);var c=Math.sin(a/2)*Math.sin(a/2)+Math.sin(o/2)*Math.sin(o/2)*Math.cos(t)*Math.cos(s),r=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));return n*r}var ce={recordCampaignPopularStatistics:function(t){vt.popularStatistics.recordPopularStatistics({type:"Campaigning",key:t})},recordRecommendedCommodityPopularStatistics:function(t){vt.popularStatistics.recordPopularStatistics({type:"Buying",key:t})},recordEcProductPopularStatistics:function(t){vt.popularStatistics.recordPopularStatistics({type:"Booking",key:t})},recordTalkTopicPopularStatistics:function(t){vt.popularStatistics.recordPopularStatistics({type:"Saying",key:t})}},re=(s("7514"),[{regionBlockCode:"sh-lawson",regionName:"江浙沪"},{regionBlockCode:"bj-lawson",regionName:"京津冀"},{regionBlockCode:"dl-lawson",regionName:"大连"},{regionBlockCode:"wh-lawson",regionName:"武汉"},{regionBlockCode:"cq-lawson",regionName:"重庆"},{regionBlockCode:"ah-lawson",regionName:"安徽"}]),le={getCurrentRegionName:function(t){return re.find(function(e){return e.regionBlockCode===t})["regionName"]}},de=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"business-time"},[0===t.formatBusinessTime?s("div",{staticClass:"business-time__content"},[s("span",{staticClass:"business-time__content__time"},[t._v("6:00-22:00")])]):t._e(),1===t.formatBusinessTime?s("div",{staticClass:"business-time__content"},[s("span",{staticClass:"business-time__content__time"},[t._v("7:00-23:00")])]):t._e(),2===t.formatBusinessTime?s("div",{staticClass:"business-time__content"},[s("span",{staticClass:"business-time__content__time"},[t._v("24h")])]):t._e(),3===t.formatBusinessTime?s("div",{staticClass:"business-time__content"},[s("span",{staticClass:"business-time__content__time"},[t._v("24h")]),s("span",{staticClass:"business-time__content__closed-time"},[t._v("周六、周日休业")])]):t._e()])},pe=[],ue={props:["businessTime"],data:function(){return{dateType:null}},computed:{formatBusinessTime:function(){var t=this.businessTime;return t.indexOf("6:00")>-1?this.dateType=0:t.indexOf("7:00")>-1?this.dateType=1:t.indexOf("每日24小时")>-1?this.dateType=2:t.indexOf("平日24")>-1&&(this.dateType=3),this.dateType}}},_e=ue,me=(s("da46"),Object(_["a"])(_e,de,pe,!1,null,"497b2388",null)),he=me.exports,ge=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"timeline-bar"},[s("div",{staticClass:"timeline-bar__line"}),s("div",{class:["timeline-bar__start-date",{"is-middle":t.startDate>t.currentDate&&t.startDate<t.endDate,"is-hidden":t.startDate<=t.currentDate}]},[s("div",{staticClass:"timeline-bar__start-date__title"},[t._v("预约开始")]),s("div",{staticClass:"timeline-bar__start-date__circle-icon"}),s("div",{staticClass:"timeline-bar__start-date__date"},[t._v(t._s(t._f("date")(t.startDate)))])]),s("div",{class:["timeline-bar__end-date",{"is-left":t.endDate<=t.currentDate,"is-right":t.endDate>t.currentDate}]},[s("div",{staticClass:"timeline-bar__end-date__title"},[t._v("预约结束")]),s("div",{staticClass:"timeline-bar__end-date__circle-icon"}),s("div",{staticClass:"timeline-bar__end-date__date"},[t._v(t._s(t._f("date")(t.endDate)))])]),s("div",{class:["timeline-bar__current-date",{"is-left":t.currentDate<t.startDate,"is-right":t.currentDate>=t.endDate}]},[s("div",{staticClass:"timeline-bar__current-date__title"},[t._v("今天")]),s("div",{staticClass:"timeline-bar__current-date__circle-icon"}),s("div",{staticClass:"timeline-bar__current-date__date"},[t._v(t._s(t._f("date")(t.currentDate)))])])])},ve=[],fe={data:function(){return{currentDate:se()()}},props:["startDate","endDate"],filters:{date:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,"-").concat(n,"-").concat(a)}}},Ce=fe,ye=(s("2eb6"),Object(_["a"])(Ce,ge,ve,!1,null,"a3b4dbd2",null)),be=ye.exports,we=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"appointment-popup"},[s("div",{staticClass:"appointment-popup__container"},[s("div",{staticClass:"appointment-popup__container__head"},[s("div",{staticClass:"appointment-popup__container__head__image"},[s("img",{attrs:{src:t.productDetail.imageSmall}})]),s("div",{staticClass:"appointment-popup__container__head__info"},[s("div",{staticClass:"appointment-popup__container__head__info__price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("toRMB")(t.productDetail.sellPrice)))]),s("div",{staticClass:"appointment-popup__container__head__info__stock"},[t._v("剩余库存："+t._s(t.productDetail.remainedQty))])])]),s("div",{staticClass:"appointment-popup__container__content"},[s("div",{staticClass:"appointment-popup__container__content__left"},[t._v("\n        合计：\n        "),s("span",{staticClass:"appointment-popup__container__content__left__total-price"},[s("span",[t._v("¥")]),t._v(" "+t._s(t._f("toRMB")(t.totalPrice)))])]),s("div",{staticClass:"appointment-popup__container__content__right"},[s("div",{staticClass:"appointment-popup__container__content__right__quantity"},[s("span",{staticClass:"appointment-popup__container__content__right__quantity__label"},[t._v("数量:")]),s("div",{staticClass:"appointment-popup__container__content__right__quantity__icon-decrease",on:{click:t.decreaseQuantity}}),s("span",{staticClass:"appointment-popup__container__content__right__quantity__number"},[t._v(t._s(t.purchaseQuantity))]),s("div",{staticClass:"appointment-popup__container__content__right__quantity__icon-increase",on:{click:t.increaseQuantity}})]),s("div",{staticClass:"appointment-popup__container__content__right__descr"},[t._v("每个用户最多可预约"+t._s(t.productDetail.singleLimited)+"个")])])]),s("div",{staticClass:"appointment-popup__container__confirm",on:{click:t.gotoConfirmOrder}},[t._v("确定")]),s("div",{staticClass:"appointment-popup__container__close",on:{click:t.hideAppointmentPopup}})])])},Se=[],De={data:function(){return{purchaseQuantity:1}},props:["productDetail"],computed:{totalPrice:function(){return this.productDetail.sellPrice*this.purchaseQuantity}},methods:{decreaseQuantity:function(){this.purchaseQuantity>1&&(this.purchaseQuantity-=1)},increaseQuantity:function(){this.purchaseQuantity<this.productDetail.singleLimited&&this.purchaseQuantity<this.productDetail.remainedQty&&(this.purchaseQuantity+=1)},hideAppointmentPopup:function(){this.$emit("hideAppointmentPopup")},gotoConfirmOrder:function(){var t=this;Rt.show();var e=this.productDetail.commodityId,s=this.purchaseQuantity;vt.ec.createOrder({commodityId:e,quantity:s}).then(function(e){var s=e.data.data;t.$router.push({path:"/ec-confirm-order/".concat(s)})}).finally(function(){return Rt.hide()})}},filters:{toRMB:function(t){return t.toFixed(1)},toDays:function(t){return Math.ceil(t/864e5)}}},ke=De,Te=(s("c1c0"),Object(_["a"])(ke,we,Se,!1,null,"f6eb9864",null)),xe=Te.exports,Ae=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"message-box"},[t.visible?s("div",{staticClass:"message-box__mask"}):t._e(),s("transition",{attrs:{name:"bounce"}},[t.visible?s("div",{staticClass:"message-box__content"},[s("div",{staticClass:"message-box__title"},[t._v(t._s(t.title))]),s("div",{staticClass:"message-box__msg",domProps:{innerHTML:t._s(t.msg)}}),"alert"===t.type?s("div",[s("div",{staticClass:"message-box__operation"},[s("div",{staticClass:"message-box__i-know-button",on:{click:t.handleIknow}},[t._v("我知道了")])])]):"confirm"===t.type?s("div",[s("div",{staticClass:"message-box__operation"},[s("div",{staticClass:"message-box__confirm-button",on:{click:t.handleConfirm}},[t._v(t._s(t.confirmButtonText))]),s("div",{staticClass:"message-box__cancel-button",on:{click:t.handleCancel}},[t._v(t._s(t.cancelButtonText))])])]):t._e()]):t._e()])],1)},Ie=[],Ne={props:{type:String,title:String,msg:String,confirmButtonText:String,cancelButtonText:String,onIknow:Function,onConfirm:Function,onCancel:Function},data:function(){return{visible:!1}},methods:{handleIknow:function(){this.onIknow(),this.visible=!1},handleCancel:function(){this.onCancel(),this.visible=!1},handleConfirm:function(){this.onConfirm(),this.visible=!1}},mounted:function(){var t=this;window.addEventListener("popstate",function(e){return t.visible=!1})}},Le=Ne,Pe=(s("4e38"),Object(_["a"])(Le,Ae,Ie,!1,null,"66497dd4",null)),Ee=Pe.exports,Me=i["a"].extend(Ee),$e=new Me({el:document.createElement("div")});document.body.appendChild($e.$el);var Fe={alert:function(t){var e=t.title,s=void 0===e?"提示":e,i=t.msg,n=void 0===i?"":i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};$e.type="alert",$e.title=s,$e.msg=n,$e.onIknow=a,$e.onCancel=o,$e.visible=!0},confirm:function(t){var e=t.title,s=void 0===e?"提示":e,i=t.msg,n=void 0===i?"":i,a=t.confirmButtonText,o=void 0===a?"确认":a,c=t.cancelButtonText,r=void 0===c?"取消":c,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};$e.type="confirm",$e.title=s,$e.msg=n,$e.confirmButtonText=o,$e.cancelButtonText=r,$e.onConfirm=l,$e.onCancel=d,$e.visible=!0}},Oe={components:{GotoHome:St,FormatBusinessTime:he,TimelineBar:be,AppointmentPopup:xe},data:function(){return{productDetail:null,currentDate:se()(),appointmentPopupVisible:!1,currentLocation:null,avatars:["".concat("http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new","/avatar/1.png"),"".concat("http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new","/avatar/2.png"),"".concat("http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new","/avatar/3.png")]}},created:function(){var t=Object(w["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.setCurrentLocation(),t.next=3,this.fetchEcProductShopDetail();case 3:e=gt.getRegionBlockCode(),e!==this.productDetail.regionBlockCode&&this.showRegionDiffModal(this.productDetail.regionBlockCode),ce.recordEcProductPopularStatistics(this.$route.params.commodityId);case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),computed:{soldOut:function(){return 0===this.productDetail.remainedQty},shopIdList:function(){return this.productDetail.shopList},shopList:function(){var t=gt.getRegionBlockCode(),e=0===this.productDetail.shopUseFlg;if(e){var s=this.$store.getters["shop/shopsAvailableForRegion"](t);return s?this.$store.getters["shop/shopsForRegion"](t):[]}var i=this.$store.state.shop.shops[t],n=this.shopIdList;return ne.a.intersectionWith(i,n,function(t,e){return t.shopId===e})},sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shopList.map(function(e){var s=te()({},e);return s.distance=oe(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shopList}},methods:{fetchEcProductShopDetail:function(){var t=this;return new b.a(function(e,s){Rt.show();var i=t.$route.params.commodityId;vt.ec.fetchEcProductShopDetail({commodityId:i}).then(function(s){200===s.status&&(t.productDetail=s.data.data,wx.miniProgram.postMessage({data:{shareTitle:t.productDetail.commodityName}})),e()}).catch(function(t){return s(t)}).finally(function(){return Rt.hide()})})},showAppointmentPopup:function(){var t=null===gt.getUserInfo();if(t){var e=this.productDetail.commodityId;wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=ecProductDetail&commodityId=".concat(e,"&sourceType=internal")})}else this.appointmentPopupVisible=!0},hideAppointmentPopup:function(){this.appointmentPopupVisible=!1},gotoEcAvailableShopList:function(){var t=null===gt.getUserInfo();if(t){var e=this.productDetail.commodityId;wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=ecProductDetail&commodityId=".concat(e,"&sourceType=internal")})}else{var s=this.productDetail.shopUseFlg,i=this.productDetail.shopList;this.$router.push({name:"ec-available-shop-list",params:{shopUseFlg:s,shopList:i}})}},setCurrentLocation:function(){var t=this;ht.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i}})},showRegionDiffModal:function(t){var e=le.getCurrentRegionName(t),s=null===gt.getUserInfo();s?Fe.alert({title:"友情提示",msg:"你当前查阅内容，可能受区域限制有所不同"}):Fe.alert({title:"友情提示",msg:"你所在区域无法参与，当前内容仅限".concat(e)})}},filters:{toRMB:function(t){return t.toFixed(1)},toDays:function(t){return Math.ceil(t/864e5)},formatOnlookerCount:function(t){return t>=1e4?t%1e4>=1e3?(t/1e4).toFixed(1)+"万":(t/1e4).toFixed(0)+"万":t},toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},Re=Oe,Be=(s("b66f"),Object(_["a"])(Re,Xt,Zt,!1,null,"7b225485",null)),Ue=Be.exports,je=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shops&&t.oftenShops?s("div",{staticClass:"ec-product-shop-list"},[s("div",{staticClass:"ec-product-shop-list__search-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchShop,expression:"searchShop"}],staticClass:"ec-product-shop-list__search-container__search-bar",attrs:{placeholder:"输入门店名称"},domProps:{value:t.searchShop},on:{input:function(e){e.target.composing||(t.searchShop=e.target.value)}}})]),s("div",{ref:"currentShop",staticClass:"ec-product-shop-list__current-shop"},[t._m(0),s("div",{staticClass:"ec-product-shop-list__current-shop__item"},[s("div",{staticClass:"ec-product-shop-list__current-shop__item__icon-location"}),t.currentAddress?s("div",{staticClass:"ec-product-shop-list__current-shop__item__current-address"},[t._v(t._s(t.currentAddress))]):t._e(),s("div",{staticClass:"ec-product-shop-list__current-shop__item__refresh-location",on:{click:t.setCurrentAddress}},[t._v("重新定位")])]),s("div",{staticClass:"ec-product-shop-list__whitespace"}),t.oftenShops.length>0?[t._m(1),t._l(t.oftenShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e(),s("div",{staticClass:"ec-product-shop-list__whitespace"}),t.nearbyShops.length>0?[t._m(2),t._l(t.nearbyShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e()],2)]):t._e()},He=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__current-shop__title-row"},[s("span",{staticClass:"ec-product-shop-list__current-shop__title-row__title"},[t._v("当前定位")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__my-shops__title-row"},[s("span",{staticClass:"ec-product-shop-list__my-shops__title-row__title"},[t._v("常去店铺")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__nearby-shops__title-row"},[s("span",{staticClass:"ec-product-shop-list__nearby-shops__title-row__title"},[t._v("附近店铺")])])}],We="QVPBZ-YBMHV-KYMPX-UIXW2-7AM7Z-BNFNU";function Ge(t){return new b.a(function(e,s){var i=document.createElement("script");i.src=t,i.addEventListener("error",s),document.body.appendChild(i)})}var ze={init:function(){return new b.a(function(t,e){window.onQqLbsLoad=function(){t()};var s=!(!window.qq||!window.qq.maps);s?t():Ge("https://map.qq.com/api/js?v=2.exp&key=".concat(We,"&callback=onQqLbsLoad")).catch(function(t){e(t)})})},getAddressByLatLng:function(t,e){return new b.a(function(s,i){new qq.maps.Geocoder({complete:function(t){var e=t.detail;s(e)},error:function(t){i(t)}}).getAddress(new qq.maps.LatLng(t,e))})}},Ve=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-item"},[s("div",{staticClass:"shop-item__info"},[s("div",{staticClass:"shop-item__basic-info"},[s("div",{staticClass:"shop-item__shop-name"},[s("span",[t._v(t._s(t.shop.shopName))]),""!==t.shop.businessTime?s("format-business-time",{attrs:{businessTime:t.shop.businessTime}}):t._e()],1),s("div",{staticClass:"shop-item__shop-address"},[t._v(t._s(t.shop.address))])]),t.shop.distance?s("div",{staticClass:"shop-item__map-info"},[s("div",{staticClass:"shop-item__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.shop.distance)))]),s("div",{staticClass:"shop-item__show-in-map",on:{click:t.openMap}},[t._v("地图 >")])]):t._e()])])},qe=[],Ye={props:{shop:Object},components:{FormatBusinessTime:he},methods:{openMap:function(){wx.openLocation({latitude:this.shop.latitude,longitude:this.shop.longitude,name:this.shop.shopName,address:this.shop.address})}},filters:{toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},Qe=Ye,Ke=(s("352a"),Object(_["a"])(Qe,Ve,qe,!1,null,"083b4cbc",null)),Xe=Ke.exports,Ze={components:{ShopItem:Xe},data:function(){return{shops:null,oftenShops:null,currentAddress:null,nearbyShopsLength:10,searchShop:null,currentLocation:null}},created:function(){this.getOrderShopList(),this.fetchOftenShoplist()},mounted:function(){var t=this;ze.init().then(function(){t.setCurrentAddress()})},updated:function(){this.$refs.currentShop.addEventListener("scroll",this.handleScroll)},computed:{sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=te()({},e);return s.distance=oe(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops},filterShops:function(){var t=this;return this.searchShop?this.sortedShopsWithDistance.filter(function(e){return e.shopName.includes(t.searchShop)}):this.sortedShopsWithDistance},currentShop:function(){return this.sortedShopsWithDistance[0]},myShops:function(){return this.sortedShopsWithDistance.slice(1,3)},nearbyShops:function(){return this.filterShops.slice(0,this.nearbyShopsLength)}},methods:{handleScroll:ne.a.debounce(function(){var t=this.$refs.currentShop.scrollTop,e=this.$refs.currentShop.clientHeight,s=this.$refs.currentShop.scrollHeight,i=s<=e+t;i&&(this.nearbyShopsLength+=10)},150),getOrderShopList:function(){var t=this.$route.params.shopUseFlg,e=this.$route.params.shopList,s=gt.getRegionBlockCode(),i=0===t;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](s);this.shops=n?this.$store.getters["shop/shopsForRegion"](s):[]}else{var a=this.$store.state.shop.shops[s];this.shops=ne.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},fetchOftenShoplist:function(){var t=this;Rt.show();var e=gt.getRegionBlockCode();vt.shop.fetchOftenShoplist({regionBlockCode:e}).then(function(e){t.oftenShops=e.data.data.slice(0,2)}).finally(function(){return Rt.hide()})},setCurrentAddress:function(){var t=this;this.currentAddress=null,ht.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i},ze.getAddressByLatLng(s,i).then(function(e){t.currentAddress=e.address})})}}},Je=Ze,ts=(s("4df1"),Object(_["a"])(Je,je,He,!1,null,"642f1e3f",null)),es=ts.exports,ss=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shops&&t.oftenShops?s("div",{staticClass:"ec-product-shop-list"},[s("div",{staticClass:"ec-product-shop-list__search-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchShop,expression:"searchShop"}],staticClass:"ec-product-shop-list__search-container__search-bar",attrs:{placeholder:"输入门店名称"},domProps:{value:t.searchShop},on:{input:function(e){e.target.composing||(t.searchShop=e.target.value)}}})]),s("div",{ref:"currentShop",staticClass:"ec-product-shop-list__current-shop"},[t._m(0),s("div",{staticClass:"ec-product-shop-list__current-shop__item"},[s("div",{staticClass:"ec-product-shop-list__current-shop__item__icon-location"}),t.currentAddress?s("div",{staticClass:"ec-product-shop-list__current-shop__item__current-address"},[t._v(t._s(t.currentAddress))]):t._e(),s("div",{staticClass:"ec-product-shop-list__current-shop__item__refresh-location",on:{click:t.setCurrentAddress}},[t._v("重新定位")])]),s("div",{staticClass:"ec-product-shop-list__whitespace"}),t.oftenShops.length>0?[t._m(1),t._l(t.oftenShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e(),s("div",{staticClass:"ec-product-shop-list__whitespace"}),t.nearbyShops.length>0?[t._m(2),t._l(t.nearbyShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e()],2)]):t._e()},is=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__current-shop__title-row"},[s("span",{staticClass:"ec-product-shop-list__current-shop__title-row__title"},[t._v("当前定位")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__my-shops__title-row"},[s("span",{staticClass:"ec-product-shop-list__my-shops__title-row__title"},[t._v("常去店铺")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ec-product-shop-list__nearby-shops__title-row"},[s("span",{staticClass:"ec-product-shop-list__nearby-shops__title-row__title"},[t._v("附近店铺")])])}],ns=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-item"},[s("div",{staticClass:"shop-item__info"},[s("div",{staticClass:"shop-item__basic-info",on:{click:function(e){return t.selectPickupShop(t.shop.shopId)}}},[s("div",{staticClass:"shop-item__shop-name"},[s("span",[t._v(t._s(t.shop.shopName))]),""!==t.shop.businessTime?s("format-business-time",{attrs:{businessTime:t.shop.businessTime}}):t._e()],1),s("div",{staticClass:"shop-item__shop-address"},[t._v(t._s(t.shop.address))])]),t.shop.distance?s("div",{staticClass:"shop-item__map-info"},[s("div",{staticClass:"shop-item__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.shop.distance)))]),s("div",{staticClass:"shop-item__show-in-map",on:{click:t.openMap}},[t._v("地图 >")])]):t._e()])])},as=[],os={props:{shop:Object},components:{FormatBusinessTime:he},methods:{openMap:function(){var t=this.shop.latitude,e=this.shop.longitude,s=this.shop.shopName,i=this.shop.address;ht.openLocation(t,e,s,i)},selectPickupShop:function(t){this.$store.commit("ecOrderInfo/setShopId",t),this.$router.back()}},filters:{toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},cs=os,rs=(s("fa16"),Object(_["a"])(cs,ns,as,!1,null,"a4ea644a",null)),ls=rs.exports,ds={components:{ShopItem:ls},data:function(){return{shops:null,oftenShops:null,currentAddress:null,nearbyShopsLength:10,searchShop:null,currentLocation:null}},created:function(){this.getOrderShopList(),this.fetchOftenShoplist()},mounted:function(){var t=this;ze.init().then(function(){t.setCurrentAddress()})},updated:function(){this.$refs.currentShop.addEventListener("scroll",this.handleScroll)},computed:{sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=te()({},e);return s.distance=oe(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops},filterShops:function(){var t=this;return this.searchShop?this.sortedShopsWithDistance.filter(function(e){return e.shopName.includes(t.searchShop)}):this.sortedShopsWithDistance},currentShop:function(){return this.sortedShopsWithDistance[0]},nearbyShops:function(){return this.filterShops.slice(0,this.nearbyShopsLength)}},methods:{handleScroll:ne.a.debounce(function(){var t=this.$refs.currentShop.scrollTop,e=this.$refs.currentShop.clientHeight,s=this.$refs.currentShop.scrollHeight,i=s<=e+t;i&&(this.nearbyShopsLength+=10)},150),getOrderShopList:function(){var t=this.$route.params.shopUseFlg,e=this.$route.params.shopList,s=gt.getRegionBlockCode(),i=0===t;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](s);this.shops=n?this.$store.getters["shop/shopsForRegion"](s):[]}else{var a=this.$store.state.shop.shops[s];this.shops=ne.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},fetchOftenShoplist:function(){var t=this;Rt.show();var e=gt.getRegionBlockCode();vt.shop.fetchOftenShoplist({regionBlockCode:e}).then(function(e){t.oftenShops=e.data.data.slice(0,2)}).finally(function(){return Rt.hide()})},setCurrentAddress:function(){var t=this;this.currentAddress=null,ht.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i},ze.getAddressByLatLng(s,i).then(function(e){t.currentAddress=e.address})})}}},ps=ds,us=(s("46ce"),Object(_["a"])(ps,ss,is,!1,null,"855d4526",null)),_s=us.exports,ms=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.orderDetail?s("div",{staticClass:"confirm-order"},[s("div",{staticClass:"confirm-order__info"},[s("div",{staticClass:"confirm-order__info__image"},[s("img",{attrs:{src:t.orderDetail.imageSmall}})]),s("div",{staticClass:"confirm-order__info__content"},[s("div",{staticClass:"confirm-order__info__content__title"},[t._v(t._s(t.orderDetail.commodityName))]),s("div",{staticClass:"confirm-order__info__content__desc"},[s("div",{staticClass:"confirm-order__info__content__desc__price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("toRMB")(t.orderDetail.sellPrice)))]),s("div",{staticClass:"confirm-order__info__content__desc__quantity"},[t._v("x"+t._s(t.orderDetail.qty))])])])]),s("div",{staticClass:"confirm-order__notice"},[s("div",{staticClass:"confirm-order__notice__title"},[t._v("预约须知")]),s("div",{staticClass:"confirm-order__notice__content",domProps:{innerHTML:t._s(t.notice)}})]),s("div",{staticClass:"confirm-order__select-take-date"},[s("div",{staticClass:"confirm-order__select-take-date__info"},[s("div",{staticClass:"confirm-order__select-take-date__info__label"},[t._v("请选择提货时间")]),t.takeDate?s("div",{staticClass:"confirm-order__select-take-date__info__date"},[t._v(t._s(t._f("formatDate")(t.takeDate)))]):t._e(),s("select",{directives:[{name:"model",rawName:"v-model",value:t.takeDate,expression:"takeDate"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.takeDate=e.target.multiple?s:s[0]}}},[s("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("请选择提货时间")]),t._l(t.orderDetail.canTakeDate,function(e){return s("option",{key:e,domProps:{value:e}},[t._v(t._s(t._f("formatDate")(e)))])})],2)]),s("div",{staticClass:"confirm-order__select-take-date__icon"})]),s("div",{staticClass:"confirm-order__select-take-shop",on:{click:t.gotoEcChooseShopList}},[s("div",{staticClass:"confirm-order__select-take-shop__info"},[t.shopInfo?[s("div",{staticClass:"confirm-order__select-take-shop__info__label"},[t._v("提货门店")]),s("div",{staticClass:"confirm-order__select-take-shop__info__shop-address"},[t._v(t._s(t.shopInfo.shopName)+" "+t._s(t.shopInfo.address))]),s("div",{staticClass:"confirm-order__select-take-shop__info__business-time"},[t._v("营业时间："+t._s(t.shopInfo.businessTime))])]:[s("div",{staticClass:"confirm-order__select-take-shop__info__label"},[t._v("请选择提货门店")])]],2),s("div",{staticClass:"confirm-order__select-take-shop__icon"})]),s("div",{staticClass:"confirm-order__pay"},[s("div",{staticClass:"confirm-order__pay__descr"},[t._v("支付即代表您已阅读并同意预约须知")]),s("div",{staticClass:"confirm-order__pay__content"},[s("div",{staticClass:"confirm-order__pay__content__amount"},[s("span",{staticClass:"confirm-order__pay__content__amount__label"},[t._v("应付：")]),s("span",{staticClass:"confirm-order__pay__content__amount__total-price"},[s("span",[t._v("¥")]),t._v(" "+t._s(t._f("toRMB")(t.orderDetail.amt)))])]),s("div",{staticClass:"confirm-order__pay__content__button"},[t.shopId&&t.takeDate?s("div",{staticClass:"confirm-order__pay__content__button__primary",on:{click:t.gotoOrderPayment}},[t._v("微信支付")]):s("div",{staticClass:"confirm-order__pay__content__button__disabled"},[t._v("微信支付")])])])])]):t._e()},hs=[],gs={namespaced:!0,state:{shopId:null,takeDate:null},mutations:{setShopId:function(t,e){t.shopId=e},setTakeDate:function(t,e){t.takeDate=e},initState:function(t){t.shopId=null,t.takeDate=null}}},vs={data:function(){return{orderDetail:null,notice:"1.支付后请按选择的日期和时间段前往指定的门店提货<br>2.非指定门店不可提货<br>3.选定日期和时间段前不可提货<br>4.选定日期和时间段内未前往门店提货时，门店无法保证商品库存和品质，因此造成的损失将由用户自己承担"}},created:function(){this.$store.registerModule("ecOrderInfo",gs),this.fetchOrderDetail()},computed:{shopId:function(){return this.$store.state.ecOrderInfo.shopId},shopInfo:function(){var t=this,e=gt.getRegionBlockCode();return this.$store.getters["shop/shopsForRegion"](e).find(function(e){return e.shopId===t.shopId})},takeDate:{get:function(){return this.$store.state.ecOrderInfo.takeDate},set:function(t){this.$store.commit("ecOrderInfo/setTakeDate",t)}}},methods:{fetchOrderDetail:function(){var t=this;Rt.show();var e=this.$route.params.orderId;vt.ec.fetchOrderDetail({orderId:e}).then(function(e){t.orderDetail=e.data.data,t.shopId&&(t.orderDetail.shopId=t.shopId),t.takeDate&&(t.orderDetail.takeDate=t.takeDate)}).finally(function(){return Rt.hide()})},gotoEcChooseShopList:function(){var t=this.orderDetail.shopUseFlg,e=this.orderDetail.shopList;this.$router.push({name:"ec-choose-shop-list",params:{shopUseFlg:t,shopList:e}})},gotoOrderPayment:function(){var t=this.orderDetail.orderId,e=this.shopId,s=this.takeDate;wx.miniProgram.redirectTo({url:"/pages/order-payment/order-payment?orderId=".concat(t,"&pickShopId=").concat(e,"&pickDate=").concat(s)}),this.$store.unregisterModule("ecOrderInfo",gs)}},filters:{toRMB:function(t){return t.toFixed(1)},formatDate:function(t){var e=["日","一","二","三","四","五","六"],s=new Date(t),i=s.getFullYear(),n=("0"+(s.getMonth()+1)).slice(-2),a=("0"+s.getDate()).slice(-2),o=s.getDay();return"".concat(i,"/").concat(n,"/").concat(a,"(星期").concat(e[o],")")}}},fs=vs,Cs=(s("c536"),Object(_["a"])(fs,ms,hs,!1,null,"456b1f4b",null)),ys=Cs.exports,bs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.orderDetail?s("div",{staticClass:"edit-order"},[s("div",{staticClass:"edit-order__info"},[s("div",{staticClass:"edit-order__info__image"},[s("img",{attrs:{src:t.orderDetail.imageSmall}})]),s("div",{staticClass:"edit-order__info__content"},[s("div",{staticClass:"edit-order__info__content__title"},[t._v(t._s(t.orderDetail.commodityName))]),s("div",{staticClass:"edit-order__info__content__desc"},[s("div",{staticClass:"edit-order__info__content__desc__price"},[s("span",[t._v("￥")]),t._v(t._s(t._f("toRMB")(t.orderDetail.sellPrice)))]),s("div",{staticClass:"edit-order__info__content__desc__quantity"},[t._v("x"+t._s(t.orderDetail.qty))])])])]),s("div",{staticClass:"edit-order__notice"},[s("div",{staticClass:"edit-order__notice__title"},[t._v("预约须知")]),s("div",{staticClass:"edit-order__notice__content",domProps:{innerHTML:t._s(t.notice)}})]),s("div",{staticClass:"edit-order__select-take-date"},[s("div",{staticClass:"edit-order__select-take-date__info"},[s("div",{staticClass:"edit-order__select-take-date__info__label"},[t._v("请选择提货时间")]),t.takeDate?s("div",{staticClass:"edit-order__select-take-date__info__date"},[t._v(t._s(t._f("formatDate")(t.takeDate)))]):t._e(),s("select",{directives:[{name:"model",rawName:"v-model",value:t.takeDate,expression:"takeDate"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.takeDate=e.target.multiple?s:s[0]}}},[s("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("请选择提货时间")]),t._l(t.orderDetail.canTakeDate,function(e){return s("option",{key:e,domProps:{value:e}},[t._v(t._s(t._f("formatDate")(e)))])})],2)]),s("div",{staticClass:"edit-order__select-take-date__icon"})]),s("div",{staticClass:"edit-order__select-take-shop",on:{click:t.gotoEcChooseShopList}},[s("div",{staticClass:"edit-order__select-take-shop__info"},[s("div",{staticClass:"edit-order__select-take-shop__info__label"},[t._v("提货门店")]),t.shopInfo?[s("div",{staticClass:"edit-order__select-take-shop__info__shop-address"},[t._v(t._s(t.shopInfo.shopName)+" "+t._s(t.shopInfo.address))]),s("div",{staticClass:"edit-order__select-take-shop__info__business-time"},[t._v("营业时间："+t._s(t.shopInfo.businessTime))])]:t._e()],2),s("div",{staticClass:"edit-order__select-take-shop__icon"})]),t.takeDate&&t.shopId?s("div",{staticClass:"edit-order__confirm-edit-order-button",on:{click:t.editOrder}},[t._v("\n    确认修改\n  ")]):t._e()]):t._e()},ws=[],Ss={data:function(){return{orderDetail:null,notice:"1.支付后请按选择的日期和时间段前往指定的门店提货<br>2.非指定门店不可提货<br>3.选定日期和时间段前不可提货<br>4.选定日期和时间段内未前往门店提货时，门店无法保证商品库存和品质，因此造成的损失将由用户自己承担"}},created:function(){this.$store.registerModule("ecOrderInfo",gs),this.fetchPayOrderDetail()},computed:{shopId:function(){return this.$store.state.ecOrderInfo.shopId},shopInfo:function(){var t=this,e=gt.getRegionBlockCode(),s=this.$store.getters["shop/shopsAvailableForRegion"](e);return s?this.$store.getters["shop/shopsForRegion"](e).find(function(e){return e.shopId===t.shopId}):null},takeDate:{get:function(){return this.$store.state.ecOrderInfo.takeDate},set:function(t){this.$store.commit("ecOrderInfo/setTakeDate",t)}}},methods:{fetchPayOrderDetail:function(){var t=this;Rt.show();var e=this.$route.params.orderId;vt.ec.fetchPayOrderDetail({orderId:e}).then(function(e){t.orderDetail=e.data.data;var s=t.orderDetail.shopId;if(t.shopId||t.$store.commit("ecOrderInfo/setShopId",s),!t.takeDate){var i=new Date(t.orderDetail.takeDate),n=i.getFullYear(),a=("0"+(i.getMonth()+1)).slice(-2),o=("0"+i.getDate()).slice(-2),c="".concat(n,"-").concat(a,"-").concat(o);t.$store.commit("ecOrderInfo/setTakeDate",c)}}).finally(function(){return Rt.hide()})},editOrder:function(){var t=this,e=this.orderDetail.orderId,s=this.takeDate,i=this.shopId;vt.ec.editOrder({orderId:e,takeDate:s,shopId:i}).then(function(e){t.$router.back()})},gotoEcChooseShopList:function(){var t=this.orderDetail.shopUseFlg,e=this.orderDetail.shopList;this.$router.push({name:"ec-choose-shop-list",params:{shopUseFlg:t,shopList:e}})}},filters:{toRMB:function(t){return t.toFixed(1)},formatDate:function(t){var e=["日","一","二","三","四","五","六"],s=new Date(t),i=s.getFullYear(),n=("0"+(s.getMonth()+1)).slice(-2),a=("0"+s.getDate()).slice(-2),o=s.getDay();return"".concat(i,"/").concat(n,"/").concat(a,"(星期").concat(e[o],")")}}},Ds=Ss,ks=(s("a4e8"),Object(_["a"])(Ds,bs,ws,!1,null,"8064359c",null)),Ts=ks.exports,xs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-payment-result"},[t.orderPaymentResult?[s("div",{staticClass:"order-payment-result__icon-success"}),s("div",{staticClass:"order-payment-result__status-text"},[t._v("支付成功")]),t.totalFee?s("div",{staticClass:"order-payment-result__amount"},[t._v("订单金额："),s("span",[t._v("¥ "+t._s(t._f("toRMB")(t.totalFee)))])]):t._e(),s("div",{staticClass:"order-payment-result__notice"},[t._v("预约商品以提货券的形式发送到您的账户可前往查看")]),s("div",{staticClass:"order-payment-result__view-order",on:{click:t.gotoMyCouponList}},[t._v("前往查看")]),s("div",{staticClass:"order-payment-result__my-order",on:{click:t.gotoMyOrderList}},[t._v("我的订单")])]:[s("div",{staticClass:"order-payment-result__icon-fail"}),s("div",{staticClass:"order-payment-result__status-text"},[t._v("支付失败")]),s("div",{staticClass:"order-payment-result__order-detail",on:{click:t.gotoMyOrderList}},[t._v("订单详情")]),s("div",{staticClass:"order-payment-result__go-home",on:{click:t.gotoHome}},[t._v("返回首页")])]],2)},As=[],Is=s("e814"),Ns=s.n(Is),Ls=(s("a481"),{data:function(){return{orderPaymentResult:null,totalFee:null}},created:function(){this.setOrderPaymentResult()},methods:{gotoMyCouponList:function(){wx.miniProgram.switchTab({url:"/pages/my-coupon-list/my-coupon-list"})},gotoMyOrderList:function(){this.$router.replace({path:"/my-order-list"})},gotoHome:function(){wx.miniProgram.switchTab({url:"/pages/homepage/homepage"})},setOrderPaymentResult:function(){var t="true"===this.$route.query.orderPaymentResult,e=this.$route.query.totalFee;this.orderPaymentResult=t,this.totalFee=e}},filters:{toRMB:function(t){return Ns()(t).toFixed(1)}}}),Ps=Ls,Es=(s("7770"),Object(_["a"])(Ps,xs,As,!1,null,"13dca6c1",null)),Ms=Es.exports,$s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.orderList?s("div",{staticClass:"my-order-list"},[s("div",{staticClass:"my-order-list__order-list"},[t.orderList.length>0?[s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchMyOrderList}},t._l(t.orderList,function(e){return s("order-item",{key:e.orderId,attrs:{order:e},on:{refreshMyOrderList:t.fetchMyOrderList}})}),1)]:[t._m(0)]],2),s("goto-home")],1):t._e()},Fs=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-order-list__order-list__no-data"},[s("div",{staticClass:"my-order-list__order-list__no-data__icon"}),s("div",{staticClass:"my-order-list__order-list__no-data__text"},[t._v("暂无内容")])])}],Os=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-list-item"},[1===t.order.status?[s("div",{staticClass:"order-list-item__head"},[s("div",{staticClass:"order-list-item__head__order-id"},[t._v("订单号："+t._s(t.order.orderId))]),s("div",{staticClass:"order-list-item__head__status"},[t._v("待取货")])]),s("div",{staticClass:"order-list-item__content"},[s("div",{staticClass:"order-list-item__content__left"},[s("img",{attrs:{src:t.order.imageSmall}})]),s("div",{staticClass:"order-list-item__content__right"},[s("div",{staticClass:"order-list-item__content__right__title"},[t._v(t._s(t.order.commodityName))]),s("div",{staticClass:"order-list-item__content__right__quantity"},[t._v("x"+t._s(t.order.qty))])]),s("div",{staticClass:"order-list-item__content__info"},[t._v("共"+t._s(t.order.qty)+"件商品  应付款：\n        "),s("span",{staticClass:"order-list-item__content__info__price"},[t._v("¥"+t._s(t._f("toRMB")(t.order.amt)))])])]),s("div",{staticClass:"order-list-item__pickup-date"},[t._v("\n      提货时间："+t._s(t._f("formatDate")(t.order.takeDate))+"  00:00 - 23:59\n    ")]),s("div",{staticClass:"order-list-item__pickup-address"},[s("div",{staticClass:"order-list-item__pickup-address__address"},[t._v("提货地址："+t._s(t.order.shop.shopName)+" "+t._s(t.order.shop.address))]),s("div",{staticClass:"order-list-item__pickup-address__goto-map",on:{click:t.openMap}},[t._v("\n        地图\n        "),s("span",{staticClass:"order-list-item__pickup-address__goto-map__icon"})])]),s("div",{staticClass:"order-list-item__button-list"},[t.order.canModifyFlg?s("div",{staticClass:"order-list-item__button-list__modify-order",on:{click:function(e){return t.gotoEditOrder(t.order.orderId)}}},[t._v("修改订单")]):t._e(),"normal"===t.order.orderStatus?s("div",{staticClass:"order-list-item__button-list__pickup-explain",on:{click:t.showPickupExplainMessageBox}},[t._v("提货说明")]):t._e(),s("div",{staticClass:"order-list-item__button-list__view-pickup-coupon",on:{click:function(e){return t.gotoCouponDetail(t.order.couponId,t.order.userCouponArr)}}},[t._v("查看提货券")])])]:[s("div",{staticClass:"order-list-item__head"},[s("div",{staticClass:"order-list-item__head__order-id"},[t._v("订单号："+t._s(t.order.orderId))]),s("div",{staticClass:"order-list-item__head__status"},[t._v("待支付")])]),s("div",{staticClass:"order-list-item__content"},[s("div",{staticClass:"order-list-item__content__left"},[s("img",{attrs:{src:t.order.imageSmall}})]),s("div",{staticClass:"order-list-item__content__right"},[s("div",{staticClass:"order-list-item__content__right__title"},[t._v(t._s(t.order.commodityName))]),s("div",{staticClass:"order-list-item__content__right__quantity"},[t._v("x"+t._s(t.order.qty))])]),s("div",{staticClass:"order-list-item__content__info"},[t._v("共"+t._s(t.order.qty)+"件商品  应付款：\n        "),s("span",{staticClass:"order-list-item__content__info__price"},[t._v("¥"+t._s(t._f("toRMB")(t.order.amt)))])])]),s("div",{staticClass:"order-list-item__can-appointment-date"},[t._v("\n      可预约时间："+t._s(t._f("formatDate")(t.order.canOrderStart))+" - "+t._s(t._f("formatDate")(t.order.canOrderEnd))+"\n    ")]),s("div",{staticClass:"order-list-item__button-list"},[s("div",{staticClass:"order-list-item__button-list__cancel-order",on:{click:function(e){return t.showCancelOrderMessageBox(t.order.orderId)}}},[t._v("取消订单")]),s("div",{staticClass:"order-list-item__button-list__goto-pay",on:{click:function(e){return t.gotoConfirmOrder(t.order.orderId)}}},[t._v("去支付")])])]],2)},Rs=[],Bs={props:["order"],methods:{openMap:function(){wx.openLocation({latitude:this.order.shop.latitude,longitude:this.order.shop.longitude,name:this.order.shop.shopName,address:this.order.shop.address})},deleteOrder:function(t){var e=this;Rt.show(),vt.ec.deleteOrder({orderId:t}).then(function(){e.$emit("refreshMyOrderList")}).finally(function(){return Rt.hide()})},gotoCouponDetail:function(t,e){var s=e[0];this.$router.push({path:"/user-coupon-detail/".concat(t,"/").concat(s)})},gotoConfirmOrder:function(t){this.$router.push({path:"/ec-confirm-order/".concat(t)})},gotoEditOrder:function(t){this.$router.push({path:"/ec-edit-order/".concat(t)})},showPickupExplainMessageBox:function(){Fe.alert({title:"提货说明",msg:"该号码仅供提货时出示给门店核销使用请妥善保管勿泄漏给他人。"})},showCancelOrderMessageBox:function(t){var e=this;Fe.confirm({title:"取消订单？",msg:"取消后该订单即被删除，且无法恢复",confirmButtonText:"确定取消",cancelButtonText:"暂不取消"},function(){e.deleteOrder(t)})}},filters:{formatDate:function(t){var e=new Date(t),s=e.getFullYear(),i=("0"+(e.getMonth()+1)).slice(-2),n=("0"+e.getDate()).slice(-2);return"".concat(s,"/").concat(i,"/").concat(n)},toRMB:function(t){return t.toFixed(1)}}},Us=Bs,js=(s("c2d3"),Object(_["a"])(Us,Os,Rs,!1,null,"cd2c2ee4",null)),Hs=js.exports,Ws={components:{GotoHome:St,OrderItem:Hs,PullDownRefresh:Vt},data:function(){return{orderList:null,isRefreshing:!1}},created:function(){this.$store.state["ecOrderInfo"]||this.$store.registerModule("ecOrderInfo",gs),this.$store.commit("ecOrderInfo/initState"),this.fetchMyOrderList()},methods:{fetchMyOrderList:function(){var t=this;this.isRefreshing=!0,Rt.show();var e=gt.getRegionBlockCode();vt.ec.fetchMyOrderList({regionBlockCode:e}).then(function(e){t.orderList=e.data.data}).finally(function(){Rt.hide(),t.isRefreshing=!1})}}},Gs=Ws,zs=(s("a4a5"),Object(_["a"])(Gs,$s,Fs,!1,null,"03ea6d2c",null)),Vs=zs.exports,qs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"takeout-intro"})},Ys=[],Qs={},Ks=Qs,Xs=(s("bde1"),Object(_["a"])(Ks,qs,Ys,!1,null,"7f54e286",null)),Zs=Xs.exports,Js=[{path:"/ec-product-list",name:"ec-product-list",component:Kt,meta:{title:"预约列表"}},{path:"/ec-product-detail/:commodityId",name:"ec-product-detail",component:Ue,meta:{title:"预约详情"}},{path:"/ec-confirm-order/:orderId",name:"ec-confirm-order",component:ys,meta:{title:"确认订单"}},{path:"/ec-edit-order/:orderId",name:"ec-edit-order",component:Ts,meta:{title:"编辑订单"}},{path:"/ec-available-shop-list",name:"ec-available-shop-list",component:es,meta:{title:"可用门店"}},{path:"/ec-choose-shop-list",name:"ec-choose-shop-list",component:_s,meta:{title:"选择门店"}},{path:"/ec-order-payment-result",name:"ec-order-payment-result",component:Ms,meta:{title:"支付结果"}},{path:"/my-order-list",name:"my-order-list",component:Vs,meta:{title:"订单列表"}},{path:"/ec-intro",name:"ec-intro",component:Zs,meta:{title:"预约介绍"}}],ti=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.couponDetails?s("div",{staticClass:"user-coupon-detail"},[s("coupon-type",{attrs:{couponDetails:t.couponDetails}}),s("div",{staticClass:"user-coupon-detail__timeline"},[s("div",{staticClass:"user-coupon-detail__timeline__title"},[s("img",{staticClass:"user-coupon-detail__timeline__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-time.png"}}),s("span",{staticClass:"user-coupon-detail__timeline__title__text"},[t._v("使用时间")])]),s("div",{staticClass:"user-coupon-detail__timeline__bar"},[s("timeline-bar",{attrs:{couponDetails:t.couponDetails}})],1)]),s("available-shop",{attrs:{couponDetails:t.couponDetails}}),s("available-commodity",{attrs:{couponDetails:t.couponDetails}}),s("coupon-instruction",{attrs:{couponExplain:t.couponDetails.couponExplain}}),""!==t.couponDetails.applicationScope1&&t.couponDetails.applicationScope1?s("use-condition",{attrs:{applicationScope1:t.couponDetails.applicationScope1}}):t._e(),""!==t.couponDetails.applicationScope2&&t.couponDetails.applicationScope2?s("other-condition",{attrs:{applicationScope2:t.couponDetails.applicationScope2}}):t._e(),s("goto-home")],1):t._e()},ei=[],si=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-type"},["productPriceMinusToFreeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[2!==t.couponDetails.useCondition&&t.currentDate<=t.couponDetails.useDateTo?s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}):s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-expired.png"}}),t._m(0)])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[2!==t.couponDetails.useCondition&&t.currentDate<=t.couponDetails.useDateTo?s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}):s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-expired.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("消费立减")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),"totalPriceMinusSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[2!==t.couponDetails.useCondition&&t.currentDate<=t.couponDetails.useDateTo?s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}):s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-expired.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("满"),s("span",{staticClass:"coupon-type__price__text__total-price__number"},[t._v(t._s(t.couponDetails.originalPrice))]),t._v("元可用\n          ")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[2!==t.couponDetails.useCondition&&t.currentDate<=t.couponDetails.useDateTo?s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}):s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-expired.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减至"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("消费立减")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),s("div",{staticClass:"coupon-type__title"},[s("div",{staticClass:"coupon-type__title__content"},[s("span",{staticClass:"coupon-type__title__content__name"},[t._v(t._s(t.couponDetails.couponName))]),t.calculateCouponUseTime?s("span",{staticClass:"coupon-type__title__content__will-expired-time"},[t._v(t._s(t.calculateCouponUseTime))]):t._e(),t.currentDate>t.couponDetails.useDateTo?s("span",{staticClass:"coupon-type__title__content__expired-time"},[t._v("已过期")]):t._e()]),s("div",{staticClass:"coupon-type__title__region"},[s("img",{staticClass:"coupon-type__title__region__image",attrs:{src:t.ossImageUrl+"/coupon/icon-region.png"}}),s("span",{staticClass:"coupon-type__title__region__name"},[t._v("限"+t._s(t.reginonName)+"使用")])])])])},ii=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("兑换")]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("全额抵扣")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("兑换券")])])}],ni={getType:function(t){return 1===t.type?"productPriceMinusToFreeCoupon":2===t.type?"totalPriceMinusSomeCoupon":3===t.type?"productPriceMinusSomeCoupon":0===t.type?"productPriceMinusToSomeCoupon":void 0}},ai=432e6,oi=864e5,ci={props:["couponDetails"],data:function(){return{currentDate:se()(),ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ni.getType(this.couponDetails)},reginonName:function(){var t=gt.getRegionBlockCode();return le.getCurrentRegionName(t)},calculateCouponUseTime:function(){var t=this.couponDetails.useDateFrom,e=this.couponDetails.useDateTo;if(this.currentDate<t){var s=t-this.currentDate,i=Math.floor(s/864e5);if(s<=ai)return s<oi?"即可使用":i+"天后可用"}else if(this.currentDate<e){var n=e-this.currentDate,a=Math.floor(n/864e5);if(n<=ai)return n<oi?"即将过期":a+"天后过期"}}}},ri=ci,li=(s("655b"),Object(_["a"])(ri,si,ii,!1,null,"443965fd",null)),di=li.exports,pi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"timeline-bar"},[s("div",{staticClass:"timeline-bar__line"}),s("div",{class:["timeline-bar__start-date",{"is-middle":t.startDate>t.currentDate&&t.startDate<t.endDate,"is-hidden":t.startDate<=t.currentDate}]},[s("div",{staticClass:"timeline-bar__start-date__title"},[t._v("活动开始")]),s("div",{staticClass:"timeline-bar__start-date__circle-icon"}),s("div",{staticClass:"timeline-bar__start-date__date"},[t._v(t._s(t._f("date")(t.startDate)))])]),s("div",{class:["timeline-bar__end-date",{"is-left":t.endDate<=t.currentDate,"is-right":t.endDate>t.currentDate}]},[s("div",{staticClass:"timeline-bar__end-date__title"},[t._v("活动结束")]),s("div",{staticClass:"timeline-bar__end-date__circle-icon"}),s("div",{staticClass:"timeline-bar__end-date__date"},[t._v(t._s(t._f("date")(t.endDate)))])]),s("div",{class:["timeline-bar__current-date",{"is-left":t.currentDate<t.startDate,"is-right":t.currentDate>=t.endDate}]},[s("div",{staticClass:"timeline-bar__current-date__title"},[t._v("今天")]),s("div",{staticClass:"timeline-bar__current-date__circle-icon"}),s("div",{staticClass:"timeline-bar__current-date__date"},[t._v(t._s(t._f("date")(t.currentDate)))])])])},ui=[],_i={props:["couponDetails"],data:function(){return{startDate:this.couponDetails.useDateFrom,endDate:this.couponDetails.useDateTo,currentDate:se()()}},filters:{date:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,"-").concat(n,"-").concat(a)}}},mi=_i,hi=(s("7af5"),Object(_["a"])(mi,pi,ui,!1,null,"109aa22e",null)),gi=hi.exports,vi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"use-condition"},[s("div",{staticClass:"use-condition__title"},[s("img",{staticClass:"use-condition__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-use-condition.png"}}),s("span",{staticClass:"use-condition__title__text"},[t._v("适用条件")])]),s("div",{staticClass:"use-condition__text-list"},[s("p",[t._v(t._s(t.applicationScope1))])])])},fi=[],Ci={props:["applicationScope1"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},yi=Ci,bi=(s("26d2"),Object(_["a"])(yi,vi,fi,!1,null,"42e58150",null)),wi=bi.exports,Si=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"other-condition"},[s("div",{staticClass:"other-condition__title"},[s("img",{staticClass:"other-condition__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-other-condition.png"}}),s("span",{staticClass:"other-condition__title__text"},[t._v("其他条件")])]),s("div",{staticClass:"other-condition__text-list"},[s("p",[t._v(t._s(t.applicationScope2))])])])},Di=[],ki={props:["applicationScope2"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},Ti=ki,xi=(s("054f"),Object(_["a"])(Ti,Si,Di,!1,null,"6caebc78",null)),Ai=xi.exports,Ii=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store"},[1===t.shopUseFlg&&null!==t.shops?s("div",[s("div",{staticClass:"available-store__title",on:{click:t.goToCouponShopList}},[s("div",{staticClass:"available-store__title__left"},[s("img",{staticClass:"available-store__title__left__image",attrs:{src:t.ossImageUrl+"/coupon/icon-shop.png"}}),s("span",{staticClass:"available-store__title__left__text"},[t._v("适用门店")])]),s("div",{staticClass:"available-store__title__right"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-arrows.png"}}),s("span",[t._v("查看全部("+t._s(t.shops.length)+")")])])]),s("div",{staticClass:"available-store__content"},[s("div",{staticClass:"available-store__content__title"},[s("div",{staticClass:"available-store__content__title__shop"},[s("span",{staticClass:"available-store__content__title__shop__name"},[t._v(t._s(t.shops[0].shopName))]),""!==t.shops[0].businessTime?s("format-business-time",{attrs:{businessTime:t.shops[0].businessTime}}):t._e()],1),t.sortedShopsWithDistance[0].distance?s("div",{staticClass:"available-store__content__title__distance"},[t._v("\n          距您"+t._s(t._f("toKilometer")(t.sortedShopsWithDistance[0].distance))+"\n        ")]):t._e()]),s("div",{staticClass:"available-store__content__address"},[t._v("\n        "+t._s(t.shops[0].address)+"\n      ")])])]):s("div",[s("div",{staticClass:"available-store__title"},[s("div",{staticClass:"available-store__title__left"},[s("img",{staticClass:"available-store__title__left__image",attrs:{src:t.ossImageUrl+"/coupon/icon-shop.png"}}),s("span",{staticClass:"available-store__title__left__text"},[t._v("适用门店")])])]),s("div",{staticClass:"available-store__all-shop"},[t._v("\n      "+t._s(t.regionName)+"地区所有门店\n    ")])])])},Ni=[],Li={props:["couponDetails"],components:{FormatBusinessTime:he},data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",shops:null,shopUseFlg:this.couponDetails.shopUseFlg,regionName:null,currentLocation:null}},created:function(){var t=gt.getRegionBlockCode();this.regionName=le.getCurrentRegionName(t),this.filterShops(),this.getLocation()},filters:{toKilometer:function(t){return t>20?">20km":t.toFixed(2)+"km"}},computed:{sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=te()({},e);return s.distance=oe(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops}},methods:{goToCouponShopList:function(){var t=this.couponDetails.shopList;this.$router.push({name:"coupon-available-shop-list",params:{shopList:t}})},filterShops:function(){var t=gt.getRegionBlockCode(),e=this.couponDetails.shopList,s=this.shopUseFlg,i=0===s;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](t);this.shops=n?this.$store.getters["shop/shopsForRegion"](t):[]}else{var a=this.$store.state.shop.shops[t];this.shops=ne.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},getLocation:function(){var t=this;ht.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i}})}}},Pi=Li,Ei=(s("5d4f"),Object(_["a"])(Pi,Ii,Ni,!1,null,"76660e64",null)),Mi=Ei.exports,$i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-instruction"},[s("div",{staticClass:"coupon-instruction__title"},[s("img",{staticClass:"coupon-instruction__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-coupon-instruction.png"}}),s("span",{staticClass:"coupon-instruction__title__text"},[t._v("礼券说明")])]),s("div",{staticClass:"coupon-instruction__text-list"},[s("p",[t._v(t._s(t.couponExplain))])])])},Fi=[],Oi={props:["couponExplain"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},Ri=Oi,Bi=(s("92bc"),Object(_["a"])(Ri,$i,Fi,!1,null,"1b3cb606",null)),Ui=Bi.exports,ji=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-commodity"},[s("div",{staticClass:"available-commodity__title"},[s("img",{staticClass:"available-commodity__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-available-commodity.png"}}),s("span",{staticClass:"available-commodity__title__text"},[t._v("适用商品")])]),s("div",{staticClass:"available-commodity__content"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",[t._v("适用所有商品")]):"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType?s("div",[t._v(t._s(t.couponDetails.commodityList[0].commodityName))]):t._e()])])},Hi=[],Wi={props:["couponDetails"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ni.getType(this.couponDetails)}}},Gi=Wi,zi=(s("a66a"),Object(_["a"])(Gi,ji,Hi,!1,null,"41b75540",null)),Vi=zi.exports,qi={data:function(){return{couponDetails:null,ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},components:{CouponType:di,TimelineBar:gi,UseCondition:wi,OtherCondition:Ai,AvailableShop:Mi,CouponInstruction:Ui,AvailableCommodity:Vi,GotoHome:St},created:function(){this.fetchUserCouponDetails()},methods:{fetchUserCouponDetails:function(){var t=this;Rt.show();var e=this.$route.params.userCouponId,s=this.$route.params.couponId,i=gt.getRegionBlockCode();vt.coupon.fetchUserCouponDetail({couponId:s,userCouponId:e,regionBlockCode:i}).then(function(e){t.couponDetails=e}).finally(function(){return Rt.hide()})}}},Yi=qi,Qi=(s("c98c"),Object(_["a"])(Yi,ti,ei,!1,null,"3da76559",null)),Ki=Qi.exports,Xi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.couponDetails?s("div",{staticClass:"coupon-detail"},[s("coupon-type",{attrs:{couponDetails:t.couponDetails}}),0===t.couponDetails.dynamicPeriodFlg?s("div",{staticClass:"coupon-detail__timeline"},[s("div",{staticClass:"coupon-detail__timeline__title"},[s("img",{staticClass:"coupon-detail__timeline__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-time.png"}}),s("span",{staticClass:"coupon-detail__timeline__title__text"},[t._v("使用时间")])]),s("div",{staticClass:"coupon-detail__timeline__bar"},[s("timeline-bar",{attrs:{couponDetails:t.couponDetails}})],1)]):t._e(),s("available-shop",{attrs:{couponDetails:t.couponDetails}}),s("available-commodity",{attrs:{couponDetails:t.couponDetails}}),s("coupon-instruction",{attrs:{couponExplain:t.couponDetails.couponExplain}}),""!==t.couponDetails.applicationScope1&&t.couponDetails.applicationScope1?s("use-condition",{attrs:{applicationScope1:t.couponDetails.applicationScope1}}):t._e(),""!==t.couponDetails.applicationScope2&&t.couponDetails.applicationScope2?s("other-condition",{attrs:{applicationScope2:t.couponDetails.applicationScope2}}):t._e(),s("goto-home")],1):t._e()},Zi=[],Ji=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-type"},["productPriceMinusToFreeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}),t._m(0)])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("消费立减")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),"totalPriceMinusSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("满"),s("span",{staticClass:"coupon-type__price__text__total-price__number"},[t._v(t._s(t.couponDetails.originalPrice))]),t._v("元可用\n          ")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",[s("div",{staticClass:"coupon-type__price"},[s("img",{staticClass:"coupon-type__price__image",attrs:{src:t.ossImageUrl+"/coupon/coupon-detail-background-t.png"}}),s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("减至"),s("span",{staticClass:"coupon-type__price__text__discount-price__number"},[t._v(t._s(t.couponDetails.discountPrice))])]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("消费立减")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("代金券")])])])]):t._e(),s("div",{staticClass:"coupon-type__title"},[s("div",{staticClass:"coupon-type__title__content"},[s("span",{staticClass:"coupon-type__title__content__name"},[t._v(t._s(t.couponDetails.couponName))]),0===t.couponDetails.dynamicPeriodFlg&&t.calculateCouponUseTime?s("span",{staticClass:"coupon-type__title__content__will-expired-time"},[t._v(t._s(t.calculateCouponUseTime))]):t._e()]),s("div",{staticClass:"coupon-type__title__region"},[s("img",{staticClass:"coupon-type__title__region__image",attrs:{src:t.ossImageUrl+"/coupon/icon-region.png"}}),s("span",{staticClass:"coupon-type__title__region__name"},[t._v("限"+t._s(t.reginonName)+"使用")])])])])},tn=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-type__price__text"},[s("div",{staticClass:"coupon-type__price__text__price"},[s("div",{staticClass:"coupon-type__price__text__discount-price"},[t._v("兑换")]),s("div",{staticClass:"coupon-type__price__text__total-price"},[t._v("全额抵扣")])]),s("div",{staticClass:"coupon-type__price__text__button"},[t._v("兑换券")])])}],en=432e6,sn=864e5,nn={props:["couponDetails"],data:function(){return{currentDate:se()(),ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ni.getType(this.couponDetails)},reginonName:function(){var t=gt.getRegionBlockCode();return le.getCurrentRegionName(t)},calculateCouponUseTime:function(){var t=this.couponDetails.useDateFrom,e=this.couponDetails.useDateTo;if(this.currentDate<t){var s=t-this.currentDate,i=Math.floor(s/864e5);if(s<=en)return s<sn?"即可使用":i+"天后可用"}else{var n=e-this.currentDate,a=Math.floor(n/864e5);if(n<=en)return n<sn?"即将过期":a+"天后过期"}}}},an=nn,on=(s("600b"),Object(_["a"])(an,Ji,tn,!1,null,"222a0e56",null)),cn=on.exports,rn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"timeline-bar"},[s("div",{staticClass:"timeline-bar__line"}),s("div",{class:["timeline-bar__start-date",{"is-middle":t.startDate>t.currentDate&&t.startDate<t.endDate,"is-hidden":t.startDate<=t.currentDate}]},[s("div",{staticClass:"timeline-bar__start-date__title"},[t._v("活动开始")]),s("div",{staticClass:"timeline-bar__start-date__circle-icon"}),s("div",{staticClass:"timeline-bar__start-date__date"},[t._v(t._s(t._f("date")(t.startDate)))])]),s("div",{class:["timeline-bar__end-date",{"is-left":t.endDate<=t.currentDate,"is-right":t.endDate>t.currentDate}]},[s("div",{staticClass:"timeline-bar__end-date__title"},[t._v("活动结束")]),s("div",{staticClass:"timeline-bar__end-date__circle-icon"}),s("div",{staticClass:"timeline-bar__end-date__date"},[t._v(t._s(t._f("date")(t.endDate)))])]),s("div",{class:["timeline-bar__current-date",{"is-left":t.currentDate<t.startDate,"is-right":t.currentDate>=t.endDate}]},[s("div",{staticClass:"timeline-bar__current-date__title"},[t._v("今天")]),s("div",{staticClass:"timeline-bar__current-date__circle-icon"}),s("div",{staticClass:"timeline-bar__current-date__date"},[t._v(t._s(t._f("date")(t.currentDate)))])])])},ln=[],dn={props:["couponDetails"],data:function(){return{startDate:this.couponDetails.useDateFrom,endDate:this.couponDetails.useDateTo,currentDate:se()()}},filters:{date:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,"-").concat(n,"-").concat(a)}}},pn=dn,un=(s("8732"),Object(_["a"])(pn,rn,ln,!1,null,"7a529eb4",null)),_n=un.exports,mn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"use-condition"},[s("div",{staticClass:"use-condition__title"},[s("img",{staticClass:"use-condition__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-use-condition.png"}}),s("span",{staticClass:"use-condition__title__text"},[t._v("适用条件")])]),s("div",{staticClass:"use-condition__text-list"},[s("p",[t._v(t._s(t.applicationScope1))])])])},hn=[],gn={props:["applicationScope1"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},vn=gn,fn=(s("3ffa"),Object(_["a"])(vn,mn,hn,!1,null,"bf545126",null)),Cn=fn.exports,yn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"other-condition"},[s("div",{staticClass:"other-condition__title"},[s("img",{staticClass:"other-condition__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-other-condition.png"}}),s("span",{staticClass:"other-condition__title__text"},[t._v("其他条件")])]),s("div",{staticClass:"other-condition__text-list"},[s("p",[t._v(t._s(t.applicationScope2))])])])},bn=[],wn={props:["applicationScope2"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},Sn=wn,Dn=(s("0a74"),Object(_["a"])(Sn,yn,bn,!1,null,"75306fd9",null)),kn=Dn.exports,Tn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store"},[1===t.shopUseFlg&&null!==t.shops?s("div",[s("div",{staticClass:"available-store__title",on:{click:t.goToCouponShopList}},[s("div",{staticClass:"available-store__title__left"},[s("img",{staticClass:"available-store__title__left__image",attrs:{src:t.ossImageUrl+"/coupon/icon-shop.png"}}),s("span",{staticClass:"available-store__title__left__text"},[t._v("适用门店")])]),s("div",{staticClass:"available-store__title__right"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-arrows.png"}}),s("span",[t._v("查看全部("+t._s(t.shops.length)+")")])])]),s("div",{staticClass:"available-store__content"},[s("div",{staticClass:"available-store__content__title"},[s("div",{staticClass:"available-store__content__title__shop"},[s("span",{staticClass:"available-store__content__title__shop__name"},[t._v(t._s(t.shops[0].shopName))]),""!==t.shops[0].businessTime?s("format-business-time",{attrs:{businessTime:t.shops[0].businessTime}}):t._e()],1),t.sortedShopsWithDistance[0].distance?s("div",{staticClass:"available-store__content__title__distance"},[t._v("\n          距您"+t._s(t._f("toKilometer")(t.sortedShopsWithDistance[0].distance))+"\n        ")]):t._e()]),s("div",{staticClass:"available-store__content__address"},[t._v("\n        "+t._s(t.shops[0].address)+"\n      ")])])]):s("div",[s("div",{staticClass:"available-store__title"},[s("div",{staticClass:"available-store__title__left"},[s("img",{staticClass:"available-store__title__left__image",attrs:{src:t.ossImageUrl+"/coupon/icon-shop.png"}}),s("span",{staticClass:"available-store__title__left__text"},[t._v("适用门店")])])]),s("div",{staticClass:"available-store__all-shop"},[t._v("\n      "+t._s(t.regionName)+"地区所有门店\n    ")])])])},xn=[],An={props:["couponDetails"],components:{FormatBusinessTime:he},data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",shops:null,shopUseFlg:this.couponDetails.shopUseFlg,regionName:null,currentLocation:null}},created:function(){var t=gt.getRegionBlockCode();this.regionName=le.getCurrentRegionName(t),this.filterShops(),this.getLocation()},filters:{toKilometer:function(t){return t>20?">20km":t.toFixed(2)+"km"}},computed:{sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=te()({},e);return s.distance=oe(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops}},methods:{goToCouponShopList:function(){var t=this.couponDetails.shopList;this.$router.push({name:"coupon-available-shop-list",params:{shopList:t}})},filterShops:function(){var t=gt.getRegionBlockCode(),e=this.couponDetails.shopList,s=this.shopUseFlg,i=0===s;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](t);this.shops=n?this.$store.getters["shop/shopsForRegion"](t):[]}else{var a=this.$store.state.shop.shops[t];this.shops=ne.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},getLocation:function(){var t=this;ht.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i}})}}},In=An,Nn=(s("748a"),Object(_["a"])(In,Tn,xn,!1,null,"adb73bba",null)),Ln=Nn.exports,Pn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-instruction"},[s("div",{staticClass:"coupon-instruction__title"},[s("img",{staticClass:"coupon-instruction__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-coupon-instruction.png"}}),s("span",{staticClass:"coupon-instruction__title__text"},[t._v("礼券说明")])]),s("div",{staticClass:"coupon-instruction__text-list"},[s("p",[t._v(t._s(t.couponExplain))])])])},En=[],Mn={props:["couponExplain"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}}},$n=Mn,Fn=(s("2a6e"),Object(_["a"])($n,Pn,En,!1,null,"69a72388",null)),On=Fn.exports,Rn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-commodity"},[s("div",{staticClass:"available-commodity__title"},[s("img",{staticClass:"available-commodity__title__image",attrs:{src:t.ossImageUrl+"/coupon/icon-available-commodity.png"}}),s("span",{staticClass:"available-commodity__title__text"},[t._v("适用商品")])]),s("div",{staticClass:"available-commodity__content"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",[t._v("适用所有商品")]):"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType?s("div",[t._v(t._s(t.couponDetails.commodityList[0].commodityName))]):t._e()])])},Bn=[],Un={props:["couponDetails"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ni.getType(this.couponDetails)}}},jn=Un,Hn=(s("afc2"),Object(_["a"])(jn,Rn,Bn,!1,null,"0127392b",null)),Wn=Hn.exports,Gn={data:function(){return{couponDetails:null,ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},components:{CouponType:cn,TimelineBar:_n,UseCondition:Cn,OtherCondition:kn,AvailableShop:Ln,CouponInstruction:On,AvailableCommodity:Wn,GotoHome:St},created:function(){this.fetchCouponDetails()},methods:{fetchCouponDetails:function(){var t=this;Rt.show();var e=this.$route.params.couponId,s=gt.getRegionBlockCode();vt.coupon.fetchCouponDetail({couponId:e,regionBlockCode:s}).then(function(e){t.couponDetails=e}).finally(function(){return Rt.hide()})}}},zn=Gn,Vn=(s("4ea9"),Object(_["a"])(zn,Xi,Zi,!1,null,"75572b64",null)),qn=Vn.exports,Yn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"get-coupons"},[s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchData}},[s("div",{staticClass:"get-coupons__content"},[s("div",{staticClass:"get-coupons__pick-coupon-remind"},[s("span",{staticClass:"get-coupons__pick-coupon-remind__text"},[t._v("优惠订阅，活动开启前提醒我。")]),t.isRemind?s("div",{staticClass:"get-coupons__pick-coupon-remind__button",on:{click:t.remindSwitch}},[s("span",{staticClass:"get-coupons__pick-coupon-remind__button__switch"})]):s("div",{staticClass:"get-coupons__pick-coupon-remind__button-gray",on:{click:t.remindSwitch}},[s("span",{staticClass:"get-coupons__pick-coupon-remind__button-gray__switch"})])]),null!==t.pickCouponActivityList?s("div",{staticClass:"get-coupons__banner"},[s("swiper",{attrs:{options:t.swiperOption}},t._l(t.pickCouponActivityList.pickCouponActivityList,function(e,i){return s("swiper-slide",{key:i},[s("img",{attrs:{src:e.imagePathList},on:{click:function(s){return t.goToPickCouponActivityDetail(e.pickCouponActivityId)}}})])}),1),s("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"})],1):t._e(),t.hasNewShopsCouponVisible?s("div",{staticClass:"get-coupons__image",on:{click:t.goToNewShopCoupon}},[s("img",{attrs:{src:t.newShopBannerImage}})]):t._e(),null!==t.pickCouponList?s("div",{staticClass:"get-coupons__coupon-list"},t._l(t.pickCouponList,function(e,i){return s("div",{key:i},[e.notBegin?s("coupon-item-not-begin",{attrs:{coupon:e}}):e.hasPicked?s("coupon-item-picked",{attrs:{coupon:e}}):e.couponRemain<=0&&e.sendUpperLimit>0?s("coupon-item-no-remaining",{attrs:{coupon:e}}):e.hasPicked?t._e():s("coupon-item-unclaimed",{attrs:{coupon:e},on:{click:function(s){return t.pickCoupon(e.couponId)}}})],1)}),0):t._e()])]),s("goto-home")],1)},Qn=[],Kn=s("768b"),Xn=(s("ac6a"),s("5df3"),s("dfa4"),s("7212")),Zn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.visible?s("div",{staticClass:"toast"},[s("transition",{attrs:{name:"fade"}},["success-icon"===t.iconName?s("div",[s("div",{staticClass:"toast__container"},[s("div",{staticClass:"toast__container__wrapper"},[s("span",{staticClass:"toast__container__wrapper__icon success"}),s("div",{staticClass:"toast__container__wrapper__msg"},[t._v(t._s(t.msg))])])])]):"error-icon"===t.iconName?s("div",[s("div",{staticClass:"toast__container"},[s("div",{staticClass:"toast__container__wrapper"},[s("span",{staticClass:"toast__container__wrapper__icon error"}),s("div",{staticClass:"toast__container__wrapper__msg"},[t._v(t._s(t.msg))])])])]):s("div",{staticClass:"toast__msg"},[t._v(t._s(t.msg))])])],1):t._e()},Jn=[],ta={props:{msg:String,iconName:String},data:function(){return{visible:!1}},mounted:function(){var t=this;window.addEventListener("popstate",function(e){t.visible=!1})}},ea=ta,sa=(s("d88c"),Object(_["a"])(ea,Zn,Jn,!1,null,"58787cb4",null)),ia=sa.exports,na=i["a"].extend(ia),aa=new na({el:document.createElement("div")});document.body.appendChild(aa.$el);var oa={show:function(t){var e=t.msg,s=void 0===e?"":e,i=t.duration,n=void 0===i?2500:i,a=t.iconName,o=void 0===a?"":a;aa.msg=s,aa.iconName=o,aa.visible=!0,setTimeout(function(){return aa.visible=!1},n)}},ca=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__picked-up"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-picked-up.png"}})])])])},ra=[],la={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:se()()}},computed:{couponType:function(){return ni.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},da=la,pa=(s("22c2"),Object(_["a"])(da,ca,ra,!1,null,"4f0bd26c",null)),ua=pa.exports,_a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__activity-progress"},[s("div",{staticClass:"coupon-item__activity-progress__no-start"},[s("div",{staticClass:"coupon-item__activity-progress__no-start__time"},[t._v(t._s(t._f("formatTime")(t.coupon.useDateFrom)))]),s("div",[t._v("活动开始")])])])])])},ma=[],ha={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:se()()}},computed:{couponType:function(){return ni.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)},formatTime:function(t){var e=new Date(t).getMonth()+1,s=new Date(t).getDate(),i=new Date(t).getHours(),n=new Date(t).getMinutes(),a=s<10?"0"+s:String(s),o=i<10?"0"+i:String(i),c=n<10?"0"+n:String(n);return"".concat(e,"月").concat(a,"日").concat(o,":").concat(c)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},ga=ha,va=(s("95da"),Object(_["a"])(ga,_a,ma,!1,null,"f1fd3c74",null)),fa=va.exports,Ca=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__activity-progress"},[t.coupon.sendUpperLimit>0?s("div",[s("div",{staticClass:"coupon-item__activity-progress__persent"},[s("canvas",{ref:"canvas",staticClass:"canvas",attrs:{width:"120",height:"120"}}),s("div",{staticClass:"coupon-item__activity-progress__persent__text"},[s("span",[t._v("已抢")]),s("span",[t._v(t._s(t.coupon.percentage)+"%")])])]),s("div",{staticClass:"coupon-item__activity-progress__button",on:{click:t.pickCoupon}},[s("span",[t._v("立即领取")])])]):s("div",{staticClass:"coupon-item__activity-progress__limit-none-button",on:{click:t.pickCoupon}},[s("span",[t._v("立即领取")])])])])])},ya=[],ba={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:se()()}},computed:{couponType:function(){return ni.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},watch:{coupon:function(t,e){this.drawCanvas()}},mounted:function(){this.drawCanvas()},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})},pickCoupon:function(t){t.stopImmediatePropagation(),this.$emit("click")},drawCanvas:function(){if(this.coupon.sendUpperLimit>0){var t=function(t){n.clearRect(0,0,100,100),n.beginPath(),n.arc(60,60,32,i(0),i(100)),n.strokeStyle="#f5c7c0",n.lineWidth=3,n.lineCap="round",n.stroke(),n.beginPath(),n.arc(60,60,32,i(0),i(t)),n.strokeStyle="#e65c58",n.lineWidth=3,n.lineCap="round",n.stroke()},e=function e(s){s<=a&&(t(s),requestAnimationFrame(function(){e(s+1)}))},s=function(t,e,s,i,n){var a=(t-e)/(s-e);return i+a*(n-i)},i=function(t){return s(t,0,100,.75*Math.PI,2.25*Math.PI)},n=this.$refs.canvas.getContext("2d"),a=this.coupon.percentage;requestAnimationFrame(function(){return e(0)})}}}},wa=ba,Sa=(s("fc26"),Object(_["a"])(wa,Ca,ya,!1,null,"7b3ed53e",null)),Da=Sa.exports,ka=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item-none",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item-none__image",attrs:{src:t.ossImageUrl+"/coupon/failure-coupons-background.png"}}),s("div",{staticClass:"coupon-item-none__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item-none__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price coupon-item-none__limit-product"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price coupon-item-none__limit-product"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item-none__description"},[s("div",{staticClass:"coupon-item-none__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item-none__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item-none__activity-progress"},[s("div",{staticClass:"coupon-item-none__activity-progress__picked-up"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-picked-up-none.png"}})])])])])},Ta=[],xa={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ni.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},Aa=xa,Ia=(s("5591"),Object(_["a"])(Aa,ka,Ta,!1,null,"3828ce2c",null)),Na=Ia.exports,La={data:function(){return{pickCouponActivityList:null,pickCouponList:null,swiperOption:{autoplay:{delay:1500,disableOnInteraction:!1},speed:500,loop:!0,pagination:{el:".swiper-pagination"}},hasNewShopsCouponVisible:!1,newShopBannerImage:null,isRemind:!1,isRefreshing:!1}},components:{swiper:Xn["swiper"],GotoHome:St,swiperSlide:Xn["swiperSlide"],PullDownRefresh:Vt,CouponItemPicked:ua,CouponItemNotBegin:fa,CouponItemUnclaimed:Da,CouponItemNoRemaining:Na},created:function(){Rt.show(),this.refusedPushState(),this.fetchData()},methods:{goToNewShopCoupon:function(){this.$router.push({path:"/new-shops-coupon"})},fetchData:function(){var t=this;return this.isRefreshing=!0,b.a.all([this.fetchPickCouponActivityList(),this.fetchPickCouponList(),this.hasNewShopsCoupon()]).then(function(e){var s=Object(Kn["a"])(e,3),i=s[0],n=s[1],a=s[2];if(a.hasCoupon){var o=gt.getRegionBlockCode();vt.coupon.getNewShopTopBanner({regionBlockCode:o}).then(function(e){t.newShopBannerImage=e.data.list[0].imagePath})}n.forEach(function(t){t.notBegin=t.currentDate<t.useDateFrom,t.percentage=Math.round((t.sendUpperLimit-t.couponRemain)/t.sendUpperLimit*100),t.isRemaining=t.couponRemain<=0&&t.sendUpperLimit>0}),t.pickCouponActivityList=i,t.pickCouponList=n,t.hasNewShopsCouponVisible=a.hasCoupon}).finally(function(){t.isRefreshing=!1,Rt.hide()})},fetchPickCouponActivityList:function(){var t=gt.getRegionBlockCode();return vt.coupon.fetchPickCouponActivityList({regionBlockCode:t})},fetchPickCouponList:function(){var t=gt.getRegionBlockCode();return vt.coupon.fetchPickCouponList({regionBlockCode:t})},hasNewShopsCoupon:function(){var t=gt.getRegionBlockCode();return vt.coupon.hasNewShopsCoupon({regionBlockCode:t})},goToPickCouponActivityDetail:function(t){this.$router.push({name:"pick-coupon-activity-detail",params:{pickCouponActivityId:t}})},remindSwitch:function(){var t=this;this.isRemind?vt.coupon.disagreePush().then(function(e){oa.show({msg:"您已关闭优惠订阅"}),t.isRemind=!1}):vt.coupon.agreePush().then(function(e){oa.show({msg:"您已开启闭优惠订阅"}),t.isRemind=!0})},pickCoupon:function(t){var e=this;vt.coupon.pickCoupon({couponId:t}).then(function(t){oa.show({msg:"抢券成功",iconName:"success-icon"});var s=gt.getRegionBlockCode();vt.coupon.fetchPickCouponList({regionBlockCode:s}).then(function(t){t.map(function(t){t.notBegin=t.currentDate<t.useDateFrom,t.percentage=Math.round((t.sendUpperLimit-t.couponRemain)/t.sendUpperLimit*100),t.isRemaining=t.couponRemain<=0&&t.sendUpperLimit>0}),e.pickCouponList=t})})},refusedPushState:function(){var t=this;vt.coupon.refusedPushState().then(function(e){e.deagreed?t.isRemind=!1:t.isRemind=!0})}}},Pa=La,Ea=(s("c462"),Object(_["a"])(Pa,Yn,Qn,!1,null,"05b9fcf5",null)),Ma=Ea.exports,$a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-shops-coupon"},[s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchNewShops}},[s("div",{staticClass:"new-shops-coupon__container"},[s("div",{staticClass:"new-shops-coupon__select-region"},[null!==t.cityList&&null!==t.currentCity?s("div",{staticClass:"new-shops-coupon__select-region__button"},[s("div",[t._v(t._s(t.currentCity.cityName))]),s("div",{staticClass:"new-shops-coupon__select-region__button__icon"}),s("select",{directives:[{name:"model",rawName:"v-model",value:t.currentCity,expression:"currentCity"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.currentCity=e.target.multiple?s:s[0]}}},t._l(t.cityList,function(e,i){return s("option",{key:e.cityId,domProps:{value:e}},[t._v(t._s(e.cityName))])}),0)]):t._e()]),null!==t.newShopList&&t.newShopList.length>0?s("div",{staticClass:"new-shops-coupon__content"},t._l(t.newShopList,function(e,i){return s("new-shop-item",{key:i,attrs:{newShop:e},on:{pickNewShopCoupon:t.pickNewShopCoupon}})}),1):s("div",{staticClass:"new-shops-coupon__no-data"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-no-data.png"}}),s("div",[t._v("暂无内容")])])])]),s("goto-home")],1)},Fa=[],Oa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-shop-item"},[s("div",{staticClass:"new-shop-item__shop"},[s("div",{staticClass:"new-shop-item__shop__name"},[s("span",{staticClass:"new-shop-item__shop__name__title"},[t._v(t._s(t.newShop.shopInfo.shopName))]),""!==t.newShop.shopInfo.businessTime?s("format-business-time",{attrs:{businessTime:t.newShop.shopInfo.businessTime}}):t._e()],1),s("div",{staticClass:"new-shop-item__shop__address"},[s("span",{staticClass:"new-shop-item__shop__address__title"},[t._v(t._s(t.newShop.shopInfo.address))]),t.shopDistance?s("span",{staticClass:"new-shop-item__shop__address__km"},[t._v("距您"+t._s(t._f("toKilometer")(t.shopDistance)))]):t._e()])]),t.couponList.length>0?s("div",{staticClass:"new-shop-item__coupon-list"},[t._l(t.couponList,function(e,i){return s("div",{key:i},[e.notBegin?s("coupon-item-not-begin",{attrs:{coupon:e}}):1===e.pickFlg?s("coupon-item-picked",{attrs:{coupon:e}}):e.couponRemain<=0&&e.sendUpperLimit>0?s("coupon-item-no-remaining",{attrs:{coupon:e}}):0===e.pickFlg?s("coupon-item-unclaimed",{attrs:{coupon:e},on:{click:function(s){return t.pickNewShopCoupon(e.couponId)}}}):t._e()],1)}),t.newShop.shopCoupons.length>2?s("div",[t.isUnfold?s("div",{staticClass:"new-shop-item__coupon-list__unfold",on:{click:t.unfoldCouponList}},[s("span",[t._v("收起")]),s("img",{staticClass:"new-shop-item__coupon-list__unfold__image",attrs:{src:t.ossImageUrl+"/coupon/icon-unfold.png"}})]):s("div",{staticClass:"new-shop-item__coupon-list__unfold",on:{click:t.unfoldCouponList}},[s("span",[t._v("展开剩余"+t._s(t.unfoldCouponListLength)+"张")]),s("img",{staticClass:"new-shop-item__coupon-list__forward__image",attrs:{src:t.ossImageUrl+"/coupon/icon-forward-copy.png"}})])]):t._e()],2):t._e()])},Ra=[],Ba=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__picked-up"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-picked-up.png"}})])])])},Ua=[],ja={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:se()()}},computed:{couponType:function(){return ni.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},Ha=ja,Wa=(s("d662"),Object(_["a"])(Ha,Ba,Ua,!1,null,"5ceae9cf",null)),Ga=Wa.exports,za=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__activity-progress"},[s("div",{staticClass:"coupon-item__activity-progress__no-start"},[s("div",{staticClass:"coupon-item__activity-progress__no-start__time"},[t._v(t._s(t._f("formatTime")(t.coupon.useDateFrom)))]),s("div",[t._v("活动开始")])])])])])},Va=[],qa={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:se()()}},computed:{couponType:function(){return ni.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)},formatTime:function(t){var e=new Date(t).getMonth()+1,s=new Date(t).getDate(),i=new Date(t).getHours(),n=new Date(t).getMinutes(),a=s<10?"0"+s:String(s),o=i<10?"0"+i:String(i),c=n<10?"0"+n:String(n);return"".concat(e,"月").concat(a,"日").concat(o,":").concat(c)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},Ya=qa,Qa=(s("2297"),Object(_["a"])(Ya,za,Va,!1,null,"69000168",null)),Ka=Qa.exports,Xa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item__image",attrs:{src:t.ossImageUrl+"/coupon/my-coupons-background.png"}}),s("div",{staticClass:"coupon-item__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__price coupon-item__limit-product"},[s("div",{staticClass:"coupon-item__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item__description"},[s("div",{staticClass:"coupon-item__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item__activity-progress"},[t.coupon.sendUpperLimit>0?s("div",[s("div",{staticClass:"coupon-item__activity-progress__persent"},[s("canvas",{ref:"canvas",staticClass:"canvas",attrs:{width:"120",height:"120"}}),s("div",{staticClass:"coupon-item__activity-progress__persent__text"},[s("span",[t._v("已抢")]),s("span",[t._v(t._s(t.coupon.percentage)+"%")])])]),s("div",{staticClass:"coupon-item__activity-progress__button",on:{click:t.pickCoupon}},[s("span",[t._v("立即领取")])])]):s("div",{staticClass:"coupon-item__activity-progress__limit-none-button",on:{click:t.pickCoupon}},[s("span",[t._v("立即领取")])])])])])},Za=[],Ja={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentDate:se()()}},computed:{couponType:function(){return ni.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},watch:{coupon:function(t,e){this.drawCanvas()}},mounted:function(){this.drawCanvas()},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})},pickCoupon:function(t){t.stopImmediatePropagation(),this.$emit("click")},drawCanvas:function(){if(this.coupon.sendUpperLimit>0){var t=function(t){n.clearRect(0,0,100,100),n.beginPath(),n.arc(60,60,32,i(0),i(100)),n.strokeStyle="#f5c7c0",n.lineWidth=3,n.lineCap="round",n.stroke(),n.beginPath(),n.arc(60,60,32,i(0),i(t)),n.strokeStyle="#e65c58",n.lineWidth=3,n.lineCap="round",n.stroke()},e=function e(s){s<=a&&(t(s),requestAnimationFrame(function(){e(s+1)}))},s=function(t,e,s,i,n){var a=(t-e)/(s-e);return i+a*(n-i)},i=function(t){return s(t,0,100,.75*Math.PI,2.25*Math.PI)},n=this.$refs.canvas.getContext("2d"),a=this.coupon.percentage;requestAnimationFrame(function(){return e(0)})}}}},to=Ja,eo=(s("4ec4"),Object(_["a"])(to,Xa,Za,!1,null,"4b908a58",null)),so=eo.exports,io=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-item-none",on:{click:t.goToCouponDetail}},[s("img",{staticClass:"coupon-item-none__image",attrs:{src:t.ossImageUrl+"/coupon/failure-coupons-background.png"}}),s("div",{staticClass:"coupon-item-none__info"},["totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        满"),s("span",{staticClass:"coupon-item-none__price__total-price__number"},[t._v(t._s(t.coupon.originalPrice))]),t._v("元\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price coupon-item-none__limit-product"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        全额折扣\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[t._v("\n        兑换\n      ")]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price"},[s("span",[t._v("减")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__price coupon-item-none__limit-product"},[s("div",{staticClass:"coupon-item-none__price__total-price"},[t._v("\n        消费立减\n      ")]),s("div",{staticClass:"coupon-item-none__price__discount-price product-price-minus-to-some-coupon"},[s("span",[t._v("减至")]),s("span",{staticClass:"coupon-item-none__price__discount-price__number"},[t._v(t._s(t.coupon.discountPrice))])]),s("div",{staticClass:"coupon-item-none__price__product-name"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")])]):t._e(),s("div",{staticClass:"coupon-item-none__description"},[s("div",{staticClass:"coupon-item-none__description__title"},[t._v("\n        "+t._s(t.coupon.couponName)+"\n      ")]),"totalPriceMinusSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__description__button"},[t._v("\n        全品类\n      ")]):t._e(),"productPriceMinusToFreeCoupon"===t.couponType||"productPriceMinusSomeCoupon"===t.couponType||"productPriceMinusToSomeCoupon"===t.couponType?s("div",{staticClass:"coupon-item-none__description__button"},[t._v("\n        限定商品\n      ")]):t._e(),0===t.coupon.dynamicPeriodFlg?s("div",{staticClass:"coupon-item-none__description__time"},[t._v("\n        有效期"+t._s(t._f("formatDate")(t.coupon.useDateFrom))+"-"+t._s(t._f("formatDate")(t.coupon.useDateTo))+"\n      ")]):t._e()]),s("div",{staticClass:"coupon-item-none__activity-progress"},[s("div",{staticClass:"coupon-item-none__activity-progress__picked-up"},[s("img",{attrs:{src:t.ossImageUrl+"/coupon/icon-picked-up-none.png"}})])])])])},no=[],ao={props:["coupon"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},computed:{couponType:function(){return ni.getType(this.coupon)}},filters:{formatDate:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,".").concat(n,".").concat(a)}},methods:{goToCouponDetail:function(){var t=this.coupon.couponId;this.$router.push({name:"coupon-detail",params:{couponId:t}})}}},oo=ao,co=(s("3ae1"),Object(_["a"])(oo,io,no,!1,null,"cd480352",null)),ro=co.exports,lo={props:["newShop"],data:function(){return{couponList:[],unfoldCouponListLength:null,isUnfold:!1,ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",currentLocation:null}},components:{CouponItemPicked:Ga,CouponItemNotBegin:Ka,CouponItemUnclaimed:so,CouponItemNoRemaining:ro,FormatBusinessTime:he},filters:{toKilometer:function(t){return t>20?">20km":t.toFixed(2)+"km"}},computed:{shopDistance:function(){var t={latitude:this.newShop.shopInfo.latitude,longitude:this.newShop.shopInfo.longitude},e=this.currentLocation;if(e)return oe(t.latitude,t.longitude,e.latitude,e.longitude)}},created:function(){this.shopCoupons(),this.getLocation()},watch:{newShop:function(t,e){this.couponList=[],this.newShop.shopCoupons.forEach(function(t){t.notBegin=t.currentDate<t.useDateFrom,t.percentage=Math.round((t.sendUpperLimit-t.couponRemain)/t.sendUpperLimit*100),t.isRemaining=t.couponRemain<=0&&t.sendUpperLimit>0}),this.couponList=this.newShop.shopCoupons}},methods:{shopCoupons:function(){this.newShop.shopCoupons.forEach(function(t){t.notBegin=t.currentDate<t.useDateFrom,t.percentage=Math.round((t.sendUpperLimit-t.couponRemain)/t.sendUpperLimit*100),t.isRemaining=t.couponRemain<=0&&t.sendUpperLimit>0}),this.newShop.shopCoupons.length>2?(this.couponList.push(this.newShop.shopCoupons[0]),this.couponList.push(this.newShop.shopCoupons[1]),this.unfoldCouponListLength=this.newShop.shopCoupons.length-2):this.couponList=this.newShop.shopCoupons},unfoldCouponList:function(){this.couponList=[],this.isUnfold?(this.isUnfold=!1,this.couponList.push(this.newShop.shopCoupons[0]),this.couponList.push(this.newShop.shopCoupons[1]),this.unfoldCouponListLength=this.newShop.shopCoupons.length-2):(this.isUnfold=!0,this.couponList=this.newShop.shopCoupons)},pickNewShopCoupon:function(t){var e=this.newShop.shopId;this.$emit("pickNewShopCoupon",{couponId:t,shopId:e})},getLocation:function(){var t=this;ht.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i}})}}},po=lo,uo=(s("6032"),Object(_["a"])(po,Oa,Ra,!1,null,"44ed5eea",null)),_o=uo.exports,mo={data:function(){return{newShopList:null,ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new",cityList:null,currentCity:null,isRefreshing:!1}},components:{GotoHome:St,NewShopItem:_o,PullDownRefresh:Vt},created:function(){var t=Object(w["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.fetchCityList();case 2:this.fetchNewShops();case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{fetchNewShops:function(){var t=this;this.isRefreshing=!0;var e=gt.getRegionBlockCode(),s=this.currentCity.cityId;vt.newShops.fetchNewShops({regionBlockCode:e,cityId:s}).then(function(e){t.newShopList=e,t.isRefreshing=!1}).catch(function(e){t.isRefreshing=!1})},fetchCityList:function(){var t=this;return Rt.show(),new b.a(function(e,s){var i=gt.getRegionBlockCode();vt.cityList.fetchCityList({regionBlockCode:i}).then(function(s){t.cityList=s.data,t.currentCity=t.cityList[0],e()}).finally(function(){return Rt.hide()})})},pickNewShopCoupon:function(t){var e=this,s=t.couponId,i=t.shopId,n=gt.getRegionBlockCode();vt.newShops.pickNewShopCoupon({regionBlockCode:n,couponId:s,shopId:i}).then(function(t){var s=e.currentCity.cityId;vt.newShops.fetchNewShops({regionBlockCode:n,cityId:s}).then(function(t){e.newShopList=t}),oa.show({msg:"抢券成功",iconName:"success-icon"})})}},watch:{currentCity:function(t,e){e&&this.fetchNewShops()}}},ho=mo,go=(s("4536"),Object(_["a"])(ho,$a,Fa,!1,null,"2ac6dc5b",null)),vo=go.exports,fo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.activityDetail?s("div",{staticClass:"pick-coupon-activity-detail"},[t.activityDetail.couponList.length<=1?s("single-coupon-activity",{attrs:{activityDetail:t.activityDetail},on:{pickCoupon:t.pickCoupon}}):s("multiple-coupon-activity",{attrs:{activityDetail:t.activityDetail},on:{pickCoupon:t.pickCoupon}}),s("goto-home")],1):t._e()},Co=[],yo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"single-coupon"},[s("div",{staticClass:"single-coupon__image"},[s("img",{attrs:{src:t.pickCouponActivity.backgroundImage}})]),s("div",{staticClass:"single-coupon__button",style:{top:t.couponShowOffset+"px"}},[t.isActivityEnd||t.isActivityBegin||t.isActivityGoingAndNoRemain?s("img",{staticClass:"single-coupon__button__image",attrs:{src:t.pickCouponActivity.couponImageList[1].couponImage}}):s("img",{staticClass:"single-coupon__button__image",attrs:{src:t.pickCouponActivity.couponImageList[0].couponImage}}),t.isActivityBegin?s("span",{staticClass:"single-coupon__button__text"},[t._v("即将开始")]):t.isActivityEnd?s("span",{staticClass:"single-coupon__button__text"},[t._v("活动结束")]):t.coupon.couponRemain<=0&&t.coupon.sendUpperLimit>0?s("span",{staticClass:"single-coupon__button__text"},[t._v("已领完")]):t.coupon.hasPicked?s("span",{staticClass:"single-coupon__button__text"},[t._v("已领取")]):t.coupon.hasPicked?t._e():s("span",{staticClass:"single-coupon__button__text",on:{click:function(e){return t.pickCoupon(t.coupon.couponId)}}},[t._v("立即领取")])])])},bo=[],wo={props:["activityDetail"],computed:{pickCouponActivity:function(){return this.activityDetail.pickCouponActivity},coupon:function(){return this.activityDetail.couponList[0]},isActivityBegin:function(){var t=Date.parse(new Date);return t<this.pickCouponActivity.beginTime},isActivityEnd:function(){var t=Date.parse(new Date);return t>this.pickCouponActivity.endTime},isActivityGoingAndNoRemain:function(){var t=Date.parse(new Date);return t>=this.pickCouponActivity.beginTime&&t<=this.pickCouponActivity.endTime&&this.coupon.couponRemain<=0&&this.coupon.sendUpperLimit>0},couponShowOffset:function(){var t=window.screen.width,e=this.pickCouponActivity.couponShowOffset,s=375;return e*t/s}},methods:{pickCoupon:function(t){this.$emit("pickCoupon",t)}}},So=wo,Do=(s("74fe"),Object(_["a"])(So,yo,bo,!1,null,"3af48294",null)),ko=Do.exports,To=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"multiple-coupon"},[s("img",{staticClass:"multiple-coupon__image",attrs:{src:t.pickCouponActivity.backgroundImage}}),s("div",{staticClass:"multiple-coupon__coupon-list",style:{top:t.couponShowOffset+"px"}},t._l(t.couponList,function(e,i){return s("div",{key:i,staticClass:"multiple-coupon__coupon-list__item"},[t.isActivityBegin?s("img",{attrs:{src:t.pickCouponActivity.couponImageList[0].couponImage}}):t.isActivityEnd&&!e.hasPicked?s("img",{attrs:{src:t.pickCouponActivity.couponImageList[2].couponImage}}):t.isActivityEnd&&e.hasPicked?s("img",{attrs:{src:t.pickCouponActivity.couponImageList[3].couponImage}}):e.noRemaining?s("img",{attrs:{src:t.pickCouponActivity.couponImageList[2].couponImage}}):e.hasPicked?s("img",{attrs:{src:t.pickCouponActivity.couponImageList[1].couponImage}}):e.hasPicked?t._e():s("img",{attrs:{src:t.pickCouponActivity.couponImageList[0].couponImage}}),s("div",{staticClass:"multiple-coupon__coupon-list__item__container",on:{click:function(s){return t.pickCoupon(e)}}},[s("div",{staticClass:"multiple-coupon__coupon-list__item__info"},["totalPriceMinusSomeCoupon"===e.couponType?s("div",[s("div",{staticClass:"multiple-coupon__coupon-list__item__info__coupon-type"},[t._v("\n              满"+t._s(e.originalPrice)+"元可用\n            ")]),s("div",{staticClass:"multiple-coupon__coupon-list__item__info__price"},[s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__symbol"},[t._v("¥")]),s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__discount"},[t._v(t._s(e.discountPrice))])])]):t._e(),"productPriceMinusToFreeCoupon"===e.couponType?s("div",[s("div",{staticClass:"multiple-coupon__coupon-list__item__info__coupon-type"},[t._v("全额折扣")]),t._m(0,!0)]):t._e(),"productPriceMinusSomeCoupon"===e.couponType?s("div",[s("div",{staticClass:"multiple-coupon__coupon-list__item__info__coupon-type"},[t._v("消费立减")]),s("div",{staticClass:"multiple-coupon__coupon-list__item__info__price"},[s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__symbol"},[t._v("¥")]),s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__discount"},[t._v(t._s(e.discountPrice))])])]):t._e(),"productPriceMinusToSomeCoupon"===e.couponType?s("div",[s("div",{staticClass:"multiple-coupon__coupon-list__item__info__coupon-type"},[t._v("\n              消费立减\n            ")]),s("div",{staticClass:"multiple-coupon__coupon-list__item__info__price"},[s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__discount product-price-minus--to-some-coupon"},[t._v("减至")]),s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__symbol"},[t._v("¥")]),s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__discount product-price-minus--to-some-coupon__price"},[t._v(t._s(e.discountPrice))])])]):t._e(),"totalPriceMinusSomeCoupon"===e.couponType?s("div",{staticClass:"multiple-coupon__coupon-list__item__info__commodity-type"},[t._v("\n            全品类商品\n          ")]):s("div",{staticClass:"multiple-coupon__coupon-list__item__info__commodity-type"},[t._v("\n            "+t._s(e.couponName)+"\n          ")])]),s("div",{staticClass:"multiple-coupon__coupon-list__item__status"},[t.isActivityBegin?s("span",[t._v("即将开始")]):t.isActivityEnd?s("span",[t._v("活动结束")]):e.noRemaining?s("span",[t._v("已领完")]):e.hasPicked?s("span",[t._v("已领取")]):e.hasPicked?t._e():s("span",[t._v("立即领取")])])])])}),0)])},xo=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"multiple-coupon__coupon-list__item__info__price"},[s("span",{staticClass:"multiple-coupon__coupon-list__item__info__price__discount product-price-minus-to-free-coupon"},[t._v("兑换")])])}],Ao={props:["activityDetail"],computed:{couponList:function(){return this.activityDetail.couponList.map(function(t){t.noRemaining=t.couponRemain<=0&&t.sendUpperLimit>0,t.couponType=ni.getType(t)}),this.activityDetail.couponList},pickCouponActivity:function(){return this.activityDetail.pickCouponActivity},isActivityBegin:function(){var t=Date.parse(new Date);return t<this.pickCouponActivity.beginTime},isActivityEnd:function(){var t=Date.parse(new Date);return t>this.pickCouponActivity.endTime},couponShowOffset:function(){var t=window.screen.width,e=this.pickCouponActivity.couponShowOffset,s=375;return e*t/s}},methods:{pickCoupon:function(t){var e=Date.parse(new Date);e>=this.pickCouponActivity.beginTime&&e<=this.pickCouponActivity.endTime&&!t.noRemaining&&!t.hasPicked&&this.$emit("pickCoupon",t.couponId)}}},Io=Ao,No=(s("6fe8"),Object(_["a"])(Io,To,xo,!1,null,"b295058e",null)),Lo=No.exports,Po={data:function(){return{activityDetail:null}},components:{GotoHome:St,SingleCouponActivity:ko,MultipleCouponActivity:Lo},created:function(){this.fetchPickCouponDetail()},methods:{fetchPickCouponDetail:function(){var t=this;Rt.show();var e=this.$route.params.pickCouponActivityId;vt.coupon.fetchPickCouponDetail({pickCouponActivityId:e}).then(function(e){t.activityDetail=e.data;var s=t.activityDetail.pickCouponActivity,i=gt.getRegionBlockCode();i!==s.regionBlockCode&&t.showRegionDiffModal(s.regionBlockCode),wx.miniProgram.postMessage({data:{shareTitle:s.title}})}).finally(function(){return Rt.hide()})},showRegionDiffModal:function(t){var e=le.getCurrentRegionName(t),s=null===gt.getUserInfo();s?Fe.alert({title:"友情提示",msg:"你当前查阅内容，可能受区域限制有所不同"}):Fe.alert({title:"友情提示",msg:"你所在区域无法参与，当前内容仅限".concat(e)})},pickCoupon:function(t){var e=this,s=this.$route.params.pickCouponActivityId,i=null===gt.getUserInfo();i?wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=pickCouponActivity&pickCouponActivityId=".concat(s,"&sourceType=internal")}):vt.coupon.pickCouponActivity({pickCouponActivityId:s,couponId:t}).then(function(t){vt.coupon.fetchPickCouponDetail({pickCouponActivityId:s}).then(function(t){e.activityDetail=t.data})}).catch(function(t){console.log(t)})}}},Eo=Po,Mo=(s("f9cc"),Object(_["a"])(Eo,fo,Co,!1,null,"95f21ea8",null)),$o=Mo.exports,Fo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shops&&t.oftenShops?s("div",{staticClass:"coupon-available-shop-list"},[s("div",{staticClass:"coupon-available-shop-list__search-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchShop,expression:"searchShop"}],staticClass:"coupon-available-shop-list__search-container__search-bar",attrs:{placeholder:"输入门店名称"},domProps:{value:t.searchShop},on:{input:function(e){e.target.composing||(t.searchShop=e.target.value)}}})]),s("div",{ref:"currentShop",staticClass:"coupon-available-shop-list__current-shop"},[t._m(0),s("div",{staticClass:"coupon-available-shop-list__current-shop__item"},[s("div",{staticClass:"coupon-available-shop-list__current-shop__item__icon-location"}),t.currentAddress?s("div",{staticClass:"coupon-available-shop-list__current-shop__item__current-address"},[t._v(t._s(t.currentAddress))]):t._e(),s("div",{staticClass:"coupon-available-shop-list__current-shop__item__refresh-location",on:{click:t.setCurrentAddress}},[t._v("重新定位")])]),s("div",{staticClass:"coupon-available-shop-list__whitespace"}),t.oftenShops.length>0?[t._m(1),t._l(t.oftenShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e(),s("div",{staticClass:"coupon-available-shop-list__whitespace"}),t._m(2),t.shops.length>0?t._l(t.nearbyShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})}):t._e()],2)]):t._e()},Oo=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-available-shop-list__current-shop__title-row"},[s("span",{staticClass:"coupon-available-shop-list__current-shop__title-row__title"},[t._v("当前定位")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-available-shop-list__my-shops__title-row"},[s("span",{staticClass:"coupon-available-shop-list__my-shops__title-row__title"},[t._v("常去门店")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-available-shop-list__nearby-shops__title-row"},[s("span",{staticClass:"coupon-available-shop-list__nearby-shops__title-row__title"},[t._v("附近门店")])])}],Ro=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-item"},[s("div",{staticClass:"shop-item__info"},[s("div",{staticClass:"shop-item__basic-info"},[s("div",{staticClass:"shop-item__shop-name"},[s("span",[t._v(t._s(t.shop.shopName))]),""!==t.shop.businessTime?s("format-business-time",{attrs:{businessTime:t.shop.businessTime}}):t._e()],1),s("div",{staticClass:"shop-item__shop-address"},[t._v(t._s(t.shop.address))])]),t.shop.distance?s("div",{staticClass:"shop-item__map-info"},[s("div",{staticClass:"shop-item__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.shop.distance)))]),s("div",{staticClass:"shop-item__show-in-map",on:{click:t.openMap}},[t._v("地图 >")])]):t._e()])])},Bo=[],Uo={props:{shop:Object},components:{FormatBusinessTime:he},methods:{openMap:function(){wx.openLocation({latitude:this.shop.latitude,longitude:this.shop.longitude,name:this.shop.shopName,address:this.shop.address})}},filters:{toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},jo=Uo,Ho=(s("9ba9"),Object(_["a"])(jo,Ro,Bo,!1,null,"fe2b9fbc",null)),Wo=Ho.exports,Go={components:{ShopItem:Wo},data:function(){return{shops:null,oftenShops:null,currentAddress:null,nearbyShopsLength:10,searchShop:null,currentLocation:null}},created:function(){this.fetchOrderShopList(),this.fetchOftenShoplist()},mounted:function(){var t=this;ze.init().then(function(){t.setCurrentAddress()})},updated:function(){this.$refs.currentShop.addEventListener("scroll",this.handleScroll)},computed:{sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=te()({},e);return s.distance=oe(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops},filterShops:function(){var t=this;return this.searchShop?this.sortedShopsWithDistance.filter(function(e){return e.shopName.includes(t.searchShop)}):this.sortedShopsWithDistance},currentShop:function(){return this.sortedShopsWithDistance[0]},myShops:function(){return this.sortedShopsWithDistance.slice(1,3)},nearbyShops:function(){return this.filterShops.slice(0,this.nearbyShopsLength)}},methods:{handleScroll:ne.a.debounce(function(){var t=this.$refs.currentShop.scrollTop,e=this.$refs.currentShop.clientHeight,s=this.$refs.currentShop.scrollHeight,i=s<=e+t;i&&(this.nearbyShopsLength+=6)},150),fetchOrderShopList:function(){var t=this.$route.params.shopUseFlg,e=this.$route.params.shopList,s=gt.getRegionBlockCode(),i=0===t;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](s);this.shops=n?this.$store.getters["shop/shopsForRegion"](s):[]}else{var a=this.$store.state.shop.shops[s];this.shops=ne.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},fetchOftenShoplist:function(){var t=this;Rt.show();var e=gt.getRegionBlockCode();vt.shop.fetchOftenShoplist({regionBlockCode:e}).then(function(e){t.oftenShops=e.data.data.slice(0,2)}).finally(function(){return Rt.hide()})},setCurrentAddress:function(){var t=this;this.currentAddress=null,ht.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i},ze.getAddressByLatLng(s,i).then(function(e){t.currentAddress=e.address})})}}},zo=Go,Vo=(s("95a5"),Object(_["a"])(zo,Fo,Oo,!1,null,"eaf579f4",null)),qo=Vo.exports,Yo=[{path:"/user-coupon-detail/:couponId/:userCouponId",name:"user-coupon-detail",component:Ki,meta:{title:"优惠券详情"}},{path:"/coupon-detail/:couponId",name:"coupon-detail",component:qn,meta:{title:"优惠券详情"}},{path:"/pick-coupon-list",name:"pick-coupon-list",component:Ma,meta:{title:"领券中心"}},{path:"/new-shops-coupon",name:"new-shops-coupon",component:vo,meta:{title:"新店优惠券"}},{path:"/pick-coupon-activity-detail/:pickCouponActivityId",name:"pick-coupon-activity-detail",component:$o,meta:{title:"领券活动详情页"}},{path:"/coupon-available-shop-list",name:"coupon-available-shop-list",component:qo,meta:{title:"优惠券适用门店"}}],Qo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-list"},[null===t.campaignList?s("div",{staticClass:"campaign-list__loading"},[s("div",{staticClass:"campaign-list__loading__skeleton-screen"})]):s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchCampaignList}},[0===t.campaignList.length?s("div",{staticClass:"campaign-list__error"},[s("div",{staticClass:"campaign-list__error__image"}),s("div",{staticClass:"campaign-list__error__no-data"},[t._v("暂无集点活动")])]):s("div",{staticClass:"campaign-list__success"},[t.canShowTitleTip?s("div",{class:["campaign-list__title-tip",{"close-title-tip-title":t.isCloseTitleTip}]},[s("div",{staticClass:"campaign-list__title-tip__image"}),s("div",{staticClass:"campaign-list__title-tip__text-wrapper"},[t.canTransferCampaignToFriend?s("div",{staticClass:"campaign-list__title-tip__text"},[t._v("你可通过转赠集点与朋友共同达成目标")]):s("div",{staticClass:"campaign-list__title-tip__text"},[t._v("您有 "+t._s(t.aboutToReachQuatity)+" 项集点即将达成目标，加油！！")]),s("div",{staticClass:"campaign-list__title-tip__close-wrapper",on:{click:t.closeTitleTip}},[s("div",{staticClass:"campaign-list__title-tip__close"})])])]):t._e(),s("div",{class:["campaign-list__list-body",{"close-title-tip-body":t.isCloseTitleTip}]},t._l(t.campaignList,function(t){return s("campaign-list-view-item",{key:t.campaignId,attrs:{campaign:t}})}),1)])]),s("div",{staticClass:"campaign-list__list-foot"},[s("goto-home")],1)],1)},Ko=[],Xo=864e5;function Zo(t){var e=(new Date).getTime(),s=e>t.campaignDateFrom&&e<t.campaignDateTo;return s}function Jo(t){var e=Ns()(t.campaignDateFrom/Xo),s=Ns()((new Date).getTime()/Xo);return!nc(t)&&Ns()((e+4)/7)==Ns()((s+4)/7)&&t.campaignDateFrom>(new Date).getTime()}function tc(t){var e=(new Date).getTime();return e<t.campaignDateFrom&&!Jo(t)&&t.campaignDateFrom-e<5*Xo&&t.campaignDateFrom-e>0}function ec(t){var e=(new Date).getTime();return e<t.campaignDateFrom&&t.campaignDateFrom-e>5*Xo}function sc(t){var e=t.userTotalStampNum%t.stampNeeded;return Zo(t)&&e/t.stampNeeded>=.7}function ic(t){var e=(new Date).getTime();return e<t.openEndDt&&t.userTotalStampNum/t.stampNeeded>=1}function nc(t){var e=(new Date).getTime();return e>t.campaignDateTo&&t.userTotalStampNum/t.stampNeeded<1||e>t.openEndDt}function ac(t){return 0===t.giftNums}function oc(t){var e=(new Date).getTime();return t.userTotalStampNum/t.stampNeeded>=.7&&t.userTotalStampNum/t.stampNeeded<1&&t.campaignDateTo-e<5*Xo&&t.giftNums>0}function cc(t){var e=(new Date).getTime();return e>t.campaignDateTo&&e<t.openEndDt&&t.userTotalStampNum/t.stampNeeded>=1&&t.giftNums>0}var rc={isAlreadyReached:function(t){return ic(t)},isAboutToReach:function(t){return sc(t)},canTransferCampaignToFriend:function(t){return!nc(t)&&(t.openEndDt-(new Date).getTime())/Xo<7&&t.userTotalStampNum/t.stampNeeded>=.5},getStatus:function(t){if(ac(t))return"已结束";if(oc(t)||cc(t)){var e=(t.campaignDateTo-(new Date).getTime())/Xo;return e>=0?"进行中 ".concat(Ns()(e,0),"天后结束"):"活动截止"}if(sc(t)){var s=(t.campaignDateTo-(new Date).getTime())/Xo;return"进行中 ".concat(Ns()(s,0),"天后结束")}if(ic(t)){var i=(t.campaignDateTo-(new Date).getTime())/Xo;return i>=0?"进行中 ".concat(Ns()(i,0),"天后结束"):"已结束"}if(Jo(t)){var n=new Date(t.campaignDateFrom),a=n.getMonth()+1,o=n.getDate()>=10?n.getDate():"0".concat(n.getDate());return"".concat(a,"月").concat(o,"日开始")}if(tc(t)){var c=new Date(t.campaignDateFrom),r=c.getMonth()+1,l=c.getDate()>=10?c.getDate():"0".concat(c.getDate());return"".concat(r,"月").concat(l,"日开始")}if(ec(t)){var d=new Date(t.campaignDateFrom),p=d.getMonth()+1,u=d.getDate()>=10?d.getDate():"0".concat(d.getDate());return"".concat(p,"月").concat(u,"日开始")}if(Zo(t)){var _=(t.campaignDateTo-(new Date).getTime())/Xo;return"进行中 ".concat(Ns()(_,0),"天后结束")}if(nc(t)){var m=new Date(t.campaignDateTo),h=m.getMonth()+1,g=m.getDate()>=10?m.getDate():"0".concat(m.getDate());return"".concat(h,"月").concat(g,"日结束")}},getCampaignStatus:function(t){if(ac(t))return{campaignStatus:"outOfDate",campaignStatusText:"已结束"};if(oc(t))return{campaignStatus:"almostOutOfDate",campaignStatusText:"即将过期"};if(cc(t))return{campaignStatus:"almostOutOfDateAndReached",campaignStatusText:"即将过期"};if(ic(t))return{campaignStatus:"reached",campaignStatusText:"可兑换"};if(sc(t))return{campaignStatus:"aboutToReach",campaignStatusText:"即将达成"};if(Jo(t)){var e=new Date(t.campaignDateFrom),s=e.getDay(),i=e.getHours()>=10?e.getHours():"0".concat(e.getHours()),n=e.getMinutes()>=10?e.getMinutes():"0".concat(e.getMinutes());switch(s){case 1:return{campaignStatus:"aboutToStart",campaignStatusText:"本周一 ".concat(i,":").concat(n,"开始")};case 2:return{campaignStatus:"aboutToStart",campaignStatusText:"本周二 ".concat(i,":").concat(n,"开始")};case 3:return{campaignStatus:"aboutToStart",campaignStatusText:"本周三 ".concat(i,":").concat(n,"开始")};case 4:return{campaignStatus:"aboutToStart",campaignStatusText:"本周四 ".concat(i,":").concat(n,"开始")};case 5:return{campaignStatus:"aboutToStart",campaignStatusText:"本周五 ".concat(i,":").concat(n,"开始")};case 6:return{campaignStatus:"aboutToStart",campaignStatusText:"本周六 ".concat(i,":").concat(n,"开始")};case 0:return{campaignStatus:"aboutToStart",campaignStatusText:"本周日 ".concat(i,":").concat(n,"开始")}}}else{if(tc(t)){var a=new Date(t.campaignDateFrom),o=new Date,c=a.getHours()>=10?a.getHours():"0".concat(a.getHours()),r=a.getMinutes()>=10?a.getMinutes():"0".concat(a.getMinutes()),l=(a.getTime()-o.getTime())/Xo;return{campaignStatus:"aboutToStart",campaignStatusText:"".concat(Ns()(l),"天后 ").concat(c,":").concat(r,"开始")}}if(ec(t)){var d=new Date(t.campaignDateFrom),p=d.getMonth()+1>=10?d.getMonth()+1:"0".concat(d.getMonth()+1),u=d.getDate()>=10?d.getDate():"0".concat(d.getDate()),_=d.getHours()>=10?d.getHours():"0".concat(d.getHours()),m=d.getMinutes()>=10?d.getMinutes():"0".concat(d.getMinutes());return{campaignStatus:"aboutToStart",campaignStatusText:"".concat(p,"月").concat(u,"日 ").concat(_,":").concat(m,"开始")}}if(Zo(t))return{campaignStatus:"onGoing",campaignStatusText:"进行中"};if(nc(t))return{campaignStatus:"outOfDate",campaignStatusText:"已结束"}}}},lc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-list-view-item",on:{click:t.gotoDetail}},[s("div",{staticClass:"campaign-list-view-item__top"},[s("img",{staticClass:"campaign-list-view-item__top__image",attrs:{src:t.campaign.image}}),s("div",{class:["campaign-list-view-item__top__image-mask",{"out-of-date":"outOfDate"===t.campaign.campaignStatus,reached:"reached"===t.campaign.campaignStatus||"almostOutOfDateAndReached"===t.campaign.campaignStatus}]}),s("div",{staticClass:"campaign-list-view-item__top__status-region-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-wrapper"},["aboutToStart"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-about-to-start-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-about-to-start"},[t._v(t._s(t.campaign.campaignStatusText))])]):"onGoing"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-on-going-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-on-going"},[t._v(t._s(t.campaign.campaignStatusText))]),s("div",{staticClass:"campaign-list-view-item__top__campaign-count"},[t._v(t._s(t.campaign.surplusCount)+"/"+t._s(t.campaign.needCount))])]):"aboutToReach"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-about-to-end-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-about-to-end"},[t._v(t._s(t.campaign.campaignStatusText))]),s("div",{staticClass:"campaign-list-view-item__top__campaign-count"},[t._v(t._s(t.campaign.surplusCount)+"/"+t._s(t.campaign.needCount))])]):"almostOutOfDate"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-almost-out-of-date-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-almost-out-of-date"},[t._v(t._s(t.campaign.campaignStatusText))]),s("div",{staticClass:"campaign-list-view-item__top__campaign-count"},[t._v(t._s(t.campaign.surplusCount)+"/"+t._s(t.campaign.needCount))])]):"almostOutOfDateAndReached"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-almost-out-of-date-and-reached-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-almost-out-of-date-and-reached"},[t._v(t._s(t.campaign.campaignStatusText))]),s("div",{staticClass:"campaign-list-view-item__top__campaign-count"},[t._v(t._s(t.campaign.surplusCount)+"/"+t._s(t.campaign.needCount))])]):"reached"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-reached-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-reached"},[t._v(t._s(t.campaign.campaignStatusText))]),s("div",{staticClass:"campaign-list-view-item__top__campaign-count"},[t._v(t._s(t.campaign.surplusCount)+"/"+t._s(t.campaign.needCount))])]):"outOfDate"===t.campaign.campaignStatus?s("div",{staticClass:"campaign-list-view-item__top__status-out-of-date-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__status-out-of-date"},[t._v(t._s(t.campaign.campaignStatusText))])]):t._e()]),s("div",{staticClass:"campaign-list-view-item__top__region-wrapper"},[s("div",{staticClass:"campaign-list-view-item__top__region-wrapper__region-icon"}),s("div",{staticClass:"campaign-list-view-item__top__region-wrapper__region-text"},[t._v(t._s(t.campaign.region))])])])]),s("div",{staticClass:"campaign-list-view-item__bottom"},[s("div",{staticClass:"campaign-list-view-item__bottom__name"},[t._v(t._s(t.campaign.name))]),s("div",{staticClass:"campaign-list-view-item__bottom__point-count-main-wrapper"},[s("div",{staticClass:"campaign-list-view-item__bottom__point-date-wrapper"},[s("div",{staticClass:"campaign-list-view-item__bottom__point-date-wrapper__date-icon"}),s("div",{staticClass:"campaign-list-view-item__bottom__point-date-wrapper__date-text"},[t._v(t._s(t.campaign.status))])]),t.campaign.onlookerCount>10?s("div",{staticClass:"campaign-list-view-item__bottom__onlooker-quatity"},[t._v(t._s(t.campaign.onlookerCount)+"人围观")]):t._e()])])])},dc=[],pc={props:{campaign:Object},methods:{gotoDetail:function(){var t=this.campaign.campaignId;this.$router.push({path:"/campaign-detail/".concat(t)})}}},uc=pc,_c=(s("dfe4"),Object(_["a"])(uc,lc,dc,!1,null,"5fa81464",null)),mc=_c.exports,hc={components:{GotoHome:St,PullDownRefresh:Vt,CampaignListViewItem:mc},data:function(){return{campaignList:null,isRefreshing:!1,isCloseTitleTip:!1,canShowTitleTip:!1,aboutToReachQuatity:0,canTransferCampaignToFriend:!1}},created:function(){this.fetchCampaignList()},methods:{parseRegionBlockCode:function(t){switch(t){case"sh-lawson":return"江浙沪";case"bj-lawson":return"京津冀";case"ah-lawson":return"安徽";case"dl-lawson":return"大连";case"wh-lawson":return"武汉";case"cq-lawson":return"重庆";default:return""}},closeTitleTip:function(){this.isCloseTitleTip=!0},fetchCampaignList:function(){var t=this;this.isRefreshing=!0;var e=gt.getRegionBlockCode();vt.campaign.fetchCampaignList({regionBlockCode:e}).then(function(s){t.campaignList=s.map(function(s,i){var n=rc.getCampaignStatus(s),a=n.campaignStatus,o=n.campaignStatusText,c=rc.isAboutToReach(s);c&&(t.aboutToReachQuatity+=1);var r=rc.canTransferCampaignToFriend(s);r&&(t.canTransferCampaignToFriend=r);var l=s.campaignName,d=s.imagePathList,p=rc.getStatus(s),u=t.parseRegionBlockCode(e),_=s.stampNeeded,m=s.campaignId,h=s.userTotalStampNum%s.stampNeeded,g=s.onlookerCount;return{name:l,image:d,status:p,region:u,needCount:_,campaignId:m,surplusCount:h,onlookerCount:g,campaignStatus:a,campaignStatusText:o}}),t.canShowTitleTip=t.aboutToReachQuatity>0,t.isRefreshing=!1}).catch(function(e){t.campaignList=[],t.isRefreshing=!1})}}},gc=hc,vc=(s("2861"),Object(_["a"])(gc,Qo,Ko,!1,null,"61f4785e",null)),fc=vc.exports,Cc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!=t.campaignDetail?s("div",{staticClass:"campaign-detail",class:{"no-scroll":"show"===t.isShowCampaignExchangeCouponSuccessModal||"show"===t.isShowCampaignExchangeNotWinningModal}},[s("div",{staticClass:"campaign-detail__banner-region"},[s("img",{staticClass:"campaign-detail__banner-region__img",attrs:{src:t.campaignDetail.imagePathDetail}}),s("div",{staticClass:"campaign-detail__banner-region__sub"},[t.barrageList?s("swiper",{attrs:{options:t.swiperOption}},t._l(t.barrageList,function(e,i){return s("swiper-slide",{key:i},[i%2?s("p",{staticClass:"campaign-detail__banner-region__sub__odd"}):s("p",{staticClass:"campaign-detail__banner-region__sub__even"},[s("img",{staticClass:"campaign-detail__banner-region__sub__profile",attrs:{src:e.userPhoto||t.defaultAvatar}}),s("span",{staticClass:"campaign-detail__banner-region__sub__name"},[t._v(t._s(e.nickName))]),s("span",{staticClass:"campaign-detail__banner-region__sub__tweets"},[t._v("刚刚获得了"+t._s(e.giftName))])])])}),1):t._e()],1)]),s("div",{staticClass:"campaign-detail__title-region"},[s("div",{staticClass:"campaign-detail__title-region__name-region"},[s("p",{staticClass:"campaign-detail__title-region__name-region__name"},[t._v(t._s(t.campaignDetail.campaignName))]),t.isCampaignStart?s("p"):t.isLessThanFivedays?s("p",{staticClass:"campaign-detail__title-region__name-region__end"},[s("span",[t._v(t._s(t._f("formatLessFiveDay")(t.campaignDetail.openEndDt)))])]):t.isThisWeed?s("p",{staticClass:"campaign-detail__title-region__name-region__end"},[s("span",[t._v(t._s(t._f("formatThisWeekDate")(t.campaignDetail.campaignDateFrom)))])]):t.isNotThisWeed?s("p",{staticClass:"campaign-detail__title-region__name-region__end"},[s("span",[t._v(t._s(t._f("formatNotThisWeekDate")(t.campaignDetail.campaignDateFrom)))])]):t._e()]),s("div",{staticClass:"campaign-detail__title-region__description"},[s("p",[s("span",[t._v("已兑换:")]),s("span",[t._v(t._s(t.campaignDetail.totalExchangedQty))])]),s("p",[s("span",[t._v("库存:")]),s("span",[t._v(t._s(t.campaignDetail.giftNums))])]),t.campaignDetail.onlookerCount>10&&t.campaignDetail.onlookerCount<1e4?s("div",{staticClass:"campaign-detail__title-region__description__profiles"},[t._m(0),s("div",{staticClass:"campaign-detail__title-region__description__concerns"},[t._v(t._s(t.campaignDetail.onlookerCount)+"人围观过")])]):t.campaignDetail.onlookerCount>=1e4?s("div",{staticClass:"campaign-detail__title-region__description__profiles"},[t._m(1),s("div",{staticClass:"campaign-detail__title-region__description__concerns"},[t._v(t._s(t._f("formatOnLookCount")(t.campaignDetail.onlookerCount))+"万人围观过")])]):t._e()])]),s("div",{staticClass:"campaign-detail__campaign-region"},[s("div",{staticClass:"campaign-detail__campaign-region__title"},[s("div",{staticClass:"campaign-detail__campaign-region__title__impress"},[t._v("集点印章 "+t._s(t.currentCompaign)+"/"+t._s(t.campaignDetail.stampNeeded))]),s("div",{staticClass:"campaign-detail__campaign-region__title__completed"},[t._v("\n        已达成\n        "),s("span",[t._v(t._s(t.completeRounds))]),t._v("轮\n      ")])]),s("div",{staticClass:"campaign-detail__campaign-region__rounds"},[s("campaign-detail-list",{attrs:{userStampList:t.campaignDetail.userStampList,participateRound:t.campaignDetail.participateRound,totalCampaignNum:t.campaignDetail.totalCampaignNum,iconNotOver:t.campaignDetail.iconNotOver,iconOver:t.campaignDetail.iconOver,stampNeeded:t.campaignDetail.stampNeeded}})],1),s("campaign-detail-expressed-and-address",{attrs:{userStampList:t.campaignDetail.userStampList,myExchangedQty:t.campaignDetail.myExchangedQty}})],1),s("div",{staticClass:"campaign-detail__appointment-time-limit-region"},[t._m(2),s("div",{staticClass:"campaign-detail__appointment-time-limit-region__title__timeline-bar"},[s("timeline-bar",{attrs:{startDate:t.campaignDetail.campaignDateFrom,endDate:t.campaignDetail.campaignDateTo}})],1)]),t.sortedShopsWithDistance[0]?s("div",{staticClass:"campaign-detail__shop-region"},[s("div",{staticClass:"campaign-detail__shop-region__title",on:{click:t.goToCampaignAvailableShopList}},[s("div",{staticClass:"campaign-detail__shop-region__title__apply-shop"},[t._v("适用门店")]),s("div",{staticClass:"campaign-detail__shop-region__title__all-shop"},[t._v("查看全部("+t._s(t.shopNum)+")")])]),s("div",{staticClass:"campaign-detail__shop-region__shop-name"},[s("p",[t._v(t._s(t.sortedShopsWithDistance[0].shopName)+"\n        "),""!==t.sortedShopsWithDistance[0].businessTime?s("format-business-time",{attrs:{businessTime:t.sortedShopsWithDistance[0].businessTime}}):t._e()],1),t.sortedShopsWithDistance[0].distance?s("p",{staticClass:"campaign-detail__shop-region__shop-distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.sortedShopsWithDistance[0].distance)))]):t._e()]),s("div",{staticClass:"campaign-detail__shop-region__shop-address"},[s("p",[t._v(t._s(t.sortedShopsWithDistance[0].address))])])]):t._e(),t.campaignDetail.commodityList.length?s("div",{staticClass:"campaign-detail__commodity-region"},[s("div",{staticClass:"campaign-detail__commodity-region__title"},[s("div",{staticClass:"campaign-detail__commodity-region__title__apply-commodity"},[t._v("活动商品")]),s("div",{staticClass:"campaign-detail__commodity-region__title__all-commoditys",on:{click:t.goToCampaignProducts}},[t._v("查看全部("+t._s(t.campaignDetail.commodityList.length)+")")])]),s("div",{staticClass:"campaign-detail__commodity-region__commodity-img"},[s("apply-commodity",{attrs:{campaignProducts:t.campaignDetail.commodityList}})],1)]):t._e(),s("div",{staticClass:"campaign-detail__explain-region"},[t._m(3),s("div",{staticClass:"campaign-detail__explain-region__describe"},[s("div",[t._v("兑换时间："+t._s(t._f("formatDate")(t.campaignDetail.campaignDateFrom))+"-"+t._s(t._f("formatDate")(t.campaignDetail.openEndDt)))]),s("hr"),s("p",{domProps:{innerHTML:t._s(t.campaignDetail.description)}})])]),s("campaign-exchangeAnd-transfer-button",{attrs:{isTransfer:t.isTransfer,isExchange:t.isExchange,campaignId:this.campaignDetail.campaignId,totalCampaignNum:this.campaignDetail.totalCampaignNum,image:this.campaignDetail.imagePathDetail||this.campaignDetail.imagePathList,rewardType:this.campaignDetail.rewardType},on:{campaignnExchang:t.__campaignnExchang,isCampaignnTransferModal:t.campaignnTransferModal}}),"show"===t.isShowCampaignExchangeNotWinningModal?s("campaign-exchange-not-winning-modal",{on:{hideCampaignExchangeNotWinningModal:t.hideCampaignExchangeNotWinningModal}}):t._e(),"show"===t.isShowCampaignExchangeCouponSuccessModal?s("campaign-exchange-coupon-success-modal",{attrs:{campaignGift:t.campaignGift}}):t._e()],1):t._e()},yc=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}}),s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}}),s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}}),s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}}),s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/2.png"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-detail__appointment-time-limit-region__title"},[s("div",{staticClass:"campaign-detail__appointment-time-limit-region__title__activity-time"},[t._v("活动时间")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-detail__explain-region__title"},[s("div",{staticClass:"campaign-detail__explain-region__title__instructions"},[t._v("活动说明")])])}],bc=(s("f576"),s("6b54"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"timeline-bar"},[s("div",{staticClass:"timeline-bar__line"}),s("div",{class:["timeline-bar__start-date",{"is-middle":t.startDate>t.currentDate&&t.startDate<t.endDate,"is-hidden":t.startDate<=t.currentDate}]},[s("div",{staticClass:"timeline-bar__start-date__title"},[t._v("活动开始")]),s("div",{staticClass:"timeline-bar__start-date__circle-icon"}),s("div",{staticClass:"timeline-bar__start-date__date"},[t._v(t._s(t._f("date")(t.startDate)))])]),s("div",{class:["timeline-bar__end-date",{"is-left":t.endDate<=t.currentDate,"is-right":t.endDate>t.currentDate}]},[s("div",{staticClass:"timeline-bar__end-date__title"},[t._v("活动结束")]),s("div",{staticClass:"timeline-bar__end-date__circle-icon"}),s("div",{staticClass:"timeline-bar__end-date__date"},[t._v(t._s(t._f("date")(t.endDate)))])]),s("div",{class:["timeline-bar__current-date",{"is-left":t.currentDate<t.startDate,"is-right":t.currentDate>=t.endDate}]},[s("div",{staticClass:"timeline-bar__current-date__title"},[t._v("今天")]),s("div",{staticClass:"timeline-bar__current-date__circle-icon"}),s("div",{staticClass:"timeline-bar__current-date__date"},[t._v(t._s(t._f("date")(t.currentDate)))])])])}),wc=[],Sc={data:function(){return{currentDate:se()()}},props:["startDate","endDate"],filters:{date:function(t){var e=new Date(t).getFullYear(),s=new Date(t).getMonth()+1,i=new Date(t).getDate(),n=s<10?"0"+s:String(s),a=i<10?"0"+i:String(i);return"".concat(e,"-").concat(n,"-").concat(a)}}},Dc=Sc,kc=(s("bd1e"),Object(_["a"])(Dc,bc,wc,!1,null,"7c1b05ae",null)),Tc=kc.exports,xc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"commodity-main"},[s("ul",t._l(t.campaignProducts,function(t,e){return s("li",{key:e},[s("img",{attrs:{src:t.imageUrl}})])}),0)])},Ac=[],Ic={props:["campaignProducts"]},Nc=Ic,Lc=(s("4114"),Object(_["a"])(Nc,xc,Ac,!1,null,"a05c31da",null)),Pc=Lc.exports,Ec=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isSendAddressShow?s("div",{staticClass:"express-address",on:{click:t.goToCampaignSendAddress}},[s("div",{staticClass:"express-address__name"},[t._v("寄送地址("+t._s(t.sendAddressNum)+")")]),s("div",{staticClass:"express-address__set-address"},[t.notSendAddressNum?s("span",[t._v("有"+t._s(t.notSendAddressNum)+"未设置地址")]):t._e(),s("span",{staticClass:"express-address__set-address__right-arrow"})])]):t.myExchangedQty?s("div",{staticClass:"express-address",on:{click:t.goToCampaignPostExchanged}},[s("div",{staticClass:"express-address__name"},[t._v("已兑换："+t._s(t.myExchangedQty))]),t._m(0)]):t.isShowExchangedAndExchangedAdress?s("div",{staticClass:"express-exchanged-and-address"},[s("div",{staticClass:"express-exchanged-and-address__warpper",on:{click:t.goToCampaignSendAddress}},[s("div",{staticClass:"express-address__name"},[t._v("寄送地址("+t._s(t.sendAddressNum)+")")]),s("div",{staticClass:"express-address__set-address"},[s("span",[t._v("有"+t._s(t.notSendAddressNum)+"未设置地址")]),s("span",{staticClass:"express-address__set-address__right-arrow"})])]),s("div",{staticClass:"express-exchanged-and-address__warpper",on:{click:t.goToCampaignPostExchanged}},[s("div",{staticClass:"express-exchanged-and-address__name"},[t._v("已兑换："+t._s(t.myExchangedQty))]),t._m(1)])]):t._e()])},Mc=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"express-address__set-address"},[s("span",{staticClass:"express-address__set-address__right-arrow"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"express-exchanged-and-address__set-address"},[s("span",{staticClass:"express-exchanged-and-address__set-address__right-arrow"})])}],$c={props:["userStampList","myExchangedQty"],computed:{notSendAddressNum:function(){var t=this.userStampList;return t.filter(function(t){return 2===t.saveAddressFlg&&2===t.giftType}).length},sendAddressNum:function(){var t=this.userStampList;return t.filter(function(t){return 2===t.giftType}).length},isSendAddressShow:function(){var t=this.userStampList;return t.filter(function(t){return 2===t.status&&2===t.giftType}).length},isShowExchangedAndExchangedAdress:function(){var t=ne.a.find(this.userStampList,{giftType:1}),e=ne.a.find(this.userStampList,{giftType:2});return t&&e}},methods:{goToCampaignSendAddress:function(){var t=gt.getUserInfo(),e=this.$route.params.campaignId;t?this.$router.push({path:"/campaign-send-address/".concat(e)}):wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=campaignDetail&commodityId=".concat(e,"&sourceType=internal")})},goToCampaignPostExchanged:function(){var t=gt.getUserInfo(),e=this.$route.params.campaignId;if(t){var s=this.userStampList;this.$router.push({name:"campaign-post-exchanged",params:{userStampList:s}})}else wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=campaignDetail&commodityId=".concat(e,"&sourceType=internal")})}}},Fc=$c,Oc=(s("6fb7"),Object(_["a"])(Fc,Ec,Mc,!1,null,"0e5a03c2",null)),Rc=Oc.exports,Bc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null===t.participateRound?s("ul",{staticClass:"campaign-list"},t._l(t.stampNeeded,function(e){return s("li",{key:e},[t.userStampList.length<=1?s("div",[t.stampNeeded===t.totalCampaignNum?s("img",{attrs:{src:t.iconNotOver||t.defaultIconNotOver}}):e-1<t.totalCampaignNum&&e!==t.stampNeeded?s("img",{attrs:{src:t.iconOver||t.defaultIconOver}}):e>t.totalCampaignNum&&e!==t.stampNeeded?s("img",{attrs:{src:t.iconNotOver||t.defaultIconNotOver}}):s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-not-last-campaign.png"}}),t.stampNeeded===t.totalCampaignNum?s("p",{staticClass:"campaign-list__not-campaign"},[t._v(t._s(t.__campaignNum(e)))]):t.totalCampaignNum%t.stampNeeded>0&&e<=t.totalCampaignNum%t.stampNeeded?s("p",{staticClass:"campaign-list__campaign"},[t._v(t._s(e))]):s("p",{staticClass:"campaign-list__not-campaign"},[t._v(t._s(e))])]):t.userStampList.length>1?s("div",[t.totalCampaignNum%t.stampNeeded===0?s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-not-last-campaign.png"}}):t.totalCampaignNum%t.stampNeeded>0&&e-1<t.totalCampaignNum%t.stampNeeded?s("img",{attrs:{src:t.iconOver||t.defaultIconOver}}):e<t.stampNeeded?s("img",{attrs:{src:t.iconNotOver||t.defaultIconNotOver}}):s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-not-last-campaign.png"}}),t.totalCampaignNum%t.stampNeeded===0?s("p",{staticClass:"campaign-list__not-campaign"},[t._v(t._s(t.__campaignNum(e)))]):s("p",{staticClass:"campaign-list__campaigned"},[t._v(t._s(t.__campaignNum(e)))])]):t._e()])}),0):t.participateRound===t.userStampList.length?s("ul",{staticClass:"campaign-list"},t._l(t.stampNeeded,function(e){return s("li",{key:e},[s("div",[t.totalCampaignNum%t.stampNeeded===0&&t.lastIndex>t.__campaignNum(e)?s("img",{attrs:{src:t.iconOver||t.defaultIconOver}}):t.totalCampaignNum%t.stampNeeded!==0&&t.__campaignNum(e)<=t.totalCampaignNum?s("img",{attrs:{src:t.iconOver||t.defaultIconOver}}):t.totalCampaignNum%t.stampNeeded!==0&&t.__campaignNum(e)>t.totalCampaignNum&&t.__campaignNum(e)!==t.lastIndex?s("img",{attrs:{src:t.iconNotOver||t.defaultIconNotOver}}):t.totalCampaignNum%t.stampNeeded!==0&&t.__campaignNum(e)===t.lastIndex?s("img",{attrs:{src:t.campaignLastIconNotOver}}):t.totalCampaignNum%t.stampNeeded===0&&t.__campaignNum(e)===t.lastIndex?s("img",{staticClass:"3",attrs:{src:t.campaignLastIconOver}}):t._e(),t.totalCampaignNum%t.stampNeeded===0?s("p",{staticClass:"campaign-list__not-campaign"},[t._v(t._s(t.__campaignNum(e)))]):s("p",{staticClass:"campaign-list__campaigned"},[t._v(t._s(t.__campaignNum(e)))])])])}),0):s("ul",{staticClass:"campaign-list"},t._l(t.stampNeeded,function(e){return s("li",{key:e},[s("div",[t.totalCampaignNum%t.stampNeeded===0&&e>t.stampNeeded?s("img",{attrs:{src:t.campaignLastIconNotOver}}):t.totalCampaignNum%t.stampNeeded>0&&e-1<t.totalCampaignNum%t.stampNeeded?s("img",{attrs:{src:t.iconOver||t.defaultIconOver}}):e<t.stampNeeded?s("img",{attrs:{src:t.iconNotOver||t.defaultIconNotOver}}):s("img",{attrs:{src:t.campaignLastIconNotOver}}),t.totalCampaignNum%t.stampNeeded===0?s("p",{staticClass:"campaign-list__not-campaign"},[t._v(t._s(t.__campaignNum(e)))]):s("p",{staticClass:"campaign-list__campaigned"},[t._v(t._s(t.__campaignNum(e)))])])])}),0)},Uc=[],jc={props:["userStampList","participateRound","totalCampaignNum","stampNeeded","iconNotOver","iconOver"],data:function(){return{defaultIconNotOver:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-not-campaign.png",defaultIconOver:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-campaigned.png",campaignLastIconNotOver:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-not-last-campaign.png",campaignLastIconOver:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/campaign-gift-bag.png"}},computed:{lastIndex:function(){return this.userStampList.length===this.participateRound?this.stampNeeded*this.userStampList.length:this.stampNeeded*this.userStampList.length+this.stampNeeded}},methods:{__campaignNum:function(t){return 0===this.userStampList.length?t:this.totalCampaignNum%this.stampNeeded>0?this.totalCampaignNum-this.totalCampaignNum%this.stampNeeded+t:this.userStampList.length<this.participateRound?this.stampNeeded*this.userStampList.length-this.stampNeeded+this.stampNeeded+t:this.userStampList.length==this.participateRound?this.stampNeeded*this.userStampList.length-this.stampNeeded+t:this.stampNeeded*this.userStampList.length-this.stampNeeded+this.stampNeeded+t}}},Hc=jc,Wc=(s("00cb"),Object(_["a"])(Hc,Bc,Uc,!1,null,"0ee864b4",null)),Gc=Wc.exports,zc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"compaign-detail__button-region"},[s("div",[s("goto-home")],1),s("div",[!0===t.isTransfer?s("button",{staticClass:"compaign-detail__button-region__transfer",on:{click:t.goToCampaignTransferPage}},[t._v("转赠")]):s("button",{staticClass:"compaign-detail__button-region__no-transfer"},[t._v("转赠")]),!0===t.isExchange&&1===t.rewardType?s("button",{staticClass:"compaign-detail__button-region__exchange",on:{click:t.campaignnExchang}},[t._v("兑换")]):t.isExchange||1!==t.rewardType?!0===t.isExchange&&0===t.rewardType?s("button",{staticClass:"compaign-detail__button-region__exchange",on:{click:t.campaignnExchang}},[t._v("抽奖")]):!1===t.isExchange&&0===t.rewardType?s("button",{staticClass:"compaign-detail__button-region__no-exchange "},[t._v("抽奖")]):t._e():s("button",{staticClass:"compaign-detail__button-region__no-exchange"},[t._v("兑换")])])])},Vc=[],qc={props:["isTransfer","isExchange","campaignId","totalCampaignNum","rewardType"],data:function(){return{}},components:{GotoHome:St},methods:{goToCampaignTransferPage:ne.a.debounce(function(){var t=this;wx.miniProgram.navigateTo({url:"/pages/campaign-transfer/campaign-transfer?campaignId=".concat(this.campaignId,"&stampNum=").concat(this.totalCampaignNum),success:function(){setTimeout(function(){t.$emit("isCampaignnTransferModal")},1e3)}})},1e3),campaignnExchang:function(){this.$emit("campaignnExchang")}}},Yc=qc,Qc=(s("c168"),Object(_["a"])(Yc,zc,Vc,!1,null,"af5fc858",null)),Kc=Qc.exports,Xc=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store"},[s("div",{staticClass:"available-store__title",on:{click:t.goToShopList}},[t._m(0),t._m(1)]),t._m(2)])},Zc=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store__title__left"},[s("img",{staticClass:"available-store__title__left__image",attrs:{src:"https://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/h5/my-coupon/icon-shop.png"}}),s("span",{staticClass:"available-store__title__left__text"},[t._v("适用门店")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store__title__right"},[s("img",{attrs:{src:"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/campaign/right-arrow.png"}}),s("span",[t._v("查看全部(10)")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"available-store__content"},[s("div",{staticClass:"available-store__content__title"},[s("div",{staticClass:"available-store__content__title__shop"},[s("span",{staticClass:"available-store__content__title__shop__name"},[t._v("大连一号店")]),s("span",{staticClass:"available-store__content__title__shop__time"},[t._v("24h")])]),s("div",{staticClass:"available-store__content__title__distance"},[t._v("\n        距您565m\n      ")])]),s("div",{staticClass:"available-store__content__address"},[t._v("\n      吴中区吴中大道1158号\n    ")])])}],Jc={methods:{goToShopList:function(){this.$router.push({path:"/ec-product-shop-list"})}}},tr=Jc,er=(s("afa2"),Object(_["a"])(tr,Xc,Zc,!1,null,"a79746ec",null)),sr=er.exports,ir=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-exchange__modal"},[s("div",{staticClass:"campaign-exchange__modal__wrapper"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__title"},[t._v("未中奖")]),s("div",{staticClass:"campaign-exchange__modal__wrapper__icon"}),s("div",{staticClass:"campaign-exchange__modal__wrapper__description-bottom"},[t._v("很遗憾！大奖与你擦肩而过,谢谢参与。")]),s("div",{staticClass:"campaign-exchange__modal__wrapper__button-wrapper"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__button-wrapper__confirm",on:{click:t.handleConfirm}},[t._v("我知道了")])])])])},nr=[],ar={methods:{handleConfirm:function(){this.$emit("hideCampaignExchangeNotWinningModal")}}},or=ar,cr=(s("3f41"),Object(_["a"])(or,ir,nr,!1,null,"63ac15af",null)),rr=cr.exports,lr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-exchange__modal"},[s("div",{staticClass:"campaign-exchange__modal__wrapper"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__title"},[t._v("兑换成功")]),s("div",{staticClass:"campaign-exchange__modal__wrapper__description-top"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__description-top__name-wrapper"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__description-top__name"},[t._v(t._s(t.campaignGift.giftName))]),s("div",{staticClass:"campaign-exchange__modal__wrapper__description-top__tip"},[t._v(t._s(t.couponType))])]),s("div",{staticClass:"campaign-exchange__modal__wrapper__description-top__condition"},[t._v("无使用门槛")])]),s("div",{staticClass:"campaign-exchange__modal__wrapper__description-bottom"},[t._v("您已成功兑换了"+t._s(t.campaignGift.giftName))]),s("div",{staticClass:"campaign-exchange__modal__wrapper__button-wrapper"},[s("div",{staticClass:"campaign-exchange__modal__wrapper__button-wrapper__gotoHome",on:{click:t.gotoHomePage}},[t._v("返回首页")]),s("div",{staticClass:"campaign-exchange__modal__wrapper__button-wrapper__gotoCoupons",on:{click:t.gotoCouponDetail}},[t._v("查看")])])])])},dr=[],pr={getType:function(t){return 1===t.couponType?"couponcouponType:freeOnItem":2===t.couponType?"couponcouponType:discountOnReachingTotal":3===t.couponType?"couponType:discountOnItem":void 0}},ur={props:["campaignGift"],computed:{couponType:function(){return"couponcouponType:discountOnReachingTotal"===pr.getType(this.campaignGift)?"免费券":"couponcouponType:discountOnReachingTotal"===pr.getType(this.campaignGift)?"满减券":"couponcouponType:discountOnItem"===pr.getType(this.campaignGift)?"立减券":void 0}},methods:{gotoHomePage:function(){this.$emit("close"),wx.miniProgram.switchTab({url:"/pages/homepage/homepage"})},gotoCouponDetail:function(){var t=this.campaignGift.couponId,e=this.campaignGift.userCouponId;this.$router.push({path:"/user-coupon-detail/".concat(t,"/").concat(e)}),this.$emit("close")}}},_r=ur,mr=(s("bb23"),Object(_["a"])(_r,lr,dr,!1,null,"392d8c73",null)),hr=mr.exports,gr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"modal"},[s("transition",{attrs:{name:"fade"}},[t.visible?s("div",[s("div",{staticClass:"modal__container"},[s("div",{staticClass:"modal__container__wrapper"},[s("svg",{staticClass:"modal__container__wrapper__icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-loading"}})]),s("div",{staticClass:"modal__container__wrapper__msg"},[t._v("提交中")])])])]):t._e()])],1)},vr=[],fr={data:function(){return{visible:!1}},mounted:function(){var t=this;window.addEventListener("popstate",function(e){t.visible=!1})}},Cr=fr,yr=(s("b6c9"),Object(_["a"])(Cr,gr,vr,!1,null,"3fe977a5",null)),br=yr.exports,wr=i["a"].extend(br),Sr=new wr({el:document.createElement("div")});document.body.appendChild(Sr.$el);var Dr={show:function(){Sr.visible=!0},hide:function(){setTimeout(function(){Sr.visible=!1},1e3)}};var kr={components:{swiper:Xn["swiper"],swiperSlide:Xn["swiperSlide"],TimelineBar:Tc,ApplyCommodity:Pc,CampaignExchangeAndTransferButton:Kc,CampaignDetailList:Gc,CampaignExchangeNotWinningModal:rr,CampaignExchangeCouponSuccessModal:hr,AvailableStore:sr,FormatBusinessTime:he,CampaignDetailExpressedAndAddress:Rc},data:function(){return{campaignDetail:null,campaignProducts:null,campaignGift:null,currentLocation:null,barrageList:null,isShowCampaignExchangeCouponSuccessModal:"hide",isShowCampaignExchangeNotWinningModal:"hide",swiperOption:{direction:"vertical",initialSlide:1,zoom:!0,look:!0,loop:!0,autoplay:!0,autoHeight:!0,spaceBetween:20}}},created:function(){var t=Object(w["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=gt.getRegionBlockCode(),this.setCurrentLocation(),this.recordCampaignPopularStatistics(),t.next=5,this.__fetchCampaignDetail();case 5:e!==this.campaignDetail.regionBlockCode&&this.showRegionDiffModal(this.campaignDetail.regionBlockCode);case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),mounted:function(){this.fetchCampaignBarrage()},computed:{defaultAvatar:function(){return"//lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new/avatar/default-man.png"},getShops:function(){var t=this.campaignDetail.shopUseFlg,e=this.campaignDetail.shopid,s=gt.getRegionBlockCode(),i=0===t;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](s);return n?this.$store.getters["shop/shopsForRegion"](s):[]}var a=this.$store.state.shop.shops[s];return ne.a.intersectionWith(a,e,function(t,e){return t.shopId===e})},sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.getShops.map(function(e){var s=te()({},e);return s.distance=oe(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.getShops.length?this.getShops:[]},shopNum:function(){var t=gt.getRegionBlockCode(),e=0===this.campaignDetail.shopUseFlg,s=this.$store.getters["shop/shopsAvailableForRegion"](t);return e?s?this.$store.getters["shop/shopsForRegion"](t).length:0:this.campaignDetail.shopid.length},isThisWeed:function(){var t=new Date,e=0===t.getDay()?7:t.getDay(),s=new Date(t.getFullYear(),t.getMonth(),t.getDate()+(7-e)),i=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1-e);return this.campaignDetail.campaignDateFrom>=i.getTime()&&this.campaignDetail.campaignDateFrom<=s.getTime()},isLessThanFivedays:function(){var t=(new Date).getTime(),e=this.campaignDetail.openEndDt,s=this.campaignDetail.campaignDateFrom,i=Ns()(864e5);return t<=e&&t>=s&&e-t<=5*i},isCampaignStart:function(){var t=(new Date).getTime(),e=this.campaignDetail.openEndDt,s=Ns()(864e5);return t>=this.campaignDetail.campaignDateFrom&&!(e-t<=5*s)},isNotThisWeed:function(){var t=new Date,e=t.getDay(),s=new Date(t.getFullYear(),t.getMonth(),t.getDate()+(7-e)),i=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1-e);return!(t.getTime()>this.campaignDetail.campaignDateFrom)&&(this.campaignDetail.campaignDateFrom<i.getTime()||this.campaignDetail.campaignDateFrom>s)},compaignEndTime:function(){return this.__fromNow(this.campaignDetail.campaignDateTo)},isTransfer:function(){return this.campaignDetail.totalCampaignNum>0&&0===this.campaignDetail.campaignGiveFlg},isExchange:function(){return this.campaignDetail.giftNums>0&&ne.a.filter(this.campaignDetail.userStampList,function(t){return 1===t.status}).length>0},currentCompaign:function(){return this.campaignDetail.userStampList.length===this.campaignDetail.participateRound&&this.campaignDetail.totalCampaignNum%this.campaignDetail.stampNeeded===0?this.campaignDetail.stampNeeded:this.campaignDetail.totalCampaignNum%this.campaignDetail.stampNeeded},completeRounds:function(){return Ns()(this.campaignDetail.userTotalStampNum/this.campaignDetail.stampNeeded)}},filters:{formatOnLookCount:function(t){return t%1e4===0?t/1e4:(t/1e4).toFixed(1)},formatDate:function(t){var e=new Date(t).getFullYear().toString(),s=(new Date(t).getMonth()+1).toString().padStart(2,"0"),i=new Date(t).getDate().toString().padStart(2,"0");return"".concat(e,".").concat(s,".").concat(i)},formatThisWeekDate:function(t){var e=["周日","周一","周二","周三","周四","周五","周六"],s=new Date(t),i=("0"+s.getHours()).slice(-2),n=("0"+s.getMinutes()).slice(-2),a=s.getDay();return"本".concat(e[a]," ").concat(i,":").concat(n,"开始")},formatNotThisWeekDate:function(t){var e=new Date,s=t,i=(new Date(s).getMonth()+1).toString().padStart(2,"0"),n=new Date(s).getDate().toString().padStart(2,"0"),a=new Date(s).getHours().toString().padStart(2,"0"),o=new Date(s).getMinutes().toString().padStart(2,"0"),c=s-e.getTime(),r=Ns()(c/864e5),l=Ns()(864e5);return e<s&&s-e>5*l?"".concat(i,"月").concat(n,"日 ").concat(a,":").concat(o,"分开始"):"".concat(r,"天后 ").concat(a,":").concat(o,"分开始")},formatLessFiveDay:function(t){var e=new Date,s=t,i=new Date(s).getHours().toString().padStart(2,"0"),n=new Date(s).getMinutes().toString().padStart(2,"0"),a=s-e.getTime(),o=Ns()(a/864e5);return"".concat(o,"天后 ").concat(i,":").concat(n,"分结束")},toKilometer:function(t){return t>20?">20km":t.toFixed(2)+"km"}},methods:{fetchCampaignBarrage:function(){var t=this,e=gt.getRegionBlockCode(),s=this.$route.params.campaignId;vt.campaign.campaignBarrage({regionBlockCode:e,campaignId:s}).then(function(e){t.barrageList=e})},showRegionDiffModal:function(t){var e=le.getCurrentRegionName(t),s=gt.getUserInfo(),i=s?"你所在区域无法参与，当前内容仅限".concat(e):"你当前查阅内容，可能受区域限制有所不同";Fe.alert({title:"友情提示",msg:i})},recordCampaignPopularStatistics:function(){var t=this.$route.params.campaignId;ce.recordCampaignPopularStatistics(t)},__handleCampaignProductsRes:function(t){var e=t.list.slice(0,4);this.campaignProducts=e},hideCampaignExchangeNotWinningModal:function(){this.isShowCampaignExchangeNotWinningModal="hide",document.body.style.overflow="auto"},__campaignnExchang:function(){var t=this,e=this.campaignDetail.campaignId,s=ne.a.find(this.campaignDetail.userStampList,function(t){return 1===t.status}).stampId;Dr.show(),vt.campaign.campaignGift({campaignId:e,stampId:s}).then(function(e){t.campaignGift=e;var s=1===t.campaignGift.giftType,i=2===t.campaignGift.giftType;if(i){var n=t.campaignGift.id;t.$router.push({path:"/campaign-post-exchange/",query:{userGiftId:n}})}else s&&(t.isShowCampaignExchangeCouponSuccessModal="show");Dr.hide()}).catch(function(e){if(201===e.data.code&&"5008"===e.data.errors[0].code){var s=1===t.campaignDetail.rewardType,i=0===t.campaignDetail.rewardType;s?Fe.alert({title:"兑换失败",msg:"很遗憾,礼品已经被抢完了。"},function(e){t.__fetchCampaignDetail()}):i&&(t.isShowCampaignExchangeNotWinningModal="show",t.__fetchCampaignDetail()),Dr.hide()}})},__fetchCampaignDetail:function(){var t=this;return new b.a(function(e,s){Rt.show();var i=gt.getRegionBlockCode(),n=t.$route.params.campaignId;vt.campaign.fetchCampaignDetail({campaignDetailId:n,regionBlockCode:i}).then(function(s){t.campaignDetail=s,Rt.hide(),e()}).catch(function(t){s(t),Rt.hide()})})},goToCampaignProducts:function(){var t=gt.getUserInfo(),e=this.campaignDetail.campaignId;t?this.$router.push({path:"/campaign-products/".concat(e)}):wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=campaignDetail&commodityId=".concat(e,"&sourceType=internal")})},goToCampaignAvailableShopList:function(){var t=gt.getUserInfo(),e=this.campaignDetail.campaignId;if(t){var s=this.campaignDetail,i=s.shopUseFlg,n=s.shopid;this.$router.push({name:"campaign-Available-shop-list",params:{shopUseFlg:i,shopid:n}})}else wx.miniProgram.reLaunch({url:"/pages/index/index?pageKey=campaignDetail&commodityId=".concat(e,"&sourceType=internal")})},campaignnTransferModal:function(){var t=this,e="提醒你的好友，要24小时内及时领取哦";Fe.alert({title:"转赠完成",msg:e},function(e){t.__fetchCampaignDetail()})},setCurrentLocation:function(){var t=this;ht.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i}})}}},Tr=kr,xr=(s("2fc9"),Object(_["a"])(Tr,Cc,yc,!1,null,"024fcf1a",null)),Ar=xr.exports,Ir=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-products"},[null!==t.productList&&t.productList.length>0?s("div",{staticClass:"campaign-products__wrapper"},t._l(t.productList,function(e,i){return s("div",{key:i,staticClass:"campaign-products__item"},[s("img",{staticClass:"campaign-products__item__image",attrs:{src:e.imgUrl}}),s("div",{staticClass:"campaign-products__item__title"},[t._v(t._s(e.commodityName))]),t.showSellPrice?s("div",{staticClass:"campaign-products__item__price-wrapper"},[s("span",{staticClass:"campaign-products__item__price-wrapper__rmb-sign"},[t._v("¥ ")]),s("span",{staticClass:"campaign-products__item__price-wrapper__number"},[t._v(t._s(t._f("toPrice")(e.sellPrice)))])]):t._e()])}),0):s("div",{staticClass:"campaign-products__empty"},[s("p",{staticClass:"campaign-products__empty__icon"}),s("p",{staticClass:"campaign-products__empty__text"},[t._v("暂无活动商品")])])])},Nr=[],Lr=(s("c5f6"),{data:function(){return{productList:[],showSellPrice:!0}},created:function(){this.fetchCampaignProducts()},methods:{fetchCampaignProducts:function(){var t=this;Rt.show();var e=gt.getRegionBlockCode(),s=this.$route.params.campaignId;vt.campaign.getCampaignProducts({regionBlockCode:e,campaignDetailId:s}).then(function(e){Rt.hide();var s=e.data.list;s.forEach(function(e){t.showSellPrice=!e.largeClassificationId}),t.productList=s}).catch(function(t){Rt.hide()})}},filters:{toPrice:function(t){return Number(t).toFixed(2)}}}),Pr=Lr,Er=(s("a34c"),Object(_["a"])(Pr,Ir,Nr,!1,null,"a3fff5e4",null)),Mr=Er.exports,$r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-post-exchange"},[s("img",{staticClass:"campaign-post-exchange__image",attrs:{src:t.imagePath}}),s("div",{staticClass:"campaign-post-exchange__description"},[t._v(t._s(t.giftName))]),s("div",{staticClass:"campaign-post-exchange__post-info-wrapper"},[t._m(0),null!==t.address?s("div",{on:{click:t.gotoChoosePostAddressInfo}},[s("div",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info"},[s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info__address"},[t._v(t._s(t.address.addressName))]),s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info__icon"})]),s("div",{staticClass:"campaign-post-exchange__post-info-wrapper__receiver-info"},[s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__receiver-info__name"},[t._v(t._s(t.address.name))]),s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__receiver-info__phone-number"},[t._v(t._s(t.address.phoneNumber))])])]):s("div",{on:{click:t.gotoChoosePostAddressInfo}},[t._m(1)])]),t._m(2),s("div",{staticClass:"campaign-post-exchange__term-description"},[t._v("点击“确认地址”表示您已阅读并同意以上条款")]),s("div",{staticClass:"campaign-post-exchange__exchange-button-wrapper"},[s("div",{staticClass:"campaign-post-exchange__exchange-button-wrapper__button",class:{active:t.confirmAddressButtonVisible},on:{click:t.handleConfirmAddress}},[t._v("确认地址\n    ")])])])},Fr=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-post-exchange__post-info-wrapper__title-info"},[s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__title-info__icon"}),s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__title-info__title"},[t._v("寄送地址")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info"},[s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info__address"},[t._v("请选择寄送地址")]),s("span",{staticClass:"campaign-post-exchange__post-info-wrapper__post-address-info__icon"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-post-exchange__intro-info-wrapper"},[s("div",{staticClass:"campaign-post-exchange__intro-info-wrapper__title-info"},[s("span",{staticClass:"campaign-post-exchange__intro-info-wrapper__title-info__icon"}),s("span",{staticClass:"campaign-post-exchange__intro-info-wrapper__title-info__title"},[t._v("兑换须知")])]),s("div",{staticClass:"campaign-post-exchange__intro-info-wrapper__other-description"},[t._v("❶ 请选择寄送地址；")]),s("div",{staticClass:"campaign-post-exchange__intro-info-wrapper__other-description"},[t._v("❷ 确认兑换后，1小时内修改寄送地址。")])])}],Or=(s("7f7f"),{namespaced:!0,state:{chooseAddressInfo:null,editAddressInfo:null,addAddressInfo:null,needShowEditAddressSuccessToast:!1,needShowAddAddressSuccessToast:!1},mutations:{setChooseAddressInfo:function(t,e){t.chooseAddressInfo=e},setEditAddressInfo:function(t,e){t.editAddressInfo=e},setAddAddressInfo:function(t,e){t.addAddressInfo=e},setNeedShowEditAddressSuccessToast:function(t,e){t.needShowEditAddressSuccessToast=e},setNeedShowAddAddressSuccessToast:function(t,e){t.needShowAddAddressSuccessToast=e},cleanupChooseAddressInfo:function(t){t.chooseAddressInfo=null},cleanupEditAddressInfo:function(t){t.editAddressInfo=null},cleanupAddAddressInfo:function(t){t.addAddressInfo=null},hideEditAddressSuccessToast:function(t){t.needShowEditAddressSuccessToast=!1},hideAddAddressSuccessToast:function(t){t.needShowAddAddressSuccessToast=!1}}}),Rr={data:function(){return{imagePath:null,giftName:null,address:null,isChooseAddressButtonVisible:!1,confirmAddressButtonVisible:!1,userGiftId:null}},created:function(){this.registerCampaignExchangeAddressModule(),this.userGiftId=this.$route.query.userGiftId,this.getUserGiftInfo(this.userGiftId);var t=this.$store.state.campaignExchangeAddress.chooseAddressInfo,e=!!t;e&&(this.address=t,this.confirmAddressButtonVisible=!0)},methods:{getUserGiftInfo:function(t){var e=this;Rt.show(),vt.campaign.getUserGiftInfo({userGiftId:t}).then(function(t){Rt.hide(),e.imagePath=t.data.imagePath,e.giftName=t.data.giftName}).catch(function(t){Rt.hide(),oa.show({msg:"获取礼品信息失败, 请稍后再试"})})},registerCampaignExchangeAddressModule:function(){this.$store.registerModule("campaignExchangeAddress",Or)},gotoChoosePostAddressInfo:function(){this.$router.push({path:"/campaign-post-exchange/choose-address"})},handleConfirmAddress:function(){var t=this;if(this.confirmAddressButtonVisible){var e=gt.getRegionBlockCode(),s={regionBlockCode:e,userGiftId:Number(this.userGiftId),userName:this.address.name,address:"".concat(this.address.addressDetailName).concat(this.address.addressName).concat(this.address.addressExtraInfo),mobile:this.address.phoneNumber};vt.campaign.campaignGiftSaveAddress({saveAddressInfo:s}).then(function(e){var s=0===e.code;if(s){var i="寄送地址: ".concat(t.address.addressDetailName).concat(t.address.addressName).concat(t.address.addressExtraInfo);Fe.alert({title:"地址提交成功",msg:i},function(e){t.$router.go(-1),t.$store.commit("campaignExchangeAddress/cleanupChooseAddressInfo"),t.$store.unregisterModule("campaignExchangeAddress")})}}).catch(function(t){oa.show({msg:"确认地址信息失败, 请稍后再试"})})}}}},Br=Rr,Ur=(s("3981"),Object(_["a"])(Br,$r,Fr,!1,null,"4b5ec0be",null)),jr=Ur.exports,Hr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-express-address"},[t.campaignPostExchangedList.length?s("ul",{staticClass:"campaign-express-address__list"},t._l(t.campaignPostExchangedList,function(e,i){return s("li",{key:i,staticClass:"campaign-express-address__list__item"},[s("div",{staticClass:"campaign-express-address__list__item__left"},[s("p",{staticClass:"campaign-express-address__list__item__left__title"},[t._v("第"+t._s(i+1)+"轮:   "+t._s(null===e.giftName?"未中奖":e.giftName))])])])}),0):s("div",{staticClass:"campaign-express-address__empty"},[s("p",{staticClass:"campaign-express-address__empty__icon"}),s("p",{staticClass:"campaign-express-address__empty__text"},[t._v("没有兑换过礼品")])])])},Wr=[],Gr={data:function(){return{campaignPostExchangedList:null}},created:function(){var t=this.$route.params.userStampList.filter(function(t){return 2===t.status||3===t.status});this.campaignPostExchangedList=t}},zr=Gr,Vr=(s("2dfb"),Object(_["a"])(zr,Hr,Wr,!1,null,"7db4fd6e",null)),qr=Vr.exports,Yr=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"choose-address"},[null!==t.addresses?s("div",{staticClass:"choose-address__wrapper"},[s("div",{staticClass:"choose-address__container"},t._l(t.addresses,function(e,i){return s("div",{key:i,staticClass:"choose-address__content"},[s("div",{staticClass:"choose-address__content__info",on:{click:function(s){return t.chooseAddress(e)}}},[s("span",{staticClass:"choose-address__content__info__address-name"},[t._v(t._s(e.addressName))]),""!==e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag-container"},["家"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag home"},[t._v(t._s(e.tags[0]))]):t._e(),"公司"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag company"},[t._v(t._s(e.tags[0]))]):t._e(),"学校"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag school"},[t._v(t._s(e.tags[0]))]):t._e()]):t._e(),s("span",{staticClass:"choose-address__content__info__detail-address"},[t._v(t._s(e.addressExtraInfo))]),s("span",{staticClass:"choose-address__content__info__contact-name"},[t._v(t._s(e.name))]),s("span",{staticClass:"choose-address__content__info__phone-number"},[t._v(t._s(e.phoneNumber))])]),s("span",{staticClass:"choose-address__edit",on:{click:function(e){return t.editAddress(i)}}},[t._v("编辑")])])}),0)]):s("div",{staticClass:"choose-address__empty"},[s("p",{staticClass:"choose-address__empty__icon"}),s("p",{staticClass:"choose-address__empty__text"},[t._v("还未添加地址")])]),s("div",{staticClass:"choose-address__add-address",on:{click:t.addAddress}},[t._v("新增常用地址")])])},Qr=[],Kr={data:function(){return{isAddAddressVisible:!1,isEditAddressVisible:!1,isTagHome:!1,isTagCompany:!1,isTagSchool:!1,addresses:null}},created:function(){ze.init(),this.fetchUserAddressInfo(),this.showAddOrEditAddressSuccessToast()},methods:{showAddOrEditAddressSuccessToast:function(){var t=this.$store.state.campaignExchangeAddress.needShowEditAddressSuccessToast,e=this.$store.state.campaignExchangeAddress.needShowAddAddressSuccessToast;t?oa.show({msg:"修改地址信息成功"}):e&&oa.show({msg:"新增地址信息成功"}),this.$store.commit("campaignExchangeAddress/hideEditAddressSuccessToast"),this.$store.commit("campaignExchangeAddress/hideAddAddressSuccessToast")},fetchUserAddressInfo:function(){var t=this;Rt.show();var e=gt.getRegionBlockCode();vt.address.fetch({regionBlockCode:e}).then(function(e){Rt.hide();var s=0===e.data.code,i=e.data.data.length>0;s?i&&(t.addresses=e.data.data):(Rt.hide(),oa.show({msg:"获取地址信息失败, 请稍后再试"}))}).catch(function(t){Rt.hide(),oa.show({msg:"获取地址信息失败, 请稍后再试"})})},chooseAddress:function(t){this.$store.commit("campaignExchangeAddress/setChooseAddressInfo",t),this.$router.go(-1)},editAddress:function(t){var e=this.addresses[t];this.$store.commit("campaignExchangeAddress/setEditAddressInfo",e),this.$router.push({path:"/campaign-post-exchange/edit-address"})},addAddress:function(){this.$router.push({path:"/campaign-post-exchange/add-address"})}}},Xr=Kr,Zr=(s("31cd"),Object(_["a"])(Xr,Yr,Qr,!1,null,"1a7ced28",null)),Jr=Zr.exports,tl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"add-address"},[s("div",{staticClass:"add-address__contact-content"},[s("span",{staticClass:"add-address__contact"},[t._v("联系人")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],staticClass:"add-address__contact-name",attrs:{placeholder:"请输入你的姓名"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"add-address__gender-info"},[s("span",{class:t.isSelectMale?"add-address__gender-mr tagSelect":"add-address__gender-mr",on:{click:t.selectMale}},[t._v("先生")]),s("span",{class:t.isSelectFemale?"add-address__gender-miss tagSelect":"add-address__gender-miss",on:{click:t.selectFemale}},[t._v("女士")])]),s("div",{staticClass:"add-address__phone-content"},[s("span",{staticClass:"add-address__phone"},[t._v("手机号")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.phoneNumber,expression:"phoneNumber"}],staticClass:"add-address__phone-number",attrs:{placeholder:"请输入你的手机号",type:"number"},domProps:{value:t.phoneNumber},on:{input:[function(e){e.target.composing||(t.phoneNumber=e.target.value)},t.handlePhoneNumberInputChange]}})]),t.showPhoneNumberSuggestion&&null!==t.suggestedPhoneNumbers?s("div",{staticClass:"add-address__phone-number-suggestion"},t._l(t.suggestedPhoneNumbers,function(e,i){return s("div",{key:i,staticClass:"add-address__phone-number-suggestion__item",on:{click:function(s){return t.handleSuggestedPhoneNumberTap(e)}}},[t._v(t._s(e))])}),0):t._e(),s("div",{staticClass:"add-address__address-content",on:{click:t.chooseAddress}},[s("span",{staticClass:"add-address__address"},[t._v("地址")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressDetailName,expression:"addressDetailName",modifiers:{trim:!0}}],staticClass:"add-address__address-description",attrs:{placeholder:"请选择地址",onfocus:"this.blur()"},domProps:{value:t.addressDetailName},on:{input:function(e){e.target.composing||(t.addressDetailName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("span",{staticClass:"add-address__address-description__icon",on:{click:t.chooseAddress}})]),s("div",{staticClass:"add-address__address-detail-content"},[s("span",{staticClass:"add-address__address-detail"},[t._v("门牌号")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressExtraInfo,expression:"addressExtraInfo",modifiers:{trim:!0}}],staticClass:"add-address__address-detail-description",attrs:{placeholder:"请输入门牌号，如A座8A座"},domProps:{value:t.addressExtraInfo},on:{input:function(e){e.target.composing||(t.addressExtraInfo=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"add-address__tag-info"},[s("span",{staticClass:"add-address__tag"},[t._v("标签")]),s("span",{class:t.isSelectHome?"add-address__tag-home tagSelect":"add-address__tag-home",on:{click:t.selectHome}},[t._v("家")]),s("span",{class:t.isSelectCompany?"add-address__tag-company tagSelect":"add-address__tag-company",on:{click:t.selectCompany}},[t._v("公司")]),s("span",{class:t.isSelectSchool?"add-address__tag-school tagSelect":"add-address__tag-school",on:{click:t.selectSchool}},[t._v("学校")])]),s("div",{staticClass:"add-address__save-address",on:{click:t.saveAddress}},[t._v("确定")])])},el=[],sl={data:function(){return{name:"",gender:"FEMALE",phoneNumber:"",addressName:"",addressDetailName:null,addressExtraInfo:"",tags:[],addAddress:null,isSelectMale:!1,isSelectFemale:!1,isSelectHome:!1,isSelectCompany:!1,isSelectSchool:!1,isLocationPickerVisible:!1,locationInfo:null,showPhoneNumberSuggestion:!1,userAllPhoneNumbers:null,suggestedPhoneNumbers:null}},created:function(){if(this.setPhoneNumberSuggestion(),this.addAddress=this.$store.state.campaignExchangeAddress.addAddressInfo,this.addAddress){this.name=this.addAddress.name,this.gender=this.addAddress.gender,this.phoneNumber=this.addAddress.phoneNumber,this.addressName=this.$store.state.location.locationInfo.addressName,this.addressDetailName=this.$store.state.location.locationInfo.addressDetailName,this.addressExtraInfo=this.addAddress.addressExtraInfo;var t=this.$store.state.location.locationInfo.latitude,e=this.$store.state.location.locationInfo.longitude;this.locationInfo={latitude:t,longitude:e},this.$store.commit("location/cleanupLocationInfo");var s="MALE"===this.addAddress.gender;s?(this.isSelectMale=!0,this.gender="MALE"):(this.isSelectFemale=!0,this.gender="FEMALE");var i=!!this.addAddress.tags;if(i){var n="家"===this.addAddress.tags[0],a="公司"===this.addAddress.tags[0],o="学校"===this.addAddress.tags[0];n?(this.isSelectHome=!0,this.tags=["家"]):a?(this.isSelectCompany=!0,this.tags=["公司"]):o&&(this.isSelectSchool=!0,this.tags=["学校"])}}else this.isSelectFemale=!0},methods:{filterPhoneNumberForSuggestion:function(t,e){return 0===t.length?e.slice():e.filter(function(e){return e.slice(0,t.length)===t})},setPhoneNumberSuggestion:function(){var t=this,e=gt.getRegionBlockCode();vt.address.fetch({regionBlockCode:e}).then(function(e){var s=0===e.data.code,i=e.data.data.length>0,n=e.data.data,a=ne.a.uniq(n.map(function(t){return t.phoneNumber}));s&&i&&(t.userAllPhoneNumbers=a,t.suggestedPhoneNumbers=a)})},handlePhoneNumberInputChange:function(){var t=this.phoneNumber;t.length>11&&(this.phoneNumber=t.slice(0,11)),this.showPhoneNumberSuggestion=!0,this.suggestedPhoneNumbers=this.filterPhoneNumberForSuggestion(t,this.userAllPhoneNumbers)},handleSuggestedPhoneNumberTap:function(t){this.phoneNumber=t,this.showPhoneNumberSuggestion=!1},chooseAddress:function(){var t=this.name,e=this.gender,s=this.phoneNumber,i=this.addressName,n=this.addressDetailName,a=this.addressExtraInfo,o=this.tags,c={name:t,gender:e,phoneNumber:s,addressName:i,addressDetailName:n,addressExtraInfo:a,tags:o};this.$store.commit("campaignExchangeAddress/setAddAddressInfo",c),this.$router.push({path:"/choose-location"})},saveAddress:function(){var t=this,e=gt.getRegionBlockCode(),s=""===this.name,i=""===this.gender,n=""===this.phoneNumber,a=""===this.addressName,o=""===this.addressExtraInfo,c=!this.checkPhoneValid(this.phoneNumber);if(s)oa.show({msg:"请输入你的姓名"});else if(i)oa.show({msg:"请选择性别"});else if(n)oa.show({msg:"请输入你的手机号"});else if(c)oa.show({msg:"请输入有效的手机号"});else if(a)oa.show({msg:"请选择地址"});else if(o)oa.show({msg:"请输入门牌号"});else{Dr.show();var r={regionBlockCode:e,name:this.name,gender:this.gender,phoneNumber:this.phoneNumber,addressName:this.addressName,addressDetailName:this.addressDetailName,addressExtraInfo:this.addressExtraInfo,latitude:this.locationInfo.latitude,longitude:this.locationInfo.longitude,tags:this.tags};vt.address.add({addressInfo:r,regionBlockCode:e}).then(function(e){Dr.hide();var s=0===e.data.code;s?(t.$router.go(-1),t.$store.commit("campaignExchangeAddress/cleanupAddAddressInfo"),t.$store.commit("campaignExchangeAddress/setNeedShowAddAddressSuccessToast",!0)):(Dr.hide(),oa.show({msg:"新增地址信息失败, 请稍后再试"}))}).catch(function(t){Dr.hide(),oa.show({msg:"新增地址信息失败, 请稍后再试"})})}},checkPhoneValid:function(t){return!!/^1\d{10}$/.test(t)},selectMale:function(){this.isSelectMale=!0,this.isSelectFemale=!1,this.gender="MALE"},selectFemale:function(){this.isSelectFemale=!0,this.isSelectMale=!1,this.gender="FEMALE"},selectHome:function(){this.isSelectHome?(this.isSelectHome=!1,this.tags=[]):(this.isSelectHome=!0,this.tags=["家"]),this.isSelectCompany=!1,this.isSelectSchool=!1},selectCompany:function(){this.isSelectCompany?(this.isSelectCompany=!1,this.tags=[]):(this.isSelectCompany=!0,this.tags=["公司"]),this.isSelectHome=!1,this.isSelectSchool=!1},selectSchool:function(){this.isSelectSchool?(this.isSelectSchool=!1,this.tags=[]):(this.isSelectSchool=!0,this.tags=["学校"]),this.isSelectHome=!1,this.isSelectCompany=!1}}},il=sl,nl=(s("fdd2"),Object(_["a"])(il,tl,el,!1,null,"2c57b4c8",null)),al=nl.exports,ol=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"edit-address"},[s("div",{staticClass:"edit-address__contact-content"},[s("span",{staticClass:"edit-address__contact"},[t._v("联系人")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],staticClass:"edit-address__contact-name",domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"edit-address__gender-info"},[s("span",{class:t.isSelectMale?"edit-address__gender-mr tagSelect":"edit-address__gender-mr",on:{click:t.selectMale}},[t._v("先生")]),s("span",{class:t.isSelectFemale?"edit-address__gender-miss tagSelect":"edit-address__gender-miss",on:{click:t.selectFemale}},[t._v("女士")])]),s("div",{staticClass:"edit-address__phone-content"},[s("span",{staticClass:"edit-address__phone"},[t._v("手机号")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.phoneNumber,expression:"phoneNumber"}],staticClass:"edit-address__phone-number",attrs:{placeholder:"请输入你的手机号",type:"number"},domProps:{value:t.phoneNumber},on:{input:[function(e){e.target.composing||(t.phoneNumber=e.target.value)},t.handlePhoneNumberInputChange]}})]),t.showPhoneNumberSuggestion&&null!==t.suggestedPhoneNumbers?s("div",{staticClass:"edit-address__phone-number-suggestion"},t._l(t.suggestedPhoneNumbers,function(e,i){return s("div",{key:i,staticClass:"edit-address__phone-number-suggestion__item",on:{click:function(s){return t.handleSuggestedPhoneNumberTap(e)}}},[t._v(t._s(e))])}),0):t._e(),s("div",{staticClass:"edit-address__address-content",on:{click:t.chooseAddress}},[s("span",{staticClass:"edit-address__address"},[t._v("地址")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressDetailName,expression:"addressDetailName",modifiers:{trim:!0}}],staticClass:"edit-address__address-description",attrs:{onfocus:"this.blur()"},domProps:{value:t.addressDetailName},on:{input:function(e){e.target.composing||(t.addressDetailName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("span",{staticClass:"edit-address__address-description__icon"})]),s("div",{staticClass:"edit-address__address-detail-content"},[s("span",{staticClass:"edit-address__address-detail"},[t._v("门牌号")]),s("div",{staticClass:"edit-address__address-detail-show",attrs:{contenteditable:"true"}},[t._v(t._s(t.addressExtraInfo))]),s("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressExtraInfo,expression:"addressExtraInfo",modifiers:{trim:!0}}],staticClass:"edit-address__address-detail-description",domProps:{value:t.addressExtraInfo},on:{input:function(e){e.target.composing||(t.addressExtraInfo=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"edit-address__tag-info"},[s("span",{staticClass:"edit-address__tag"},[t._v("标签")]),s("span",{class:t.isSelectHome?"edit-address__tag-home tagSelect":"edit-address__tag-home",on:{click:t.selectHome}},[t._v("家")]),s("span",{class:t.isSelectCompany?"edit-address__tag-company tagSelect":"edit-address__tag-company",on:{click:t.selectCompany}},[t._v("公司")]),s("span",{class:t.isSelectSchool?"edit-address__tag-school tagSelect":"edit-address__tag-school",on:{click:t.selectSchool}},[t._v("学校")])]),s("div",{staticClass:"edit-address__save-address",on:{click:t.saveAddress}},[t._v("确定")])])},cl=[],rl={data:function(){return{name:null,gender:null,phoneNumber:null,addressName:null,addressDetailName:null,addressExtraInfo:null,addressId:null,tags:[],editAddress:null,isSelectMale:!1,isSelectFemale:!1,isSelectHome:!1,isSelectCompany:!1,isSelectSchool:!1,isLocationPickerVisible:!1,locationInfo:null,showPhoneNumberSuggestion:!1,userAllPhoneNumbers:null,suggestedPhoneNumbers:null}},created:function(){this.setPhoneNumberSuggestion(),this.editAddress=this.$store.state.campaignExchangeAddress.editAddressInfo,this.name=this.editAddress.name,this.gender=this.editAddress.gender,this.phoneNumber=this.editAddress.phoneNumber,this.addressName=this.editAddress.addressName,this.addressDetailName=this.editAddress.addressDetailName,this.addressExtraInfo=this.editAddress.addressExtraInfo,this.addressId=this.editAddress.addressId;var t=this.editAddress.latitude,e=this.editAddress.longitude;this.locationInfo={latitude:t,longitude:e};var s=null!==this.$store.state.location.locationInfo;if(s){this.addressName=this.$store.state.location.locationInfo.addressName,this.addressDetailName=this.$store.state.location.locationInfo.addressDetailName;var i=this.$store.state.location.locationInfo.latitude,n=this.$store.state.location.locationInfo.longitude;this.locationInfo={latitude:i,longitude:n},this.$store.commit("location/cleanupLocationInfo")}var a="MALE"===this.editAddress.gender,o="FEMALE"===this.editAddress.gender;a?(this.isSelectMale=!0,this.gender="MALE"):o&&(this.isSelectFemale=!0,this.gender="FEMALE");var c=!!this.editAddress.tags;if(c){var r="家"===this.editAddress.tags[0],l="公司"===this.editAddress.tags[0],d="学校"===this.editAddress.tags[0];r?(this.isSelectHome=!0,this.tags=["家"]):l?(this.isSelectCompany=!0,this.tags=["公司"]):d&&(this.isSelectSchool=!0,this.tags=["学校"])}},methods:{filterPhoneNumberForSuggestion:function(t,e){return 0===t.length?e.slice():e.filter(function(e){return e.slice(0,t.length)===t})},setPhoneNumberSuggestion:function(){var t=this,e=gt.getRegionBlockCode();vt.address.fetch({regionBlockCode:e}).then(function(e){var s=0===e.data.code,i=e.data.data.length>0,n=e.data.data,a=ne.a.uniq(n.map(function(t){return t.phoneNumber}));s&&i&&(t.userAllPhoneNumbers=a,t.suggestedPhoneNumbers=a)})},handlePhoneNumberInputChange:function(){var t=this.phoneNumber;t.length>11&&(this.phoneNumber=t.slice(0,11)),this.showPhoneNumberSuggestion=!0,this.suggestedPhoneNumbers=this.filterPhoneNumberForSuggestion(t,this.userAllPhoneNumbers)},handleSuggestedPhoneNumberTap:function(t){this.phoneNumber=t,this.showPhoneNumberSuggestion=!1},chooseAddress:function(){var t=this.name,e=this.gender,s=this.phoneNumber,i=this.addressName,n=this.addressDetailName,a=this.addressId,o=this.addressExtraInfo,c=this.editAddress.tags,r={name:t,gender:e,phoneNumber:s,addressName:i,addressDetailName:n,addressExtraInfo:o,addressId:a,tags:c,latitude:this.editAddress.location,longitude:this.editAddress.location};this.$store.commit("campaignExchangeAddress/setEditAddressInfo",r),this.$router.push({path:"/choose-location"})},saveAddress:function(){var t=this,e=""===this.name,s=""===this.gender,i=""==this.phoneNumber,n=""===this.addressName,a=""===this.addressExtraInfo,o=!this.checkPhoneValid(this.phoneNumber);if(e)oa.show({msg:"请输入你的姓名"});else if(s)oa.show({msg:"请选择性别"});else if(i)oa.show({msg:"请输入你的手机号"});else if(o)oa.show({msg:"请输入有效的手机号"});else if(n)oa.show({msg:"请选择地址"});else if(a)oa.show({msg:"请输入门牌号"});else{Dr.show();var c=gt.getRegionBlockCode(),r={regionBlockCode:c,addressId:this.editAddress.addressId,name:this.name,gender:this.gender,phoneNumber:this.phoneNumber,addressName:this.addressName,addressDetailName:this.addressDetailName,addressExtraInfo:this.addressExtraInfo,latitude:this.locationInfo.latitude,longitude:this.locationInfo.longitude,tags:this.tags};vt.address.edit({addressInfo:r,regionBlockCode:c}).then(function(e){Dr.hide();var s=0===e.data.code;s?(t.$router.go(-1),t.$store.commit("campaignExchangeAddress/cleanupEditAddressInfo"),t.$store.commit("campaignExchangeAddress/setNeedShowEditAddressSuccessToast",!0)):(Dr.hide(),oa.show({msg:"修改地址信息失败, 请稍后再试"}))}).catch(function(t){Dr.hide(),oa.show({msg:"修改地址信息失败, 请稍后再试"})})}},checkPhoneValid:function(t){return!!/^1\d{10}$/.test(t)},selectMale:function(){this.isSelectMale=!0,this.isSelectFemale=!1,this.gender="MALE"},selectFemale:function(){this.isSelectFemale=!0,this.isSelectMale=!1,this.gender="FEMALE"},selectHome:function(){this.isSelectHome?(this.isSelectHome=!1,this.tags=[]):(this.isSelectHome=!0,this.tags=["家"]),this.isSelectCompany=!1,this.isSelectSchool=!1,this.editAddress.tags=this.tags},selectCompany:function(){this.isSelectCompany?(this.isSelectCompany=!1,this.tags=[]):(this.isSelectCompany=!0,this.tags=["公司"]),this.isSelectHome=!1,this.isSelectSchool=!1,this.editAddress.tags=this.tags},selectSchool:function(){this.isSelectSchool?(this.isSelectSchool=!1,this.tags=[]):(this.isSelectSchool=!0,this.tags=["学校"]),this.isSelectHome=!1,this.isSelectCompany=!1,this.editAddress.tags=this.tags}}},ll=rl,dl=(s("0077"),Object(_["a"])(ll,ol,cl,!1,null,"3252c45b",null)),pl=dl.exports,ul=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"location-picker"},[s("iframe",{ref:"locationPicker",attrs:{width:"100%",height:"100%",frameborder:"0",src:"https://apis.map.qq.com/tools/locpicker?type=1&policy=1&key=QVPBZ-YBMHV-KYMPX-UIXW2-7AM7Z-BNFNU&referer=locator"}})])},_l=[],ml={data:function(){return{chosenAddressName:null}},created:function(){this.initQQMapLocationPicker()},methods:{initQQMapLocationPicker:function(){window.addEventListener("message",this.handleLocationChange,!1)},handleLocationChange:function(t){var e=this,s=t.data;if(s&&"locationPicker"==s.module){var i="我的位置"===s.poiname;i?qqLbsService.getAddressByLatLng(s.latlng.lat,s.latlng.lng).then(function(t){var s=t.nearPois[0];e.chosenAddressName=s,e.hideLocationPicker()}):(this.chosenAddressName=s.poiname,this.hideLocationPicker());var n=this.$store.state.campaignExchangeAddress.addAddressInfo,a=n.name,o=n.gender,c=n.phoneNumber,r=this.chosenAddressName,l=s.poiaddress,d=n.addressExtraInfo,p=n.tags,u={name:a,gender:o,phoneNumber:c,addressName:r,addressDetailName:l,addressExtraInfo:d,tags:p,latitude:s.latlng.lat,longitude:s.latlng.lng};this.$store.commit("campaignExchangeAddress/setAddAddressInfo",u),this.$router.go(-1)}},hideLocationPicker:function(){var t=this.$refs.locationPicker;t.focus(),t.blur(),window.removeEventListener("message",this.handleLocationChange,!1)}}},hl=ml,gl=(s("de52"),Object(_["a"])(hl,ul,_l,!1,null,"37bba296",null)),vl=gl.exports,fl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"location-picker"},[s("iframe",{ref:"locationPicker",attrs:{width:"100%",height:"100%",frameborder:"0",src:"https://apis.map.qq.com/tools/locpicker?type=1&policy=1&key=QVPBZ-YBMHV-KYMPX-UIXW2-7AM7Z-BNFNU&referer=locator"}})])},Cl=[],yl={data:function(){return{chosenAddressName:null}},created:function(){this.initQQMapLocationPicker()},methods:{initQQMapLocationPicker:function(){window.addEventListener("message",this.handleLocationChange,!1)},handleLocationChange:function(t){var e=this,s=t.data;if(s&&"locationPicker"==s.module){var i="我的位置"===s.poiname;i?qqLbsService.getAddressByLatLng(s.latlng.lat,s.latlng.lng).then(function(t){var s=t.nearPois[0];e.chosenAddressName=s,e.hideLocationPicker()}):(this.chosenAddressName=s.poiname,this.hideLocationPicker());var n=this.$store.state.campaignExchangeAddress.editAddressInfo,a=n.name,o=n.gender,c=n.phoneNumber,r=this.chosenAddressName,l=s.poiaddress,d=n.addressExtraInfo,p=n.addressId,u=n.tags,_={name:a,gender:o,phoneNumber:c,addressName:r,addressDetailName:l,addressExtraInfo:d,addressId:p,tags:u,latitude:s.latlng.lat,longitude:s.latlng.lng};this.$store.commit("campaignExchangeAddress/setEditAddressInfo",_),this.$router.go(-1)}},hideLocationPicker:function(){var t=this.$refs.locationPicker;t.focus(),t.blur(),window.removeEventListener("message",this.handleLocationChange,!1)}}},bl=yl,wl=(s("9edc"),Object(_["a"])(bl,fl,Cl,!1,null,"6a1b74a4",null)),Sl=wl.exports,Dl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"choose-address"},[null!==t.addresses?s("div",{staticClass:"choose-address__wrapper"},[s("div",{staticClass:"choose-address__container"},t._l(t.addresses,function(e,i){return s("div",{key:i,staticClass:"choose-address__content"},[s("div",{staticClass:"choose-address__content__info",on:{click:function(s){return t.chooseAddress(e)}}},[s("span",{staticClass:"choose-address__content__info__address-name"},[t._v(t._s(e.addressName))]),""!==e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag-container"},["家"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag home"},[t._v(t._s(e.tags[0]))]):t._e(),"公司"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag company"},[t._v(t._s(e.tags[0]))]):t._e(),"学校"===e.tags[0]?s("div",{staticClass:"choose-address__content__info__tag school"},[t._v(t._s(e.tags[0]))]):t._e()]):t._e(),s("span",{staticClass:"choose-address__content__info__detail-address"},[t._v(t._s(e.addressExtraInfo))]),s("span",{staticClass:"choose-address__content__info__contact-name"},[t._v(t._s(e.name))]),s("span",{staticClass:"choose-address__content__info__phone-number"},[t._v(t._s(e.phoneNumber))])]),s("span",{staticClass:"choose-address__edit",on:{click:function(e){return t.editAddress(i)}}},[t._v("编辑")])])}),0)]):s("div",{staticClass:"choose-address__empty"},[s("p",{staticClass:"choose-address__empty__icon"}),s("p",{staticClass:"choose-address__empty__text"},[t._v("还未添加地址")])]),s("div",{staticClass:"choose-address__add-address",on:{click:t.addAddress}},[t._v("新增常用地址")])])},kl=[],Tl={namespaced:!0,state:{chooseAddressInfo:null,editAddressInfo:null,addAddressInfo:null,needShowEditAddressSuccessToast:!1,needShowAddAddressSuccessToast:!1},mutations:{setChooseAddressInfo:function(t,e){t.chooseAddressInfo=e},setEditAddressInfo:function(t,e){t.editAddressInfo=e},setAddAddressInfo:function(t,e){t.addAddressInfo=e},setNeedShowEditAddressSuccessToast:function(t,e){t.needShowEditAddressSuccessToast=e},setNeedShowAddAddressSuccessToast:function(t,e){t.needShowAddAddressSuccessToast=e},cleanupChooseAddressInfo:function(t){t.chooseAddressInfo=null},cleanupEditAddressInfo:function(t){t.editAddressInfo=null},cleanupAddAddressInfo:function(t){t.addAddressInfo=null},hideEditAddressSuccessToast:function(t){t.needShowEditAddressSuccessToast=!1},hideAddAddressSuccessToast:function(t){t.needShowAddAddressSuccessToast=!1}}},xl={data:function(){return{isAddAddressVisible:!1,isEditAddressVisible:!1,isTagHome:!1,isTagCompany:!1,isTagSchool:!1,addresses:null}},created:function(){this.registerCampaignExchangeAddressModule(),this.fetchUserAddressInfo(),this.showAddOrEditAddressSuccessToast()},methods:{registerCampaignExchangeAddressModule:function(){this.$store.registerModule("campaignSendExchangeAddress",Tl)},showAddOrEditAddressSuccessToast:function(){var t=this.$store.state.campaignSendExchangeAddress.needShowEditAddressSuccessToast,e=this.$store.state.campaignSendExchangeAddress.needShowAddAddressSuccessToast;t?oa.show({msg:"修改地址信息成功"}):e&&oa.show({msg:"新增地址信息成功"}),this.$store.commit("campaignSendExchangeAddress/hideEditAddressSuccessToast"),this.$store.commit("campaignSendExchangeAddress/hideAddAddressSuccessToast")},fetchUserAddressInfo:function(){var t=this,e=gt.getRegionBlockCode();Rt.show(),vt.address.fetch({regionBlockCode:e}).then(function(e){Rt.hide();var s=0===e.data.code;s?e.data.data.length>0&&(t.addresses=e.data.data):oa.show({msg:"获取地址信息失败, 请稍后再试"})}).catch(function(t){oa.show({msg:"获取地址信息失败, 请稍后再试"}),Rt.hide()})},chooseAddress:function(t){var e=this,s=this.$route.params.userGiftId,i=gt.getRegionBlockCode(),n={regionBlockCode:i,userGiftId:s,userName:t.name,address:"".concat(t.addressDetailName).concat(t.addressName).concat(t.addressExtraInfo),mobile:t.phoneNumber},a="".concat(n.address);Fe.confirm({title:"您选择地址是",msg:a},function(t){Dr.show(),vt.campaign.campaignGiftSaveAddress({saveAddressInfo:n}).then(function(t){var s=0===t.code;s&&(e.$router.back(),Dr.hide())}).catch(function(t){console.log(t),Dr.hide()})})},editAddress:function(t){var e=this.addresses[t];this.$store.commit("campaignSendExchangeAddress/setEditAddressInfo",e),this.$router.push({path:"/campaign-send-exchange/edit-address"})},addAddress:function(){this.$router.push({path:"/campaign-send-exchange/add-address"})}}},Al=xl,Il=(s("1e58"),Object(_["a"])(Al,Dl,kl,!1,null,"06283ed1",null)),Nl=Il.exports,Ll=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-express-address"},[s("ul",{staticClass:"campaign-express-address__list"},t._l(t.sendAddressList,function(e,i){return s("li",{key:i,staticClass:"campaign-express-address__list__item"},[s("div",{staticClass:"campaign-express-address__list__item__left",on:{click:function(e){return t.back()}}},[s("p",{staticClass:"campaign-express-address__list__item__left__title"},[t._v("第"+t._s(i+1)+"轮: "+t._s(e.giftName))]),s("p",{staticClass:"campaign-express-address__list__item__left__address"},[t._v(t._s(e.address?e.address:"未设置"))]),s("p",{staticClass:"campaign-express-address__list__item__left__info"},[s("span",{staticClass:"campaign-express-address__list__item__left__name"},[t._v(t._s(e.userName))]),s("span",{staticClass:"campaign-express-address__list__item__left__phone"},[t._v(t._s(e.mobile))])])]),s("div",{staticClass:"campaign-express-address__list__item__right",on:{click:function(s){return t.goToCampaignChooseAddress(e.id)}}},[s("span",[t._v("设置")])])])}),0)])},Pl=[],El={data:function(){return{sendAddressList:null}},created:function(){this.fetchSendAddressList()},methods:{fetchSendAddressList:function(){var t=this,e=this.$route.params.campaignId;Rt.show(),vt.campaign.getSendAddress({campaignId:e}).then(function(e){t.sendAddressList=e,Rt.hide()})},goToCampaignChooseAddress:function(t){this.$router.push({path:"/campaign-send-choose-address/".concat(t)})},back:function(){this.$router.back()}}},Ml=El,$l=(s("7dfb"),Object(_["a"])(Ml,Ll,Pl,!1,null,"907dca14",null)),Fl=$l.exports,Ol=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"add-address"},[s("div",{staticClass:"add-address__contact-content"},[s("span",{staticClass:"add-address__contact"},[t._v("联系人")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],staticClass:"add-address__contact-name",attrs:{placeholder:"请输入你的姓名"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"add-address__gender-info"},[s("span",{class:t.isSelectMale?"add-address__gender-mr tagSelect":"add-address__gender-mr",on:{click:t.selectMale}},[t._v("先生")]),s("span",{class:t.isSelectFemale?"add-address__gender-miss tagSelect":"add-address__gender-miss",on:{click:t.selectFemale}},[t._v("女士")])]),s("div",{staticClass:"add-address__phone-content"},[s("span",{staticClass:"add-address__phone"},[t._v("手机号")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.phoneNumber,expression:"phoneNumber",modifiers:{number:!0}}],staticClass:"add-address__phone-number",attrs:{oninput:"if(value.length>11)value=value.slice(0,11)",placeholder:"请输入你的手机号",type:"number"},domProps:{value:t.phoneNumber},on:{input:function(e){e.target.composing||(t.phoneNumber=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"add-address__address-content",on:{click:t.chooseAddress}},[s("span",{staticClass:"add-address__address"},[t._v("地址")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressDetailName,expression:"addressDetailName",modifiers:{trim:!0}}],staticClass:"add-address__address-description",attrs:{placeholder:"请选择地址",onfocus:"this.blur()"},domProps:{value:t.addressDetailName},on:{input:function(e){e.target.composing||(t.addressDetailName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("span",{staticClass:"add-address__address-description__icon",on:{click:t.chooseAddress}})]),s("div",{staticClass:"add-address__address-detail-content"},[s("span",{staticClass:"add-address__address-detail"},[t._v("门牌号")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressExtraInfo,expression:"addressExtraInfo",modifiers:{trim:!0}}],staticClass:"add-address__address-detail-description",attrs:{placeholder:"请输入门牌号，如A座8A座"},domProps:{value:t.addressExtraInfo},on:{input:function(e){e.target.composing||(t.addressExtraInfo=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"add-address__tag-info"},[s("span",{staticClass:"add-address__tag"},[t._v("标签")]),s("span",{class:t.isSelectHome?"add-address__tag-home tagSelect":"add-address__tag-home",on:{click:t.selectHome}},[t._v("家")]),s("span",{class:t.isSelectCompany?"add-address__tag-company tagSelect":"add-address__tag-company",on:{click:t.selectCompany}},[t._v("公司")]),s("span",{class:t.isSelectSchool?"add-address__tag-school tagSelect":"add-address__tag-school",on:{click:t.selectSchool}},[t._v("学校")])]),s("div",{staticClass:"add-address__save-address",on:{click:t.saveAddress}},[t._v("确定")])])},Rl=[],Bl={data:function(){return{name:"",gender:"FEMALE",phoneNumber:"",addressName:"",addressDetailName:null,addressExtraInfo:"",tags:[],addAddress:null,isSelectMale:!1,isSelectFemale:!1,isSelectHome:!1,isSelectCompany:!1,isSelectSchool:!1,isLocationPickerVisible:!1,locationInfo:null}},created:function(){if(this.addAddress=this.$store.state.campaignSendExchangeAddress.addAddressInfo,this.addAddress){this.name=this.addAddress.name,this.gender=this.addAddress.gender,this.phoneNumber=this.addAddress.phoneNumber,this.addressName=this.$store.state.location.locationInfo.addressName,this.addressDetailName=this.$store.state.location.locationInfo.addressDetailName,this.addressExtraInfo=this.addAddress.addressExtraInfo;var t=this.$store.state.location.locationInfo.latitude,e=this.$store.state.location.locationInfo.longitude;this.locationInfo={latitude:t,longitude:e};var s="MALE"===this.addAddress.gender;s?(this.isSelectMale=!0,this.gender="MALE"):(this.isSelectFemale=!0,this.gender="FEMALE");var i=!!this.addAddress.tags;if(i){var n="家"===this.addAddress.tags[0],a="公司"===this.addAddress.tags[0],o="学校"===this.addAddress.tags[0];n?(this.isSelectHome=!0,this.tags=["家"]):a?(this.isSelectCompany=!0,this.tags=["公司"]):o&&(this.isSelectSchool=!0,this.tags=["学校"])}}else this.isSelectFemale=!0},methods:{chooseAddress:function(){var t=this.name,e=this.gender,s=this.phoneNumber,i=this.addressName,n=this.addressDetailName,a=this.addressExtraInfo,o=this.tags,c={name:t,gender:e,phoneNumber:s,addressName:i,addressDetailName:n,addressExtraInfo:a,tags:o};this.$store.commit("campaignSendExchangeAddress/setAddAddressInfo",c),this.$router.push({path:"/choose-location"})},saveAddress:function(){var t=this,e=gt.getRegionBlockCode(),s=""===this.name,i=""===this.gender,n=""===this.phoneNumber,a=""===this.addressName,o=""===this.addressExtraInfo,c=!this.checkPhoneValid(this.phoneNumber);if(s)oa.show({msg:"请输入你的姓名"});else if(i)oa.show({msg:"请选择性别"});else if(n)oa.show({msg:"请输入你的手机号"});else if(c)oa.show({msg:"请输入有效的手机号"});else if(a)oa.show({msg:"请选择地址"});else if(o)oa.show({msg:"请输入门牌号"});else{var r={regionBlockCode:e,name:this.name,gender:this.gender,phoneNumber:this.phoneNumber,addressName:this.addressName,addressDetailName:this.addressDetailName,addressExtraInfo:this.addressExtraInfo,latitude:this.locationInfo.latitude,longitude:this.locationInfo.longitude,tags:this.tags};Dr.show(),vt.address.add({addressInfo:r,regionBlockCode:e}).then(function(e){Dr.hide();var s=0===e.data.code;s?(t.$router.go(-1),t.$store.commit("campaignSendExchangeAddress/cleanupAddAddressInfo"),t.$store.commit("campaignSendExchangeAddress/setNeedShowAddAddressSuccessToast",!0)):oa.show({msg:"新增地址信息失败, 请稍后再试"})}).catch(function(t){Dr.hide(),oa.show({msg:"新增地址信息失败, 请稍后再试"})})}},checkPhoneValid:function(t){return!!/^1\d{10}$/.test(t)},selectMale:function(){this.isSelectMale=!0,this.isSelectFemale=!1,this.gender="MALE"},selectFemale:function(){this.isSelectFemale=!0,this.isSelectMale=!1,this.gender="FEMALE"},selectHome:function(){this.isSelectHome?(this.isSelectHome=!1,this.tags=[]):(this.isSelectHome=!0,this.tags=["家"]),this.isSelectCompany=!1,this.isSelectSchool=!1},selectCompany:function(){this.isSelectCompany?(this.isSelectCompany=!1,this.tags=[]):(this.isSelectCompany=!0,this.tags=["公司"]),this.isSelectHome=!1,this.isSelectSchool=!1},selectSchool:function(){this.isSelectSchool?(this.isSelectSchool=!1,this.tags=[]):(this.isSelectSchool=!0,this.tags=["学校"]),this.isSelectHome=!1,this.isSelectCompany=!1}}},Ul=Bl,jl=(s("70f4"),Object(_["a"])(Ul,Ol,Rl,!1,null,"203a6ce0",null)),Hl=jl.exports,Wl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"edit-address"},[s("div",{staticClass:"edit-address__contact-content"},[s("span",{staticClass:"edit-address__contact"},[t._v("联系人")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],staticClass:"edit-address__contact-name",domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"edit-address__gender-info"},[s("span",{class:t.isSelectMale?"edit-address__gender-mr tagSelect":"edit-address__gender-mr",on:{click:t.selectMale}},[t._v("先生")]),s("span",{class:t.isSelectFemale?"edit-address__gender-miss tagSelect":"edit-address__gender-miss",on:{click:t.selectFemale}},[t._v("女士")])]),s("div",{staticClass:"edit-address__phone-content"},[s("span",{staticClass:"edit-address__phone"},[t._v("手机号")]),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.phoneNumber,expression:"phoneNumber",modifiers:{number:!0}}],staticClass:"edit-address__phone-number",attrs:{oninput:"if(value.length>11)value=value.slice(0,11)",type:"number"},domProps:{value:t.phoneNumber},on:{input:function(e){e.target.composing||(t.phoneNumber=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"edit-address__address-content",on:{click:t.chooseAddress}},[s("span",{staticClass:"edit-address__address"},[t._v("地址")]),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressDetailName,expression:"addressDetailName",modifiers:{trim:!0}}],staticClass:"edit-address__address-description",attrs:{onfocus:"this.blur()"},domProps:{value:t.addressDetailName},on:{input:function(e){e.target.composing||(t.addressDetailName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("span",{staticClass:"edit-address__address-description__icon"})]),s("div",{staticClass:"edit-address__address-detail-content"},[s("span",{staticClass:"edit-address__address-detail"},[t._v("门牌号")]),s("div",{staticClass:"edit-address__address-detail-show",attrs:{contenteditable:"true"}},[t._v(t._s(t.addressExtraInfo))]),s("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.addressExtraInfo,expression:"addressExtraInfo",modifiers:{trim:!0}}],staticClass:"edit-address__address-detail-description",domProps:{value:t.addressExtraInfo},on:{input:function(e){e.target.composing||(t.addressExtraInfo=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),s("div",{staticClass:"edit-address__tag-info"},[s("span",{staticClass:"edit-address__tag"},[t._v("标签")]),s("span",{class:t.isSelectHome?"edit-address__tag-home tagSelect":"edit-address__tag-home",on:{click:t.selectHome}},[t._v("家")]),s("span",{class:t.isSelectCompany?"edit-address__tag-company tagSelect":"edit-address__tag-company",on:{click:t.selectCompany}},[t._v("公司")]),s("span",{class:t.isSelectSchool?"edit-address__tag-school tagSelect":"edit-address__tag-school",on:{click:t.selectSchool}},[t._v("学校")])]),s("div",{staticClass:"edit-address__save-address",on:{click:t.saveAddress}},[t._v("确定")])])},Gl=[],zl={data:function(){return{name:null,gender:null,phoneNumber:null,addressName:null,addressDetailName:null,addressExtraInfo:null,addressId:null,tags:[],editAddress:null,isSelectMale:!1,isSelectFemale:!1,isSelectHome:!1,isSelectCompany:!1,isSelectSchool:!1,isLocationPickerVisible:!1,locationInfo:null}},created:function(){this.editAddress=this.$store.state.campaignSendExchangeAddress.editAddressInfo,this.name=this.editAddress.name,this.gender=this.editAddress.gender,this.phoneNumber=this.editAddress.phoneNumber,this.addressName=this.editAddress.addressName,this.addressDetailName=this.editAddress.addressDetailName,this.addressExtraInfo=this.editAddress.addressExtraInfo,this.addressId=this.editAddress.addressId;var t=this.editAddress.latitude,e=this.editAddress.longitude;this.locationInfo={latitude:t,longitude:e};var s=null!==this.$store.state.location.locationInfo;if(s){this.addressName=this.$store.state.location.locationInfo.addressName,this.addressDetailName=this.$store.state.location.locationInfo.addressDetailName;var i=this.$store.state.location.locationInfo.latitude,n=this.$store.state.location.locationInfo.longitude;this.locationInfo={latitude:i,longitude:n},this.$store.commit("location/cleanupLocationInfo")}var a="MALE"===this.editAddress.gender,o="FEMALE"===this.editAddress.gender;a?(this.isSelectMale=!0,this.gender="MALE"):o&&(this.isSelectFemale=!0,this.gender="FEMALE");var c=!!this.editAddress.tags;if(c){var r="家"===this.editAddress.tags[0],l="公司"===this.editAddress.tags[0],d="学校"===this.editAddress.tags[0];r?(this.isSelectHome=!0,this.tags=["家"]):l?(this.isSelectCompany=!0,this.tags=["公司"]):d&&(this.isSelectSchool=!0,this.tags=["学校"])}},methods:{chooseAddress:function(){var t=this.name,e=this.gender,s=this.phoneNumber,i=this.addressName,n=this.addressDetailName,a=this.addressId,o=this.addressExtraInfo,c=this.editAddress.tags,r={name:t,gender:e,phoneNumber:s,addressName:i,addressDetailName:n,addressExtraInfo:o,addressId:a,tags:c,latitude:this.editAddress.location,longitude:this.editAddress.location};this.$store.commit("campaignSendExchangeAddress/setEditAddressInfo",r),this.$router.push({path:"/choose-location"})},saveAddress:function(){var t=this,e=""===this.name,s=""===this.gender,i=""==this.phoneNumber,n=""===this.addressName,a=""===this.addressExtraInfo,o=!this.checkPhoneValid(this.phoneNumber);if(e)oa.show({msg:"请输入你的姓名"});else if(s)oa.show({msg:"请选择性别"});else if(i)oa.show({msg:"请输入你的手机号"});else if(o)oa.show({msg:"请输入有效的手机号"});else if(n)oa.show({msg:"请选择地址"});else if(a)oa.show({msg:"请输入门牌号"});else{var c=gt.getRegionBlockCode(),r={regionBlockCode:c,addressId:this.editAddress.addressId,name:this.name,gender:this.gender,phoneNumber:this.phoneNumber,addressName:this.addressName,addressDetailName:this.addressDetailName,addressExtraInfo:this.addressExtraInfo,latitude:this.locationInfo.latitude,longitude:this.locationInfo.longitude,tags:this.tags};Dr.show(),vt.address.edit({addressInfo:r,regionBlockCode:c}).then(function(e){var s=0===e.data.code;Dr.hide(),s?(t.$router.go(-1),t.$store.commit("campaignSendExchangeAddress/cleanupEditAddressInfo"),t.$store.commit("campaignSendExchangeAddress/setNeedShowEditAddressSuccessToast",!0)):oa.show({msg:"修改地址信息失败, 请稍后再试"})}).catch(function(t){Dr.hide(),oa.show({msg:"修改地址信息失败, 请稍后再试"})})}},checkPhoneValid:function(t){return!!/^1\d{10}$/.test(t)},selectMale:function(){this.isSelectMale=!0,this.isSelectFemale=!1,this.gender="MALE"},selectFemale:function(){this.isSelectFemale=!0,this.isSelectMale=!1,this.gender="FEMALE"},selectHome:function(){this.isSelectHome?(this.isSelectHome=!1,this.tags=[]):(this.isSelectHome=!0,this.tags=["家"]),this.isSelectCompany=!1,this.isSelectSchool=!1,this.editAddress.tags=this.tags},selectCompany:function(){this.isSelectCompany?(this.isSelectCompany=!1,this.tags=[]):(this.isSelectCompany=!0,this.tags=["公司"]),this.isSelectHome=!1,this.isSelectSchool=!1,this.editAddress.tags=this.tags},selectSchool:function(){this.isSelectSchool?(this.isSelectSchool=!1,this.tags=[]):(this.isSelectSchool=!0,this.tags=["学校"]),this.isSelectHome=!1,this.isSelectCompany=!1,this.editAddress.tags=this.tags}}},Vl=zl,ql=(s("d95f"),Object(_["a"])(Vl,Wl,Gl,!1,null,"20baab58",null)),Yl=ql.exports,Ql=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shops&&t.oftenShops?s("div",{staticClass:"campagin-shop-list"},[s("div",{staticClass:"campagin-shop-list__search-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchShop,expression:"searchShop"}],staticClass:"campagin-shop-list__search-container__search-bar",attrs:{placeholder:"输入门店名称"},domProps:{value:t.searchShop},on:{input:function(e){e.target.composing||(t.searchShop=e.target.value)}}})]),s("div",{ref:"currentShop",staticClass:"campagin-shop-list__current-shop"},[t._m(0),s("div",{staticClass:"campagin-shop-list__current-shop__item"},[s("div",{staticClass:"campagin-shop-list__current-shop__item__icon-location"}),t.currentAddress?s("div",{staticClass:"campagin-shop-list__current-shop__item__current-address"},[t._v(t._s(t.currentAddress))]):t._e(),s("div",{staticClass:"campagin-shop-list__current-shop__item__refresh-location",on:{click:t.setCurrentAddress}},[t._v("重新定位")])]),s("div",{staticClass:"campagin-shop-list__whitespace"}),t.oftenShops.length>0?[t._m(1),t._l(t.oftenShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e(),s("div",{staticClass:"campagin-shop-list__whitespace"}),t._m(2),t.shops.length>0?t._l(t.nearbyShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})}):t._e()],2)]):t._e()},Kl=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campagin-shop-list__current-shop__title-row"},[s("span",{staticClass:"campagin-shop-list__current-shop__title-row__title"},[t._v("当前定位")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campagin-shop-list__my-shops__title-row"},[s("span",{staticClass:"campagin-shop-list__my-shops__title-row__title"},[t._v("常去店铺")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campagin-shop-list__nearby-shops__title-row"},[s("span",{staticClass:"campagin-shop-list__nearby-shops__title-row__title"},[t._v("附近店铺")])])}],Xl=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-item"},[s("div",{staticClass:"shop-item__info"},[s("div",{staticClass:"shop-item__basic-info"},[s("div",{staticClass:"shop-item__shop-name"},[t._v("\n        "+t._s(t.shop.shopName)+"\n        "),t.shop.is24h?s("span",{staticClass:"shop-item__shop-name__24h-mark"},[t._v("24h")]):t._e()]),s("div",{staticClass:"shop-item__shop-address"},[t._v(t._s(t.shop.address))])]),t.shop.distance?s("div",{staticClass:"shop-item__map-info"},[s("div",{staticClass:"shop-item__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.shop.distance)))]),s("div",{staticClass:"shop-item__show-in-map",on:{click:t.openMap}},[t._v("地图 >")])]):t._e()])])},Zl=[],Jl={props:{shop:Object},methods:{openMap:function(){wx.openLocation({latitude:this.shop.latitude,longitude:this.shop.longitude,name:this.shop.shopName,address:this.shop.address})}},filters:{toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},td=Jl,ed=(s("7783"),Object(_["a"])(td,Xl,Zl,!1,null,"c555971c",null)),sd=ed.exports,id={components:{ShopItem:sd},data:function(){return{shops:null,oftenShops:null,currentAddress:null,nearbyShopsLength:10,searchShop:null,currentLocation:null}},created:function(){this.getShopList(),this.fetchOftenShoplist()},mounted:function(){var t=this;ze.init().then(function(){t.setCurrentAddress()})},updated:function(){this.$refs.currentShop.addEventListener("scroll",this.handleScroll)},computed:{sortedShopsWithDistance:function(){function t(t){return t*Math.PI/180}function e(e,s,i,n){var a=6371,o=t(i-e),c=t(n-s);e=t(e),i=t(i);var r=Math.sin(o/2)*Math.sin(o/2)+Math.sin(c/2)*Math.sin(c/2)*Math.cos(e)*Math.cos(i),l=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r));return a*l}var s=this.currentLocation;if(s){var i=this.shops.map(function(t){var i=te()({},t);return i.distance=e(t.latitude,t.longitude,s.latitude,s.longitude),i});return i.sort(function(t,e){return t.distance-e.distance}),i}return this.shops},filterShops:function(){var t=this;return this.searchShop?this.sortedShopsWithDistance.filter(function(e){return e.shopName.includes(t.searchShop)}):this.sortedShopsWithDistance},currentShop:function(){return this.sortedShopsWithDistance[0]},myShops:function(){return this.sortedShopsWithDistance.slice(1,3)},nearbyShops:function(){return this.filterShops.slice(0,this.nearbyShopsLength)}},methods:{handleScroll:ne.a.debounce(function(){var t=this.$refs.currentShop.scrollTop,e=this.$refs.currentShop.clientHeight,s=this.$refs.currentShop.scrollHeight,i=s<=e+t;i&&(this.nearbyShopsLength+=6)},150),getShopList:function(){var t=this.$route.params.shopUseFlg,e=this.$route.params.shopid,s=gt.getRegionBlockCode(),i=0===t;if(i){var n=this.$store.getters["shop/shopsAvailableForRegion"](s);this.shops=n?this.$store.getters["shop/shopsForRegion"](s):[]}else{var a=this.$store.state.shop.shops[s];this.shops=ne.a.intersectionWith(a,e,function(t,e){return t.shopId===e})}},fetchOftenShoplist:function(){var t=this,e=gt.getRegionBlockCode();Rt.show(),vt.shop.fetchOftenShoplist({regionBlockCode:e}).then(function(e){t.oftenShops=e.data.data.slice(0,2),Rt.hide()})},setCurrentAddress:function(){var t=this;this.currentAddress=null,ht.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i},ze.getAddressByLatLng(s,i).then(function(e){t.currentAddress=e.address})})}}},nd=id,ad=(s("11f9"),Object(_["a"])(nd,Ql,Kl,!1,null,"1eeabde6",null)),od=ad.exports,cd=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"location-picker"},[s("iframe",{ref:"locationPicker",attrs:{width:"100%",height:"100%",frameborder:"0",src:"https://apis.map.qq.com/tools/locpicker?type=1&policy=1&key=QVPBZ-YBMHV-KYMPX-UIXW2-7AM7Z-BNFNU&referer=locator"}})])},rd=[],ld={data:function(){return{chosenAddressName:null}},created:function(){var t=this;ze.init().then(function(){t.initQQMapLocationPicker()})},methods:{initQQMapLocationPicker:function(){window.addEventListener("message",this.handleLocationChange,!1)},handleLocationChange:function(t){var e=this,s=t.data;if(s&&"locationPicker"==s.module){var i="我的位置"===s.poiname;i?ze.getAddressByLatLng(s.latlng.lat,s.latlng.lng).then(function(t){var s=t.nearPois[0];e.chosenAddressName=s,e.hideLocationPicker()}):(this.chosenAddressName=s.poiname,this.hideLocationPicker());var n=this.$store.state.campaignSendExchangeAddress.editAddressInfo,a=n.name,o=n.gender,c=n.phoneNumber,r=this.chosenAddressName,l=s.poiaddress,d=n.addressExtraInfo,p=n.addressId,u=n.tags,_={name:a,gender:o,phoneNumber:c,addressName:r,addressDetailName:l,addressExtraInfo:d,addressId:p,tags:u,latitude:s.latlng.lat,longitude:s.latlng.lng};this.$store.commit("campaignSendExchangeAddress/setEditAddressInfo",_),this.$router.back(),window.removeEventListener("message",this.handleLocationChange,!1)}},hideLocationPicker:function(){var t=this.$refs.locationPicker;t.focus(),t.blur(),window.removeEventListener("message",this.handleLocationChange,!1)}}},dd=ld,pd=(s("5269"),Object(_["a"])(dd,cd,rd,!1,null,"922e2b14",null)),ud=pd.exports,_d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"location-picker"},[s("iframe",{ref:"locationPicker",attrs:{width:"100%",height:"100%",frameborder:"0",src:"https://apis.map.qq.com/tools/locpicker?type=1&policy=1&key=QVPBZ-YBMHV-KYMPX-UIXW2-7AM7Z-BNFNU&referer=locator"}})])},md=[],hd={data:function(){return{chosenAddressName:null}},created:function(){this.initQQMapLocationPicker()},methods:{initQQMapLocationPicker:function(){window.addEventListener("message",this.handleLocationChange,!1)},handleLocationChange:function(t){var e=this,s=t.data;if(s&&"locationPicker"==s.module){var i="我的位置"===s.poiname;i?qqLbsService.getAddressByLatLng(s.latlng.lat,s.latlng.lng).then(function(t){var s=t.nearPois[0];e.chosenAddressName=s,e.hideLocationPicker()}):(this.chosenAddressName=s.poiname,this.hideLocationPicker());var n=this.$store.state.campaignSendExchangeAddress.addAddressInfo,a=n.name,o=n.gender,c=n.phoneNumber,r=this.chosenAddressName,l=s.poiaddress,d=n.addressExtraInfo,p=n.tags,u={name:a,gender:o,phoneNumber:c,addressName:r,addressDetailName:l,addressExtraInfo:d,tags:p,latitude:s.latlng.lat,longitude:s.latlng.lng};this.$store.commit("campaignSendExchangeAddress/setAddAddressInfo",u),this.$router.back()}},hideLocationPicker:function(){var t=this.$refs.locationPicker;t.focus(),t.blur(),window.removeEventListener("message",this.handleLocationChange,!1)}}},gd=hd,vd=(s("81e0"),Object(_["a"])(gd,_d,md,!1,null,"62cdb60c",null)),fd=vd.exports,Cd=[{path:"/campaign-list-view",name:"campaign-list-view",component:fc,meta:{title:"集点列表"}},{path:"/campaign-detail/:campaignId",name:"campaign-detail",component:Ar,meta:{title:"集点详情"}},{path:"/campaign-products/:campaignId",name:"campaign-products",component:Mr,meta:{title:"集点商品"}},{path:"/campaign-post-exchange",name:"campaign-post-exchange",component:jr,meta:{title:"集点兑换"}},{path:"/campaign-post-exchange/choose-address",name:"campaign-post-exchange/choose-address",component:Jr,meta:{title:"选择地址"}},{path:"/campaign-post-exchange/add-address",name:"campaign-post-exchange/add-address",component:al,meta:{title:"新增地址"}},{path:"/campaign-post-exchange/edit-address",name:"campaign-post-exchange/edit-address",component:pl,meta:{title:"编辑地址"}},{path:"/campaign-post-exchange/add-address/location-picker",name:"campaign-post-exchange/add-address/location-picker",component:vl,meta:{title:"新增地址"}},{path:"/campaign-post-exchange/edit-address/location-picker",name:"campaign-post-exchange/edit-address/location-picker",component:Sl,meta:{title:"编辑地址"}},{path:"/campaign-send-address/:campaignId",name:"campaign-express-address",component:Fl,meta:{title:"寄送地址"}},{path:"/campaign-post-exchanged",name:"campaign-post-exchanged",component:qr,meta:{title:"已兑换"}},{path:"/campaign-send-choose-address/:userGiftId",name:"campaign-choose-address",component:Nl,meta:{title:"选择地址"}},{path:"/campaign-Available-shop-list",name:"campaign-Available-shop-list",component:od,meta:{title:"适用门店"}},{path:"/campaign-send-exchange/add-address",name:"campaign-send-exchange/add-address",component:Hl,meta:{title:"编辑地址"}},{path:"/campaign-send-exchange/edit-address",name:"campaign-send-exchange/edit-address",component:Yl,meta:{title:"编辑地址"}},{path:"/campaign-send-exchange/edit-address/location-picker",name:"campaign-send-exchange/edit-address/location-picker",component:ud,meta:{title:"编辑地址"}},{path:"/campaign-send-exchange/add-address/location-picker",name:"campaign-send-exchange/add-address/location-picker",component:fd,meta:{title:"新增地址"}}],yd=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null===t.missions?s("div",{staticClass:"mission-center-loading"}):s("div",{staticClass:"mission-center"},[s("div",{staticClass:"mission-center__content"},[s("div",{staticClass:"mission-center__content__background"}),s("div",{staticClass:"mission-center__content__rule",on:{click:t.gotoRule}},[s("span",{staticClass:"mission-center__content__rule__text"},[t._v("活动规则")]),s("span",{staticClass:"mission-center__content__rule__question-mark"})]),null!==t.userGroupInfo?s("div",{staticClass:"mission-center__content__misc"},[s("div",{staticClass:"mission-center__content__misc__avatar"},[s("img",{attrs:{src:t.avatarUrl}})]),s("div",{staticClass:"mission-center__content__misc__checkin-count"},[s("p",{staticClass:"mission-center__content__misc__checkin-count__number"},[t._v(t._s(t.userGroupInfo.continusDays))]),s("p",{staticClass:"mission-center__content__misc__checkin-count__title"},[t._v("签到")])]),s("div",{staticClass:"mission-center__content__misc__lottery-coin-count"},[s("p",{staticClass:"mission-center__content__misc__lottery-coin-count__number"},[t._v(t._s(t.userGroupInfo.ticketNum))]),s("p",{staticClass:"mission-center__content__misc__lottery-coin-count__title"},[t._v("抽奖币")])]),s("div",{staticClass:"mission-center__content__misc__go-to-lottery"},[s("button",{staticClass:"mission-center__content__misc__go-to-lottery__button",on:{click:t.gotoLottery}},[t._v("去抽奖")])])]):t._e(),null!==t.missions?s("div",{staticClass:"mission-center__content__weekly-missions"},[s("div",{staticClass:"mission-center__content__weekly-missions__title"}),s("div",{staticClass:"mission-center__content__weekly-missions__come-to-shop-mission"},[s("come-to-shop-mission",{attrs:{mission:t.comeToShopMission}})],1),s("div",{staticClass:"mission-center__content__weekly-missions__purchase-amount-mission"},[s("purchase-amount-mission",{attrs:{mission:t.purchaseAmountMission}})],1)]):t._e(),null!==t.missions?s("div",{staticClass:"mission-center__content__other-missions"},[s("div",{staticClass:"mission-center__content__other-missions__title"}),t._l(t.otherMissions,function(t){return s("div",{staticClass:"mission-center__content__other-missions__mission-item"},[s("other-mission",{attrs:{mission:t}})],1)})],2):t._e(),s("div",{staticClass:"mission-center__content__data-refresh-hint"},[t._v("数据可能会有延迟，24小时内更新")])]),s("transition",{attrs:{name:"fade"}},[null!==t.pickedResult?s("div",{staticClass:"mission-center__pick-result-modal"},[s("div",{staticClass:"mission-center__pick-result-modal__icon"}),s("p",{staticClass:"mission-center__pick-result-modal__text"},[t._v("任务已完成")]),s("p",{staticClass:"mission-center__pick-result-modal__text"},[t._v(t._s(t.pickedResultText))])]):t._e()])],1)},bd=[],wd=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"other-mission"},[s("div",{staticClass:"other-mission__icon"},[s("img",{attrs:{src:t.missionIconUrl}})]),s("div",{staticClass:"other-mission__info"},[s("div",{staticClass:"other-mission__info__title-and-reward"},[s("span",{staticClass:"other-mission__info__title-and-reward__title"},[t._v(t._s(t.mission.missionName))]),"point"===t.missionRewardType?s("span",{staticClass:"other-mission__info__title-and-reward__reward"},[t._v("+"+t._s(t.mission.lotteryPoint)+"积分")]):"coupon"===t.missionRewardType?s("span",{staticClass:"other-mission__info__title-and-reward__reward"},[t._v("+1礼券")]):"lotteryCoin"===t.missionRewardType?s("span",{staticClass:"other-mission__info__title-and-reward__reward"},[t._v("+"+t._s(t.mission.lotteryTicketNum)+"抽奖币")]):t._e()]),s("div",{staticClass:"other-mission__info__description"},[t._v(t._s(t.mission.missionContent))])]),s("div",{staticClass:"other-mission__right"},[2===t.mission.receiveFlg&&"firstRedeemPoint"!==t.missionType&&"firstPurchaseDiscountCommodity"!==t.missionType?s("button",{on:{click:t.gotoMission}},[t._v("去完成")]):1===t.mission.receiveFlg?s("div",[t._v("已达成")]):t._e()])])},Sd=[],Dd={getMissionType:function(t){return 0===t.missionType?"comeToShopWeekly":1===t.missionType?"comeToShopMonthly":2===t.missionType?"purchaseAmountWeekly":3===t.missionType?"purchaseAmountMonthly":4===t.missionType?"firstGotStamp":5===t.missionType?"firstGotCampaignReward":6===t.missionType?"firstPurchaseAnyCommodity":7===t.missionType?"firstPurchaseDiscountCommodity":8===t.missionType?"firstRedeemPoint":9===t.missionType?"firstPurchaseAnyCommodityByNewUser":void 0},getMissionRewardType:function(t){return 0===t.lotteryType?"point":1===t.lotteryType?"coupon":2===t.lotteryType?"lotteryCoin":void 0},getMissionIconUrl:function(t){var e="http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new";return 4===t.missionType?e+"/mission-center/head.png":5===t.missionType?e+"/mission-center/coupon.png":6===t.missionType?e+"/mission-center/shopping-bag.png":7===t.missionType?e+"/mission-center/diamond.png":8===t.missionType?e+"/mission-center/exchange.png":9===t.missionType?e+"/mission-center/shopping-bag.png":void 0},getGotoMissionHandler:function(t){return 4===t.missionType?function(){return console.log("去集点")}:5===t.missionType?function(){return console.log("去兑换集点")}:6===t.missionType?function(){return console.log("去预约购买")}:7===t.missionType?function(){return console.log("去会员价格商品")}:8===t.missionType?function(){return console.log("去积分商城")}:9===t.missionType?function(){return console.log("去会员价格商品")}:void 0}},kd={props:{mission:Object},computed:{missionIconUrl:function(){return Dd.getMissionIconUrl(this.mission)},missionRewardType:function(){return Dd.getMissionRewardType(this.mission)},missionType:function(){return Dd.getMissionType(this.mission)}},methods:{gotoMission:function(){var t=this.missionType;switch(t){case"firstGotStamp":this.gotoCampaign();break;case"firstGotCampaignReward":this.gotoCampaign();break;case"firstPurchaseAnyCommodity":this.backToHomepage();break;case"firstPurchaseAnyCommodityByNewUser":this.backToHomepage();break;default:throw"unknown mission type"}},gotoCampaign:function(){this.$router.push("/campaign-list-view")},backToHomepage:function(){wx.miniProgram.switchTab({url:"/pages/homepage/homepage"})}}},Td=kd,xd=(s("79e50"),Object(_["a"])(Td,wd,Sd,!1,null,"07d891f6",null)),Ad=xd.exports,Id=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"come-to-shop-mission"},[s("div",{staticClass:"come-to-shop-mission__corner-circle"}),s("div",{staticClass:"come-to-shop-mission__corner-icon"}),1===t.mission.receiveFlg?s("div",{staticClass:"come-to-shop-mission__before-mission-complete-hint"},[t._v("已成功领取奖励 "+t._s(t.pickedType)+" "),s("span",[t._v(t._s(t.pickedCount))])]):s("div",{staticClass:"come-to-shop-mission__before-mission-complete-hint"},[t._v("还差到店 "),s("span",[t._v(t._s(t.beforeMissionCompleteComeToShopCount))]),t._v(" 次即可领取奖励，加油~")]),s("div",{staticClass:"come-to-shop-mission__requirement-hint"},[t._v("本周到店达到"+t._s(t.mission.visitsNumber)+"次即可获得奖励")]),s("div",{staticClass:"come-to-shop-mission__progress-bar"},[s("mission-progress-bar-discrete",{attrs:{total:t.mission.visitsNumber,current:t.mission.userComeShopTimes}})],1)])},Nd=[],Ld=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mission-progress-bar-discrete"},[s("div",{staticClass:"mission-progress-bar-discrete__sections"},[s("div",{staticClass:"mission-progress-bar-discrete__sections__complete",style:{"flex-grow":t.current}}),s("div",{staticClass:"mission-progress-bar-discrete__sections__incomplete",style:{"flex-grow":t.left}})]),s("div",{staticClass:"mission-progress-bar-discrete__milestones"},[t._l(t.total,function(e){return[e-1<=t.current?s("div",{staticClass:"mission-progress-bar-discrete__milestones__milestone complete"},[t._v(t._s(e-1))]):s("div",{staticClass:"mission-progress-bar-discrete__milestones__milestone"},[t._v(t._s(e-1))])]}),s("div",{staticClass:"mission-progress-bar-discrete__milestones__end",class:{"with-check":t.current===t.total}})],2)])},Pd=[],Ed={props:{total:Number,current:Number},computed:{left:function(){return this.total-this.current}}},Md=Ed,$d=(s("41fa"),Object(_["a"])(Md,Ld,Pd,!1,null,"49449fee",null)),Fd=$d.exports,Od={components:{MissionProgressBarDiscrete:Fd},props:{mission:Object},computed:{beforeMissionCompleteComeToShopCount:function(){return this.mission.visitsNumber-this.mission.userComeShopTimes},pickedType:function(){var t=Dd.getMissionRewardType(this.mission);return"point"===t?"积分":"coupon"===t?"礼券":"lotteryCoin"===t?"抽奖币":void 0},pickedCount:function(){var t=Dd.getMissionRewardType(this.mission);return"point"===t?"+".concat(this.mission.lotteryPoint):"coupon"===t?"+1":"lotteryCoin"===t?"+".concat(this.mission.lotteryTicketNum):void 0}}},Rd=Od,Bd=(s("a087"),Object(_["a"])(Rd,Id,Nd,!1,null,"59827885",null)),Ud=Bd.exports,jd=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"purchase-amount-mission"},[s("div",{staticClass:"purchase-amount-mission__corner-circle"}),s("div",{staticClass:"purchase-amount-mission__corner-icon"}),1===t.mission.receiveFlg?s("div",{staticClass:"purchase-amount-mission__before-mission-complete-hint"},[t._v("已成功领取奖励 "+t._s(t.pickedType)+" "),s("span",[t._v(t._s(t.pickedCount))])]):s("div",{staticClass:"purchase-amount-mission__before-mission-complete-hint"},[t._v("还差消费 "),s("span",[t._v(t._s(t.beforeMissionCompletePurchaseAmount))]),t._v(" 元即可领取奖励，加油~")]),s("div",{staticClass:"purchase-amount-mission__requirement-hint"},[t._v("本周消费"+t._s(t.mission.visitsConsumptionAmount)+"元即可获得奖励")]),s("div",{staticClass:"purchase-amount-mission__progress-bar"},[s("mission-progress-bar",{attrs:{total:t.mission.visitsConsumptionAmount,current:t.mission.userPurchaseAmount}})],1)])},Hd=[],Wd=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mission-progress-bar"},[s("div",{staticClass:"mission-progress-bar__sections"},[s("div",{staticClass:"mission-progress-bar__sections__complete",style:{"flex-grow":t.current}}),s("div",{staticClass:"mission-progress-bar__sections__incomplete",style:{"flex-grow":t.left}})]),s("div",{staticClass:"mission-progress-bar__milestones"},[s("div",{staticClass:"mission-progress-bar__milestones__milestone complete"},[t._v("0")]),s("div",{staticClass:"mission-progress-bar__milestones__end",class:{"with-check":t.current===t.total}})]),t.current!==t.total?s("div",{staticClass:"mission-progress-bar__current-milestone",style:{left:t.current/t.total*100+"%"}},[s("div",[t._v(t._s(t.current))])]):t._e()])},Gd=[],zd={props:{total:Number,current:Number},computed:{left:function(){return this.total-this.current}}},Vd=zd,qd=(s("a203"),Object(_["a"])(Vd,Wd,Gd,!1,null,"74874d43",null)),Yd=qd.exports,Qd={components:{MissionProgressBar:Yd},props:{mission:Object},computed:{beforeMissionCompletePurchaseAmount:function(){return this.mission.visitsConsumptionAmount-this.mission.userPurchaseAmount},pickedType:function(){var t=Dd.getMissionRewardType(this.mission);return"point"===t?"积分":"coupon"===t?"礼券":"lotteryCoin"===t?"抽奖币":void 0},pickedCount:function(){var t=Dd.getMissionRewardType(this.mission);return"point"===t?"+".concat(this.mission.lotteryPoint):"coupon"===t?"+1":"lotteryCoin"===t?"+".concat(this.mission.lotteryTicketNum):void 0}}},Kd=Qd,Xd=(s("8e19"),Object(_["a"])(Kd,jd,Hd,!1,null,"49680306",null)),Zd=Xd.exports,Jd={components:{OtherMission:Ad,ComeToShopMission:Ud,PurchaseAmountMission:Zd},data:function(){return{missions:null,userGroupInfo:null,avatarUrl:gt.getUserInfo().basic.photo,pickedResult:null}},computed:{comeToShopMission:function(){return this.missions.find(function(t){return"comeToShopWeekly"===Dd.getMissionType(t)})},purchaseAmountMission:function(){return this.missions.find(function(t){return"purchaseAmountWeekly"===Dd.getMissionType(t)})},otherMissions:function(){return this.missions.filter(function(t){var e=["comeToShopWeekly","purchaseAmountWeekly","comeToShopMonthly","purchaseAmountMonthly"],s=Dd.getMissionType(t);return e.indexOf(s)<0})},pickedResultText:function(){var t=Dd.getMissionRewardType(this.pickedResult);return"point"===t?"积分+".concat(this.pickedResult.lotteryPoint):"coupon"===t?"礼券+1":"lotteryCoin"===t?"抽奖币+".concat(this.pickedResult.lotteryTicketNum):void 0}},methods:{gotoRule:function(){this.$router.push("/mission-center/rule")},gotoLottery:function(){this.$router.replace("/lottery")},fetchUserGroupInfo:function(){var t=this,e=gt.getRegionBlockCode();vt.user.fetchUserGroupInfo({regionBlockCode:e}).then(function(e){t.userGroupInfo=e})}},created:function(){var t=this,e=gt.getRegionBlockCode();this.fetchUserGroupInfo(),vt.mission.fetchMissions({regionBlockCode:e}).then(function(){var s=Object(w["a"])(regeneratorRuntime.mark(function s(i){var n,a,o,c,r;return regeneratorRuntime.wrap(function(s){while(1)switch(s.prev=s.next){case 0:if(t.missions=i,n=t.missions.filter(function(t){return 0===t.receiveFlg}),!(n.length>0)){s.next=19;break}a=0;case 4:if(!(a<n.length)){s.next=18;break}return o=n[a],s.next=8,vt.mission.pickReward({missionHistoryId:o.missionHistoryId});case 8:return c=s.sent,t.pickedResult=c,t.fetchUserGroupInfo(),r=new b.a(function(t){setTimeout(function(){t()},3e3)}),s.next=14,r;case 14:t.pickedResult=null;case 15:a++,s.next=4;break;case 18:vt.mission.fetchMissions({regionBlockCode:e}).then(function(e){t.missions=e});case 19:case"end":return s.stop()}},s)}));return function(t){return s.apply(this,arguments)}}())}},tp=Jd,ep=(s("2dbc"),Object(_["a"])(tp,yd,bd,!1,null,"dec08b8c",null)),sp=ep.exports,ip=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},np=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rule"},[s("p",[t._v("1. 活动时间：2018年1月25日—2018年2月9日（在活动时间内，活动资源送完则活动自动结束）；")]),s("p",[t._v("2. 参与方式：在“浙江移动”微信公众号中回复“福袋”关键字；")]),s("p",[t._v("3. 活动规则：用户在活动期间参与活动，可通过本人参与、受邀、邀请好友三种方式参与活动，每个手机号累计最多获得11个福袋。")]),s("p",[t._v("（1）首次发起邀请成功，无论对方是否接受邀请，发起人均可获得1个福袋。")]),s("p",[t._v("（2）每次被邀请人接受邀请，发起人和被邀请人双方各自可获得1个福袋。双方可互相邀请，均可以发起人和被发起人的身份各自获得1个福袋，但一方重复接受另一方的邀请，只为双方赠送1个福袋。")]),s("p",[t._v("同一被邀请人接受多个发起人的邀请，均可获赠福袋，但单个手机号码累计获得以11个福袋为上限，之后再发起或接受邀请均不再享受。")])])}],ap={},op=ap,cp=(s("f948"),Object(_["a"])(op,ip,np,!1,null,"5643598a",null)),rp=cp.exports,lp=[{path:"/mission-center",name:"mission-center",component:sp,meta:{title:"任务中心"}},{path:"/mission-center/rule",name:"mission-center/rule",component:rp,meta:{title:"活动规则"}}],dp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lottery"},[s("div",{staticClass:"lottery__gachapon"},[s("div",{staticClass:"lottery__gachapon__background"}),s("div",{staticClass:"lottery__gachapon__logo",style:{"background-image":"url("+t.logoImgUrl+")"}}),s("div",{staticClass:"lottery__gachapon__capsules"},[null!==t.capsules&&null!==t.capsulePhysicsInfo?s("div",{staticClass:"lottery__gachapon__capsules__wrapper"},t._l(t.capsules,function(e,i){return s("capsule",{key:i,attrs:{capsule:e,x:t.capsulePhysicsInfo[i].x,y:t.capsulePhysicsInfo[i].y,r:t.capsulePhysicsInfo[i].r}})}),1):t._e()]),s("div",{staticClass:"lottery__gachapon__collected-count"},[t._v(t._s(t.collectedCapsulesCount))]),null!==t.collectedCapsules?s("div",{staticClass:"lottery__gachapon__collected"},t._l(t.collectedCapsules,function(t){return s("div",{staticClass:"lottery__gachapon__collected__capsule",class:t.color})}),0):t._e(),s("div",{staticClass:"lottery__gachapon__goto-collected",on:{click:t.gotoCollected}}),t._m(0),null!==t.droppedCapsule?s("div",{staticClass:"lottery__gachapon__dropped-capsule",class:t.droppedCapsule.color}):t.tryDroppedCapsuleVisible?s("div",{staticClass:"lottery__gachapon__try-dropped-capsule blue"}):t._e(),t.isFetchingResult?s("div",{staticClass:"lottery__gachapon__knob rotating"}):t.isFetchingLotteryDetail?s("div",{staticClass:"lottery__gachapon__knob"}):s("div",{staticClass:"lottery__gachapon__knob",on:{click:t.startGachapon}}),s("div",{staticClass:"lottery__gachapon__current-mode-selection-wrapper",style:{left:t.currentModeSelectionWrapperLeft}}),s("div",{staticClass:"lottery__gachapon__mode try",on:{click:t.useModeTry}},[s("p",{staticClass:"lottery__gachapon__mode__title try",class:{selected:"try"===t.currentMode}},[t._v("试一试")]),s("p",{staticClass:"lottery__gachapon__mode__subtitle try",class:{selected:"try"===t.currentMode}},[t._v("免费试手气")])]),s("div",{staticClass:"lottery__gachapon__mode once",on:{click:t.useModeOnce}},[s("p",{staticClass:"lottery__gachapon__mode__title once",class:{selected:"once"===t.currentMode}},[t._v("扭一次")]),s("p",{staticClass:"lottery__gachapon__mode__subtitle once",class:{selected:"once"===t.currentMode}},[t._v(t._s(t.lotteryCoinForOneTrial)+"抽奖币")])]),s("div",{staticClass:"lottery__gachapon__mode three-times",on:{click:t.useModeThreeTimes}},[s("p",{staticClass:"lottery__gachapon__mode__title three-times",class:{selected:"threeTimes"===t.currentMode}},[t._v("扭三次")]),s("p",{staticClass:"lottery__gachapon__mode__subtitle three-times",class:{selected:"threeTimes"===t.currentMode}},[t._v(t._s(3*t.lotteryCoinForOneTrial)+"抽奖币")])]),s("div",{staticClass:"lottery__gachapon__goto-mission-center",on:{click:t.gotoMissionCenter}}),s("div",{staticClass:"lottery__gachapon__lottery-coin-count"},[t._v(t._s(t.lotteryCoinCount))])]),s("div",{staticClass:"lottery__rules"},[s("div",{staticClass:"lottery__rules__wrapper"},[t._m(1),s("p",{staticClass:"lottery__rules__wrapper__rule"},[t._v("❶ 每次抽奖都消耗"+t._s(t.lotteryCoinForOneTrial)+"枚抽奖币，每个用户每天最多抽奖"+t._s(t.maxLotteryTimeForOneDay)+"次")]),s("p",{staticClass:"lottery__rules__wrapper__rule"},[t._v("❷ 每次扭蛋都可以获得一个随机颜色的蛋壳，蛋壳颜色共3种")]),t._m(2),t._m(3),t._m(4)])]),t.gachaponResultVisible?s("div",{staticClass:"lottery__result-modal"},[s("div",{staticClass:"lottery__result-modal__mask"}),s("div",{staticClass:"lottery__result-modal__spark-left"}),s("div",{staticClass:"lottery__result-modal__spark-right"}),s("div",{staticClass:"lottery__result-modal__opened-capsule-right",class:t.droppedCapsule.color}),s("div",{staticClass:"lottery__result-modal__opened-capsule-left",class:t.droppedCapsule.color}),s("div",{staticClass:"lottery__result-modal__wrapper"},[null===t.droppedCapsule.reward?s("div",{staticClass:"lottery__result-modal__wrapper__reward-icon empty"}):s("div",{staticClass:"lottery__result-modal__wrapper__reward-icon",class:t.droppedCapsule.reward.type}),null===t.droppedCapsule.reward?s("div",{staticClass:"lottery__result-modal__wrapper__reward-title"},[t._v("这个扭蛋是空的")]):"coupon"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-title"},[t._v(t._s(t.droppedCapsule.reward.title))]):"point"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-title"},[t._v("赠送积分 "),s("span",[t._v("+"+t._s(t.droppedCapsule.reward.pointCount))])]):"lotteryCoin"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-title"},[t._v("赠送抽奖币 "),s("span",[t._v("+"+t._s(t.droppedCapsule.reward.lotteryCoinCount))])]):t._e(),null===t.droppedCapsule.reward?s("div",{staticClass:"lottery__result-modal__wrapper__reward-subtitle"},[t._v("加油，说不定下一次就是大奖哦")]):"coupon"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-subtitle"},[t._v("详情可至“优惠券”查看")]):"point"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-subtitle"},[t._v("请下载并安装APP，可至我的查看")]):"lotteryCoin"===t.droppedCapsule.reward.type?s("div",{staticClass:"lottery__result-modal__wrapper__reward-subtitle"},[t._v("已经收入你的帐户，可至任务中心查看")]):t._e()]),t.trialLeft>0?s("button",{staticClass:"lottery__result-modal__try-again",on:{click:t.continueGachapon}},[t._v("继续")]):s("button",{staticClass:"lottery__result-modal__try-again",on:{click:t.hideGachaponResult}},[t._v("去扭蛋")])]):t.gachaponTryResultVisible?s("div",{staticClass:"lottery__try-result-modal"},[s("div",{staticClass:"lottery__try-result-modal__mask"}),s("div",{staticClass:"lottery__try-result-modal__spark-left"}),s("div",{staticClass:"lottery__try-result-modal__spark-right"}),s("div",{staticClass:"lottery__try-result-modal__opened-capsule-right blue"}),s("div",{staticClass:"lottery__try-result-modal__opened-capsule-left blue"}),t._m(5),s("button",{staticClass:"lottery__result-modal__try-again",on:{click:t.hideGachaponTryResult}},[t._v("去扭蛋")])]):t._e(),t.lotteryCoinNotEnoughModalVisible?s("div",{staticClass:"lottery__lottery-coin-not-enough-modal"},[s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__mask"}),s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__wrapper"},[s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__wrapper__close",on:{click:t.hideLotteryCoinNotEnoughModal}}),s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__wrapper__icon"}),s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__wrapper__title"},[t._v("余额不足")]),s("div",{staticClass:"lottery__lottery-coin-not-enough-modal__wrapper__subtitle"},[t._v("剩余："+t._s(t.lotteryCoinCount)+"抽奖币")])]),s("button",{staticClass:"lottery__lottery-coin-not-enough-modal__get-lottery-coin",on:{click:t.getLotteryCoin}},[t._v("获取抽奖币")])]):t._e()])},pp=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lottery__gachapon__broadcast"},[s("div",[s("span",[t._v("133****0000获得草莓8折券一张🎉")]),s("span",[t._v("138****0000获得草莓7折券一张🎉")]),s("span",[t._v("139****0000获得草莓6折券一张🎉")]),s("span",[t._v("131****0000获得草莓5折券一张🎉")]),s("span",[t._v("135****0000获得草莓4折券一张🎉")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"lottery__rules__wrapper__title"},[s("span",{staticClass:"lottery__rules__wrapper__title__left-bar"}),s("span",{staticClass:"lottery__rules__wrapper__title__text"},[t._v("游戏说明")]),s("span",{staticClass:"lottery__rules__wrapper__title__right-bar"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"lottery__rules__wrapper__capsule-intro"},[s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__capsule red"}),s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__text"},[t._v("红色扭蛋 会随机出现优惠券")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"lottery__rules__wrapper__capsule-intro"},[s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__capsule blue"}),s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__text"},[t._v("蓝色扭蛋 会随机出现会员积分")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",{staticClass:"lottery__rules__wrapper__capsule-intro"},[s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__capsule yellow"}),s("span",{staticClass:"lottery__rules__wrapper__capsule-intro__text"},[t._v("黄色扭蛋 会随机出现抽奖币")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"lottery__try-result-modal__wrapper"},[s("div",{staticClass:"lottery__try-result-modal__wrapper__reward-icon try-success"}),s("div",{staticClass:"lottery__try-result-modal__wrapper__reward-title"},[t._v("免费尝试成功")]),s("div",{staticClass:"lottery__try-result-modal__wrapper__reward-subtitle"},[t._v("马上去实践吧，试试运气呦~~")])])}],up=s("b8bf"),_p={namespaced:!0,state:{collectedCapsules:[]},getters:{collectedCapsulesCount:function(t){return t.collectedCapsules.length},collectedCapsulesFirstThree:function(t){return t.collectedCapsules.slice(0,3)}},mutations:{resetCollectedCapsules:function(t){t.collectedCapsules=[]},addCollectedCapsule:function(t,e){t.collectedCapsules.push(e)}}},mp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"capsule",class:t.capsule.color,style:t.transforms},[t.capsule.logo?s("img",{staticClass:"capsule__logo",attrs:{src:t.capsule.logo}}):t._e()])},hp=[],gp={props:{capsule:Object,x:Number,y:Number,r:Number},computed:{transforms:function(){return{left:100*this.x+"%",top:100*this.y+"%",transform:"rotate(".concat(this.r,"rad)")}}}},vp=gp,fp=(s("6d4b"),Object(_["a"])(vp,mp,hp,!1,null,"fb1e3faa",null)),Cp=fp.exports,yp={components:{Capsule:Cp},data:function(){return{logoImgUrl:null,lotteryCoinCount:null,lotteryId:null,lotteryCoinForOneTrial:null,maxLotteryTimeForOneDay:null,currentMode:"try",trialLeft:0,isFetchingResult:!1,capsules:null,lotteryHistory:null,gachaponResultVisible:!1,gachaponTryResultVisible:!1,lotteryCoinNotEnoughModalVisible:!1,droppedCapsule:null,tryDroppedCapsuleVisible:!1,capsulePhysicsInfo:null,circles:[]}},computed:{currentModeSelectionWrapperLeft:function(){return"try"===this.currentMode?"18vw":"once"===this.currentMode?"39vw":"threeTimes"===this.currentMode?"60vw":void 0},isFetchingLotteryDetail:function(){return null===this.lotteryId},collectedCapsules:function(){return this.$store.getters["lottery/collectedCapsulesFirstThree"]},collectedCapsulesCount:function(){return this.$store.getters["lottery/collectedCapsulesCount"]}},methods:{gotoCollected:function(){this.$router.push("/lottery/collected")},gotoMissionCenter:function(){this.$router.replace("/mission-center")},useModeTry:function(){this.currentMode="try"},useModeOnce:function(){this.currentMode="once"},useModeThreeTimes:function(){this.currentMode="threeTimes"},getLotteryCoin:function(){this.lotteryCoinNotEnoughModalVisible=!1,this.$router.replace("/mission-center")},startGachapon:function(){"try"===this.currentMode?(this.trialLeft=0,this.startGachaponForTry()):"once"===this.currentMode?this.lotteryCoinCount>=this.lotteryCoinForOneTrial?(this.trialLeft=0,this.startGachaponForOnce()):this.showLotteryCoinNotEnoughModal():"threeTimes"===this.currentMode&&(this.lotteryCoinCount>=3*this.lotteryCoinForOneTrial?(this.trialLeft=2,this.startGachaponForOnce()):this.showLotteryCoinNotEnoughModal())},startGachaponForTry:function(){var t=this;this.isFetchingResult=!0;var e=setInterval(function(){t.circles.forEach(function(t){up["Body"].applyForce(t,t.position,up["Vector"].create(0,-.002))})},500);setTimeout(function(){clearInterval(e),t.isFetchingResult=!1,t.showGachaponTryResult()},3e3)},startGachaponForOnce:function(){var t=this;this.isFetchingResult=!0;var e=setInterval(function(){t.circles.forEach(function(t){up["Body"].applyForce(t,t.position,up["Vector"].create(0,-.002))})},500);this.fetchGachaponResult().then(function(s){clearInterval(e),t.isFetchingResult=!1,t.$store.commit("lottery/addCollectedCapsule",s),t.showGachaponResult(s)}).catch(function(s){clearInterval(e),t.isFetchingResult=!1,"reachMaxLotteryTimeForOneDay"===s?Fe.alert({msg:"今日抽奖次数已达上限，明天再来哦"}):"rewardNoRemaining"===s&&Fe.alert({msg:"奖品发光了，下次早点来哦"})})},continueGachapon:function(){this.fetchLotteryDetail(),this.hideGachaponResult(),this.trialLeft--,this.startGachaponForOnce()},showGachaponResult:function(t){this.droppedCapsule=t,this.gachaponResultVisible=!0},showGachaponTryResult:function(){this.tryDroppedCapsuleVisible=!0,this.gachaponTryResultVisible=!0},hideGachaponResult:function(){this.fetchLotteryDetail(),this.gachaponResultVisible=!1,this.droppedCapsule=null},hideGachaponTryResult:function(){this.tryDroppedCapsuleVisible=!1,this.gachaponTryResultVisible=!1},showLotteryCoinNotEnoughModal:function(){this.lotteryCoinNotEnoughModalVisible=!0},hideLotteryCoinNotEnoughModal:function(){this.lotteryCoinNotEnoughModalVisible=!1},getCapsulesWithLogos:function(t){for(var e=["yellow","blue","red"],s=10,i=[],n=0;n<s;n++){var a={color:ne.a.sample(e),logo:ne.a.sample(t)};i.push(a)}return i},getCollectedCapsules:function(t){return t.filter(function(t){var e=[0,1,2],s=e.indexOf(t.lotteryType)>-1;return s}).map(function(t){var e=function(){return 0===t.lotteryType?"point":1===t.lotteryType?"coupon":2===t.lotteryType?"lotteryCoin":void 0}();return"point"===e?{color:"blue"}:"coupon"===e?{color:"red"}:"lotteryCoin"===e?{color:"yellow"}:void 0})},fetchLotteryDetail:function(){var t=this;return new b.a(function(e,s){var i=gt.getRegionBlockCode();vt.lottery.fetchLotteryDetail({regionBlockCode:i}).then(function(s){t.lotteryId=s.lotteryId,t.lotteryCoinCount=s.userTicketNum,t.lotteryCoinForOneTrial=s.lotteryCouponCount,t.maxLotteryTimeForOneDay=s.lotteryTimes,t.logoImgUrl=s.bigLogo,t.capsules=t.getCapsulesWithLogos(s.smallLogoArr),e()})})},fetchGachaponResult:function(){var t=this;return new b.a(function(e,s){var i=gt.getRegionBlockCode();vt.lottery.startLottery({lotteryId:t.lotteryId,regionBlockCode:i}).then(function(t){var s=3===t.lotteryType;if(s)e({color:"blue",reward:null});else{var i=function(){return 0===t.lotteryType?"point":1===t.lotteryType?"coupon":2===t.lotteryType?"lotteryCoin":void 0}();"point"===i?e({color:"blue",reward:{type:"point",pointCount:t.lotteryNum}}):"coupon"===i?e({color:"red",reward:{type:"coupon",title:t.lotteryName}}):"lotteryCoin"===i&&e({color:"yellow",reward:{type:"lotteryCoin",lotteryCoinCount:t.lotteryNum}})}}).catch(function(t){var e="26004"===t.data.errors[0].code,i="26003"===t.data.errors[0].code;s(e?"rewardNoRemaining":i?"reachMaxLotteryTimeForOneDay":t)})})},createCapsulePhysicsWorld:function(){var t=up["Engine"].create();t.enableSleeping=!0;var e=up["Bodies"].rectangle(.5,22.5,1,45,{isStatic:!0}),s=up["Bodies"].rectangle(91.5,22.5,1,45,{isStatic:!0}),i=up["Bodies"].rectangle(46,44.5,92,1,{isStatic:!0}),n=up["Bodies"].rectangle(46,.5,92,1,{isStatic:!0});up["World"].add(t.world,[n,i,e,s]);for(var a=0;a<this.capsules.length;a++){var o=up["Bodies"].circle(92/this.capsules.length*(a%5)+7.5,10*(Math.floor(a/5)+1),7.5,{restitution:.99});up["World"].add(t.world,[o]),this.circles.push(o)}up["Engine"].run(t);var c=this;(function e(){window.requestAnimationFrame(e);var s=up["Composite"].allBodies(t.world),i=s.slice(4),n=i.map(function(t){return{x:(t.position.x-7.5)/92,y:(t.position.y-7.5)/45,r:t.angle}});c.capsulePhysicsInfo=n})()}},created:function(){var t=this;Rt.show(),this.$store.state.lottery||(this.$store.registerModule("lottery",_p,{preserveState:!1}),this.$store.commit("lottery/resetCollectedCapsules")),this.fetchLotteryDetail().then(function(){Rt.hide(),t.createCapsulePhysicsWorld()})},beforeRouteLeave:function(t,e,s){"/lottery/collected"!==t.path&&this.$store.unregisterModule("lottery"),s()}},bp=yp,wp=(s("f0a7"),Object(_["a"])(bp,dp,pp,!1,null,"dc93c8fc",null)),Sp=wp.exports,Dp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.pickedCapsules?s("div",{staticClass:"picked"},[t.pickedCapsules.length>0?s("div",{staticClass:"picked__capsules"},t._l(t.pickedCapsules,function(e){return s("div",{staticClass:"picked__capsule"},[s("div",{staticClass:"picked__capsule__capsule",class:e.color}),"coupon"===e.type?s("div",{staticClass:"picked__capsule__info"},[s("p",{staticClass:"picked__capsule__info__title"},[t._v(t._s(e.reward.couponName))]),s("p",{staticClass:"picked__capsule__info__subtitle"},[t._v("详情可至“优惠券”查看")])]):"point"===e.type?s("div",{staticClass:"picked__capsule__info"},[s("p",{staticClass:"picked__capsule__info__title"},[t._v("赠送积分+"+t._s(e.reward.lotteryPoint))]),s("p",{staticClass:"picked__capsule__info__subtitle"},[t._v("请下载并安装APP，可至我的查看")])]):"lotteryCoin"===e.type?s("div",{staticClass:"picked__capsule__info"},[s("p",{staticClass:"picked__capsule__info__title"},[t._v("赠送抽奖币+"+t._s(e.reward.lotteryTicketNum))]),s("p",{staticClass:"picked__capsule__info__subtitle"},[t._v("已经收入你的账户，可至任务中心查看")])]):t._e()])}),0):s("div",{staticClass:"picked__no-content"},[s("div",{staticClass:"picked__no-content__icon"}),s("div",{staticClass:"picked__no-content__text"},[t._v("暂无内容")])])]):t._e()},kp=[],Tp={data:function(){return{pickedCapsules:null}},methods:{getCollectedCapsules:function(t){return t.filter(function(t){var e=[0,1,2],s=e.indexOf(t.lotteryType)>-1;return s}).map(function(t){var e=function(){return 0===t.lotteryType?"point":1===t.lotteryType?"coupon":2===t.lotteryType?"lotteryCoin":void 0}();return"point"===e?{type:"point",color:"blue",reward:t}:"coupon"===e?{type:"coupon",color:"red",reward:t}:"lotteryCoin"===e?{type:"lotteryCoin",color:"yellow",reward:t}:void 0})}},created:function(){var t=this;Rt.show();var e=gt.getRegionBlockCode();vt.lottery.fetchLotteryHistory({regionBlockCode:e}).then(function(e){Rt.hide(),t.pickedCapsules=t.getCollectedCapsules(e)})}},xp=Tp,Ap=(s("e4c7"),Object(_["a"])(xp,Dp,kp,!1,null,"08c168ba",null)),Ip=Ap.exports,Np=[{path:"/lottery",name:"lottery",component:Sp,meta:{title:""}},{path:"/lottery/collected",name:"lottery/collected",component:Ip,meta:{title:"已领取奖品"}}],Lp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.talkTopicDetail?s("div",{staticClass:"talk-topic-detail"},[s("div",{staticClass:"talk-topic-detail__banner"},[s("img",{attrs:{src:t.talkTopicDetail.themeImage}})]),s("div",{staticClass:"talk-topic-detail__content"},[s("div",{staticClass:"talk-topic-detail__title"},[t._v(t._s(t.talkTopicDetail.subTitle))]),s("div",{staticClass:"talk-topic-detail__lookers-count"},[t._v(t._s(t.talkTopicDetail.onlookerCount)+"人围观")]),s("div",{staticClass:"talk-topic-detail__article",domProps:{innerHTML:t._s(t.talkTopicDetail.article)}})]),t.talkTopicDetail.commodityList.length>0?s("div",{staticClass:"talk-topic-detail__show-commodity-button",on:{click:function(e){t.commodityListPopupVisible=!0}}},[t._v("\n    商品("+t._s(t.talkTopicDetail.commodityList.length)+")\n  ")]):t._e(),t.commodityListPopupVisible?s("div",[s("commodity-list-popup",{attrs:{commodities:t.talkTopicDetail.commodityList},on:{close:function(e){t.commodityListPopupVisible=!1}}})],1):t._e(),s("goto-home")],1):t._e()},Pp=[],Ep=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"commodity-list-popup"},[s("div",{staticClass:"commodity-list-popup__mask"}),s("div",{staticClass:"commodity-list-popup__content"},[s("div",{ref:"header",staticClass:"commodity-list-popup__header"},[s("div",[t._v("文中商品")]),s("img",{staticClass:"commodity-list-popup__header__close-button",attrs:{src:t.ossImageUrl+"/talk-topic/close.png"},on:{click:function(e){return t.$emit("close")}}})]),s("div",{ref:"list",staticClass:"commodity-list-popup__list"},t._l(t.commodities,function(e,i){return s("div",{key:i,staticClass:"commodity-list-popup__commodity"},[s("img",{staticClass:"commodity-list-popup__commodity__image",attrs:{src:e.imageUrl}}),s("div",{staticClass:"commodity-list-popup__commodity__detail"},[s("div",{staticClass:"commodity-list-popup__commodity__name"},[t._v(t._s(e.commodityName))]),s("div",{staticClass:"commodity-list-popup__commodity__price"},[s("span",{staticClass:"commodity-list-popup__commodity__price__rmb-sign"},[t._v("¥ ")]),s("span",{staticClass:"commodity-list-popup__commodity__price__number"},[t._v(t._s(e.sellPrice))])])])])}),0)])])},Mp=[],$p={props:["commodities"],data:function(){return{ossImageUrl:"http://lawson-app.oss-cn-hangzhou.aliyuncs.com/miniprogram-new"}},mounted:function(){this.$refs.header.style.bottom="".concat(this.$refs.list.clientHeight-1,"px")}},Fp=$p,Op=(s("cbb6"),Object(_["a"])(Fp,Ep,Mp,!1,null,"2458eaf3",null)),Rp=Op.exports,Bp={components:{CommodityListPopup:Rp,GotoHome:St},data:function(){return{talkTopicDetail:null,commodityListPopupVisible:!1}},created:function(){var t=this,e=this.$route.params.id;vt.talkTopic.fetchTalkTopicDetail({talkTopicId:e}).then(function(e){t.talkTopicDetail=e}),ce.recordTalkTopicPopularStatistics(e)}},Up=Bp,jp=(s("07dd"),Object(_["a"])(Up,Lp,Pp,!1,null,"4129891b",null)),Hp=jp.exports,Wp=[{path:"/talk-topic-detail/:id",name:"talk-topic-detail",component:Hp,meta:{title:"聊话题"}}],Gp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"load-failed"},[s("div",{staticClass:"load-failed__icon"}),s("div",{staticClass:"load-failed__text"},[t._v("加载失败")]),s("div",{staticClass:"load-failed__button",on:{click:t.handleRefresh}},[t._v("刷新")])])},zp=[],Vp={methods:{handleRefresh:function(){this.$router.go(-1)}}},qp=Vp,Yp=(s("352c"),Object(_["a"])(qp,Gp,zp,!1,null,"00f4e6a0",null)),Qp=Yp.exports,Kp=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"network-unstable"},[s("div",{staticClass:"network-unstable__icon"}),s("div",{staticClass:"network-unstable__text"},[t._v("网络不稳定")]),s("div",{staticClass:"network-unstable__button",on:{click:t.handleRefresh}},[t._v("刷新")])])},Xp=[],Zp={methods:{handleRefresh:function(){this.$router.go(-1)}}},Jp=Zp,tu=(s("0b48"),Object(_["a"])(Jp,Kp,Xp,!1,null,"8cdef00e",null)),eu=tu.exports,su=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"no-network"},[s("div",{staticClass:"no-network__icon"}),s("div",{staticClass:"no-network__text"},[t._v("暂无网络")]),s("div",{staticClass:"no-network__button",on:{click:t.handleRefresh}},[t._v("刷新")])])},iu=[],nu={methods:{handleRefresh:function(){this.$router.go(-1)}}},au=nu,ou=(s("583c"),Object(_["a"])(au,su,iu,!1,null,"3e2a7f50",null)),cu=ou.exports,ru=[{path:"/load-failed",name:"load-failed",component:Qp,meta:{title:"加载失败"}},{path:"/network-unstable",name:"network-unstable",component:eu,meta:{title:"网络不稳定"}},{path:"/no-network",name:"no-network",component:cu,meta:{title:"暂无网络"}}],lu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.commodities?s("div",{staticClass:"commodity-list"},[s("pull-down-refresh",{attrs:{isRefreshing:t.isRefreshing},on:{refresh:t.fetchRecommendedCommodities}},t._l(t.commodities,function(e,i){return s("div",{key:i,staticClass:"commodity-list__item",on:{click:function(s){return t.toDetailView(e)}}},[s("img",{staticClass:"commodity-list__item__image",attrs:{src:e.pictureKeys[0]}}),s("div",{staticClass:"commodity-list__item__detail"},[s("div",{staticClass:"commodity-list__item__detail__name"},[t._v(t._s(e.commodityName))]),e.onlookerCount>10?s("div",{staticClass:"commodity-list__item__detail__popular"},[t._v("\n          "+t._s(e.onlookerCount)+"人围观\n        ")]):t._e(),s("div",{staticClass:"commodity-list__item__detail__price"},[s("span",{staticClass:"commodity-list__item__detail__price__rmb-sign"},[t._v("¥")]),s("span",{staticClass:"commodity-list__item__detail__price__number"},[t._v(t._s(t._f("formatRMB")(e.price)))])])])])}),0)],1):t._e()},du=[],pu={components:{PullDownRefresh:Vt},data:function(){return{commodities:null,isRefreshing:!1}},methods:{toDetailView:function(t){this.$router.push({path:"/recommended-commodity-detail/".concat(t.id)})},fetchRecommendedCommodities:function(){var t=this;this.isRefreshing=!0,Rt.show();var e=envService.getRegionBlockCode();vt.recommendedCommodity.fetchRecommendedCommodities({regionBlockCode:e}).then(function(e){t.commodities=e,Rt.hide(),t.isRefreshing=!1}).catch(function(e){t.isRefreshing=!1})}},filters:{formatRMB:function(t){return t.toFixed(2)}},created:function(){this.fetchRecommendedCommodities()}},uu=pu,_u=(s("8b72"),Object(_["a"])(uu,lu,du,!1,null,"1f0d0dc8",null)),mu=_u.exports,hu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return null!==t.commodity?s("div",{staticClass:"commodity-detail"},[s("img",{staticClass:"commodity-detail__image",attrs:{src:t.commodity.articleImage}}),s("goto-home")],1):t._e()},gu=[],vu={components:{GotoHome:St},data:function(){return{commodity:null}},created:function(){var t=this;Rt.show();var e=this.$route.params.id;vt.recommendedCommodity.fetchRecommendedCommodity({o2oCommodityId:e}).then(function(e){t.commodity=e,Rt.hide()})}},fu=vu,Cu=(s("8b3c"),Object(_["a"])(fu,hu,gu,!1,null,"f46e8eea",null)),yu=Cu.exports,bu=[{path:"/recommended-commodity-list",name:"recommended-commodity-list",component:mu,meta:{name:"购品质"}},{path:"/recommended-commodity-detail/:id",name:"recommended-commodity-detail",component:yu,meta:{name:"购品质详情"}}],wu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div")},Su=[],Du={beforeRouteEnter:function(t,e,s){"/choose-location"!==e.path&&wx.miniProgram.navigateTo({url:"/pages/webview-choose-location/webview-choose-location"}),s()},watch:{$route:function(){var t=JSON.parse(this.$route.query.location),e=!ne.a.isEmpty(t);e&&this.$store.commit("location/setLocationInfo",t),history.go(-2)}}},ku=Du,Tu=Object(_["a"])(ku,wu,Su,!1,null,"5e516f97",null),xu=Tu.exports,Au=[{path:"/choose-location",name:"choose-location",component:xu,meta:{title:"选择地址"}}],Iu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.shops&&t.oftenShops?s("div",{staticClass:"shop-list"},[s("div",{staticClass:"shop-list__search-container"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchShop,expression:"searchShop"}],staticClass:"shop-list__search-container__search-bar",attrs:{placeholder:"输入门店名称"},domProps:{value:t.searchShop},on:{input:function(e){e.target.composing||(t.searchShop=e.target.value)}}})]),s("div",{ref:"currentShop",staticClass:"shop-list__current-shop"},[t._m(0),s("div",{staticClass:"shop-list__current-shop__item"},[s("div",{staticClass:"shop-list__current-shop__item__icon-location"}),t.currentAddress?s("div",{staticClass:"shop-list__current-shop__item__current-address"},[t._v(t._s(t.currentAddress))]):t._e(),s("div",{staticClass:"shop-list__current-shop__item__refresh-location",on:{click:t.setCurrentAddress}},[t._v("重新定位")])]),s("div",{staticClass:"shop-list__whitespace"}),t.oftenShops.length>0?[t._m(1),t._l(t.oftenShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e(),s("div",{staticClass:"shop-list__whitespace"}),t.nearbyShops.length>0?[t._m(2),t._l(t.nearbyShops,function(t){return s("shop-item",{key:t.shopId,attrs:{shop:t}})})]:t._e()],2)]):t._e()},Nu=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-list__current-shop__title-row"},[s("span",{staticClass:"shop-list__current-shop__title-row__title"},[t._v("当前定位")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-list__my-shops__title-row"},[s("span",{staticClass:"shop-list__my-shops__title-row__title"},[t._v("常去店铺")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-list__nearby-shops__title-row"},[s("span",{staticClass:"shop-list__nearby-shops__title-row__title"},[t._v("附近店铺")])])}],Lu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"shop-item"},[s("div",{staticClass:"shop-item__info"},[s("div",{staticClass:"shop-item__basic-info"},[s("div",{staticClass:"shop-item__shop-name"},[s("span",[t._v(t._s(t.shop.shopName))]),""!==t.shop.businessTime?s("format-business-time",{attrs:{businessTime:t.shop.businessTime}}):t._e()],1),s("div",{staticClass:"shop-item__shop-address"},[t._v(t._s(t.shop.address))])]),t.shop.distance?s("div",{staticClass:"shop-item__map-info"},[s("div",{staticClass:"shop-item__distance"},[t._v("距您"+t._s(t._f("toKilometer")(t.shop.distance)))]),s("div",{staticClass:"shop-item__show-in-map",on:{click:t.openMap}},[t._v("地图 >")])]):t._e()])])},Pu=[],Eu={props:{shop:Object},components:{FormatBusinessTime:he},methods:{openMap:function(){wx.openLocation({latitude:this.shop.latitude,longitude:this.shop.longitude,name:this.shop.shopName,address:this.shop.address})}},filters:{toKilometer:function(t){return t>20?"> 20km":t.toFixed(2)+"km"}}},Mu=Eu,$u=(s("1774"),Object(_["a"])(Mu,Lu,Pu,!1,null,"4a62c5de",null)),Fu=$u.exports,Ou={components:{ShopItem:Fu},data:function(){return{oftenShops:null,currentAddress:null,nearbyShopsLength:10,searchShop:null,currentLocation:null}},created:function(){this.fetchOftenShoplist()},mounted:function(){var t=this;ze.init().then(function(){t.setCurrentAddress()})},updated:function(){this.$refs.currentShop.addEventListener("scroll",this.handleScroll)},computed:{shops:function(){var t=this.$store.state.shop.shops;if(ne.a.isEmpty(t))return[];var e=gt.getRegionBlockCode();return t[e]},sortedShopsWithDistance:function(){var t=this.currentLocation;if(t){var e=this.shops.map(function(e){var s=te()({},e);return s.distance=oe(e.latitude,e.longitude,t.latitude,t.longitude),s});return e.sort(function(t,e){return t.distance-e.distance}),e}return this.shops},filterShops:function(){var t=this;return this.searchShop?this.sortedShopsWithDistance.filter(function(e){return e.shopName.includes(t.searchShop)}):this.sortedShopsWithDistance},currentShop:function(){return this.sortedShopsWithDistance[0]},myShops:function(){return this.sortedShopsWithDistance.slice(1,3)},nearbyShops:function(){return this.filterShops.slice(0,this.nearbyShopsLength)}},methods:{handleScroll:ne.a.debounce(function(){var t=this.$refs.currentShop.scrollTop,e=this.$refs.currentShop.clientHeight,s=this.$refs.currentShop.scrollHeight,i=s<=e+t;i&&(this.nearbyShopsLength+=10)},150),fetchOftenShoplist:function(){var t=this;Rt.show();var e=gt.getRegionBlockCode();vt.shop.fetchOftenShoplist({regionBlockCode:e}).then(function(e){t.oftenShops=e.data.data.slice(0,2)}).finally(function(){return Rt.hide()})},setCurrentAddress:function(){var t=this;this.currentAddress=null,ht.getLocation().then(function(e){var s=e.latitude,i=e.longitude;t.currentLocation={latitude:s,longitude:i},ze.getAddressByLatLng(s,i).then(function(e){t.currentAddress=e.address})})}}},Ru=Ou,Bu=(s("5c6b"),Object(_["a"])(Ru,Iu,Nu,!1,null,"0a235796",null)),Uu=Bu.exports,ju=[{path:"/nearby-shop-list",name:"nearby-shop-list",component:Uu,meta:{title:"附近门店"}}],Hu=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"takeout-intro"})},Wu=[],Gu={},zu=Gu,Vu=(s("0d5d"),Object(_["a"])(zu,Hu,Wu,!1,null,"0167f826",null)),qu=Vu.exports,Yu=[{path:"/takeout-intro",name:"takeout-intro",component:qu,meta:{title:"外卖预约介绍"}}],Qu=[].concat(Object(v["a"])(Js),Object(v["a"])(Yo),Object(v["a"])(Cd),Object(v["a"])(lp),Object(v["a"])(Np),Object(v["a"])(Wp),Object(v["a"])(ru),Object(v["a"])(bu),Object(v["a"])(Au),Object(v["a"])(ju),Object(v["a"])(Yu));i["a"].use(g["a"]);var Ku=new g["a"]({routes:Qu});Ku.afterEach(function(t,e){document.title=t.meta.title?t.meta.title:"罗森点点"});var Xu=Ku,Zu=s("2f62"),Ju=function(t){return"number"!==typeof t.latitude||"number"!==typeof t.longitude},t_=function(t){return 0!==t.businessStatus},e_=function(t){return 0!==t.delFlg},s_=function(t){return Ju(t)||t_(t)||e_(t)},i_={namespaced:!0,state:{shops:{}},getters:{shopsForRegion:function(t){return function(e){return t.shops[e].filter(function(t){return!s_(t)})}},shopsAvailableForRegion:function(t){return function(e){return void 0!==t.shops[e]}}},mutations:{updateShopsForRegion:function(t,e){var s=e.shops,n=e.regionBlockCode;i["a"].set(t.shops,n,s)}}},n_={namespaced:!0,state:{locationInfo:null},mutations:{setLocationInfo:function(t,e){t.locationInfo=e},cleanupLocationInfo:function(t){t.locationInfo=null}}};i["a"].use(Zu["a"]);var a_=new Zu["a"].Store({modules:{shop:i_,location:n_}}),o_=a_,c_=s("9579"),r_=s.n(c_),l_="500677044",d_="500677066",p_=new i["a"],u_={init:function(){r_.a.init({sid:l_,cid:d_,autoReport:1,senseHash:1,senseQuery:1,performanceMonitor:1,ignoreParams:[]}),p_.$watch(function(){return Xu.app.$route},function(){r_.a.pgv()})}};s("0038");i["a"].config.productionTip=!1;var __=function(){new i["a"]({router:Xu,store:o_,render:function(t){return t(h)}}).$mount("#app")};gt.init().then(function(){__(),u_.init();var t=gt.getRegionBlockCode();vt.shop.fetchShops({regionBlockCode:t}).then(function(e){var s=0===e.data.code;if(s){var i=e.data.data.list;o_.commit("shop/updateShopsForRegion",{shops:i,regionBlockCode:t})}})})},"583c":function(t,e,s){"use strict";var i=s("e2d7"),n=s.n(i);n.a},"5ad5":function(t,e,s){},"5c0b":function(t,e,s){"use strict";var i=s("ca2b"),n=s.n(i);n.a},"5c6b":function(t,e,s){"use strict";var i=s("62fd"),n=s.n(i);n.a},"5ceb":function(t,e,s){},"5d4f":function(t,e,s){"use strict";var i=s("d469"),n=s.n(i);n.a},"5e76":function(t,e,s){"use strict";var i=s("ace3"),n=s.n(i);n.a},"5f40":function(t,e,s){"use strict";var i=s("d698"),n=s.n(i);n.a},"600b":function(t,e,s){"use strict";var i=s("9580"),n=s.n(i);n.a},6032:function(t,e,s){"use strict";var i=s("0059"),n=s.n(i);n.a},6126:function(t,e,s){},6138:function(t,e,s){},6223:function(t,e,s){"use strict";var i=s("cc08"),n=s.n(i);n.a},"622b":function(t,e,s){},6288:function(t,e,s){},"62fd":function(t,e,s){},"655b":function(t,e,s){"use strict";var i=s("0a37"),n=s.n(i);n.a},"69c0":function(t,e,s){},"6b6a":function(t,e,s){},"6d4b":function(t,e,s){"use strict";var i=s("0b49"),n=s.n(i);n.a},"6e7c":function(t,e,s){},"6fb7":function(t,e,s){"use strict";var i=s("f7e4"),n=s.n(i);n.a},"6fe8":function(t,e,s){"use strict";var i=s("89e1"),n=s.n(i);n.a},"70f4":function(t,e,s){"use strict";var i=s("1b20"),n=s.n(i);n.a},"748a":function(t,e,s){"use strict";var i=s("02e5"),n=s.n(i);n.a},"74fe":function(t,e,s){"use strict";var i=s("b37b"),n=s.n(i);n.a},7764:function(t,e,s){},7770:function(t,e,s){"use strict";var i=s("4e6b"),n=s.n(i);n.a},7783:function(t,e,s){"use strict";var i=s("5ad5"),n=s.n(i);n.a},7832:function(t,e,s){},"79e50":function(t,e,s){"use strict";var i=s("9aff"),n=s.n(i);n.a},"7af5":function(t,e,s){"use strict";var i=s("f848"),n=s.n(i);n.a},"7dfb":function(t,e,s){"use strict";var i=s("b095"),n=s.n(i);n.a},"819c":function(t,e,s){},"81b0":function(t,e,s){},"81e0":function(t,e,s){"use strict";var i=s("cb13"),n=s.n(i);n.a},8469:function(t,e,s){"use strict";var i=s("ee5e"),n=s.n(i);n.a},8732:function(t,e,s){"use strict";var i=s("272d"),n=s.n(i);n.a},"87c8":function(t,e,s){},"880b":function(t,e,s){},"89e1":function(t,e,s){},"8a27":function(t,e,s){},"8b3c":function(t,e,s){"use strict";var i=s("19b6"),n=s.n(i);n.a},"8b72":function(t,e,s){"use strict";var i=s("bb72"),n=s.n(i);n.a},"8e19":function(t,e,s){"use strict";var i=s("b68f"),n=s.n(i);n.a},"8f65":function(t,e,s){},"915b":function(t,e,s){},"92bc":function(t,e,s){"use strict";var i=s("ecd6"),n=s.n(i);n.a},"92ff":function(t,e,s){},9580:function(t,e,s){},9587:function(t,e,s){},"95a5":function(t,e,s){"use strict";var i=s("9587"),n=s.n(i);n.a},"95da":function(t,e,s){"use strict";var i=s("df90"),n=s.n(i);n.a},9882:function(t,e,s){},"9aff":function(t,e,s){},"9ba9":function(t,e,s){"use strict";var i=s("d97d"),n=s.n(i);n.a},"9edc":function(t,e,s){"use strict";var i=s("4ccb"),n=s.n(i);n.a},a087:function(t,e,s){"use strict";var i=s("fffc"),n=s.n(i);n.a},a203:function(t,e,s){"use strict";var i=s("2691"),n=s.n(i);n.a},a29c:function(t,e,s){},a34c:function(t,e,s){"use strict";var i=s("6b6a"),n=s.n(i);n.a},a4a5:function(t,e,s){"use strict";var i=s("1458"),n=s.n(i);n.a},a4e8:function(t,e,s){"use strict";var i=s("47e4"),n=s.n(i);n.a},a66a:function(t,e,s){"use strict";var i=s("81b0"),n=s.n(i);n.a},a6fc:function(t,e,s){"use strict";var i=s("0f02"),n=s.n(i);n.a},a9d3:function(t,e,s){},ace3:function(t,e,s){},afa2:function(t,e,s){"use strict";var i=s("33a7"),n=s.n(i);n.a},afc2:function(t,e,s){"use strict";var i=s("d81e"),n=s.n(i);n.a},b06b:function(t,e,s){},b095:function(t,e,s){},b32f:function(t,e,s){},b37b:function(t,e,s){},b66f:function(t,e,s){"use strict";var i=s("819c"),n=s.n(i);n.a},b68f:function(t,e,s){},b6c9:function(t,e,s){"use strict";var i=s("318b"),n=s.n(i);n.a},ba75:function(t,e,s){},bb23:function(t,e,s){"use strict";var i=s("d00d"),n=s.n(i);n.a},bb72:function(t,e,s){},bd1e:function(t,e,s){"use strict";var i=s("6e7c"),n=s.n(i);n.a},bde1:function(t,e,s){"use strict";var i=s("b32f"),n=s.n(i);n.a},c01d:function(t,e,s){},c168:function(t,e,s){"use strict";var i=s("0f67"),n=s.n(i);n.a},c1c0:function(t,e,s){"use strict";var i=s("92ff"),n=s.n(i);n.a},c25f:function(t,e,s){},c2d3:function(t,e,s){"use strict";var i=s("5616"),n=s.n(i);n.a},c37f:function(t,e,s){},c3b2:function(t,e,s){},c400:function(t,e,s){},c462:function(t,e,s){"use strict";var i=s("344e"),n=s.n(i);n.a},c536:function(t,e,s){"use strict";var i=s("e79f"),n=s.n(i);n.a},c98c:function(t,e,s){"use strict";var i=s("5ceb"),n=s.n(i);n.a},ca2b:function(t,e,s){},cb13:function(t,e,s){},cb54:function(t,e,s){},cbb6:function(t,e,s){"use strict";var i=s("7832"),n=s.n(i);n.a},cc08:function(t,e,s){},d00d:function(t,e,s){},d072:function(t,e,s){},d469:function(t,e,s){},d662:function(t,e,s){"use strict";var i=s("49bc"),n=s.n(i);n.a},d698:function(t,e,s){},d81e:function(t,e,s){},d88c:function(t,e,s){"use strict";var i=s("c400"),n=s.n(i);n.a},d95f:function(t,e,s){"use strict";var i=s("f70c"),n=s.n(i);n.a},d97d:function(t,e,s){},da46:function(t,e,s){"use strict";var i=s("0a68"),n=s.n(i);n.a},da66:function(t,e,s){},de52:function(t,e,s){"use strict";var i=s("00e6"),n=s.n(i);n.a},df90:function(t,e,s){},dfe4:function(t,e,s){"use strict";var i=s("69c0"),n=s.n(i);n.a},e2d7:function(t,e,s){},e4c7:function(t,e,s){"use strict";var i=s("7764"),n=s.n(i);n.a},e637:function(t,e,s){},e79f:function(t,e,s){},ea6d:function(t,e,s){},ecd6:function(t,e,s){},ee5e:function(t,e,s){},ef3e:function(t,e,s){},f0a7:function(t,e,s){"use strict";var i=s("c3b2"),n=s.n(i);n.a},f1b9:function(t,e,s){},f70c:function(t,e,s){},f7e4:function(t,e,s){},f848:function(t,e,s){},f948:function(t,e,s){"use strict";var i=s("051d"),n=s.n(i);n.a},f9cc:function(t,e,s){"use strict";var i=s("87c8"),n=s.n(i);n.a},fa16:function(t,e,s){"use strict";var i=s("915b"),n=s.n(i);n.a},fc26:function(t,e,s){"use strict";var i=s("9882"),n=s.n(i);n.a},fdd2:function(t,e,s){"use strict";var i=s("8a27"),n=s.n(i);n.a},fffc:function(t,e,s){}});
//# sourceMappingURL=app.2ddc2347.js.map